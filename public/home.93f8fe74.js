parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"3Z1+":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=Object.freeze({});function n(t){return null==t}function r(t){return null!=t}function o(t){return!0===t}function i(t){return!1===t}function a(t){return"string"==typeof t||"number"==typeof t||"symbol"==typeof t||"boolean"==typeof t}function s(t){return null!==t&&"object"==typeof t}var c=Object.prototype.toString;function u(t){return c.call(t).slice(8,-1)}function l(t){return"[object Object]"===c.call(t)}function f(t){return"[object RegExp]"===c.call(t)}function p(t){var e=parseFloat(String(t));return e>=0&&Math.floor(e)===e&&isFinite(t)}function d(t){return r(t)&&"function"==typeof t.then&&"function"==typeof t.catch}function v(t){return null==t?"":Array.isArray(t)||l(t)&&t.toString===c?JSON.stringify(t,null,2):String(t)}function h(t){var e=parseFloat(t);return isNaN(e)?t:e}function m(t,e){for(var n=Object.create(null),r=t.split(","),o=0;o<r.length;o++)n[r[o]]=!0;return e?function(t){return n[t.toLowerCase()]}:function(t){return n[t]}}var y=m("slot,component",!0),g=m("key,ref,slot,slot-scope,is");function _(t,e){if(t.length){var n=t.indexOf(e);if(n>-1)return t.splice(n,1)}}var b=Object.prototype.hasOwnProperty;function C(t,e){return b.call(t,e)}function w(t){var e=Object.create(null);return function(n){return e[n]||(e[n]=t(n))}}var $=/-(\w)/g,A=w(function(t){return t.replace($,function(t,e){return e?e.toUpperCase():""})}),x=w(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}),O=/\B([A-Z])/g,k=w(function(t){return t.replace(O,"-$1").toLowerCase()});function S(t,e){function n(n){var r=arguments.length;return r?r>1?t.apply(e,arguments):t.call(e,n):t.call(e)}return n._length=t.length,n}function j(t,e){return t.bind(e)}var E=Function.prototype.bind?j:S;function T(t,e){e=e||0;for(var n=t.length-e,r=new Array(n);n--;)r[n]=t[n+e];return r}function I(t,e){for(var n in e)t[n]=e[n];return t}function D(t){for(var e={},n=0;n<t.length;n++)t[n]&&I(e,t[n]);return e}function N(t,e,n){}var L=function(t,e,n){return!1},P=function(t){return t};function M(t,e){if(t===e)return!0;var n=s(t),r=s(e);if(!n||!r)return!n&&!r&&String(t)===String(e);try{var o=Array.isArray(t),i=Array.isArray(e);if(o&&i)return t.length===e.length&&t.every(function(t,n){return M(t,e[n])});if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(o||i)return!1;var a=Object.keys(t),c=Object.keys(e);return a.length===c.length&&a.every(function(n){return M(t[n],e[n])})}catch(u){return!1}}function F(t,e){for(var n=0;n<t.length;n++)if(M(t[n],e))return n;return-1}function R(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}var H="data-server-rendered",U=["component","directive","filter"],B=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],z={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:L,isReservedAttr:L,isUnknownElement:L,getTagNamespace:N,parsePlatformTagName:P,mustUseProp:L,async:!0,_lifecycleHooks:B},V=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function W(t){var e=(t+"").charCodeAt(0);return 36===e||95===e}function q(t,e,n,r){Object.defineProperty(t,e,{value:n,enumerable:!!r,writable:!0,configurable:!0})}var K=new RegExp("[^"+V.source+".$_\\d]");function X(t){if(!K.test(t)){var e=t.split(".");return function(t){for(var n=0;n<e.length;n++){if(!t)return;t=t[e[n]]}return t}}}var G,Z="__proto__"in{},J="undefined"!=typeof window,Q="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,Y=Q&&WXEnvironment.platform.toLowerCase(),tt=J&&window.navigator.userAgent.toLowerCase(),et=tt&&/msie|trident/.test(tt),nt=tt&&tt.indexOf("msie 9.0")>0,rt=tt&&tt.indexOf("edge/")>0,ot=tt&&tt.indexOf("android")>0||"android"===Y,it=tt&&/iphone|ipad|ipod|ios/.test(tt)||"ios"===Y,at=tt&&/chrome\/\d+/.test(tt)&&!rt,st=tt&&/phantomjs/.test(tt),ct=tt&&tt.match(/firefox\/(\d+)/),ut={}.watch,lt=!1;if(J)try{var ft={};Object.defineProperty(ft,"passive",{get:function(){lt=!0}}),window.addEventListener("test-passive",null,ft)}catch(as){}var pt=function(){return void 0===G&&(G=!J&&!Q&&void 0!==t&&(t.process&&"server"===t.process.env.VUE_ENV)),G},dt=J&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function vt(t){return"function"==typeof t&&/native code/.test(t.toString())}var ht,mt="undefined"!=typeof Symbol&&vt(Symbol)&&"undefined"!=typeof Reflect&&vt(Reflect.ownKeys);ht="undefined"!=typeof Set&&vt(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var yt,gt,_t,bt,Ct=N,wt=N,$t=N,At=N,xt=0,Ot=function(){this.id=xt++,this.subs=[]};Ot.prototype.addSub=function(t){this.subs.push(t)},Ot.prototype.removeSub=function(t){_(this.subs,t)},Ot.prototype.depend=function(){Ot.target&&Ot.target.addDep(this)},Ot.prototype.notify=function(){var t=this.subs.slice();for(var e=0,n=t.length;e<n;e++)t[e].update()},Ot.target=null;var kt=[];function St(t){kt.push(t),Ot.target=t}function jt(){kt.pop(),Ot.target=kt[kt.length-1]}var Et=function(t,e,n,r,o,i,a,s){this.tag=t,this.data=e,this.children=n,this.text=r,this.elm=o,this.ns=void 0,this.context=i,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=a,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},Tt={child:{configurable:!0}};Tt.child.get=function(){return this.componentInstance},Object.defineProperties(Et.prototype,Tt);var It=function(t){void 0===t&&(t="");var e=new Et;return e.text=t,e.isComment=!0,e};function Dt(t){return new Et(void 0,void 0,void 0,String(t))}function Nt(t){var e=new Et(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}var Lt=Array.prototype,Pt=Object.create(Lt),Mt=["push","pop","shift","unshift","splice","sort","reverse"];Mt.forEach(function(t){var e=Lt[t];q(Pt,t,function(){for(var n=[],r=arguments.length;r--;)n[r]=arguments[r];var o,i=e.apply(this,n),a=this.__ob__;switch(t){case"push":case"unshift":o=n;break;case"splice":o=n.slice(2)}return o&&a.observeArray(o),a.dep.notify(),i})});var Ft=Object.getOwnPropertyNames(Pt),Rt=!0;function Ht(t){Rt=t}var Ut=function(t){this.value=t,this.dep=new Ot,this.vmCount=0,q(t,"__ob__",this),Array.isArray(t)?(Z?Bt(t,Pt):zt(t,Pt,Ft),this.observeArray(t)):this.walk(t)};function Bt(t,e){t.__proto__=e}function zt(t,e,n){for(var r=0,o=n.length;r<o;r++){var i=n[r];q(t,i,e[i])}}function Vt(t,e){var n;if(s(t)&&!(t instanceof Et))return C(t,"__ob__")&&t.__ob__ instanceof Ut?n=t.__ob__:Rt&&!pt()&&(Array.isArray(t)||l(t))&&Object.isExtensible(t)&&!t._isVue&&(n=new Ut(t)),e&&n&&n.vmCount++,n}function Wt(t,e,n,r,o){var i=new Ot,a=Object.getOwnPropertyDescriptor(t,e);if(!a||!1!==a.configurable){var s=a&&a.get,c=a&&a.set;s&&!c||2!==arguments.length||(n=t[e]);var u=!o&&Vt(n);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=s?s.call(t):n;return Ot.target&&(i.depend(),u&&(u.dep.depend(),Array.isArray(e)&&Xt(e))),e},set:function(e){var r=s?s.call(t):n;e===r||e!=e&&r!=r||s&&!c||(c?c.call(t,e):n=e,u=!o&&Vt(e),i.notify())}})}}function qt(t,e,n){if(Array.isArray(t)&&p(e))return t.length=Math.max(t.length,e),t.splice(e,1,n),n;if(e in t&&!(e in Object.prototype))return t[e]=n,n;var r=t.__ob__;return t._isVue||r&&r.vmCount?n:r?(Wt(r.value,e,n),r.dep.notify(),n):(t[e]=n,n)}function Kt(t,e){if(Array.isArray(t)&&p(e))t.splice(e,1);else{var n=t.__ob__;t._isVue||n&&n.vmCount||C(t,e)&&(delete t[e],n&&n.dep.notify())}}function Xt(t){for(var e=void 0,n=0,r=t.length;n<r;n++)(e=t[n])&&e.__ob__&&e.__ob__.dep.depend(),Array.isArray(e)&&Xt(e)}Ut.prototype.walk=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)Wt(t,e[n])},Ut.prototype.observeArray=function(t){for(var e=0,n=t.length;e<n;e++)Vt(t[e])};var Gt=z.optionMergeStrategies;function Zt(t,e){if(!e)return t;for(var n,r,o,i=mt?Reflect.ownKeys(e):Object.keys(e),a=0;a<i.length;a++)"__ob__"!==(n=i[a])&&(r=t[n],o=e[n],C(t,n)?r!==o&&l(r)&&l(o)&&Zt(r,o):qt(t,n,o));return t}function Jt(t,e,n){return n?function(){var r="function"==typeof e?e.call(n,n):e,o="function"==typeof t?t.call(n,n):t;return r?Zt(r,o):o}:e?t?function(){return Zt("function"==typeof e?e.call(this,this):e,"function"==typeof t?t.call(this,this):t)}:e:t}function Qt(t,e){var n=e?t?t.concat(e):Array.isArray(e)?e:[e]:t;return n?Yt(n):n}function Yt(t){for(var e=[],n=0;n<t.length;n++)-1===e.indexOf(t[n])&&e.push(t[n]);return e}function te(t,e,n,r){var o=Object.create(t||null);return e?I(o,e):o}Gt.data=function(t,e,n){return n?Jt(t,e,n):e&&"function"!=typeof e?t:Jt(t,e)},B.forEach(function(t){Gt[t]=Qt}),U.forEach(function(t){Gt[t+"s"]=te}),Gt.watch=function(t,e,n,r){if(t===ut&&(t=void 0),e===ut&&(e=void 0),!e)return Object.create(t||null);if(!t)return e;var o={};for(var i in I(o,t),e){var a=o[i],s=e[i];a&&!Array.isArray(a)&&(a=[a]),o[i]=a?a.concat(s):Array.isArray(s)?s:[s]}return o},Gt.props=Gt.methods=Gt.inject=Gt.computed=function(t,e,n,r){if(!t)return e;var o=Object.create(null);return I(o,t),e&&I(o,e),o},Gt.provide=Jt;var ee=function(t,e){return void 0===e?t:e};function ne(t){for(var e in t.components)re(e)}function re(t){new RegExp("^[a-zA-Z][\\-\\.0-9_"+V.source+"]*$").test(t)||Ct('Invalid component name: "'+t+'". Component names should conform to valid custom element name in html5 specification.'),(y(t)||z.isReservedTag(t))&&Ct("Do not use built-in or reserved HTML elements as component id: "+t)}function oe(t,e){var n=t.props;if(n){var r,o,i={};if(Array.isArray(n))for(r=n.length;r--;)"string"==typeof(o=n[r])&&(i[A(o)]={type:null});else if(l(n))for(var a in n)o=n[a],i[A(a)]=l(o)?o:{type:o};else 0;t.props=i}}function ie(t,e){var n=t.inject;if(n){var r=t.inject={};if(Array.isArray(n))for(var o=0;o<n.length;o++)r[n[o]]={from:n[o]};else if(l(n))for(var i in n){var a=n[i];r[i]=l(a)?I({from:i},a):{from:a}}else 0}}function ae(t){var e=t.directives;if(e)for(var n in e){var r=e[n];"function"==typeof r&&(e[n]={bind:r,update:r})}}function se(t,e,n){l(e)||Ct('Invalid value for option "'+t+'": expected an Object, but got '+u(e)+".",n)}function ce(t,e,n){if("function"==typeof e&&(e=e.options),oe(e,n),ie(e,n),ae(e),!e._base&&(e.extends&&(t=ce(t,e.extends,n)),e.mixins))for(var r=0,o=e.mixins.length;r<o;r++)t=ce(t,e.mixins[r],n);var i,a={};for(i in t)s(i);for(i in e)C(t,i)||s(i);function s(r){var o=Gt[r]||ee;a[r]=o(t[r],e[r],n,r)}return a}function ue(t,e,n,r){if("string"==typeof n){var o=t[e];if(C(o,n))return o[n];var i=A(n);if(C(o,i))return o[i];var a=x(i);if(C(o,a))return o[a];var s=o[n]||o[i]||o[a];return s}}function le(t,e,n,r){var o=e[t],i=!C(n,t),a=n[t],s=ye(Boolean,o.type);if(s>-1)if(i&&!C(o,"default"))a=!1;else if(""===a||a===k(t)){var c=ye(String,o.type);(c<0||s<c)&&(a=!0)}if(void 0===a){a=fe(r,o,t);var u=Rt;Ht(!0),Vt(a),Ht(u)}return a}function fe(t,e,n){if(C(e,"default")){var r=e.default;return t&&t.$options.propsData&&void 0===t.$options.propsData[n]&&void 0!==t._props[n]?t._props[n]:"function"==typeof r&&"Function"!==he(e.type)?r.call(t):r}}function pe(t,e,n,r,o){if(t.required&&o)Ct('Missing required prop: "'+e+'"',r);else if(null!=n||t.required){var i=t.type,a=!i||!0===i,s=[];if(i){Array.isArray(i)||(i=[i]);for(var c=0;c<i.length&&!a;c++){var u=ve(n,i[c]);s.push(u.expectedType||""),a=u.valid}}if(a){var l=t.validator;l&&(l(n)||Ct('Invalid prop: custom validator check failed for prop "'+e+'".',r))}else Ct(ge(e,n,s),r)}}var de=/^(String|Number|Boolean|Function|Symbol)$/;function ve(t,e){var n,r=he(e);if(de.test(r)){var o=typeof t;(n=o===r.toLowerCase())||"object"!==o||(n=t instanceof e)}else n="Object"===r?l(t):"Array"===r?Array.isArray(t):t instanceof e;return{valid:n,expectedType:r}}function he(t){var e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:""}function me(t,e){return he(t)===he(e)}function ye(t,e){if(!Array.isArray(e))return me(e,t)?0:-1;for(var n=0,r=e.length;n<r;n++)if(me(e[n],t))return n;return-1}function ge(t,e,n){var r='Invalid prop: type check failed for prop "'+t+'". Expected '+n.map(x).join(", "),o=n[0],i=u(e),a=_e(e,o),s=_e(e,i);return 1===n.length&&be(o)&&!Ce(o,i)&&(r+=" with value "+a),r+=", got "+i+" ",be(i)&&(r+="with value "+s+"."),r}function _e(t,e){return"String"===e?'"'+t+'"':"Number"===e?""+Number(t):""+t}function be(t){return["string","number","boolean"].some(function(e){return t.toLowerCase()===e})}function Ce(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return t.some(function(t){return"boolean"===t.toLowerCase()})}function we(t,e,n){St();try{if(e)for(var r=e;r=r.$parent;){var o=r.$options.errorCaptured;if(o)for(var i=0;i<o.length;i++)try{if(!1===o[i].call(r,t,e,n))return}catch(as){Ae(as,r,"errorCaptured hook")}}Ae(t,e,n)}finally{jt()}}function $e(t,e,n,r,o){var i;try{(i=n?t.apply(e,n):t.call(e))&&!i._isVue&&d(i)&&!i._handled&&(i.catch(function(t){return we(t,r,o+" (Promise/async)")}),i._handled=!0)}catch(as){we(as,r,o)}return i}function Ae(t,e,n){if(z.errorHandler)try{return z.errorHandler.call(null,t,e,n)}catch(as){as!==t&&xe(as,null,"config.errorHandler")}xe(t,e,n)}function xe(t,e,n){if(!J&&!Q||"undefined"==typeof console)throw t;console.error(t)}var Oe,ke,Se,je,Ee,Te,Ie,De,Ne,Le=!1,Pe=[],Me=!1;function Fe(){Me=!1;var t=Pe.slice(0);Pe.length=0;for(var e=0;e<t.length;e++)t[e]()}if("undefined"!=typeof Promise&&vt(Promise)){var Re=Promise.resolve();Oe=function(){Re.then(Fe),it&&setTimeout(N)},Le=!0}else if(et||"undefined"==typeof MutationObserver||!vt(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Oe="undefined"!=typeof setImmediate&&vt(setImmediate)?function(){setImmediate(Fe)}:function(){setTimeout(Fe,0)};else{var He=1,Ue=new MutationObserver(Fe),Be=document.createTextNode(String(He));Ue.observe(Be,{characterData:!0}),Oe=function(){He=(He+1)%2,Be.data=String(He)},Le=!0}function ze(t,e){var n;if(Pe.push(function(){if(t)try{t.call(e)}catch(as){we(as,e,"nextTick")}else n&&n(e)}),Me||(Me=!0,Oe()),!t&&"undefined"!=typeof Promise)return new Promise(function(t){n=t})}var Ve,We,qe,Ke=new ht;function Xe(t){Ge(t,Ke),Ke.clear()}function Ge(t,e){var n,r,o=Array.isArray(t);if(!(!o&&!s(t)||Object.isFrozen(t)||t instanceof Et)){if(t.__ob__){var i=t.__ob__.dep.id;if(e.has(i))return;e.add(i)}if(o)for(n=t.length;n--;)Ge(t[n],e);else for(n=(r=Object.keys(t)).length;n--;)Ge(t[r[n]],e)}}var Ze=w(function(t){var e="&"===t.charAt(0),n="~"===(t=e?t.slice(1):t).charAt(0),r="!"===(t=n?t.slice(1):t).charAt(0);return{name:t=r?t.slice(1):t,once:n,capture:r,passive:e}});function Je(t,e){function n(){var t=arguments,r=n.fns;if(!Array.isArray(r))return $e(r,null,arguments,e,"v-on handler");for(var o=r.slice(),i=0;i<o.length;i++)$e(o[i],null,t,e,"v-on handler")}return n.fns=t,n}function Qe(t,e,r,i,a,s){var c,u,l,f;for(c in t)u=t[c],l=e[c],f=Ze(c),n(u)||(n(l)?(n(u.fns)&&(u=t[c]=Je(u,s)),o(f.once)&&(u=t[c]=a(f.name,u,f.capture)),r(f.name,u,f.capture,f.passive,f.params)):u!==l&&(l.fns=u,t[c]=l));for(c in e)n(t[c])&&i((f=Ze(c)).name,e[c],f.capture)}function Ye(t,e,i){var a;t instanceof Et&&(t=t.data.hook||(t.data.hook={}));var s=t[e];function c(){i.apply(this,arguments),_(a.fns,c)}n(s)?a=Je([c]):r(s.fns)&&o(s.merged)?(a=s).fns.push(c):a=Je([s,c]),a.merged=!0,t[e]=a}function tn(t,e,o){var i=e.options.props;if(!n(i)){var a={},s=t.attrs,c=t.props;if(r(s)||r(c))for(var u in i){var l=k(u);en(a,c,u,l,!0)||en(a,s,u,l,!1)}return a}}function en(t,e,n,o,i){if(r(e)){if(C(e,n))return t[n]=e[n],i||delete e[n],!0;if(C(e,o))return t[n]=e[o],i||delete e[o],!0}return!1}function nn(t){for(var e=0;e<t.length;e++)if(Array.isArray(t[e]))return Array.prototype.concat.apply([],t);return t}function rn(t){return a(t)?[Dt(t)]:Array.isArray(t)?an(t):void 0}function on(t){return r(t)&&r(t.text)&&i(t.isComment)}function an(t,e){var i,s,c,u,l=[];for(i=0;i<t.length;i++)n(s=t[i])||"boolean"==typeof s||(u=l[c=l.length-1],Array.isArray(s)?s.length>0&&(on((s=an(s,(e||"")+"_"+i))[0])&&on(u)&&(l[c]=Dt(u.text+s[0].text),s.shift()),l.push.apply(l,s)):a(s)?on(u)?l[c]=Dt(u.text+s):""!==s&&l.push(Dt(s)):on(s)&&on(u)?l[c]=Dt(u.text+s.text):(o(t._isVList)&&r(s.tag)&&n(s.key)&&r(e)&&(s.key="__vlist"+e+"_"+i+"__"),l.push(s)));return l}function sn(t){var e=t.$options.provide;e&&(t._provided="function"==typeof e?e.call(t):e)}function cn(t){var e=un(t.$options.inject,t);e&&(Ht(!1),Object.keys(e).forEach(function(n){Wt(t,n,e[n])}),Ht(!0))}function un(t,e){if(t){for(var n=Object.create(null),r=mt?Reflect.ownKeys(t):Object.keys(t),o=0;o<r.length;o++){var i=r[o];if("__ob__"!==i){for(var a=t[i].from,s=e;s;){if(s._provided&&C(s._provided,a)){n[i]=s._provided[a];break}s=s.$parent}if(!s)if("default"in t[i]){var c=t[i].default;n[i]="function"==typeof c?c.call(e):c}else 0}}return n}}function ln(t,e){if(!t||!t.length)return{};for(var n={},r=0,o=t.length;r<o;r++){var i=t[r],a=i.data;if(a&&a.attrs&&a.attrs.slot&&delete a.attrs.slot,i.context!==e&&i.fnContext!==e||!a||null==a.slot)(n.default||(n.default=[])).push(i);else{var s=a.slot,c=n[s]||(n[s]=[]);"template"===i.tag?c.push.apply(c,i.children||[]):c.push(i)}}for(var u in n)n[u].every(fn)&&delete n[u];return n}function fn(t){return t.isComment&&!t.asyncFactory||" "===t.text}function pn(t,n,r){var o,i=Object.keys(n).length>0,a=t?!!t.$stable:!i,s=t&&t.$key;if(t){if(t._normalized)return t._normalized;if(a&&r&&r!==e&&s===r.$key&&!i&&!r.$hasNormal)return r;for(var c in o={},t)t[c]&&"$"!==c[0]&&(o[c]=dn(n,c,t[c]))}else o={};for(var u in n)u in o||(o[u]=vn(n,u));return t&&Object.isExtensible(t)&&(t._normalized=o),q(o,"$stable",a),q(o,"$key",s),q(o,"$hasNormal",i),o}function dn(t,e,n){var r=function(){var t=arguments.length?n.apply(null,arguments):n({});return(t=t&&"object"==typeof t&&!Array.isArray(t)?[t]:rn(t))&&(0===t.length||1===t.length&&t[0].isComment)?void 0:t};return n.proxy&&Object.defineProperty(t,e,{get:r,enumerable:!0,configurable:!0}),r}function vn(t,e){return function(){return t[e]}}function hn(t,e){var n,o,i,a,c;if(Array.isArray(t)||"string"==typeof t)for(n=new Array(t.length),o=0,i=t.length;o<i;o++)n[o]=e(t[o],o);else if("number"==typeof t)for(n=new Array(t),o=0;o<t;o++)n[o]=e(o+1,o);else if(s(t))if(mt&&t[Symbol.iterator]){n=[];for(var u=t[Symbol.iterator](),l=u.next();!l.done;)n.push(e(l.value,n.length)),l=u.next()}else for(a=Object.keys(t),n=new Array(a.length),o=0,i=a.length;o<i;o++)c=a[o],n[o]=e(t[c],c,o);return r(n)||(n=[]),n._isVList=!0,n}function mn(t,e,n,r){var o,i=this.$scopedSlots[t];i?(n=n||{},r&&(n=I(I({},r),n)),o=i(n)||e):o=this.$slots[t]||e;var a=n&&n.slot;return a?this.$createElement("template",{slot:a},o):o}function yn(t){return ue(this.$options,"filters",t,!0)||P}function gn(t,e){return Array.isArray(t)?-1===t.indexOf(e):t!==e}function _n(t,e,n,r,o){var i=z.keyCodes[e]||n;return o&&r&&!z.keyCodes[e]?gn(o,r):i?gn(i,t):r?k(r)!==e:void 0}function bn(t,e,n,r,o){if(n)if(s(n)){var i;Array.isArray(n)&&(n=D(n));var a=function(a){if("class"===a||"style"===a||g(a))i=t;else{var s=t.attrs&&t.attrs.type;i=r||z.mustUseProp(e,s,a)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={})}var c=A(a),u=k(a);c in i||u in i||(i[a]=n[a],o&&((t.on||(t.on={}))["update:"+a]=function(t){n[a]=t}))};for(var c in n)a(c)}else;return t}function Cn(t,e){var n=this._staticTrees||(this._staticTrees=[]),r=n[t];return r&&!e?r:($n(r=n[t]=this.$options.staticRenderFns[t].call(this._renderProxy,null,this),"__static__"+t,!1),r)}function wn(t,e,n){return $n(t,"__once__"+e+(n?"_"+n:""),!0),t}function $n(t,e,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)t[r]&&"string"!=typeof t[r]&&An(t[r],e+"_"+r,n);else An(t,e,n)}function An(t,e,n){t.isStatic=!0,t.key=e,t.isOnce=n}function xn(t,e){if(e)if(l(e)){var n=t.on=t.on?I({},t.on):{};for(var r in e){var o=n[r],i=e[r];n[r]=o?[].concat(o,i):i}}else;return t}function On(t,e,n,r){e=e||{$stable:!n};for(var o=0;o<t.length;o++){var i=t[o];Array.isArray(i)?On(i,e,n):i&&(i.proxy&&(i.fn.proxy=!0),e[i.key]=i.fn)}return r&&(e.$key=r),e}function kn(t,e){for(var n=0;n<e.length;n+=2){var r=e[n];"string"==typeof r&&r&&(t[e[n]]=e[n+1])}return t}function Sn(t,e){return"string"==typeof t?e+t:t}function jn(t){t._o=wn,t._n=h,t._s=v,t._l=hn,t._t=mn,t._q=M,t._i=F,t._m=Cn,t._f=yn,t._k=_n,t._b=bn,t._v=Dt,t._e=It,t._u=On,t._g=xn,t._d=kn,t._p=Sn}function En(t,n,r,i,a){var s,c=this,u=a.options;C(i,"_uid")?(s=Object.create(i))._original=i:(s=i,i=i._original);var l=o(u._compiled),f=!l;this.data=t,this.props=n,this.children=r,this.parent=i,this.listeners=t.on||e,this.injections=un(u.inject,i),this.slots=function(){return c.$slots||pn(t.scopedSlots,c.$slots=ln(r,i)),c.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return pn(t.scopedSlots,this.slots())}}),l&&(this.$options=u,this.$slots=this.slots(),this.$scopedSlots=pn(t.scopedSlots,this.$slots)),u._scopeId?this._c=function(t,e,n,r){var o=zn(s,t,e,n,r,f);return o&&!Array.isArray(o)&&(o.fnScopeId=u._scopeId,o.fnContext=i),o}:this._c=function(t,e,n,r){return zn(s,t,e,n,r,f)}}function Tn(t,n,o,i,a){var s=t.options,c={},u=s.props;if(r(u))for(var l in u)c[l]=le(l,u,n||e);else r(o.attrs)&&Dn(c,o.attrs),r(o.props)&&Dn(c,o.props);var f=new En(o,c,a,i,t),p=s.render.call(null,f._c,f);if(p instanceof Et)return In(p,o,f.parent,s,f);if(Array.isArray(p)){for(var d=rn(p)||[],v=new Array(d.length),h=0;h<d.length;h++)v[h]=In(d[h],o,f.parent,s,f);return v}}function In(t,e,n,r,o){var i=Nt(t);return i.fnContext=n,i.fnOptions=r,e.slot&&((i.data||(i.data={})).slot=e.slot),i}function Dn(t,e){for(var n in e)t[A(n)]=e[n]}jn(En.prototype);var Nn={init:function(t,e){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var n=t;Nn.prepatch(n,n)}else{(t.componentInstance=Mn(t,cr)).$mount(e?t.elm:void 0,e)}},prepatch:function(t,e){var n=e.componentOptions;vr(e.componentInstance=t.componentInstance,n.propsData,n.listeners,e,n.children)},insert:function(t){var e=t.context,n=t.componentInstance;n._isMounted||(n._isMounted=!0,gr(n,"mounted")),t.data.keepAlive&&(e._isMounted?Dr(n):mr(n,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?yr(e,!0):e.$destroy())}},Ln=Object.keys(Nn);function Pn(t,e,i,a,c){if(!n(t)){var u=i.$options._base;if(s(t)&&(t=u.extend(t)),"function"==typeof t){var l;if(n(t.cid)&&void 0===(t=Yn(l=t,u)))return Qn(l,e,i,a,c);e=e||{},no(t),r(e.model)&&Hn(t.options,e);var f=tn(e,t,c);if(o(t.options.functional))return Tn(t,f,e,i,a);var p=e.on;if(e.on=e.nativeOn,o(t.options.abstract)){var d=e.slot;e={},d&&(e.slot=d)}Fn(e);var v=t.options.name||c;return new Et("vue-component-"+t.cid+(v?"-"+v:""),e,void 0,void 0,void 0,i,{Ctor:t,propsData:f,listeners:p,tag:c,children:a},l)}}}function Mn(t,e){var n={_isComponent:!0,_parentVnode:t,parent:e},o=t.data.inlineTemplate;return r(o)&&(n.render=o.render,n.staticRenderFns=o.staticRenderFns),new t.componentOptions.Ctor(n)}function Fn(t){for(var e=t.hook||(t.hook={}),n=0;n<Ln.length;n++){var r=Ln[n],o=e[r],i=Nn[r];o===i||o&&o._merged||(e[r]=o?Rn(i,o):i)}}function Rn(t,e){var n=function(n,r){t(n,r),e(n,r)};return n._merged=!0,n}function Hn(t,e){var n=t.model&&t.model.prop||"value",o=t.model&&t.model.event||"input";(e.attrs||(e.attrs={}))[n]=e.model.value;var i=e.on||(e.on={}),a=i[o],s=e.model.callback;r(a)?(Array.isArray(a)?-1===a.indexOf(s):a!==s)&&(i[o]=[s].concat(a)):i[o]=s}var Un=1,Bn=2;function zn(t,e,n,r,i,s){return(Array.isArray(n)||a(n))&&(i=r,r=n,n=void 0),o(s)&&(i=Bn),Vn(t,e,n,r,i)}function Vn(t,e,n,o,i){if(r(n)&&r(n.__ob__))return It();if(r(n)&&r(n.is)&&(e=n.is),!e)return It();var a,s,c;(Array.isArray(o)&&"function"==typeof o[0]&&((n=n||{}).scopedSlots={default:o[0]},o.length=0),i===Bn?o=rn(o):i===Un&&(o=nn(o)),"string"==typeof e)?(s=t.$vnode&&t.$vnode.ns||z.getTagNamespace(e),a=z.isReservedTag(e)?new Et(z.parsePlatformTagName(e),n,o,void 0,void 0,t):n&&n.pre||!r(c=ue(t.$options,"components",e))?new Et(e,n,o,void 0,void 0,t):Pn(c,n,t,o,e)):a=Pn(e,n,t,o);return Array.isArray(a)?a:r(a)?(r(s)&&Wn(a,s),r(n)&&qn(n),a):It()}function Wn(t,e,i){if(t.ns=e,"foreignObject"===t.tag&&(e=void 0,i=!0),r(t.children))for(var a=0,s=t.children.length;a<s;a++){var c=t.children[a];r(c.tag)&&(n(c.ns)||o(i)&&"svg"!==c.tag)&&Wn(c,e,i)}}function qn(t){s(t.style)&&Xe(t.style),s(t.class)&&Xe(t.class)}function Kn(t){t._vnode=null,t._staticTrees=null;var n=t.$options,r=t.$vnode=n._parentVnode,o=r&&r.context;t.$slots=ln(n._renderChildren,o),t.$scopedSlots=e,t._c=function(e,n,r,o){return zn(t,e,n,r,o,!1)},t.$createElement=function(e,n,r,o){return zn(t,e,n,r,o,!0)};var i=r&&r.data;Wt(t,"$attrs",i&&i.attrs||e,null,!0),Wt(t,"$listeners",n._parentListeners||e,null,!0)}var Xn,Gn=null;function Zn(t){jn(t.prototype),t.prototype.$nextTick=function(t){return ze(t,this)},t.prototype._render=function(){var t,e=this,n=e.$options,r=n.render,o=n._parentVnode;o&&(e.$scopedSlots=pn(o.data.scopedSlots,e.$slots,e.$scopedSlots)),e.$vnode=o;try{Gn=e,t=r.call(e._renderProxy,e.$createElement)}catch(as){we(as,e,"render"),t=e._vnode}finally{Gn=null}return Array.isArray(t)&&1===t.length&&(t=t[0]),t instanceof Et||(t=It()),t.parent=o,t}}function Jn(t,e){return(t.__esModule||mt&&"Module"===t[Symbol.toStringTag])&&(t=t.default),s(t)?e.extend(t):t}function Qn(t,e,n,r,o){var i=It();return i.asyncFactory=t,i.asyncMeta={data:e,context:n,children:r,tag:o},i}function Yn(t,e){if(o(t.error)&&r(t.errorComp))return t.errorComp;if(r(t.resolved))return t.resolved;var i=Gn;if(i&&r(t.owners)&&-1===t.owners.indexOf(i)&&t.owners.push(i),o(t.loading)&&r(t.loadingComp))return t.loadingComp;if(i&&!r(t.owners)){var a=t.owners=[i],c=!0,u=null,l=null;i.$on("hook:destroyed",function(){return _(a,i)});var f=function(t){for(var e=0,n=a.length;e<n;e++)a[e].$forceUpdate();t&&(a.length=0,null!==u&&(clearTimeout(u),u=null),null!==l&&(clearTimeout(l),l=null))},p=R(function(n){t.resolved=Jn(n,e),c?a.length=0:f(!0)}),v=R(function(e){r(t.errorComp)&&(t.error=!0,f(!0))}),h=t(p,v);return s(h)&&(d(h)?n(t.resolved)&&h.then(p,v):d(h.component)&&(h.component.then(p,v),r(h.error)&&(t.errorComp=Jn(h.error,e)),r(h.loading)&&(t.loadingComp=Jn(h.loading,e),0===h.delay?t.loading=!0:u=setTimeout(function(){u=null,n(t.resolved)&&n(t.error)&&(t.loading=!0,f(!1))},h.delay||200)),r(h.timeout)&&(l=setTimeout(function(){l=null,n(t.resolved)&&v(null)},h.timeout)))),c=!1,t.loading?t.loadingComp:t.resolved}}function tr(t){return t.isComment&&t.asyncFactory}function er(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var n=t[e];if(r(n)&&(r(n.componentOptions)||tr(n)))return n}}function nr(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&ar(t,e)}function rr(t,e){Xn.$on(t,e)}function or(t,e){Xn.$off(t,e)}function ir(t,e){var n=Xn;return function r(){null!==e.apply(null,arguments)&&n.$off(t,r)}}function ar(t,e,n){Xn=t,Qe(e,n||{},rr,or,ir,t),Xn=void 0}function sr(t){var e=/^hook:/;t.prototype.$on=function(t,n){var r=this;if(Array.isArray(t))for(var o=0,i=t.length;o<i;o++)r.$on(t[o],n);else(r._events[t]||(r._events[t]=[])).push(n),e.test(t)&&(r._hasHookEvent=!0);return r},t.prototype.$once=function(t,e){var n=this;function r(){n.$off(t,r),e.apply(n,arguments)}return r.fn=e,n.$on(t,r),n},t.prototype.$off=function(t,e){var n=this;if(!arguments.length)return n._events=Object.create(null),n;if(Array.isArray(t)){for(var r=0,o=t.length;r<o;r++)n.$off(t[r],e);return n}var i,a=n._events[t];if(!a)return n;if(!e)return n._events[t]=null,n;for(var s=a.length;s--;)if((i=a[s])===e||i.fn===e){a.splice(s,1);break}return n},t.prototype.$emit=function(t){var e=this,n=e._events[t];if(n){n=n.length>1?T(n):n;for(var r=T(arguments,1),o='event handler for "'+t+'"',i=0,a=n.length;i<a;i++)$e(n[i],e,r,e,o)}return e}}var cr=null,ur=!1;function lr(t){var e=cr;return cr=t,function(){cr=e}}function fr(t){var e=t.$options,n=e.parent;if(n&&!e.abstract){for(;n.$options.abstract&&n.$parent;)n=n.$parent;n.$children.push(t)}t.$parent=n,t.$root=n?n.$root:t,t.$children=[],t.$refs={},t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}function pr(t){t.prototype._update=function(t,e){var n=this,r=n.$el,o=n._vnode,i=lr(n);n._vnode=t,n.$el=o?n.__patch__(o,t):n.__patch__(n.$el,t,e,!1),i(),r&&(r.__vue__=null),n.$el&&(n.$el.__vue__=n),n.$vnode&&n.$parent&&n.$vnode===n.$parent._vnode&&(n.$parent.$el=n.$el)},t.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},t.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){gr(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||_(e.$children,t),t._watcher&&t._watcher.teardown();for(var n=t._watchers.length;n--;)t._watchers[n].teardown();t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,t.__patch__(t._vnode,null),gr(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.$vnode&&(t.$vnode.parent=null)}}}function dr(t,e,n){var r;return t.$el=e,t.$options.render||(t.$options.render=It),gr(t,"beforeMount"),r=function(){t._update(t._render(),n)},new Mr(t,r,N,{before:function(){t._isMounted&&!t._isDestroyed&&gr(t,"beforeUpdate")}},!0),n=!1,null==t.$vnode&&(t._isMounted=!0,gr(t,"mounted")),t}function vr(t,n,r,o,i){var a=o.data.scopedSlots,s=t.$scopedSlots,c=!!(a&&!a.$stable||s!==e&&!s.$stable||a&&t.$scopedSlots.$key!==a.$key),u=!!(i||t.$options._renderChildren||c);if(t.$options._parentVnode=o,t.$vnode=o,t._vnode&&(t._vnode.parent=o),t.$options._renderChildren=i,t.$attrs=o.data.attrs||e,t.$listeners=r||e,n&&t.$options.props){Ht(!1);for(var l=t._props,f=t.$options._propKeys||[],p=0;p<f.length;p++){var d=f[p],v=t.$options.props;l[d]=le(d,v,n,t)}Ht(!0),t.$options.propsData=n}r=r||e;var h=t.$options._parentListeners;t.$options._parentListeners=r,ar(t,r,h),u&&(t.$slots=ln(i,o.context),t.$forceUpdate())}function hr(t){for(;t&&(t=t.$parent);)if(t._inactive)return!0;return!1}function mr(t,e){if(e){if(t._directInactive=!1,hr(t))return}else if(t._directInactive)return;if(t._inactive||null===t._inactive){t._inactive=!1;for(var n=0;n<t.$children.length;n++)mr(t.$children[n]);gr(t,"activated")}}function yr(t,e){if(!(e&&(t._directInactive=!0,hr(t))||t._inactive)){t._inactive=!0;for(var n=0;n<t.$children.length;n++)yr(t.$children[n]);gr(t,"deactivated")}}function gr(t,e){St();var n=t.$options[e],r=e+" hook";if(n)for(var o=0,i=n.length;o<i;o++)$e(n[o],t,null,t,r);t._hasHookEvent&&t.$emit("hook:"+e),jt()}var _r=100,br=[],Cr=[],wr={},$r={},Ar=!1,xr=!1,Or=0;function kr(){Or=br.length=Cr.length=0,wr={},Ar=xr=!1}var Sr=0,jr=Date.now;if(J&&!et){var Er=window.performance;Er&&"function"==typeof Er.now&&jr()>document.createEvent("Event").timeStamp&&(jr=function(){return Er.now()})}function Tr(){var t,e;for(Sr=jr(),xr=!0,br.sort(function(t,e){return t.id-e.id}),Or=0;Or<br.length;Or++)(t=br[Or]).before&&t.before(),e=t.id,wr[e]=null,t.run();var n=Cr.slice(),r=br.slice();kr(),Nr(n),Ir(r),dt&&z.devtools&&dt.emit("flush")}function Ir(t){for(var e=t.length;e--;){var n=t[e],r=n.vm;r._watcher===n&&r._isMounted&&!r._isDestroyed&&gr(r,"updated")}}function Dr(t){t._inactive=!1,Cr.push(t)}function Nr(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,mr(t[e],!0)}function Lr(t){var e=t.id;if(null==wr[e]){if(wr[e]=!0,xr){for(var n=br.length-1;n>Or&&br[n].id>t.id;)n--;br.splice(n+1,0,t)}else br.push(t);Ar||(Ar=!0,ze(Tr))}}var Pr=0,Mr=function(t,e,n,r,o){this.vm=t,o&&(t._watcher=this),t._watchers.push(this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync,this.before=r.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++Pr,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new ht,this.newDepIds=new ht,this.expression="","function"==typeof e?this.getter=e:(this.getter=X(e),this.getter||(this.getter=N)),this.value=this.lazy?void 0:this.get()};Mr.prototype.get=function(){var t;St(this);var e=this.vm;try{t=this.getter.call(e,e)}catch(as){if(!this.user)throw as;we(as,e,'getter for watcher "'+this.expression+'"')}finally{this.deep&&Xe(t),jt(),this.cleanupDeps()}return t},Mr.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},Mr.prototype.cleanupDeps=function(){for(var t=this.deps.length;t--;){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0},Mr.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():Lr(this)},Mr.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||s(t)||this.deep){var e=this.value;if(this.value=t,this.user)try{this.cb.call(this.vm,t,e)}catch(as){we(as,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,t,e)}}},Mr.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},Mr.prototype.depend=function(){for(var t=this.deps.length;t--;)this.deps[t].depend()},Mr.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||_(this.vm._watchers,this);for(var t=this.deps.length;t--;)this.deps[t].removeSub(this);this.active=!1}};var Fr={enumerable:!0,configurable:!0,get:N,set:N};function Rr(t,e,n){Fr.get=function(){return this[e][n]},Fr.set=function(t){this[e][n]=t},Object.defineProperty(t,n,Fr)}function Hr(t){t._watchers=[];var e=t.$options;e.props&&Ur(t,e.props),e.methods&&Gr(t,e.methods),e.data?Br(t):Vt(t._data={},!0),e.computed&&Wr(t,e.computed),e.watch&&e.watch!==ut&&Zr(t,e.watch)}function Ur(t,e){var n=t.$options.propsData||{},r=t._props={},o=t.$options._propKeys=[],i=!t.$parent;i||Ht(!1);var a=function(i){o.push(i);var a=le(i,e,n,t);Wt(r,i,a),i in t||Rr(t,"_props",i)};for(var s in e)a(s);Ht(!0)}function Br(t){var e=t.$options.data;l(e=t._data="function"==typeof e?zr(e,t):e||{})||(e={});for(var n=Object.keys(e),r=t.$options.props,o=(t.$options.methods,n.length);o--;){var i=n[o];0,r&&C(r,i)||W(i)||Rr(t,"_data",i)}Vt(e,!0)}function zr(t,e){St();try{return t.call(e,e)}catch(as){return we(as,e,"data()"),{}}finally{jt()}}var Vr={lazy:!0};function Wr(t,e){var n=t._computedWatchers=Object.create(null),r=pt();for(var o in e){var i=e[o],a="function"==typeof i?i:i.get;0,r||(n[o]=new Mr(t,a||N,N,Vr)),o in t||qr(t,o,i)}}function qr(t,e,n){var r=!pt();"function"==typeof n?(Fr.get=r?Kr(e):Xr(n),Fr.set=N):(Fr.get=n.get?r&&!1!==n.cache?Kr(e):Xr(n.get):N,Fr.set=n.set||N),Object.defineProperty(t,e,Fr)}function Kr(t){return function(){var e=this._computedWatchers&&this._computedWatchers[t];if(e)return e.dirty&&e.evaluate(),Ot.target&&e.depend(),e.value}}function Xr(t){return function(){return t.call(this,this)}}function Gr(t,e){t.$options.props;for(var n in e)t[n]="function"!=typeof e[n]?N:E(e[n],t)}function Zr(t,e){for(var n in e){var r=e[n];if(Array.isArray(r))for(var o=0;o<r.length;o++)Jr(t,n,r[o]);else Jr(t,n,r)}}function Jr(t,e,n,r){return l(n)&&(r=n,n=n.handler),"string"==typeof n&&(n=t[n]),t.$watch(e,n,r)}function Qr(t){var e={get:function(){return this._data}},n={get:function(){return this._props}};Object.defineProperty(t.prototype,"$data",e),Object.defineProperty(t.prototype,"$props",n),t.prototype.$set=qt,t.prototype.$delete=Kt,t.prototype.$watch=function(t,e,n){if(l(e))return Jr(this,t,e,n);(n=n||{}).user=!0;var r=new Mr(this,t,e,n);if(n.immediate)try{e.call(this,r.value)}catch(o){we(o,this,'callback for immediate watcher "'+r.expression+'"')}return function(){r.teardown()}}}var Yr=0;function to(t){t.prototype._init=function(t){var e=this;e._uid=Yr++,e._isVue=!0,t&&t._isComponent?eo(e,t):e.$options=ce(no(e.constructor),t||{},e),e._renderProxy=e,e._self=e,fr(e),nr(e),Kn(e),gr(e,"beforeCreate"),cn(e),Hr(e),sn(e),gr(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}function eo(t,e){var n=t.$options=Object.create(t.constructor.options),r=e._parentVnode;n.parent=e.parent,n._parentVnode=r;var o=r.componentOptions;n.propsData=o.propsData,n._parentListeners=o.listeners,n._renderChildren=o.children,n._componentTag=o.tag,e.render&&(n.render=e.render,n.staticRenderFns=e.staticRenderFns)}function no(t){var e=t.options;if(t.super){var n=no(t.super);if(n!==t.superOptions){t.superOptions=n;var r=ro(t);r&&I(t.extendOptions,r),(e=t.options=ce(n,t.extendOptions)).name&&(e.components[e.name]=t)}}return e}function ro(t){var e,n=t.options,r=t.sealedOptions;for(var o in n)n[o]!==r[o]&&(e||(e={}),e[o]=n[o]);return e}function oo(t){this._init(t)}function io(t){t.use=function(t){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(t)>-1)return this;var n=T(arguments,1);return n.unshift(this),"function"==typeof t.install?t.install.apply(t,n):"function"==typeof t&&t.apply(null,n),e.push(t),this}}function ao(t){t.mixin=function(t){return this.options=ce(this.options,t),this}}function so(t){t.cid=0;var e=1;t.extend=function(t){t=t||{};var n=this,r=n.cid,o=t._Ctor||(t._Ctor={});if(o[r])return o[r];var i=t.name||n.options.name;var a=function(t){this._init(t)};return(a.prototype=Object.create(n.prototype)).constructor=a,a.cid=e++,a.options=ce(n.options,t),a.super=n,a.options.props&&co(a),a.options.computed&&uo(a),a.extend=n.extend,a.mixin=n.mixin,a.use=n.use,U.forEach(function(t){a[t]=n[t]}),i&&(a.options.components[i]=a),a.superOptions=n.options,a.extendOptions=t,a.sealedOptions=I({},a.options),o[r]=a,a}}function co(t){var e=t.options.props;for(var n in e)Rr(t.prototype,"_props",n)}function uo(t){var e=t.options.computed;for(var n in e)qr(t.prototype,n,e[n])}function lo(t){U.forEach(function(e){t[e]=function(t,n){return n?("component"===e&&l(n)&&(n.name=n.name||t,n=this.options._base.extend(n)),"directive"===e&&"function"==typeof n&&(n={bind:n,update:n}),this.options[e+"s"][t]=n,n):this.options[e+"s"][t]}})}function fo(t){return t&&(t.Ctor.options.name||t.tag)}function po(t,e){return Array.isArray(t)?t.indexOf(e)>-1:"string"==typeof t?t.split(",").indexOf(e)>-1:!!f(t)&&t.test(e)}function vo(t,e){var n=t.cache,r=t.keys,o=t._vnode;for(var i in n){var a=n[i];if(a){var s=fo(a.componentOptions);s&&!e(s)&&ho(n,i,r,o)}}}function ho(t,e,n,r){var o=t[e];!o||r&&o.tag===r.tag||o.componentInstance.$destroy(),t[e]=null,_(n,e)}to(oo),Qr(oo),sr(oo),pr(oo),Zn(oo);var mo=[String,RegExp,Array],yo={name:"keep-alive",abstract:!0,props:{include:mo,exclude:mo,max:[String,Number]},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)ho(this.cache,t,this.keys)},mounted:function(){var t=this;this.$watch("include",function(e){vo(t,function(t){return po(e,t)})}),this.$watch("exclude",function(e){vo(t,function(t){return!po(e,t)})})},render:function(){var t=this.$slots.default,e=er(t),n=e&&e.componentOptions;if(n){var r=fo(n),o=this.include,i=this.exclude;if(o&&(!r||!po(o,r))||i&&r&&po(i,r))return e;var a=this.cache,s=this.keys,c=null==e.key?n.Ctor.cid+(n.tag?"::"+n.tag:""):e.key;a[c]?(e.componentInstance=a[c].componentInstance,_(s,c),s.push(c)):(a[c]=e,s.push(c),this.max&&s.length>parseInt(this.max)&&ho(a,s[0],s,this._vnode)),e.data.keepAlive=!0}return e||t&&t[0]}},go={KeepAlive:yo};function _o(t){var e={get:function(){return z}};Object.defineProperty(t,"config",e),t.util={warn:Ct,extend:I,mergeOptions:ce,defineReactive:Wt},t.set=qt,t.delete=Kt,t.nextTick=ze,t.observable=function(t){return Vt(t),t},t.options=Object.create(null),U.forEach(function(e){t.options[e+"s"]=Object.create(null)}),t.options._base=t,I(t.options.components,go),io(t),ao(t),so(t),lo(t)}_o(oo),Object.defineProperty(oo.prototype,"$isServer",{get:pt}),Object.defineProperty(oo.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(oo,"FunctionalRenderContext",{value:En}),oo.version="2.6.10";var bo=m("style,class"),Co=m("input,textarea,option,select,progress"),wo=function(t,e,n){return"value"===n&&Co(t)&&"button"!==e||"selected"===n&&"option"===t||"checked"===n&&"input"===t||"muted"===n&&"video"===t},$o=m("contenteditable,draggable,spellcheck"),Ao=m("events,caret,typing,plaintext-only"),xo=function(t,e){return Eo(e)||"false"===e?"false":"contenteditable"===t&&Ao(e)?e:"true"},Oo=m("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,translate,truespeed,typemustmatch,visible"),ko="http://www.w3.org/1999/xlink",So=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},jo=function(t){return So(t)?t.slice(6,t.length):""},Eo=function(t){return null==t||!1===t};function To(t){for(var e=t.data,n=t,o=t;r(o.componentInstance);)(o=o.componentInstance._vnode)&&o.data&&(e=Io(o.data,e));for(;r(n=n.parent);)n&&n.data&&(e=Io(e,n.data));return Do(e.staticClass,e.class)}function Io(t,e){return{staticClass:No(t.staticClass,e.staticClass),class:r(t.class)?[t.class,e.class]:e.class}}function Do(t,e){return r(t)||r(e)?No(t,Lo(e)):""}function No(t,e){return t?e?t+" "+e:t:e||""}function Lo(t){return Array.isArray(t)?Po(t):s(t)?Mo(t):"string"==typeof t?t:""}function Po(t){for(var e,n="",o=0,i=t.length;o<i;o++)r(e=Lo(t[o]))&&""!==e&&(n&&(n+=" "),n+=e);return n}function Mo(t){var e="";for(var n in t)t[n]&&(e&&(e+=" "),e+=n);return e}var Fo={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Ro=m("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Ho=m("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignObject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),Uo=function(t){return Ro(t)||Ho(t)};function Bo(t){return Ho(t)?"svg":"math"===t?"math":void 0}var zo=Object.create(null);function Vo(t){if(!J)return!0;if(Uo(t))return!1;if(t=t.toLowerCase(),null!=zo[t])return zo[t];var e=document.createElement(t);return t.indexOf("-")>-1?zo[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:zo[t]=/HTMLUnknownElement/.test(e.toString())}var Wo=m("text,number,password,search,email,tel,url");function qo(t){if("string"==typeof t){var e=document.querySelector(t);return e||document.createElement("div")}return t}function Ko(t,e){var n=document.createElement(t);return"select"!==t?n:(e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&n.setAttribute("multiple","multiple"),n)}function Xo(t,e){return document.createElementNS(Fo[t],e)}function Go(t){return document.createTextNode(t)}function Zo(t){return document.createComment(t)}function Jo(t,e,n){t.insertBefore(e,n)}function Qo(t,e){t.removeChild(e)}function Yo(t,e){t.appendChild(e)}function ti(t){return t.parentNode}function ei(t){return t.nextSibling}function ni(t){return t.tagName}function ri(t,e){t.textContent=e}function oi(t,e){t.setAttribute(e,"")}var ii=Object.freeze({createElement:Ko,createElementNS:Xo,createTextNode:Go,createComment:Zo,insertBefore:Jo,removeChild:Qo,appendChild:Yo,parentNode:ti,nextSibling:ei,tagName:ni,setTextContent:ri,setStyleScope:oi}),ai={create:function(t,e){si(e)},update:function(t,e){t.data.ref!==e.data.ref&&(si(t,!0),si(e))},destroy:function(t){si(t,!0)}};function si(t,e){var n=t.data.ref;if(r(n)){var o=t.context,i=t.componentInstance||t.elm,a=o.$refs;e?Array.isArray(a[n])?_(a[n],i):a[n]===i&&(a[n]=void 0):t.data.refInFor?Array.isArray(a[n])?a[n].indexOf(i)<0&&a[n].push(i):a[n]=[i]:a[n]=i}}var ci=new Et("",{},[]),ui=["create","activate","update","remove","destroy"];function li(t,e){return t.key===e.key&&(t.tag===e.tag&&t.isComment===e.isComment&&r(t.data)===r(e.data)&&fi(t,e)||o(t.isAsyncPlaceholder)&&t.asyncFactory===e.asyncFactory&&n(e.asyncFactory.error))}function fi(t,e){if("input"!==t.tag)return!0;var n,o=r(n=t.data)&&r(n=n.attrs)&&n.type,i=r(n=e.data)&&r(n=n.attrs)&&n.type;return o===i||Wo(o)&&Wo(i)}function pi(t,e,n){var o,i,a={};for(o=e;o<=n;++o)r(i=t[o].key)&&(a[i]=o);return a}function di(t){var e,i,s={},c=t.modules,u=t.nodeOps;for(e=0;e<ui.length;++e)for(s[ui[e]]=[],i=0;i<c.length;++i)r(c[i][ui[e]])&&s[ui[e]].push(c[i][ui[e]]);function l(t){var e=u.parentNode(t);r(e)&&u.removeChild(e,t)}function f(t,e,n,i,a,c,l){if(r(t.elm)&&r(c)&&(t=c[l]=Nt(t)),t.isRootInsert=!a,!function(t,e,n,i){var a=t.data;if(r(a)){var c=r(t.componentInstance)&&a.keepAlive;if(r(a=a.hook)&&r(a=a.init)&&a(t,!1),r(t.componentInstance))return p(t,e),d(n,t.elm,i),o(c)&&function(t,e,n,o){var i,a=t;for(;a.componentInstance;)if(a=a.componentInstance._vnode,r(i=a.data)&&r(i=i.transition)){for(i=0;i<s.activate.length;++i)s.activate[i](ci,a);e.push(a);break}d(n,t.elm,o)}(t,e,n,i),!0}}(t,e,n,i)){var f=t.data,h=t.children,m=t.tag;r(m)?(t.elm=t.ns?u.createElementNS(t.ns,m):u.createElement(m,t),g(t),v(t,h,e),r(f)&&y(t,e),d(n,t.elm,i)):o(t.isComment)?(t.elm=u.createComment(t.text),d(n,t.elm,i)):(t.elm=u.createTextNode(t.text),d(n,t.elm,i))}}function p(t,e){r(t.data.pendingInsert)&&(e.push.apply(e,t.data.pendingInsert),t.data.pendingInsert=null),t.elm=t.componentInstance.$el,h(t)?(y(t,e),g(t)):(si(t),e.push(t))}function d(t,e,n){r(t)&&(r(n)?u.parentNode(n)===t&&u.insertBefore(t,e,n):u.appendChild(t,e))}function v(t,e,n){if(Array.isArray(e)){0;for(var r=0;r<e.length;++r)f(e[r],n,t.elm,null,!0,e,r)}else a(t.text)&&u.appendChild(t.elm,u.createTextNode(String(t.text)))}function h(t){for(;t.componentInstance;)t=t.componentInstance._vnode;return r(t.tag)}function y(t,n){for(var o=0;o<s.create.length;++o)s.create[o](ci,t);r(e=t.data.hook)&&(r(e.create)&&e.create(ci,t),r(e.insert)&&n.push(t))}function g(t){var e;if(r(e=t.fnScopeId))u.setStyleScope(t.elm,e);else for(var n=t;n;)r(e=n.context)&&r(e=e.$options._scopeId)&&u.setStyleScope(t.elm,e),n=n.parent;r(e=cr)&&e!==t.context&&e!==t.fnContext&&r(e=e.$options._scopeId)&&u.setStyleScope(t.elm,e)}function _(t,e,n,r,o,i){for(;r<=o;++r)f(n[r],i,t,e,!1,n,r)}function b(t){var e,n,o=t.data;if(r(o))for(r(e=o.hook)&&r(e=e.destroy)&&e(t),e=0;e<s.destroy.length;++e)s.destroy[e](t);if(r(e=t.children))for(n=0;n<t.children.length;++n)b(t.children[n])}function C(t,e,n,o){for(;n<=o;++n){var i=e[n];r(i)&&(r(i.tag)?(w(i),b(i)):l(i.elm))}}function w(t,e){if(r(e)||r(t.data)){var n,o=s.remove.length+1;for(r(e)?e.listeners+=o:e=function(t,e){function n(){0==--n.listeners&&l(t)}return n.listeners=e,n}(t.elm,o),r(n=t.componentInstance)&&r(n=n._vnode)&&r(n.data)&&w(n,e),n=0;n<s.remove.length;++n)s.remove[n](t,e);r(n=t.data.hook)&&r(n=n.remove)?n(t,e):e()}else l(t.elm)}function $(t,e,n,o){for(var i=n;i<o;i++){var a=e[i];if(r(a)&&li(t,a))return i}}function A(t,e,i,a,c,l){if(t!==e){r(e.elm)&&r(a)&&(e=a[c]=Nt(e));var p=e.elm=t.elm;if(o(t.isAsyncPlaceholder))r(e.asyncFactory.resolved)?k(t.elm,e,i):e.isAsyncPlaceholder=!0;else if(o(e.isStatic)&&o(t.isStatic)&&e.key===t.key&&(o(e.isCloned)||o(e.isOnce)))e.componentInstance=t.componentInstance;else{var d,v=e.data;r(v)&&r(d=v.hook)&&r(d=d.prepatch)&&d(t,e);var m=t.children,y=e.children;if(r(v)&&h(e)){for(d=0;d<s.update.length;++d)s.update[d](t,e);r(d=v.hook)&&r(d=d.update)&&d(t,e)}n(e.text)?r(m)&&r(y)?m!==y&&function(t,e,o,i,a){var s,c,l,p=0,d=0,v=e.length-1,h=e[0],m=e[v],y=o.length-1,g=o[0],b=o[y],w=!a;for(;p<=v&&d<=y;)n(h)?h=e[++p]:n(m)?m=e[--v]:li(h,g)?(A(h,g,i,o,d),h=e[++p],g=o[++d]):li(m,b)?(A(m,b,i,o,y),m=e[--v],b=o[--y]):li(h,b)?(A(h,b,i,o,y),w&&u.insertBefore(t,h.elm,u.nextSibling(m.elm)),h=e[++p],b=o[--y]):li(m,g)?(A(m,g,i,o,d),w&&u.insertBefore(t,m.elm,h.elm),m=e[--v],g=o[++d]):(n(s)&&(s=pi(e,p,v)),n(c=r(g.key)?s[g.key]:$(g,e,p,v))?f(g,i,t,h.elm,!1,o,d):li(l=e[c],g)?(A(l,g,i,o,d),e[c]=void 0,w&&u.insertBefore(t,l.elm,h.elm)):f(g,i,t,h.elm,!1,o,d),g=o[++d]);p>v?_(t,n(o[y+1])?null:o[y+1].elm,o,d,y,i):d>y&&C(0,e,p,v)}(p,m,y,i,l):r(y)?(r(t.text)&&u.setTextContent(p,""),_(p,null,y,0,y.length-1,i)):r(m)?C(0,m,0,m.length-1):r(t.text)&&u.setTextContent(p,""):t.text!==e.text&&u.setTextContent(p,e.text),r(v)&&r(d=v.hook)&&r(d=d.postpatch)&&d(t,e)}}}function x(t,e,n){if(o(n)&&r(t.parent))t.parent.data.pendingInsert=e;else for(var i=0;i<e.length;++i)e[i].data.hook.insert(e[i])}var O=m("attrs,class,staticClass,staticStyle,key");function k(t,e,n,i){var a,s=e.tag,c=e.data,u=e.children;if(i=i||c&&c.pre,e.elm=t,o(e.isComment)&&r(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(r(c)&&(r(a=c.hook)&&r(a=a.init)&&a(e,!0),r(a=e.componentInstance)))return p(e,n),!0;if(r(s)){if(r(u))if(t.hasChildNodes())if(r(a=c)&&r(a=a.domProps)&&r(a=a.innerHTML)){if(a!==t.innerHTML)return!1}else{for(var l=!0,f=t.firstChild,d=0;d<u.length;d++){if(!f||!k(f,u[d],n,i)){l=!1;break}f=f.nextSibling}if(!l||f)return!1}else v(e,u,n);if(r(c)){var h=!1;for(var m in c)if(!O(m)){h=!0,y(e,n);break}!h&&c.class&&Xe(c.class)}}else t.data!==e.text&&(t.data=e.text);return!0}return function(t,e,i,a){if(!n(e)){var c,l=!1,p=[];if(n(t))l=!0,f(e,p);else{var d=r(t.nodeType);if(!d&&li(t,e))A(t,e,p,null,null,a);else{if(d){if(1===t.nodeType&&t.hasAttribute(H)&&(t.removeAttribute(H),i=!0),o(i)&&k(t,e,p))return x(e,p,!0),t;c=t,t=new Et(u.tagName(c).toLowerCase(),{},[],void 0,c)}var v=t.elm,m=u.parentNode(v);if(f(e,p,v._leaveCb?null:m,u.nextSibling(v)),r(e.parent))for(var y=e.parent,g=h(e);y;){for(var _=0;_<s.destroy.length;++_)s.destroy[_](y);if(y.elm=e.elm,g){for(var w=0;w<s.create.length;++w)s.create[w](ci,y);var $=y.data.hook.insert;if($.merged)for(var O=1;O<$.fns.length;O++)$.fns[O]()}else si(y);y=y.parent}r(m)?C(0,[t],0,0):r(t.tag)&&b(t)}}return x(e,p,l),e.elm}r(t)&&b(t)}}var vi={create:hi,update:hi,destroy:function(t){hi(t,ci)}};function hi(t,e){(t.data.directives||e.data.directives)&&mi(t,e)}function mi(t,e){var n,r,o,i=t===ci,a=e===ci,s=gi(t.data.directives,t.context),c=gi(e.data.directives,e.context),u=[],l=[];for(n in c)r=s[n],o=c[n],r?(o.oldValue=r.value,o.oldArg=r.arg,bi(o,"update",e,t),o.def&&o.def.componentUpdated&&l.push(o)):(bi(o,"bind",e,t),o.def&&o.def.inserted&&u.push(o));if(u.length){var f=function(){for(var n=0;n<u.length;n++)bi(u[n],"inserted",e,t)};i?Ye(e,"insert",f):f()}if(l.length&&Ye(e,"postpatch",function(){for(var n=0;n<l.length;n++)bi(l[n],"componentUpdated",e,t)}),!i)for(n in s)c[n]||bi(s[n],"unbind",t,t,a)}var yi=Object.create(null);function gi(t,e){var n,r,o=Object.create(null);if(!t)return o;for(n=0;n<t.length;n++)(r=t[n]).modifiers||(r.modifiers=yi),o[_i(r)]=r,r.def=ue(e.$options,"directives",r.name,!0);return o}function _i(t){return t.rawName||t.name+"."+Object.keys(t.modifiers||{}).join(".")}function bi(t,e,n,r,o){var i=t.def&&t.def[e];if(i)try{i(n.elm,t,n,r,o)}catch(as){we(as,n.context,"directive "+t.name+" "+e+" hook")}}var Ci=[ai,vi];function wi(t,e){var o=e.componentOptions;if(!(r(o)&&!1===o.Ctor.options.inheritAttrs||n(t.data.attrs)&&n(e.data.attrs))){var i,a,s=e.elm,c=t.data.attrs||{},u=e.data.attrs||{};for(i in r(u.__ob__)&&(u=e.data.attrs=I({},u)),u)a=u[i],c[i]!==a&&$i(s,i,a);for(i in(et||rt)&&u.value!==c.value&&$i(s,"value",u.value),c)n(u[i])&&(So(i)?s.removeAttributeNS(ko,jo(i)):$o(i)||s.removeAttribute(i))}}function $i(t,e,n){t.tagName.indexOf("-")>-1?Ai(t,e,n):Oo(e)?Eo(n)?t.removeAttribute(e):(n="allowfullscreen"===e&&"EMBED"===t.tagName?"true":e,t.setAttribute(e,n)):$o(e)?t.setAttribute(e,xo(e,n)):So(e)?Eo(n)?t.removeAttributeNS(ko,jo(e)):t.setAttributeNS(ko,e,n):Ai(t,e,n)}function Ai(t,e,n){if(Eo(n))t.removeAttribute(e);else{if(et&&!nt&&"TEXTAREA"===t.tagName&&"placeholder"===e&&""!==n&&!t.__ieph){var r=function(e){e.stopImmediatePropagation(),t.removeEventListener("input",r)};t.addEventListener("input",r),t.__ieph=!0}t.setAttribute(e,n)}}var xi={create:wi,update:wi};function Oi(t,e){var o=e.elm,i=e.data,a=t.data;if(!(n(i.staticClass)&&n(i.class)&&(n(a)||n(a.staticClass)&&n(a.class)))){var s=To(e),c=o._transitionClasses;r(c)&&(s=No(s,Lo(c))),s!==o._prevClass&&(o.setAttribute("class",s),o._prevClass=s)}}var ki,Si={create:Oi,update:Oi},ji="__r",Ei="__c";function Ti(t){if(r(t[ji])){var e=et?"change":"input";t[e]=[].concat(t[ji],t[e]||[]),delete t[ji]}r(t[Ei])&&(t.change=[].concat(t[Ei],t.change||[]),delete t[Ei])}function Ii(t,e,n){var r=ki;return function o(){null!==e.apply(null,arguments)&&Li(t,o,n,r)}}var Di=Le&&!(ct&&Number(ct[1])<=53);function Ni(t,e,n,r){if(Di){var o=Sr,i=e;e=i._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=o||t.timeStamp<=0||t.target.ownerDocument!==document)return i.apply(this,arguments)}}ki.addEventListener(t,e,lt?{capture:n,passive:r}:n)}function Li(t,e,n,r){(r||ki).removeEventListener(t,e._wrapper||e,n)}function Pi(t,e){if(!n(t.data.on)||!n(e.data.on)){var r=e.data.on||{},o=t.data.on||{};ki=e.elm,Ti(r),Qe(r,o,Ni,Li,Ii,e.context),ki=void 0}}var Mi,Fi={create:Pi,update:Pi};function Ri(t,e){if(!n(t.data.domProps)||!n(e.data.domProps)){var o,i,a=e.elm,s=t.data.domProps||{},c=e.data.domProps||{};for(o in r(c.__ob__)&&(c=e.data.domProps=I({},c)),s)o in c||(a[o]="");for(o in c){if(i=c[o],"textContent"===o||"innerHTML"===o){if(e.children&&(e.children.length=0),i===s[o])continue;1===a.childNodes.length&&a.removeChild(a.childNodes[0])}if("value"===o&&"PROGRESS"!==a.tagName){a._value=i;var u=n(i)?"":String(i);Hi(a,u)&&(a.value=u)}else if("innerHTML"===o&&Ho(a.tagName)&&n(a.innerHTML)){(Mi=Mi||document.createElement("div")).innerHTML="<svg>"+i+"</svg>";for(var l=Mi.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;l.firstChild;)a.appendChild(l.firstChild)}else if(i!==s[o])try{a[o]=i}catch(as){}}}}function Hi(t,e){return!t.composing&&("OPTION"===t.tagName||Ui(t,e)||Bi(t,e))}function Ui(t,e){var n=!0;try{n=document.activeElement!==t}catch(as){}return n&&t.value!==e}function Bi(t,e){var n=t.value,o=t._vModifiers;if(r(o)){if(o.number)return h(n)!==h(e);if(o.trim)return n.trim()!==e.trim()}return n!==e}var zi={create:Ri,update:Ri},Vi=w(function(t){var e={},n=/:(.+)/;return t.split(/;(?![^(]*\))/g).forEach(function(t){if(t){var r=t.split(n);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e});function Wi(t){var e=qi(t.style);return t.staticStyle?I(t.staticStyle,e):e}function qi(t){return Array.isArray(t)?D(t):"string"==typeof t?Vi(t):t}function Ki(t,e){var n,r={};if(e)for(var o=t;o.componentInstance;)(o=o.componentInstance._vnode)&&o.data&&(n=Wi(o.data))&&I(r,n);(n=Wi(t.data))&&I(r,n);for(var i=t;i=i.parent;)i.data&&(n=Wi(i.data))&&I(r,n);return r}var Xi,Gi=/^--/,Zi=/\s*!important$/,Ji=function(t,e,n){if(Gi.test(e))t.style.setProperty(e,n);else if(Zi.test(n))t.style.setProperty(k(e),n.replace(Zi,""),"important");else{var r=Yi(e);if(Array.isArray(n))for(var o=0,i=n.length;o<i;o++)t.style[r]=n[o];else t.style[r]=n}},Qi=["Webkit","Moz","ms"],Yi=w(function(t){if(Xi=Xi||document.createElement("div").style,"filter"!==(t=A(t))&&t in Xi)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<Qi.length;n++){var r=Qi[n]+e;if(r in Xi)return r}});function ta(t,e){var o=e.data,i=t.data;if(!(n(o.staticStyle)&&n(o.style)&&n(i.staticStyle)&&n(i.style))){var a,s,c=e.elm,u=i.staticStyle,l=i.normalizedStyle||i.style||{},f=u||l,p=qi(e.data.style)||{};e.data.normalizedStyle=r(p.__ob__)?I({},p):p;var d=Ki(e,!0);for(s in f)n(d[s])&&Ji(c,s,"");for(s in d)(a=d[s])!==f[s]&&Ji(c,s,null==a?"":a)}}var ea={create:ta,update:ta},na=/\s+/;function ra(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(na).forEach(function(e){return t.classList.add(e)}):t.classList.add(e);else{var n=" "+(t.getAttribute("class")||"")+" ";n.indexOf(" "+e+" ")<0&&t.setAttribute("class",(n+e).trim())}}function oa(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(na).forEach(function(e){return t.classList.remove(e)}):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{for(var n=" "+(t.getAttribute("class")||"")+" ",r=" "+e+" ";n.indexOf(r)>=0;)n=n.replace(r," ");(n=n.trim())?t.setAttribute("class",n):t.removeAttribute("class")}}function ia(t){if(t){if("object"==typeof t){var e={};return!1!==t.css&&I(e,aa(t.name||"v")),I(e,t),e}return"string"==typeof t?aa(t):void 0}}var aa=w(function(t){return{enterClass:t+"-enter",enterToClass:t+"-enter-to",enterActiveClass:t+"-enter-active",leaveClass:t+"-leave",leaveToClass:t+"-leave-to",leaveActiveClass:t+"-leave-active"}}),sa=J&&!nt,ca="transition",ua="animation",la="transition",fa="transitionend",pa="animation",da="animationend";sa&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(la="WebkitTransition",fa="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(pa="WebkitAnimation",da="webkitAnimationEnd"));var va=J?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function ha(t){va(function(){va(t)})}function ma(t,e){var n=t._transitionClasses||(t._transitionClasses=[]);n.indexOf(e)<0&&(n.push(e),ra(t,e))}function ya(t,e){t._transitionClasses&&_(t._transitionClasses,e),oa(t,e)}function ga(t,e,n){var r=ba(t,e),o=r.type,i=r.timeout,a=r.propCount;if(!o)return n();var s=o===ca?fa:da,c=0,u=function(){t.removeEventListener(s,l),n()},l=function(e){e.target===t&&++c>=a&&u()};setTimeout(function(){c<a&&u()},i+1),t.addEventListener(s,l)}var _a=/\b(transform|all)(,|$)/;function ba(t,e){var n,r=window.getComputedStyle(t),o=(r[la+"Delay"]||"").split(", "),i=(r[la+"Duration"]||"").split(", "),a=Ca(o,i),s=(r[pa+"Delay"]||"").split(", "),c=(r[pa+"Duration"]||"").split(", "),u=Ca(s,c),l=0,f=0;return e===ca?a>0&&(n=ca,l=a,f=i.length):e===ua?u>0&&(n=ua,l=u,f=c.length):f=(n=(l=Math.max(a,u))>0?a>u?ca:ua:null)?n===ca?i.length:c.length:0,{type:n,timeout:l,propCount:f,hasTransform:n===ca&&_a.test(r[la+"Property"])}}function Ca(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map(function(e,n){return wa(e)+wa(t[n])}))}function wa(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function $a(t,e){var o=t.elm;r(o._leaveCb)&&(o._leaveCb.cancelled=!0,o._leaveCb());var i=ia(t.data.transition);if(!n(i)&&!r(o._enterCb)&&1===o.nodeType){for(var a=i.css,c=i.type,u=i.enterClass,l=i.enterToClass,f=i.enterActiveClass,p=i.appearClass,d=i.appearToClass,v=i.appearActiveClass,m=i.beforeEnter,y=i.enter,g=i.afterEnter,_=i.enterCancelled,b=i.beforeAppear,C=i.appear,w=i.afterAppear,$=i.appearCancelled,A=i.duration,x=cr,O=cr.$vnode;O&&O.parent;)x=O.context,O=O.parent;var k=!x._isMounted||!t.isRootInsert;if(!k||C||""===C){var S=k&&p?p:u,j=k&&v?v:f,E=k&&d?d:l,T=k&&b||m,I=k&&"function"==typeof C?C:y,D=k&&w||g,N=k&&$||_,L=h(s(A)?A.enter:A);0;var P=!1!==a&&!nt,M=ka(I),F=o._enterCb=R(function(){P&&(ya(o,E),ya(o,j)),F.cancelled?(P&&ya(o,S),N&&N(o)):D&&D(o),o._enterCb=null});t.data.show||Ye(t,"insert",function(){var e=o.parentNode,n=e&&e._pending&&e._pending[t.key];n&&n.tag===t.tag&&n.elm._leaveCb&&n.elm._leaveCb(),I&&I(o,F)}),T&&T(o),P&&(ma(o,S),ma(o,j),ha(function(){ya(o,S),F.cancelled||(ma(o,E),M||(Oa(L)?setTimeout(F,L):ga(o,c,F)))})),t.data.show&&(e&&e(),I&&I(o,F)),P||M||F()}}}function Aa(t,e){var o=t.elm;r(o._enterCb)&&(o._enterCb.cancelled=!0,o._enterCb());var i=ia(t.data.transition);if(n(i)||1!==o.nodeType)return e();if(!r(o._leaveCb)){var a=i.css,c=i.type,u=i.leaveClass,l=i.leaveToClass,f=i.leaveActiveClass,p=i.beforeLeave,d=i.leave,v=i.afterLeave,m=i.leaveCancelled,y=i.delayLeave,g=i.duration,_=!1!==a&&!nt,b=ka(d),C=h(s(g)?g.leave:g);0;var w=o._leaveCb=R(function(){o.parentNode&&o.parentNode._pending&&(o.parentNode._pending[t.key]=null),_&&(ya(o,l),ya(o,f)),w.cancelled?(_&&ya(o,u),m&&m(o)):(e(),v&&v(o)),o._leaveCb=null});y?y($):$()}function $(){w.cancelled||(!t.data.show&&o.parentNode&&((o.parentNode._pending||(o.parentNode._pending={}))[t.key]=t),p&&p(o),_&&(ma(o,u),ma(o,f),ha(function(){ya(o,u),w.cancelled||(ma(o,l),b||(Oa(C)?setTimeout(w,C):ga(o,c,w)))})),d&&d(o,w),_||b||w())}}function xa(t,e,n){"number"!=typeof t?Ct("<transition> explicit "+e+" duration is not a valid number - got "+JSON.stringify(t)+".",n.context):isNaN(t)&&Ct("<transition> explicit "+e+" duration is NaN - the duration expression might be incorrect.",n.context)}function Oa(t){return"number"==typeof t&&!isNaN(t)}function ka(t){if(n(t))return!1;var e=t.fns;return r(e)?ka(Array.isArray(e)?e[0]:e):(t._length||t.length)>1}function Sa(t,e){!0!==e.data.show&&$a(e)}var ja=J?{create:Sa,activate:Sa,remove:function(t,e){!0!==t.data.show?Aa(t,e):e()}}:{},Ea=[xi,Si,Fi,zi,ea,ja],Ta=Ea.concat(Ci),Ia=di({nodeOps:ii,modules:Ta});nt&&document.addEventListener("selectionchange",function(){var t=document.activeElement;t&&t.vmodel&&Ha(t,"input")});var Da={inserted:function(t,e,n,r){"select"===n.tag?(r.elm&&!r.elm._vOptions?Ye(n,"postpatch",function(){Da.componentUpdated(t,e,n)}):Na(t,e,n.context),t._vOptions=[].map.call(t.options,Ma)):("textarea"===n.tag||Wo(t.type))&&(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",Fa),t.addEventListener("compositionend",Ra),t.addEventListener("change",Ra),nt&&(t.vmodel=!0)))},componentUpdated:function(t,e,n){if("select"===n.tag){Na(t,e,n.context);var r=t._vOptions,o=t._vOptions=[].map.call(t.options,Ma);if(o.some(function(t,e){return!M(t,r[e])}))(t.multiple?e.value.some(function(t){return Pa(t,o)}):e.value!==e.oldValue&&Pa(e.value,o))&&Ha(t,"change")}}};function Na(t,e,n){La(t,e,n),(et||rt)&&setTimeout(function(){La(t,e,n)},0)}function La(t,e,n){var r=e.value,o=t.multiple;if(!o||Array.isArray(r)){for(var i,a,s=0,c=t.options.length;s<c;s++)if(a=t.options[s],o)i=F(r,Ma(a))>-1,a.selected!==i&&(a.selected=i);else if(M(Ma(a),r))return void(t.selectedIndex!==s&&(t.selectedIndex=s));o||(t.selectedIndex=-1)}}function Pa(t,e){return e.every(function(e){return!M(e,t)})}function Ma(t){return"_value"in t?t._value:t.value}function Fa(t){t.target.composing=!0}function Ra(t){t.target.composing&&(t.target.composing=!1,Ha(t.target,"input"))}function Ha(t,e){var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}function Ua(t){return!t.componentInstance||t.data&&t.data.transition?t:Ua(t.componentInstance._vnode)}var Ba={bind:function(t,e,n){var r=e.value,o=(n=Ua(n)).data&&n.data.transition,i=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;r&&o?(n.data.show=!0,$a(n,function(){t.style.display=i})):t.style.display=r?i:"none"},update:function(t,e,n){var r=e.value;!r!=!e.oldValue&&((n=Ua(n)).data&&n.data.transition?(n.data.show=!0,r?$a(n,function(){t.style.display=t.__vOriginalDisplay}):Aa(n,function(){t.style.display="none"})):t.style.display=r?t.__vOriginalDisplay:"none")},unbind:function(t,e,n,r,o){o||(t.style.display=t.__vOriginalDisplay)}},za={model:Da,show:Ba},Va={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function Wa(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?Wa(er(e.children)):t}function qa(t){var e={},n=t.$options;for(var r in n.propsData)e[r]=t[r];var o=n._parentListeners;for(var i in o)e[A(i)]=o[i];return e}function Ka(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}function Xa(t){for(;t=t.parent;)if(t.data.transition)return!0}function Ga(t,e){return e.key===t.key&&e.tag===t.tag}var Za=function(t){return t.tag||tr(t)},Ja=function(t){return"show"===t.name},Qa={name:"transition",props:Va,abstract:!0,render:function(t){var e=this,n=this.$slots.default;if(n&&(n=n.filter(Za)).length){0;var r=this.mode;0;var o=n[0];if(Xa(this.$vnode))return o;var i=Wa(o);if(!i)return o;if(this._leaving)return Ka(t,o);var s="__transition-"+this._uid+"-";i.key=null==i.key?i.isComment?s+"comment":s+i.tag:a(i.key)?0===String(i.key).indexOf(s)?i.key:s+i.key:i.key;var c=(i.data||(i.data={})).transition=qa(this),u=this._vnode,l=Wa(u);if(i.data.directives&&i.data.directives.some(Ja)&&(i.data.show=!0),l&&l.data&&!Ga(i,l)&&!tr(l)&&(!l.componentInstance||!l.componentInstance._vnode.isComment)){var f=l.data.transition=I({},c);if("out-in"===r)return this._leaving=!0,Ye(f,"afterLeave",function(){e._leaving=!1,e.$forceUpdate()}),Ka(t,o);if("in-out"===r){if(tr(i))return u;var p,d=function(){p()};Ye(c,"afterEnter",d),Ye(c,"enterCancelled",d),Ye(f,"delayLeave",function(t){p=t})}}return o}}},Ya=I({tag:String,moveClass:String},Va);delete Ya.mode;var ts={props:Ya,beforeMount:function(){var t=this,e=this._update;this._update=function(n,r){var o=lr(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,o(),e.call(t,n,r)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",n=Object.create(null),r=this.prevChildren=this.children,o=this.$slots.default||[],i=this.children=[],a=qa(this),s=0;s<o.length;s++){var c=o[s];if(c.tag)if(null!=c.key&&0!==String(c.key).indexOf("__vlist"))i.push(c),n[c.key]=c,(c.data||(c.data={})).transition=a;else;}if(r){for(var u=[],l=[],f=0;f<r.length;f++){var p=r[f];p.data.transition=a,p.data.pos=p.elm.getBoundingClientRect(),n[p.key]?u.push(p):l.push(p)}this.kept=t(e,null,u),this.removed=l}return t(e,null,i)},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,e)&&(t.forEach(es),t.forEach(ns),t.forEach(rs),this._reflow=document.body.offsetHeight,t.forEach(function(t){if(t.data.moved){var n=t.elm,r=n.style;ma(n,e),r.transform=r.WebkitTransform=r.transitionDuration="",n.addEventListener(fa,n._moveCb=function t(r){r&&r.target!==n||r&&!/transform$/.test(r.propertyName)||(n.removeEventListener(fa,t),n._moveCb=null,ya(n,e))})}}))},methods:{hasMove:function(t,e){if(!sa)return!1;if(this._hasMove)return this._hasMove;var n=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach(function(t){oa(n,t)}),ra(n,e),n.style.display="none",this.$el.appendChild(n);var r=ba(n);return this.$el.removeChild(n),this._hasMove=r.hasTransform}}};function es(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function ns(t){t.data.newPos=t.elm.getBoundingClientRect()}function rs(t){var e=t.data.pos,n=t.data.newPos,r=e.left-n.left,o=e.top-n.top;if(r||o){t.data.moved=!0;var i=t.elm.style;i.transform=i.WebkitTransform="translate("+r+"px,"+o+"px)",i.transitionDuration="0s"}}var os={Transition:Qa,TransitionGroup:ts};oo.config.mustUseProp=wo,oo.config.isReservedTag=Uo,oo.config.isReservedAttr=bo,oo.config.getTagNamespace=Bo,oo.config.isUnknownElement=Vo,I(oo.options.directives,za),I(oo.options.components,os),oo.prototype.__patch__=J?Ia:N,oo.prototype.$mount=function(t,e){return dr(this,t=t&&J?qo(t):void 0,e)},J&&setTimeout(function(){z.devtools&&dt&&dt.emit("init",oo)},0);var is=oo;exports.default=is;
},{}],"cCcs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createDecorator=i,exports.mixins=f,exports.default=void 0;var e=t(require("vue"));function t(e){return e&&e.__esModule?e:{default:e}}var r="undefined"!=typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys;function o(e,t){n(e,t),Object.getOwnPropertyNames(t.prototype).forEach(function(r){n(e.prototype,t.prototype,r)}),Object.getOwnPropertyNames(t).forEach(function(r){n(e,t,r)})}function n(e,t,r){(r?Reflect.getOwnMetadataKeys(t,r):Reflect.getOwnMetadataKeys(t)).forEach(function(o){var n=r?Reflect.getOwnMetadata(o,t,r):Reflect.getOwnMetadata(o,t);r?Reflect.defineMetadata(o,n,e,r):Reflect.defineMetadata(o,n,e)})}var a={__proto__:[]},c=a instanceof Array;function i(e){return function(t,r,o){var n="function"==typeof t?t:t.constructor;n.__decorators__||(n.__decorators__=[]),"number"!=typeof o&&(o=void 0),n.__decorators__.push(function(t){return e(t,r,o)})}}function f(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.default.extend({mixins:t})}function u(e){var t=typeof e;return null==e||"object"!==t&&"function"!==t}function p(e){"undefined"!=typeof console&&console.warn("[vue-class-component] "+e)}function s(e,t){var r=t.prototype._init;t.prototype._init=function(){var t=this,r=Object.getOwnPropertyNames(e);if(e.$options.props)for(var o in e.$options.props)e.hasOwnProperty(o)||r.push(o);r.forEach(function(r){"_"!==r.charAt(0)&&Object.defineProperty(t,r,{get:function(){return e[r]},set:function(t){e[r]=t},configurable:!0})})};var o=new t;t.prototype._init=r;var n={};return Object.keys(o).forEach(function(e){void 0!==o[e]&&(n[e]=o[e])}),n}var d=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function l(t,n){void 0===n&&(n={}),n.name=n.name||t._componentTag||t.name;var a=t.prototype;Object.getOwnPropertyNames(a).forEach(function(e){if("constructor"!==e)if(d.indexOf(e)>-1)n[e]=a[e];else{var t=Object.getOwnPropertyDescriptor(a,e);void 0!==t.value?"function"==typeof t.value?(n.methods||(n.methods={}))[e]=t.value:(n.mixins||(n.mixins=[])).push({data:function(){var r;return(r={})[e]=t.value,r}}):(t.get||t.set)&&((n.computed||(n.computed={}))[e]={get:t.get,set:t.set})}}),(n.mixins||(n.mixins=[])).push({data:function(){return s(this,t)}});var c=t.__decorators__;c&&(c.forEach(function(e){return e(n)}),delete t.__decorators__);var i=Object.getPrototypeOf(t.prototype),f=i instanceof e.default?i.constructor:e.default,u=f.extend(n);return O(u,t,f),r&&o(u,t),u}var v=["cid","super","options","superOptions","extendOptions","sealedOptions","component","directive","filter"],y={prototype:!0,arguments:!0,callee:!0,caller:!0};function O(e,t,r){Object.getOwnPropertyNames(t).forEach(function(o){if(!y[o]){var n=Object.getOwnPropertyDescriptor(e,o);if(!n||n.configurable){var a=Object.getOwnPropertyDescriptor(t,o);if(!c){if("cid"===o)return;var i=Object.getOwnPropertyDescriptor(r,o);if(!u(a.value)&&i&&i.value===a.value)return}0,Object.defineProperty(e,o,a)}}})}function _(e){return"function"==typeof e?l(e):function(t){return l(t,e)}}_.registerHooks=function(e){d.push.apply(d,e)};var g=_;exports.default=g;
},{"vue":"3Z1+"}],"bOF0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Inject=i,exports.InjectReactive=c,exports.Provide=a,exports.ProvideReactive=u,exports.Model=d,exports.Prop=s,exports.PropSync=v,exports.Watch=l,exports.Emit=j,exports.Ref=g,Object.defineProperty(exports,"Vue",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"Component",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"Mixins",{enumerable:!0,get:function(){return t.mixins}});var e=n(require("vue")),t=r(require("vue-class-component"));function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}var o="__reactiveInject__";function i(e){return(0,t.createDecorator)(function(t,r){void 0===t.inject&&(t.inject={}),Array.isArray(t.inject)||(t.inject[r]=e||r)})}function c(e){return(0,t.createDecorator)(function(t,r){if(void 0===t.inject&&(t.inject={}),!Array.isArray(t.inject)){var n=e?e.from||e:r,i=!!e&&e.default||void 0;t.computed||(t.computed={}),t.computed[r]=function(){var e=this[o];return e?e[n]:i},t.inject[o]=o}})}function a(e){return(0,t.createDecorator)(function(t,r){var n=t.provide;if("function"!=typeof n||!n.managed){var o=t.provide;(n=t.provide=function(){var e=Object.create(("function"==typeof o?o.call(this):o)||null);for(var t in n.managed)e[n.managed[t]]=this[t];return e}).managed={}}n.managed[r]=e||r})}function u(e){return(0,t.createDecorator)(function(t,r){var n=t.provide;if("function"!=typeof n||!n.managed){var i=t.provide;(n=t.provide=function(){var e=this,t=Object.create(("function"==typeof i?i.call(this):i)||null);t[o]={};var r=function(r){t[n.managed[r]]=c[r],Object.defineProperty(t[o],n.managed[r],{enumerable:!0,get:function(){return e[r]}})},c=this;for(var a in n.managed)r(a);return t}).managed={}}n.managed[r]=e||r})}var f="undefined"!=typeof Reflect&&void 0!==Reflect.getMetadata;function p(e,t,r){f&&(Array.isArray(e)||"function"==typeof e||void 0!==e.type||(e.type=Reflect.getMetadata("design:type",t,r)))}function d(e,r){return void 0===r&&(r={}),function(n,o){p(r,n,o),(0,t.createDecorator)(function(t,n){(t.props||(t.props={}))[n]=r,t.model={prop:n,event:e||n}})(n,o)}}function s(e){return void 0===e&&(e={}),function(r,n){p(e,r,n),(0,t.createDecorator)(function(t,r){(t.props||(t.props={}))[r]=e})(r,n)}}function v(e,r){return void 0===r&&(r={}),function(n,o){p(r,n,o),(0,t.createDecorator)(function(t,n){(t.props||(t.props={}))[e]=r,(t.computed||(t.computed={}))[n]={get:function(){return this[e]},set:function(t){this.$emit("update:"+e,t)}}})(n,o)}}function l(e,r){void 0===r&&(r={});var n=r.deep,o=void 0!==n&&n,i=r.immediate,c=void 0!==i&&i;return(0,t.createDecorator)(function(t,r){"object"!=typeof t.watch&&(t.watch=Object.create(null));var n=t.watch;"object"!=typeof n[e]||Array.isArray(n[e])?void 0===n[e]&&(n[e]=[]):n[e]=[n[e]],n[e].push({handler:r,deep:o,immediate:c})})}var m=/\B([A-Z])/g,y=function(e){return e.replace(m,"-$1").toLowerCase()};function j(e){return function(t,r,n){r=y(r);var o=n.value;n.value=function(){for(var t=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var c=function(o){void 0!==o&&n.unshift(o),t.$emit.apply(t,[e||r].concat(n))},a=o.apply(this,n);return h(a)?a.then(function(e){c(e)}):c(a),a}}}function g(e){return(0,t.createDecorator)(function(t,r){t.computed=t.computed||{},t.computed[r]={cache:!1,get:function(){return this.$refs[e||r]}}})}function h(e){return e instanceof Promise||e&&"function"==typeof e.then}
},{"vue":"3Z1+","vue-class-component":"cCcs"}],"NwEK":[function(require,module,exports) {
"use strict";module.exports=function(r,n){return function(){for(var t=new Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e];return r.apply(n,t)}};
},{}],"82YB":[function(require,module,exports) {
module.exports=function(o){return null!=o&&null!=o.constructor&&"function"==typeof o.constructor.isBuffer&&o.constructor.isBuffer(o)};
},{}],"La2s":[function(require,module,exports) {
"use strict";var e=require("./helpers/bind"),r=require("is-buffer"),t=Object.prototype.toString;function n(e){return"[object Array]"===t.call(e)}function o(e){return"[object ArrayBuffer]"===t.call(e)}function i(e){return"undefined"!=typeof FormData&&e instanceof FormData}function f(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function u(e){return"string"==typeof e}function c(e){return"number"==typeof e}function a(e){return void 0===e}function l(e){return null!==e&&"object"==typeof e}function s(e){return"[object Date]"===t.call(e)}function p(e){return"[object File]"===t.call(e)}function y(e){return"[object Blob]"===t.call(e)}function d(e){return"[object Function]"===t.call(e)}function b(e){return l(e)&&d(e.pipe)}function j(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function v(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function m(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function g(e,r){if(null!=e)if("object"!=typeof e&&(e=[e]),n(e))for(var t=0,o=e.length;t<o;t++)r.call(null,e[t],t,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&r.call(null,e[i],i,e)}function B(){var e={};function r(r,t){"object"==typeof e[t]&&"object"==typeof r?e[t]=B(e[t],r):e[t]=r}for(var t=0,n=arguments.length;t<n;t++)g(arguments[t],r);return e}function h(){var e={};function r(r,t){"object"==typeof e[t]&&"object"==typeof r?e[t]=h(e[t],r):e[t]="object"==typeof r?h({},r):r}for(var t=0,n=arguments.length;t<n;t++)g(arguments[t],r);return e}function A(r,t,n){return g(t,function(t,o){r[o]=n&&"function"==typeof t?e(t,n):t}),r}module.exports={isArray:n,isArrayBuffer:o,isBuffer:r,isFormData:i,isArrayBufferView:f,isString:u,isNumber:c,isObject:l,isUndefined:a,isDate:s,isFile:p,isBlob:y,isFunction:d,isStream:b,isURLSearchParams:j,isStandardBrowserEnv:m,forEach:g,merge:B,deepMerge:h,extend:A,trim:v};
},{"./helpers/bind":"NwEK","is-buffer":"82YB"}],"x+/8":[function(require,module,exports) {
"use strict";var e=require("./../utils");function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}module.exports=function(i,n,t){if(!n)return i;var a;if(t)a=t(n);else if(e.isURLSearchParams(n))a=n.toString();else{var c=[];e.forEach(n,function(i,n){null!=i&&(e.isArray(i)?n+="[]":i=[i],e.forEach(i,function(i){e.isDate(i)?i=i.toISOString():e.isObject(i)&&(i=JSON.stringify(i)),c.push(r(n)+"="+r(i))}))}),a=c.join("&")}if(a){var l=i.indexOf("#");-1!==l&&(i=i.slice(0,l)),i+=(-1===i.indexOf("?")?"?":"&")+a}return i};
},{"./../utils":"La2s"}],"Vq9p":[function(require,module,exports) {
"use strict";var t=require("./../utils");function e(){this.handlers=[]}e.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},e.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},e.prototype.forEach=function(e){t.forEach(this.handlers,function(t){null!==t&&e(t)})},module.exports=e;
},{"./../utils":"La2s"}],"tLbi":[function(require,module,exports) {
"use strict";var r=require("./../utils");module.exports=function(t,u,e){return r.forEach(e,function(r){t=r(t,u)}),t};
},{"./../utils":"La2s"}],"oYZ2":[function(require,module,exports) {
"use strict";module.exports=function(t){return!(!t||!t.__CANCEL__)};
},{}],"feM3":[function(require,module,exports) {
"use strict";var e=require("../utils");module.exports=function(t,r){e.forEach(t,function(e,o){o!==r&&o.toUpperCase()===r.toUpperCase()&&(t[r]=e,delete t[o])})};
},{"../utils":"La2s"}],"3ZBI":[function(require,module,exports) {
"use strict";module.exports=function(e,i,s,t,n){return e.config=i,s&&(e.code=s),e.request=t,e.response=n,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e};
},{}],"wsXG":[function(require,module,exports) {
"use strict";var r=require("./enhanceError");module.exports=function(e,n,o,t,u){var a=new Error(e);return r(a,n,o,t,u)};
},{"./enhanceError":"3ZBI"}],"H2iV":[function(require,module,exports) {
"use strict";var t=require("./createError");module.exports=function(e,s,r){var u=r.config.validateStatus;!u||u(r.status)?e(r):s(t("Request failed with status code "+r.status,r.config,null,r.request,r))};
},{"./createError":"wsXG"}],"nAs4":[function(require,module,exports) {
"use strict";var e=require("./../utils"),t=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];module.exports=function(r){var i,o,n,s={};return r?(e.forEach(r.split("\n"),function(r){if(n=r.indexOf(":"),i=e.trim(r.substr(0,n)).toLowerCase(),o=e.trim(r.substr(n+1)),i){if(s[i]&&t.indexOf(i)>=0)return;s[i]="set-cookie"===i?(s[i]?s[i]:[]).concat([o]):s[i]?s[i]+", "+o:o}}),s):s};
},{"./../utils":"La2s"}],"qw5y":[function(require,module,exports) {
"use strict";var t=require("./../utils");module.exports=t.isStandardBrowserEnv()?function(){var r,e=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");function a(t){var r=t;return e&&(o.setAttribute("href",r),r=o.href),o.setAttribute("href",r),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}return r=a(window.location.href),function(e){var o=t.isString(e)?a(e):e;return o.protocol===r.protocol&&o.host===r.host}}():function(){return!0};
},{"./../utils":"La2s"}],"k3ra":[function(require,module,exports) {
"use strict";var e=require("./../utils");module.exports=e.isStandardBrowserEnv()?{write:function(n,t,o,r,i,u){var s=[];s.push(n+"="+encodeURIComponent(t)),e.isNumber(o)&&s.push("expires="+new Date(o).toGMTString()),e.isString(r)&&s.push("path="+r),e.isString(i)&&s.push("domain="+i),!0===u&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};
},{"./../utils":"La2s"}],"Di/a":[function(require,module,exports) {
"use strict";var e=require("./../utils"),r=require("./../core/settle"),t=require("./../helpers/buildURL"),s=require("./../helpers/parseHeaders"),o=require("./../helpers/isURLSameOrigin"),n=require("../core/createError");module.exports=function(a){return new Promise(function(i,u){var l=a.data,d=a.headers;e.isFormData(l)&&delete d["Content-Type"];var p=new XMLHttpRequest;if(a.auth){var c=a.auth.username||"",f=a.auth.password||"";d.Authorization="Basic "+btoa(c+":"+f)}if(p.open(a.method.toUpperCase(),t(a.url,a.params,a.paramsSerializer),!0),p.timeout=a.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var e="getAllResponseHeaders"in p?s(p.getAllResponseHeaders()):null,t={data:a.responseType&&"text"!==a.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:e,config:a,request:p};r(i,u,t),p=null}},p.onabort=function(){p&&(u(n("Request aborted",a,"ECONNABORTED",p)),p=null)},p.onerror=function(){u(n("Network Error",a,null,p)),p=null},p.ontimeout=function(){u(n("timeout of "+a.timeout+"ms exceeded",a,"ECONNABORTED",p)),p=null},e.isStandardBrowserEnv()){var h=require("./../helpers/cookies"),m=(a.withCredentials||o(a.url))&&a.xsrfCookieName?h.read(a.xsrfCookieName):void 0;m&&(d[a.xsrfHeaderName]=m)}if("setRequestHeader"in p&&e.forEach(d,function(e,r){void 0===l&&"content-type"===r.toLowerCase()?delete d[r]:p.setRequestHeader(r,e)}),a.withCredentials&&(p.withCredentials=!0),a.responseType)try{p.responseType=a.responseType}catch(T){if("json"!==a.responseType)throw T}"function"==typeof a.onDownloadProgress&&p.addEventListener("progress",a.onDownloadProgress),"function"==typeof a.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",a.onUploadProgress),a.cancelToken&&a.cancelToken.promise.then(function(e){p&&(p.abort(),u(e),p=null)}),void 0===l&&(l=null),p.send(l)})};
},{"./../utils":"La2s","./../core/settle":"H2iV","./../helpers/buildURL":"x+/8","./../helpers/parseHeaders":"nAs4","./../helpers/isURLSameOrigin":"qw5y","../core/createError":"wsXG","./../helpers/cookies":"k3ra"}],"FT5O":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"zBDM":[function(require,module,exports) {
var process = require("process");
var e=require("process"),t=require("./utils"),r=require("./helpers/normalizeHeaderName"),n={"Content-Type":"application/x-www-form-urlencoded"};function a(e,r){!t.isUndefined(e)&&t.isUndefined(e["Content-Type"])&&(e["Content-Type"]=r)}function i(){var t;return void 0!==e&&"[object process]"===Object.prototype.toString.call(e)?t=require("./adapters/http"):"undefined"!=typeof XMLHttpRequest&&(t=require("./adapters/xhr")),t}var o={adapter:i(),transformRequest:[function(e,n){return r(n,"Accept"),r(n,"Content-Type"),t.isFormData(e)||t.isArrayBuffer(e)||t.isBuffer(e)||t.isStream(e)||t.isFile(e)||t.isBlob(e)?e:t.isArrayBufferView(e)?e.buffer:t.isURLSearchParams(e)?(a(n,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):t.isObject(e)?(a(n,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};t.forEach(["delete","get","head"],function(e){o.headers[e]={}}),t.forEach(["post","put","patch"],function(e){o.headers[e]=t.merge(n)}),module.exports=o;
},{"./utils":"La2s","./helpers/normalizeHeaderName":"feM3","./adapters/http":"Di/a","./adapters/xhr":"Di/a","process":"FT5O"}],"VbyR":[function(require,module,exports) {
"use strict";module.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)};
},{}],"2qHL":[function(require,module,exports) {
"use strict";module.exports=function(e,r){return r?e.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):e};
},{}],"vUUJ":[function(require,module,exports) {
"use strict";var e=require("./../utils"),r=require("./transformData"),a=require("../cancel/isCancel"),s=require("../defaults"),t=require("./../helpers/isAbsoluteURL"),n=require("./../helpers/combineURLs");function o(e){e.cancelToken&&e.cancelToken.throwIfRequested()}module.exports=function(d){return o(d),d.baseURL&&!t(d.url)&&(d.url=n(d.baseURL,d.url)),d.headers=d.headers||{},d.data=r(d.data,d.headers,d.transformRequest),d.headers=e.merge(d.headers.common||{},d.headers[d.method]||{},d.headers||{}),e.forEach(["delete","get","head","post","put","patch","common"],function(e){delete d.headers[e]}),(d.adapter||s.adapter)(d).then(function(e){return o(d),e.data=r(e.data,e.headers,d.transformResponse),e},function(e){return a(e)||(o(d),e&&e.response&&(e.response.data=r(e.response.data,e.response.headers,d.transformResponse))),Promise.reject(e)})};
},{"./../utils":"La2s","./transformData":"tLbi","../cancel/isCancel":"oYZ2","../defaults":"zBDM","./../helpers/isAbsoluteURL":"VbyR","./../helpers/combineURLs":"2qHL"}],"lxi1":[function(require,module,exports) {
"use strict";var e=require("../utils");module.exports=function(t,r){r=r||{};var o={};return e.forEach(["url","method","params","data"],function(e){void 0!==r[e]&&(o[e]=r[e])}),e.forEach(["headers","auth","proxy"],function(a){e.isObject(r[a])?o[a]=e.deepMerge(t[a],r[a]):void 0!==r[a]?o[a]=r[a]:e.isObject(t[a])?o[a]=e.deepMerge(t[a]):void 0!==t[a]&&(o[a]=t[a])}),e.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],function(e){void 0!==r[e]?o[e]=r[e]:void 0!==t[e]&&(o[e]=t[e])}),o};
},{"../utils":"La2s"}],"koPw":[function(require,module,exports) {
"use strict";var e=require("./../utils"),t=require("../helpers/buildURL"),r=require("./InterceptorManager"),o=require("./dispatchRequest"),i=require("./mergeConfig");function s(e){this.defaults=e,this.interceptors={request:new r,response:new r}}s.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=i(this.defaults,e)).method=e.method?e.method.toLowerCase():"get";var t=[o,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)r=r.then(t.shift(),t.shift());return r},s.prototype.getUri=function(e){return e=i(this.defaults,e),t(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},e.forEach(["delete","get","head","options"],function(t){s.prototype[t]=function(r,o){return this.request(e.merge(o||{},{method:t,url:r}))}}),e.forEach(["post","put","patch"],function(t){s.prototype[t]=function(r,o,i){return this.request(e.merge(i||{},{method:t,url:r,data:o}))}}),module.exports=s;
},{"./../utils":"La2s","../helpers/buildURL":"x+/8","./InterceptorManager":"Vq9p","./dispatchRequest":"vUUJ","./mergeConfig":"lxi1"}],"MqSD":[function(require,module,exports) {
"use strict";function t(t){this.message=t}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,module.exports=t;
},{}],"H1pc":[function(require,module,exports) {
"use strict";var e=require("./Cancel");function n(n){if("function"!=typeof n)throw new TypeError("executor must be a function.");var o;this.promise=new Promise(function(e){o=e});var r=this;n(function(n){r.reason||(r.reason=new e(n),o(r.reason))})}n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var e;return{token:new n(function(n){e=n}),cancel:e}},module.exports=n;
},{"./Cancel":"MqSD"}],"FYPw":[function(require,module,exports) {
"use strict";module.exports=function(n){return function(t){return n.apply(null,t)}};
},{}],"U60K":[function(require,module,exports) {
"use strict";var e=require("./utils"),r=require("./helpers/bind"),n=require("./core/Axios"),u=require("./core/mergeConfig"),t=require("./defaults");function i(u){var t=new n(u),i=r(n.prototype.request,t);return e.extend(i,n.prototype,t),e.extend(i,t),i}var l=i(t);l.Axios=n,l.create=function(e){return i(u(l.defaults,e))},l.Cancel=require("./cancel/Cancel"),l.CancelToken=require("./cancel/CancelToken"),l.isCancel=require("./cancel/isCancel"),l.all=function(e){return Promise.all(e)},l.spread=require("./helpers/spread"),module.exports=l,module.exports.default=l;
},{"./utils":"La2s","./helpers/bind":"NwEK","./core/Axios":"koPw","./core/mergeConfig":"lxi1","./defaults":"zBDM","./cancel/Cancel":"MqSD","./cancel/CancelToken":"H1pc","./cancel/isCancel":"oYZ2","./helpers/spread":"FYPw"}],"gI3o":[function(require,module,exports) {
module.exports=require("./lib/axios");
},{"./lib/axios":"U60K"}],"AXFY":[function(require,module,exports) {
var define;
var t;!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof t&&t.amd?t([],n):"object"==typeof exports?exports.swal=n():e.swal=n()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o="swal-button";e.CLASS_NAMES={MODAL:"swal-modal",OVERLAY:"swal-overlay",SHOW_MODAL:"swal-overlay--show-modal",MODAL_TITLE:"swal-title",MODAL_TEXT:"swal-text",ICON:"swal-icon",ICON_CUSTOM:"swal-icon--custom",CONTENT:"swal-content",FOOTER:"swal-footer",BUTTON_CONTAINER:"swal-button-container",BUTTON:o,CONFIRM_BUTTON:o+"--confirm",CANCEL_BUTTON:o+"--cancel",DANGER_BUTTON:o+"--danger",BUTTON_LOADING:o+"--loading",BUTTON_LOADER:o+"__loader"},e.default=e.CLASS_NAMES},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getNode=function(t){var e="."+t;return document.querySelector(e)},e.stringToNode=function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild},e.insertAfter=function(t,e){var n=e.nextSibling;e.parentNode.insertBefore(t,n)},e.removeNode=function(t){t.parentElement.removeChild(t)},e.throwErr=function(t){throw"SweetAlert: "+(t=t.replace(/ +(?= )/g,"")).trim()},e.isPlainObject=function(t){if("[object Object]"!==Object.prototype.toString.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype},e.ordinalSuffixOf=function(t){var e=t%10,n=t%100;return 1===e&&11!==n?t+"st":2===e&&12!==n?t+"nd":3===e&&13!==n?t+"rd":t+"th"}},function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n(25));var r=n(26);e.overlayMarkup=r.default,o(n(27)),o(n(28)),o(n(29));var i=n(0),a=i.default.MODAL_TITLE,s=i.default.MODAL_TEXT,c=i.default.ICON,l=i.default.FOOTER;e.iconMarkup='\n  <div class="'+c+'"></div>',e.titleMarkup='\n  <div class="'+a+'"></div>\n',e.textMarkup='\n  <div class="'+s+'"></div>',e.footerMarkup='\n  <div class="'+l+'"></div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1);e.CONFIRM_KEY="confirm",e.CANCEL_KEY="cancel";var r={visible:!0,text:null,value:null,className:"",closeModal:!0},i=Object.assign({},r,{visible:!1,text:"Cancel",value:null}),a=Object.assign({},r,{text:"OK",value:!0});e.defaultButtonList={cancel:i,confirm:a};var s=function(t){switch(t){case e.CONFIRM_KEY:return a;case e.CANCEL_KEY:return i;default:var n=t.charAt(0).toUpperCase()+t.slice(1);return Object.assign({},r,{text:n,value:t})}},c=function(t,e){var n=s(t);return!0===e?Object.assign({},n,{visible:!0}):"string"==typeof e?Object.assign({},n,{visible:!0,text:e}):o.isPlainObject(e)?Object.assign({visible:!0},n,e):Object.assign({},n,{visible:!1})},l=function(t){var n={};switch(t.length){case 1:n[e.CANCEL_KEY]=Object.assign({},i,{visible:!1});break;case 2:n[e.CANCEL_KEY]=c(e.CANCEL_KEY,t[0]),n[e.CONFIRM_KEY]=c(e.CONFIRM_KEY,t[1]);break;default:o.throwErr("Invalid number of 'buttons' in array ("+t.length+").\n      If you want more than 2 buttons, you need to use an object!")}return n};e.getButtonListOpts=function(t){var n=e.defaultButtonList;return"string"==typeof t?n[e.CONFIRM_KEY]=c(e.CONFIRM_KEY,t):Array.isArray(t)?n=l(t):o.isPlainObject(t)?n=function(t){for(var e={},n=0,o=Object.keys(t);n<o.length;n++){var r=o[n],a=t[r],s=c(r,a);e[r]=s}return e.cancel||(e.cancel=i),e}(t):!0===t?n=l([!0,!0]):!1===t?n=l([!1,!1]):void 0===t&&(n=e.defaultButtonList),n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(2),i=n(0),a=i.default.MODAL,s=i.default.OVERLAY,c=n(30),l=n(31),u=n(32),f=n(33);e.injectElIntoModal=function(t){var e=o.getNode(a),n=o.stringToNode(t);return e.appendChild(n),n};var d=function(t,e){!function(t){t.className=a,t.textContent=""}(t);var n=e.className;n&&t.classList.add(n)};e.initModalContent=function(t){var e=o.getNode(a);d(e,t),c.default(t.icon),l.initTitle(t.title),l.initText(t.text),f.default(t.content),u.default(t.buttons,t.dangerMode)};e.default=function(){var t=o.getNode(s),e=o.stringToNode(r.modalMarkup);t.appendChild(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r={isOpen:!1,promise:null,actions:{},timer:null},i=Object.assign({},r);e.resetState=function(){i=Object.assign({},r)},e.setActionValue=function(t){if("string"==typeof t)return a(o.CONFIRM_KEY,t);for(var e in t)a(e,t[e])};var a=function(t,e){i.actions[t]||(i.actions[t]={}),Object.assign(i.actions[t],{value:e})};e.setActionOptionsFor=function(t,e){var n=(void 0===e?{}:e).closeModal,o=void 0===n||n;Object.assign(i.actions[t],{closeModal:o})},e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(3),i=n(0),a=i.default.OVERLAY,s=i.default.SHOW_MODAL,c=i.default.BUTTON,l=i.default.BUTTON_LOADING,u=n(5);e.openModal=function(){o.getNode(a).classList.add(s),u.default.isOpen=!0};e.onAction=function(t){void 0===t&&(t=r.CANCEL_KEY);var e=u.default.actions[t],n=e.value;if(!1===e.closeModal){var i=c+"--"+t;o.getNode(i).classList.add(l)}else o.getNode(a).classList.remove(s),u.default.isOpen=!1;u.default.promise.resolve(n)},e.getState=function(){var t=Object.assign({},u.default);return delete t.promise,delete t.timer,t},e.stopLoading=function(){for(var t=document.querySelectorAll("."+c),e=0;e<t.length;e++)t[e].classList.remove(l)}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(e){t.exports=e.sweetAlert=n(9)}).call(e,n(7))},function(t,e,n){(function(e){t.exports=e.swal=n(10)}).call(e,n(7))},function(t,e,n){"undefined"!=typeof window&&n(11),n(16);var o=n(23).default;t.exports=o},function(t,e,n){var o=n(12);"string"==typeof o&&(o=[[t.i,o,""]]);var r={insertAt:"top",transform:void 0};n(14)(o,r),o.locals&&(t.exports=o.locals)},function(t,e,n){(t.exports=n(13)(void 0)).push([t.i,'.swal-icon--error{border-color:#f27474;-webkit-animation:animateErrorIcon .5s;animation:animateErrorIcon .5s}.swal-icon--error__x-mark{position:relative;display:block;-webkit-animation:animateXMark .5s;animation:animateXMark .5s}.swal-icon--error__line{position:absolute;height:5px;width:47px;background-color:#f27474;display:block;top:37px;border-radius:2px}.swal-icon--error__line--left{-webkit-transform:rotate(45deg);transform:rotate(45deg);left:17px}.swal-icon--error__line--right{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);right:16px}@-webkit-keyframes animateErrorIcon{0%{-webkit-transform:rotateX(100deg);transform:rotateX(100deg);opacity:0}to{-webkit-transform:rotateX(0deg);transform:rotateX(0deg);opacity:1}}@keyframes animateErrorIcon{0%{-webkit-transform:rotateX(100deg);transform:rotateX(100deg);opacity:0}to{-webkit-transform:rotateX(0deg);transform:rotateX(0deg);opacity:1}}@-webkit-keyframes animateXMark{0%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}50%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}80%{-webkit-transform:scale(1.15);transform:scale(1.15);margin-top:-6px}to{-webkit-transform:scale(1);transform:scale(1);margin-top:0;opacity:1}}@keyframes animateXMark{0%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}50%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}80%{-webkit-transform:scale(1.15);transform:scale(1.15);margin-top:-6px}to{-webkit-transform:scale(1);transform:scale(1);margin-top:0;opacity:1}}.swal-icon--warning{border-color:#f8bb86;-webkit-animation:pulseWarning .75s infinite alternate;animation:pulseWarning .75s infinite alternate}.swal-icon--warning__body{width:5px;height:47px;top:10px;border-radius:2px;margin-left:-2px}.swal-icon--warning__body,.swal-icon--warning__dot{position:absolute;left:50%;background-color:#f8bb86}.swal-icon--warning__dot{width:7px;height:7px;border-radius:50%;margin-left:-4px;bottom:-11px}@-webkit-keyframes pulseWarning{0%{border-color:#f8d486}to{border-color:#f8bb86}}@keyframes pulseWarning{0%{border-color:#f8d486}to{border-color:#f8bb86}}.swal-icon--success{border-color:#a5dc86}.swal-icon--success:after,.swal-icon--success:before{content:"";border-radius:50%;position:absolute;width:60px;height:120px;background:#fff;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.swal-icon--success:before{border-radius:120px 0 0 120px;top:-7px;left:-33px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transform-origin:60px 60px;transform-origin:60px 60px}.swal-icon--success:after{border-radius:0 120px 120px 0;top:-11px;left:30px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transform-origin:0 60px;transform-origin:0 60px;-webkit-animation:rotatePlaceholder 4.25s ease-in;animation:rotatePlaceholder 4.25s ease-in}.swal-icon--success__ring{width:80px;height:80px;border:4px solid hsla(98,55%,69%,.2);border-radius:50%;box-sizing:content-box;position:absolute;left:-4px;top:-4px;z-index:2}.swal-icon--success__hide-corners{width:5px;height:90px;background-color:#fff;padding:1px;position:absolute;left:28px;top:8px;z-index:1;-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.swal-icon--success__line{height:5px;background-color:#a5dc86;display:block;border-radius:2px;position:absolute;z-index:2}.swal-icon--success__line--tip{width:25px;left:14px;top:46px;-webkit-transform:rotate(45deg);transform:rotate(45deg);-webkit-animation:animateSuccessTip .75s;animation:animateSuccessTip .75s}.swal-icon--success__line--long{width:47px;right:8px;top:38px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-animation:animateSuccessLong .75s;animation:animateSuccessLong .75s}@-webkit-keyframes rotatePlaceholder{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}5%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}12%{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}to{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}}@keyframes rotatePlaceholder{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}5%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}12%{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}to{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}}@-webkit-keyframes animateSuccessTip{0%{width:0;left:1px;top:19px}54%{width:0;left:1px;top:19px}70%{width:50px;left:-8px;top:37px}84%{width:17px;left:21px;top:48px}to{width:25px;left:14px;top:45px}}@keyframes animateSuccessTip{0%{width:0;left:1px;top:19px}54%{width:0;left:1px;top:19px}70%{width:50px;left:-8px;top:37px}84%{width:17px;left:21px;top:48px}to{width:25px;left:14px;top:45px}}@-webkit-keyframes animateSuccessLong{0%{width:0;right:46px;top:54px}65%{width:0;right:46px;top:54px}84%{width:55px;right:0;top:35px}to{width:47px;right:8px;top:38px}}@keyframes animateSuccessLong{0%{width:0;right:46px;top:54px}65%{width:0;right:46px;top:54px}84%{width:55px;right:0;top:35px}to{width:47px;right:8px;top:38px}}.swal-icon--info{border-color:#c9dae1}.swal-icon--info:before{width:5px;height:29px;bottom:17px;border-radius:2px;margin-left:-2px}.swal-icon--info:after,.swal-icon--info:before{content:"";position:absolute;left:50%;background-color:#c9dae1}.swal-icon--info:after{width:7px;height:7px;border-radius:50%;margin-left:-3px;top:19px}.swal-icon{width:80px;height:80px;border-width:4px;border-style:solid;border-radius:50%;padding:0;position:relative;box-sizing:content-box;margin:20px auto}.swal-icon:first-child{margin-top:32px}.swal-icon--custom{width:auto;height:auto;max-width:100%;border:none;border-radius:0}.swal-icon img{max-width:100%;max-height:100%}.swal-title{color:rgba(0,0,0,.65);font-weight:600;text-transform:none;position:relative;display:block;padding:13px 16px;font-size:27px;line-height:normal;text-align:center;margin-bottom:0}.swal-title:first-child{margin-top:26px}.swal-title:not(:first-child){padding-bottom:0}.swal-title:not(:last-child){margin-bottom:13px}.swal-text{font-size:16px;position:relative;float:none;line-height:normal;vertical-align:top;text-align:left;display:inline-block;margin:0;padding:0 10px;font-weight:400;color:rgba(0,0,0,.64);max-width:calc(100% - 20px);overflow-wrap:break-word;box-sizing:border-box}.swal-text:first-child{margin-top:45px}.swal-text:last-child{margin-bottom:45px}.swal-footer{text-align:right;padding-top:13px;margin-top:13px;padding:13px 16px;border-radius:inherit;border-top-left-radius:0;border-top-right-radius:0}.swal-button-container{margin:5px;display:inline-block;position:relative}.swal-button{background-color:#7cd1f9;color:#fff;border:none;box-shadow:none;border-radius:5px;font-weight:600;font-size:14px;padding:10px 24px;margin:0;cursor:pointer}.swal-button:not([disabled]):hover{background-color:#78cbf2}.swal-button:active{background-color:#70bce0}.swal-button:focus{outline:none;box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(43,114,165,.29)}.swal-button[disabled]{opacity:.5;cursor:default}.swal-button::-moz-focus-inner{border:0}.swal-button--cancel{color:#555;background-color:#efefef}.swal-button--cancel:not([disabled]):hover{background-color:#e8e8e8}.swal-button--cancel:active{background-color:#d7d7d7}.swal-button--cancel:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(116,136,150,.29)}.swal-button--danger{background-color:#e64942}.swal-button--danger:not([disabled]):hover{background-color:#df4740}.swal-button--danger:active{background-color:#cf423b}.swal-button--danger:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(165,43,43,.29)}.swal-content{padding:0 20px;margin-top:20px;font-size:medium}.swal-content:last-child{margin-bottom:20px}.swal-content__input,.swal-content__textarea{-webkit-appearance:none;background-color:#fff;border:none;font-size:14px;display:block;box-sizing:border-box;width:100%;border:1px solid rgba(0,0,0,.14);padding:10px 13px;border-radius:2px;transition:border-color .2s}.swal-content__input:focus,.swal-content__textarea:focus{outline:none;border-color:#6db8ff}.swal-content__textarea{resize:vertical}.swal-button--loading{color:transparent}.swal-button--loading~.swal-button__loader{opacity:1}.swal-button__loader{position:absolute;height:auto;width:43px;z-index:2;left:50%;top:50%;-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);text-align:center;pointer-events:none;opacity:0}.swal-button__loader div{display:inline-block;float:none;vertical-align:baseline;width:9px;height:9px;padding:0;border:none;margin:2px;opacity:.4;border-radius:7px;background-color:hsla(0,0%,100%,.9);transition:background .2s;-webkit-animation:swal-loading-anim 1s infinite;animation:swal-loading-anim 1s infinite}.swal-button__loader div:nth-child(3n+2){-webkit-animation-delay:.15s;animation-delay:.15s}.swal-button__loader div:nth-child(3n+3){-webkit-animation-delay:.3s;animation-delay:.3s}@-webkit-keyframes swal-loading-anim{0%{opacity:.4}20%{opacity:.4}50%{opacity:1}to{opacity:.4}}@keyframes swal-loading-anim{0%{opacity:.4}20%{opacity:.4}50%{opacity:1}to{opacity:.4}}.swal-overlay{position:fixed;top:0;bottom:0;left:0;right:0;text-align:center;font-size:0;overflow-y:auto;background-color:rgba(0,0,0,.4);z-index:10000;pointer-events:none;opacity:0;transition:opacity .3s}.swal-overlay:before{content:" ";display:inline-block;vertical-align:middle;height:100%}.swal-overlay--show-modal{opacity:1;pointer-events:auto}.swal-overlay--show-modal .swal-modal{opacity:1;pointer-events:auto;box-sizing:border-box;-webkit-animation:showSweetAlert .3s;animation:showSweetAlert .3s;will-change:transform}.swal-modal{width:478px;opacity:0;pointer-events:none;background-color:#fff;text-align:center;border-radius:5px;position:static;margin:20px auto;display:inline-block;vertical-align:middle;-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;z-index:10001;transition:opacity .2s,-webkit-transform .3s;transition:transform .3s,opacity .2s;transition:transform .3s,opacity .2s,-webkit-transform .3s}@media (max-width:500px){.swal-modal{width:calc(100% - 20px)}}@-webkit-keyframes showSweetAlert{0%{-webkit-transform:scale(1);transform:scale(1)}1%{-webkit-transform:scale(.5);transform:scale(.5)}45%{-webkit-transform:scale(1.05);transform:scale(1.05)}80%{-webkit-transform:scale(.95);transform:scale(.95)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes showSweetAlert{0%{-webkit-transform:scale(1);transform:scale(1)}1%{-webkit-transform:scale(.5);transform:scale(.5)}45%{-webkit-transform:scale(1.05);transform:scale(1.05)}80%{-webkit-transform:scale(.95);transform:scale(.95)}to{-webkit-transform:scale(1);transform:scale(1)}}',""])},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",o=t[3];if(!o)return n;if(e&&"function"==typeof btoa)return[n].concat(o.sources.map(function(t){return"/*# sourceURL="+o.sourceRoot+t+" */"})).concat([""]).join("\n");return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var o={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(o[i]=!0)}for(r=0;r<t.length;r++){var a=t[r];"number"==typeof a[0]&&o[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(t,e,n){function o(t,e){for(var n=0;n<t.length;n++){var o=t[n],r=d[o.id];if(r){r.refs++;for(var i=0;i<r.parts.length;i++)r.parts[i](o.parts[i]);for(;i<o.parts.length;i++)r.parts.push(u(o.parts[i],e))}else{var a=[];for(i=0;i<o.parts.length;i++)a.push(u(o.parts[i],e));d[o.id]={id:o.id,refs:1,parts:a}}}}function r(t,e){for(var n=[],o={},r=0;r<t.length;r++){var i=t[r],a=e.base?i[0]+e.base:i[0],s={css:i[1],media:i[2],sourceMap:i[3]};o[a]?o[a].parts.push(s):n.push(o[a]={id:a,parts:[s]})}return n}function i(t,e){var n=m(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var o=v[v.length-1];if("top"===t.insertAt)o?o.nextSibling?n.insertBefore(e,o.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),v.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function a(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=v.indexOf(t);e>=0&&v.splice(e,1)}function s(t){var e=document.createElement("style");return t.attrs.type="text/css",l(e,t.attrs),i(t,e),e}function c(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",l(e,t.attrs),i(t,e),e}function l(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function u(t,e){var n,o,r,i;if(e.transform&&t.css){if(!(i=e.transform(t.css)))return function(){};t.css=i}if(e.singleton){var l=g++;n=b||(b=s(e)),o=f.bind(null,n,l,!1),r=f.bind(null,n,l,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=c(e),o=function(t,e,n){var o=n.css,r=n.sourceMap,i=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||i)&&(o=h(o)),r&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var a=new Blob([o],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,n,e),r=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(e),o=function(t,e){var n=e.css,o=e.media;if(o&&t.setAttribute("media",o),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),r=function(){a(n)});return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else r()}}function f(t,e,n,o){var r=n?"":o.css;if(t.styleSheet)t.styleSheet.cssText=w(e,r);else{var i=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}var d={},p=function(t){var e;return function(){return void 0===e&&(e=function(){return window&&document&&document.all&&!window.atob}.apply(this,arguments)),e}}(),m=function(t){var e={};return function(t){return void 0===e[t]&&(e[t]=function(t){return document.querySelector(t)}.call(this,t)),e[t]}}(),b=null,g=0,v=[],h=n(15);t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||(e.singleton=p()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=r(t,e);return o(n,e),function(t){for(var i=[],a=0;a<n.length;a++){var s=n[a];(c=d[s.id]).refs--,i.push(c)}t&&o(r(t,e),e);for(a=0;a<i.length;a++){var c;if(0===(c=i[a]).refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete d[c.id]}}}};var w=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,o=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var r,i=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(i)?t:(r=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:o+i.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},function(t,e,n){var o=n(17);"undefined"==typeof window||window.Promise||(window.Promise=o),n(21),String.prototype.includes||(String.prototype.includes=function(t,e){"use strict";return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),o=n.length>>>0;if(0===o)return!1;for(var r=0|e,i=Math.max(r>=0?r:o-Math.abs(r),0);i<o;){if(function(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}(n[i],t))return!0;i++}return!1}}),"undefined"!=typeof window&&[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})},function(t,e,n){(function(e){!function(n){function o(){}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(t,this)}function i(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,r._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var o;try{o=n(t._value)}catch(t){return void s(e.promise,t)}a(e.promise,o)}else(1===t._state?a:s)(e.promise,t._value)})):t._deferreds.push(e)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof r)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void u(function(t,e){return function(){t.apply(e,arguments)}}(n,e),t)}t._state=1,t._value=e,c(t)}catch(e){s(t,e)}}function s(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)i(t,t._deferreds[e]);t._deferreds=null}function l(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function u(t,e){var n=!1;try{t(function(t){n||(n=!0,a(e,t))},function(t){n||(n=!0,s(e,t))})}catch(t){if(n)return;n=!0,s(e,t)}}var f=setTimeout;r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,e){var n=new this.constructor(o);return i(this,new l(t,e,n)),n},r.all=function(t){var e=Array.prototype.slice.call(t);return new r(function(t,n){function o(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(t){o(i,t)},n)}e[i]=a,0==--r&&t(e)}catch(t){n(t)}}if(0===e.length)return t([]);for(var r=e.length,i=0;i<e.length;i++)o(i,e[i])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(t){return new r(function(e,n){n(t)})},r.race=function(t){return new r(function(e,n){for(var o=0,r=t.length;o<r;o++)t[o].then(e,n)})},r._immediateFn="function"==typeof e&&function(t){e(t)}||function(t){f(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function(t){r._immediateFn=t},r._setUnhandledRejectionFn=function(t){r._unhandledRejectionFn=t},void 0!==t&&t.exports?t.exports=r:n.Promise||(n.Promise=r)}(this)}).call(e,n(18).setImmediate)},function(t,e,n){function o(t,e){this._id=t,this._clearFn=e}var r=Function.prototype.apply;e.setTimeout=function(){return new o(r.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new o(r.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(19),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},function(t,e,n){(function(t,e){!function(t,n){"use strict";function o(t){delete s[t]}function r(t){if(c)setTimeout(r,0,t);else{var e=s[t];if(e){c=!0;try{!function(t){var e=t.callback,o=t.args;switch(o.length){case 0:e();break;case 1:e(o[0]);break;case 2:e(o[0],o[1]);break;case 3:e(o[0],o[1],o[2]);break;default:e.apply(n,o)}}(e)}finally{o(t),c=!1}}}}if(!t.setImmediate){var i,a=1,s={},c=!1,l=t.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(t);u=u&&u.setTimeout?u:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick(function(){r(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&r(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),i=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){r(t.data)},i=function(e){t.port2.postMessage(e)}}():l&&"onreadystatechange"in l.createElement("script")?function(){var t=l.documentElement;i=function(e){var n=l.createElement("script");n.onreadystatechange=function(){r(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():i=function(t){setTimeout(r,0,t)},u.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var o={callback:t,args:e};return s[a]=o,i(a),a++},u.clearImmediate=o}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,n(7),n(20))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function i(){m&&d&&(m=!1,d.length?p=d.concat(p):b=-1,p.length&&a())}function a(){if(!m){var t=r(i);m=!0;for(var e=p.length;e;){for(d=p,p=[];++b<e;)d&&d[b].run();b=-1,e=p.length}d=null,m=!1,function(t){if(u===clearTimeout)return clearTimeout(t);if((u===o||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{u(t)}catch(e){try{return u.call(null,t)}catch(e){return u.call(this,t)}}}(t)}}function s(t,e){this.fun=t,this.array=e}function c(){}var l,u,f=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(t){l=n}try{u="function"==typeof clearTimeout?clearTimeout:o}catch(t){u=o}}();var d,p=[],m=!1,b=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new s(t,e)),1!==p.length||m||r(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,n){"use strict";n(22).polyfill()},function(t,e,n){"use strict";function o(t,e){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var n=Object(t),o=1;o<arguments.length;o++){var r=arguments[o];if(null!=r)for(var i=Object.keys(Object(r)),a=0,s=i.length;a<s;a++){var c=i[a],l=Object.getOwnPropertyDescriptor(r,c);void 0!==l&&l.enumerable&&(n[c]=r[c])}}return n}t.exports={assign:o,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:o})}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(24),r=n(6),i=n(5),a=n(36),s=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("undefined"!=typeof window){var n=a.getOpts.apply(void 0,t);return new Promise(function(t,e){i.default.promise={resolve:t,reject:e},o.default(n),setTimeout(function(){r.openModal()})})}};s.close=r.onAction,s.getState=r.getState,s.setActionValue=i.setActionValue,s.stopLoading=r.stopLoading,s.setDefaults=a.setDefaults,e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(0).default.MODAL,i=n(4),a=n(34),s=n(35),c=n(1);e.init=function(t){o.getNode(r)||(document.body||c.throwErr("You can only use SweetAlert AFTER the DOM has loaded!"),a.default(),i.default()),i.initModalContent(t),s.default(t)},e.default=e.init},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0).default.MODAL;e.modalMarkup='\n  <div class="'+o+'" role="dialog" aria-modal="true"></div>',e.default=e.modalMarkup},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o='<div \n    class="'+n(0).default.OVERLAY+'"\n    tabIndex="-1">\n  </div>';e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0).default.ICON;e.errorIconMarkup=function(){var t=o+"--error",e=t+"__line";return'\n    <div class="'+t+'__x-mark">\n      <span class="'+e+" "+e+'--left"></span>\n      <span class="'+e+" "+e+'--right"></span>\n    </div>\n  '},e.warningIconMarkup=function(){var t=o+"--warning";return'\n    <span class="'+t+'__body">\n      <span class="'+t+'__dot"></span>\n    </span>\n  '},e.successIconMarkup=function(){var t=o+"--success";return'\n    <span class="'+t+"__line "+t+'__line--long"></span>\n    <span class="'+t+"__line "+t+'__line--tip"></span>\n\n    <div class="'+t+'__ring"></div>\n    <div class="'+t+'__hide-corners"></div>\n  '}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0).default.CONTENT;e.contentMarkup='\n  <div class="'+o+'">\n\n  </div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=o.default.BUTTON_CONTAINER,i=o.default.BUTTON,a=o.default.BUTTON_LOADER;e.buttonMarkup='\n  <div class="'+r+'">\n\n    <button\n      class="'+i+'"\n    ></button>\n\n    <div class="'+a+'">\n      <div></div>\n      <div></div>\n      <div></div>\n    </div>\n\n  </div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),r=n(2),i=n(0),a=i.default.ICON,s=i.default.ICON_CUSTOM,c=["error","warning","success","info"],l={error:r.errorIconMarkup(),warning:r.warningIconMarkup(),success:r.successIconMarkup()};e.default=function(t){if(t){var e=o.injectElIntoModal(r.iconMarkup);c.includes(t)?function(t,e){var n=a+"--"+t;e.classList.add(n);var o=l[t];o&&(e.innerHTML=o)}(t,e):function(t,e){e.classList.add(s);var n=document.createElement("img");n.src=t,e.appendChild(n)}(t,e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),r=n(4),i=function(t){navigator.userAgent.includes("AppleWebKit")&&(t.style.display="none",t.offsetHeight,t.style.display="")};e.initTitle=function(t){if(t){var e=r.injectElIntoModal(o.titleMarkup);e.textContent=t,i(e)}},e.initText=function(t){if(t){var e=document.createDocumentFragment();t.split("\n").forEach(function(t,n,o){e.appendChild(document.createTextNode(t)),n<o.length-1&&e.appendChild(document.createElement("br"))});var n=r.injectElIntoModal(o.textMarkup);n.appendChild(e),i(n)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(4),i=n(0),a=i.default.BUTTON,s=i.default.DANGER_BUTTON,c=n(3),l=n(2),u=n(6),f=n(5),d=function(t,e,n){var r=e.text,i=e.value,d=e.className,p=e.closeModal,m=o.stringToNode(l.buttonMarkup),b=m.querySelector("."+a),g=a+"--"+t;b.classList.add(g),d&&(Array.isArray(d)?d:d.split(" ")).filter(function(t){return t.length>0}).forEach(function(t){b.classList.add(t)}),n&&t===c.CONFIRM_KEY&&b.classList.add(s),b.textContent=r;var v={};return v[t]=i,f.setActionValue(v),f.setActionOptionsFor(t,{closeModal:p}),b.addEventListener("click",function(){return u.onAction(t)}),m};e.default=function(t,e){var n=r.injectElIntoModal(l.footerMarkup);for(var o in t){var i=t[o],a=d(o,i,e);i.visible&&n.appendChild(a)}0===n.children.length&&n.remove()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(4),i=n(2),a=n(5),s=n(6),c=n(0).default.CONTENT,l=function(t){t.addEventListener("input",function(t){var e=t.target.value;a.setActionValue(e)}),t.addEventListener("keyup",function(t){if("Enter"===t.key)return s.onAction(o.CONFIRM_KEY)}),setTimeout(function(){t.focus(),a.setActionValue("")},0)};e.default=function(t){if(t){var e=r.injectElIntoModal(i.contentMarkup),n=t.element,o=t.attributes;"string"==typeof n?function(t,e,n){var o=document.createElement(e),r=c+"__"+e;for(var i in o.classList.add(r),n){var a=n[i];o[i]=a}"input"===e&&l(o),t.appendChild(o)}(e,n,o):e.appendChild(n)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(2);e.default=function(){var t=o.stringToNode(r.overlayMarkup);document.body.appendChild(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(5),r=n(6),i=n(1),a=n(3),s=n(0),c=s.default.MODAL,l=s.default.BUTTON,u=s.default.OVERLAY,f=function(t){if(o.default.isOpen)switch(t.key){case"Escape":return r.onAction(a.CANCEL_KEY)}},d=function(t){if(o.default.isOpen)switch(t.key){case"Tab":return function(t){t.preventDefault(),m()}(t)}},p=function(t){if(o.default.isOpen)return"Tab"===t.key&&t.shiftKey?function(t){t.preventDefault(),b()}(t):void 0},m=function(){var t=i.getNode(l);t&&(t.tabIndex=0,t.focus())},b=function(){var t=i.getNode(c).querySelectorAll("."+l),e=t[t.length-1];e&&e.focus()},g=function(){var t=i.getNode(c).querySelectorAll("."+l);t.length&&(function(t){t[t.length-1].addEventListener("keydown",d)}(t),function(t){t[0].addEventListener("keydown",p)}(t))},v=function(t){if(i.getNode(u)===t.target)return r.onAction(a.CANCEL_KEY)};e.default=function(t){t.closeOnEsc?document.addEventListener("keyup",f):document.removeEventListener("keyup",f),t.dangerMode?m():b(),g(),function(t){var e=i.getNode(u);e.removeEventListener("click",v),t&&e.addEventListener("click",v)}(t.closeOnClickOutside),function(t){o.default.timer&&clearTimeout(o.default.timer),t&&(o.default.timer=window.setTimeout(function(){return r.onAction(a.CANCEL_KEY)},t))}(t.timer)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(3),i=n(37),a=n(38),s={title:null,text:null,icon:null,buttons:r.defaultButtonList,content:null,className:null,closeOnClickOutside:!0,closeOnEsc:!0,dangerMode:!1,timer:null},c=Object.assign({},s);e.setDefaults=function(t){c=Object.assign({},s,t)};var l=function(t){var e=t&&t.button,n=t&&t.buttons;return void 0!==e&&void 0!==n&&o.throwErr("Cannot set both 'button' and 'buttons' options!"),void 0!==e?{confirm:e}:n},u=function(t){return o.ordinalSuffixOf(t+1)},f=function(t,e){o.throwErr(u(e)+" argument ('"+t+"') is invalid")},d=function(t,e){var n=t+1,r=e[n];o.isPlainObject(r)||void 0===r||o.throwErr("Expected "+u(n)+" argument ('"+r+"') to be a plain object")},p=function(t,e,n,r){var i=e instanceof Element;if("string"===typeof e){if(0===n)return{text:e};if(1===n)return{text:e,title:r[0]};if(2===n)return d(n,r),{icon:e};f(e,n)}else{if(i&&0===n)return d(n,r),{content:e};if(o.isPlainObject(e))return function(t,e){var n=t+1,r=e[n];void 0!==r&&o.throwErr("Unexpected "+u(n)+" argument ("+r+")")}(n,r),e;f(e,n)}};e.getOpts=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n={};t.forEach(function(e,o){var r=p(0,e,o,t);Object.assign(n,r)});var o=l(n);n.buttons=r.getButtonListOpts(o),delete n.button,n.content=i.getContentOpts(n.content);var u=Object.assign({},s,c,n);return Object.keys(u).forEach(function(t){a.DEPRECATED_OPTS[t]&&a.logDeprecation(t)}),u}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r={element:"input",attributes:{placeholder:""}};e.getContentOpts=function(t){return o.isPlainObject(t)?Object.assign({},t):t instanceof Element?{element:t}:"input"===t?r:null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.logDeprecation=function(t){var n=e.DEPRECATED_OPTS[t],o=n.onlyRename,r=n.replacement,i=n.subOption,a=n.link,s='SweetAlert warning: "'+t+'" option has been '+(o?"renamed":"deprecated")+".";r&&(s+=" Please use"+(i?' "'+i+'" in ':" ")+'"'+r+'" instead.');var c="https://sweetalert.js.org";s+=a?" More details: "+c+a:" More details: "+c+"/guides/#upgrading-from-1x",console.warn(s)},e.DEPRECATED_OPTS={type:{replacement:"icon",link:"/docs/#icon"},imageUrl:{replacement:"icon",link:"/docs/#icon"},customClass:{replacement:"className",onlyRename:!0,link:"/docs/#classname"},imageSize:{},showCancelButton:{replacement:"buttons",link:"/docs/#buttons"},showConfirmButton:{replacement:"button",link:"/docs/#button"},confirmButtonText:{replacement:"button",link:"/docs/#button"},confirmButtonColor:{},cancelButtonText:{replacement:"buttons",link:"/docs/#buttons"},closeOnConfirm:{replacement:"button",subOption:"closeModal",link:"/docs/#button"},closeOnCancel:{replacement:"buttons",subOption:"closeModal",link:"/docs/#buttons"},showLoaderOnConfirm:{replacement:"buttons"},animation:{},inputType:{replacement:"content",link:"/docs/#content"},inputValue:{replacement:"content",link:"/docs/#content"},inputPlaceholder:{replacement:"content",link:"/docs/#content"},html:{replacement:"content",link:"/docs/#content"},allowEscapeKey:{replacement:"closeOnEsc",onlyRename:!0,link:"/docs/#closeonesc"},allowClickOutside:{replacement:"closeOnClickOutside",onlyRename:!0,link:"/docs/#closeonclickoutside"}}}])});
},{}],"Bbek":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}var t=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),n=this&&this.__decorate||function(t,n,r,o){var i,a=arguments.length,c=a<3?n:null===o?o=Object.getOwnPropertyDescriptor(n,r):o;if("object"===("undefined"==typeof Reflect?"undefined":e(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,n,r,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(a<3?i(c):a>3?i(n,r,c):i(n,r))||c);return a>3&&c&&Object.defineProperty(n,r,c),c},r=this&&this.__metadata||function(t,n){if("object"===("undefined"==typeof Reflect?"undefined":e(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function c(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,c)}s((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(c){i=[6,c],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var c=require("vue-property-decorator"),s=a(require("axios")),u=a(require("sweetalert")),l=function(e){function a(){return null!==e&&e.apply(this,arguments)||this}var l,f,p,d,y,h;return t(a,e),a.prototype.refresh=function(){return o(this,void 0,void 0,function(){var e,t,n;return i(this,function(r){switch(r.label){case 0:e={url:"http://localhost:3000/home/refresh",method:"GET",headers:{"Content-Type":"application/json"}},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.default(e)];case 2:return t=r.sent(),[3,4];case 3:return n=r.sent(),console.log(n),[2,u.default("Internal Server Error","Please, try again later","error")];case 4:return t.data.success?u.default("Done!","Your access token has been successfully refreshed","success"):u.default("Something went wrong","We could not refresh your token - please, try again later","error"),[2]}})})},a.prototype.validate=function(){return o(this,void 0,void 0,function(){var e,t,n;return i(this,function(r){switch(r.label){case 0:e={url:"http://localhost:3000/home/validate",method:"GET",headers:{"Content-Type":"application/json"}},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.default(e)];case 2:return t=r.sent(),[3,4];case 3:return n=r.sent(),console.log(n),[2,u.default("Internal Server Error","Please, try again later","error")];case 4:return t.data.success?u.default("Done!","Your token is valid","success"):u.default("Something went wrong","Your token seems to not be valid - please, try entering a new token","error"),[2]}})})},a.prototype.addToken=function(){window.location.assign("https://auth.truelayer.com/?response_type=code&client_id=test-eb3e42&nonce=1535304510&scope=info%20accounts%20balance%20cards%20transactions%20direct_debits%20standing_orders%20products%20beneficiaries%20offline_access&redirect_uri=http://localhost:3000/callback/callback&enable_mock=true&enable_oauth_providers=true&enable_open_banking_providers=true&enable_credentials_sharing_providers=false")},n([c.Prop(String),r("design:type","function"==typeof(l="undefined"!=typeof String&&String)?l:Object)],a.prototype,"credentials_id",void 0),n([c.Prop(String),r("design:type","function"==typeof(f="undefined"!=typeof String&&String)?f:Object)],a.prototype,"consent_status",void 0),n([c.Prop(String),r("design:type","function"==typeof(p="undefined"!=typeof String&&String)?p:Object)],a.prototype,"consent_status_created_at",void 0),n([c.Prop(String),r("design:type","function"==typeof(d="undefined"!=typeof String&&String)?d:Object)],a.prototype,"consent_status_expires_at",void 0),n([c.Prop(String),r("design:type","function"==typeof(y="undefined"!=typeof String&&String)?y:Object)],a.prototype,"provider_name",void 0),n([c.Prop(String),r("design:type","function"==typeof(h="undefined"!=typeof String&&String)?h:Object)],a.prototype,"provider_icon",void 0),a=n([c.Component],a)}(c.Vue);exports.default=l;
(function(){var t=exports.default||module.exports;"function"==typeof t&&(t=t.options),Object.assign(t,{render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("table",{staticClass:"table table-striped table-nonfluid"},[e("thead",[e("div",{staticClass:"top"},[t._m(0),t._v(" "),e("button",{staticClass:"btn btn-default btn-circle",attrs:{type:"button"},on:{click:t.addToken}},[e("img",{attrs:{id:"plus-img",src:"https://img.icons8.com/windows/32/000000/plus.png"}})])]),t._v(" "),t._m(1)]),t._v(" "),e("tbody",[e("tr",[e("td",{attrs:{id:"provider-values"}},[e("img",{attrs:{id:"provider-logo",src:t.provider_icon}}),t._v(" "+t._s(t.provider_name)+" ")]),t._v(" "),e("td",[t._v(t._s(t.credentials_id))]),t._v(" "),e("td",[t._v(t._s(t.consent_status))]),t._v(" "),e("td",{attrs:{id:"consent-values"}},[t._m(2),t._v(" "+t._s(t.consent_status_created_at)+" "),e("br"),t._v(" "),t._m(3),t._v(" "+t._s(t.consent_status_expires_at)+" ")]),t._v(" "),e("td",{staticClass:"buttons"},[e("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:t.refresh}},[t._v("REFRESH")]),t._v("  "),e("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:t.validate}},[t._v("VALIDATE")])])])])])},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("caption",[s("b",[this._v("Your access tokens")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("tr",[s("th",{attrs:{scope:"col"}},[this._v("Provider")]),this._v(" "),s("th",{attrs:{scope:"col"}},[this._v("Credentials ID")]),this._v(" "),s("th",{attrs:{scope:"col"}},[this._v("Consent Status")]),this._v(" "),s("th",{attrs:{scope:"col"}}),this._v(" "),s("th",{attrs:{scope:"col"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("span",{staticClass:"category"},[s("b",[this._v("CREATED AT")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("span",{staticClass:"category"},[s("b",[this._v("EXPIRES AT")])])}],_compiled:!0,_scopeId:null,functional:void 0});})();
},{"vue-property-decorator":"bOF0","axios":"gI3o","sweetalert":"AXFY"}],"k6wc":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}var e=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),n=this&&this.__decorate||function(e,n,o,r){var u,i=arguments.length,c=i<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,o):r;if("object"===("undefined"==typeof Reflect?"undefined":t(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,n,o,r);else for(var l=e.length-1;l>=0;l--)(u=e[l])&&(c=(i<3?u(c):i>3?u(n,o,c):u(n,o))||c);return i>3&&c&&Object.defineProperty(n,o,c),c},o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,u){function i(t){try{l(o.next(t))}catch(e){u(e)}}function c(t){try{l(o.throw(t))}catch(e){u(e)}}function l(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(i,c)}l((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,u,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return u={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&u[0]?o.return:u[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,u[1])).done)return r;switch(o=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,o=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===u[0]||2===u[0])){i=0;continue}if(3===u[0]&&(!r||u[1]>r[0]&&u[1]<r[3])){i.label=u[1];break}if(6===u[0]&&i.label<r[1]){i.label=r[1],r=u;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(u);break}r[2]&&i.ops.pop(),i.trys.pop();continue}u=e.call(t,i)}catch(c){u=[6,c],o=0}finally{n=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var i=require("vue-property-decorator"),c=u(require("axios")),l=function(t){function u(){var e=null!==t&&t.apply(this,arguments)||this;return e.textLogOut="Log out",e}return e(u,t),u.prototype.logout=function(){return o(this,void 0,void 0,function(){var t,e;return r(this,function(n){switch(n.label){case 0:t={url:"http://localhost:3000/auth/logout",method:"GET",headers:{"Content-Type":"application/json"}},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,c.default(t)];case 2:return n.sent(),[3,4];case 3:return e=n.sent(),console.log(e),[2,"ok"];case 4:return window.location.replace("http://localhost:3000/access/auth.html"),[2]}})})},u=n([i.Component],u)}(i.Vue);exports.default=l;
(function(){var t=exports.default||module.exports;"function"==typeof t&&(t=t.options),Object.assign(t,{render:function(){var t=this.$createElement,a=this._self._c||t;return a("nav",{staticClass:"navbar navbar-expand-lg navbar-dark bg-dark justify-content-between"},[this._m(0),this._v(" "),a("form",{staticClass:"form-inline"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"button",id:"logout-button"},on:{click:this.logout}},[this._v(this._s(this.textLogOut))])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("a",{staticClass:"navbar-brand"},[a("img",{staticClass:"d-inline-block align-top",attrs:{src:"/token.55c3413a.svg",width:"35",height:"35",alt:""}}),this._v(" NakedToken ")])}],_compiled:!0,_scopeId:null,functional:void 0});})();
},{"vue-property-decorator":"bOF0","axios":"gI3o","./../../../../../token.svg":[["token.55c3413a.svg","gK3n"],"gK3n"]}],"DdMC":[function(require,module,exports) {
"use strict";function r(r,e){return Object.prototype.hasOwnProperty.call(r,e)}module.exports=function(t,n,o,a){n=n||"&",o=o||"=";var s={};if("string"!=typeof t||0===t.length)return s;var p=/\+/g;t=t.split(n);var u=1e3;a&&"number"==typeof a.maxKeys&&(u=a.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var i=0;i<c;++i){var y,l,f,v,b=t[i].replace(p,"%20"),d=b.indexOf(o);d>=0?(y=b.substr(0,d),l=b.substr(d+1)):(y=b,l=""),f=decodeURIComponent(y),v=decodeURIComponent(l),r(s,f)?e(s[f])?s[f].push(v):s[f]=[s[f],v]:s[f]=v}return s};var e=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)};
},{}],"ipy0":[function(require,module,exports) {
"use strict";var n=function(n){switch(typeof n){case"string":return n;case"boolean":return n?"true":"false";case"number":return isFinite(n)?n:"";default:return""}};module.exports=function(o,u,c,a){return u=u||"&",c=c||"=",null===o&&(o=void 0),"object"==typeof o?r(t(o),function(t){var a=encodeURIComponent(n(t))+c;return e(o[t])?r(o[t],function(e){return a+encodeURIComponent(n(e))}).join(u):a+encodeURIComponent(n(o[t]))}).join(u):a?encodeURIComponent(n(a))+c+encodeURIComponent(n(o)):""};var e=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)};function r(n,e){if(n.map)return n.map(e);for(var r=[],t=0;t<n.length;t++)r.push(e(n[t],t));return r}var t=Object.keys||function(n){var e=[];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.push(r);return e};
},{}],"njjI":[function(require,module,exports) {
"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode");
},{"./decode":"DdMC","./encode":"ipy0"}],"Hmv1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TL_SECRET="c63b4b72-7a09-4662-91bc-8730a98d6f4f",exports.conString="app-db://user:password@localhost:5432/app",exports.client_id="test-eb3e42";
},{}],"c4AP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__extends=e,exports.__rest=n,exports.__decorate=o,exports.__param=a,exports.__metadata=u,exports.__awaiter=i,exports.__generator=c,exports.__exportStar=f,exports.__values=l,exports.__read=s,exports.__spread=p,exports.__spreadArrays=y,exports.__await=_,exports.__asyncGenerator=h,exports.__asyncDelegator=v,exports.__asyncValues=b,exports.__makeTemplateObject=d,exports.__importStar=x,exports.__importDefault=w,exports.__assign=void 0;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,u=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,n);else for(var i=t.length-1;i>=0;i--)(o=t[i])&&(u=(a<3?o(u):a>3?o(e,r,u):o(e,r))||u);return a>3&&u&&Object.defineProperty(e,r,u),u}function a(t,e){return function(r,n){e(r,n,t)}}function u(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function i(t,e,r,n){return new(r||(r=Promise))(function(o,a){function u(t){try{c(n.next(t))}catch(e){a(e)}}function i(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(u,i)}c((n=n.apply(t,e||[])).next())})}function c(t,e){var r,n,o,a,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,n=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){u=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){u.label=a[1];break}if(6===a[0]&&u.label<o[1]){u.label=o[1],o=a;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(a);break}o[2]&&u.ops.pop(),u.trys.pop();continue}a=e.call(t,u)}catch(i){a=[6,i],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}function f(t,e){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}function l(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)u.push(n.value)}catch(i){o={error:i}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return u}function p(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}function y(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var a=arguments[e],u=0,i=a.length;u<i;u++,o++)n[o]=a[u];return n}function _(t){return this instanceof _?(this.v=t,this):new _(t)}function h(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},u("next"),u("throw"),u("return"),n[Symbol.asyncIterator]=function(){return this},n;function u(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||i(t,e)})})}function i(t,e){try{(r=o[t](e)).value instanceof _?Promise.resolve(r.value.v).then(c,f):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function c(t){i("next",t)}function f(t){i("throw",t)}function l(t,e){t(e),a.shift(),a.length&&i(a[0][0],a[0][1])}}function v(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:_(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof l?l(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function d(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function x(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function w(t){return t&&t.__esModule?t:{default:t}}exports.__assign=r;
},{}],"w3jr":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var t,e=arguments[3],r=require("process");!function(t){!function(n){var i="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),o=u(t);function u(t,e){return function(r,n){"function"!=typeof t[r]&&Object.defineProperty(t,r,{configurable:!0,writable:!0,value:n}),e&&e(r,n)}}void 0===i.Reflect?i.Reflect=t:o=u(i.Reflect,o),function(t){var e=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",u="function"==typeof Object.create,a={__proto__:[]}instanceof Array,f=!u&&!a,c={create:u?function(){return I(Object.create(null))}:a?function(){return I({__proto__:null})}:function(){return I({})},has:f?function(t,r){return e.call(t,r)}:function(t,e){return e in t},get:f?function(t,r){return e.call(t,r)?t[r]:void 0}:function(t,e){return t[e]}},s=Object.getPrototypeOf(Function),h="object"==typeof r&&r.env&&!1,y=h||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var t={},e=[],r=function(){function t(t,e,r){this._index=0,this._keys=t,this._values=e,this._selector=r}return t.prototype["@@iterator"]=function(){return this},t.prototype[o]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var r=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var r=this._find(t,!0);return this._values[r]=e,this},e.prototype.delete=function(e){var r=this._find(e,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new r(this._keys,this._values,n)},e.prototype.values=function(){return new r(this._keys,this._values,i)},e.prototype.entries=function(){return new r(this._keys,this._values,u)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[o]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function n(t,e){return t}function i(t,e){return e}function u(t,e){return[t,e]}}():Map,p=h||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new y}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[o]=function(){return this.keys()},t}():Set,l=new(h||"function"!=typeof WeakMap?function(){var t=16,r=c.create(),n=i();return function(){function t(){this._key=i()}return t.prototype.has=function(t){var e=o(t,!1);return void 0!==e&&c.has(e,this._key)},t.prototype.get=function(t){var e=o(t,!1);return void 0!==e?c.get(e,this._key):void 0},t.prototype.set=function(t,e){var r=o(t,!0);return r[this._key]=e,this},t.prototype.delete=function(t){var e=o(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=i()},t}();function i(){var t;do{t="@@WeakMap@@"+a()}while(c.has(r,t));return r[t]=!0,t}function o(t,r){if(!e.call(t,n)){if(!r)return;Object.defineProperty(t,n,{value:c.create()})}return t[n]}function u(t,e){for(var r=0;r<e;++r)t[r]=255*Math.random()|0;return t}function a(){var e=function(t){if("function"==typeof Uint8Array)return"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):u(new Uint8Array(t),t);return u(new Array(t),t)}(t);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var r="",n=0;n<t;++n){var i=e[n];4!==n&&6!==n&&8!==n||(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}():WeakMap);function v(t,e,r){var n=l.get(t);if(k(n)){if(!r)return;n=new y,l.set(t,n)}var i=n.get(e);if(k(i)){if(!r)return;i=new y,n.set(e,i)}return i}function _(t,e,r){var n=v(e,r,!1);return!k(n)&&!!n.has(t)}function d(t,e,r){var n=v(e,r,!1);if(!k(n))return n.get(t)}function w(t,e,r,n){var i=v(r,n,!0);i.set(t,e)}function g(t,e){var r=[],n=v(t,e,!1);if(k(n))return r;for(var i=n.keys(),u=function(t){var e=A(t,o);if(!x(e))throw new TypeError;var r=e.call(t);if(!O(r))throw new TypeError;return r}(i),a=0;;){var f=S(u);if(!f)return r.length=a,r;var c=f.value;try{r[a]=c}catch(s){try{P(u)}finally{throw s}}a++}}function b(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function k(t){return void 0===t}function m(t){return null===t}function O(t){return"object"==typeof t?null!==t:"function"==typeof t}function E(t,e){switch(b(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var r=3===e?"string":5===e?"number":"default",n=A(t,i);if(void 0!==n){var o=n.call(t,r);if(O(o))throw new TypeError;return o}return function(t,e){if("string"===e){var r=t.toString;if(x(r)){var n=r.call(t);if(!O(n))return n}var i=t.valueOf;if(x(i)){var n=i.call(t);if(!O(n))return n}}else{var i=t.valueOf;if(x(i)){var n=i.call(t);if(!O(n))return n}var o=t.toString;if(x(o)){var n=o.call(t);if(!O(n))return n}}throw new TypeError}(t,"default"===r?"number":r)}function T(t){var e=E(t,3);return"symbol"==typeof e?e:function(t){return""+t}(e)}function j(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function x(t){return"function"==typeof t}function M(t){return"function"==typeof t}function A(t,e){var r=t[e];if(null!=r){if(!x(r))throw new TypeError;return r}}function S(t){var e=t.next();return!e.done&&e}function P(t){var e=t.return;e&&e.call(t)}function K(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===s)return e;if(e!==s)return e;var r=t.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return e;var i=n.constructor;return"function"!=typeof i?e:i===t?e:i}function I(t){return t.__=void 0,delete t.__,t}t("decorate",function(t,e,r,n){if(k(r)){if(!j(t))throw new TypeError;if(!M(e))throw new TypeError;return function(t,e){for(var r=t.length-1;r>=0;--r){var n=t[r],i=n(e);if(!k(i)&&!m(i)){if(!M(i))throw new TypeError;e=i}}return e}(t,e)}if(!j(t))throw new TypeError;if(!O(e))throw new TypeError;if(!O(n)&&!k(n)&&!m(n))throw new TypeError;return m(n)&&(n=void 0),r=T(r),function(t,e,r,n){for(var i=t.length-1;i>=0;--i){var o=t[i],u=o(e,r,n);if(!k(u)&&!m(u)){if(!O(u))throw new TypeError;n=u}}return n}(t,e,r,n)}),t("metadata",function(t,e){return function(r,n){if(!O(r))throw new TypeError;if(!k(n)&&!function(t){switch(b(t)){case 3:case 4:return!0;default:return!1}}(n))throw new TypeError;w(t,e,r,n)}}),t("defineMetadata",function(t,e,r,n){if(!O(r))throw new TypeError;k(n)||(n=T(n));return w(t,e,r,n)}),t("hasMetadata",function(t,e,r){if(!O(e))throw new TypeError;k(r)||(r=T(r));return function t(e,r,n){var i=_(e,r,n);if(i)return!0;var o=K(r);if(!m(o))return t(e,o,n);return!1}(t,e,r)}),t("hasOwnMetadata",function(t,e,r){if(!O(e))throw new TypeError;k(r)||(r=T(r));return _(t,e,r)}),t("getMetadata",function(t,e,r){if(!O(e))throw new TypeError;k(r)||(r=T(r));return function t(e,r,n){var i=_(e,r,n);if(i)return d(e,r,n);var o=K(r);if(!m(o))return t(e,o,n);return}(t,e,r)}),t("getOwnMetadata",function(t,e,r){if(!O(e))throw new TypeError;k(r)||(r=T(r));return d(t,e,r)}),t("getMetadataKeys",function(t,e){if(!O(t))throw new TypeError;k(e)||(e=T(e));return function t(e,r){var n=g(e,r);var i=K(e);if(null===i)return n;var o=t(i,r);if(o.length<=0)return n;if(n.length<=0)return o;var u=new p;var a=[];for(var f=0,c=n;f<c.length;f++){var s=c[f],h=u.has(s);h||(u.add(s),a.push(s))}for(var y=0,l=o;y<l.length;y++){var s=l[y],h=u.has(s);h||(u.add(s),a.push(s))}return a}(t,e)}),t("getOwnMetadataKeys",function(t,e){if(!O(t))throw new TypeError;k(e)||(e=T(e));return g(t,e)}),t("deleteMetadata",function(t,e,r){if(!O(e))throw new TypeError;k(r)||(r=T(r));var n=v(e,r,!1);if(k(n))return!1;if(!n.delete(t))return!1;if(n.size>0)return!0;var i=l.get(e);return i.delete(r),i.size>0||(l.delete(e),!0)})}(o)}()}(t||(t={}));
},{"process":"FT5O"}],"TvFb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RandomGenerator=void 0;var r=function(){function r(){}return r.sha1=function(r){var e,o,t,n,x,a,c,u,h,d=function(r,e){return r<<e|r>>>32-e},f=function(r){var e,o="";for(e=7;e>=0;e--)o+=(r>>>4*e&15).toString(16);return o},s=new Array(80),i=1732584193,C=4023233417,p=2562383102,A=271733878,g=3285377520,l=(r=encodeURIComponent(r)).length,v=[];for(o=0;o<l-3;o+=4)t=r.charCodeAt(o)<<24|r.charCodeAt(o+1)<<16|r.charCodeAt(o+2)<<8|r.charCodeAt(o+3),v.push(t);switch(l%4){case 0:o=2147483648;break;case 1:o=r.charCodeAt(l-1)<<24|8388608;break;case 2:o=r.charCodeAt(l-2)<<24|r.charCodeAt(l-1)<<16|32768;break;case 3:o=r.charCodeAt(l-3)<<24|r.charCodeAt(l-2)<<16|r.charCodeAt(l-1)<<8|128}for(v.push(o);v.length%16!=14;)v.push(0);for(v.push(l>>>29),v.push(l<<3&4294967295),e=0;e<v.length;e+=16){for(o=0;o<16;o++)s[o]=v[e+o];for(o=16;o<=79;o++)s[o]=d(s[o-3]^s[o-8]^s[o-14]^s[o-16],1);for(n=i,x=C,a=p,c=A,u=g,o=0;o<=19;o++)h=d(n,5)+(x&a|~x&c)+u+s[o]+1518500249&4294967295,u=c,c=a,a=d(x,30),x=n,n=h;for(o=20;o<=39;o++)h=d(n,5)+(x^a^c)+u+s[o]+1859775393&4294967295,u=c,c=a,a=d(x,30),x=n,n=h;for(o=40;o<=59;o++)h=d(n,5)+(x&a|x&c|a&c)+u+s[o]+2400959708&4294967295,u=c,c=a,a=d(x,30),x=n,n=h;for(o=60;o<=79;o++)h=d(n,5)+(x^a^c)+u+s[o]+3395469782&4294967295,u=c,c=a,a=d(x,30),x=n,n=h;i=i+n&4294967295,C=C+x&4294967295,p=p+a&4294967295,A=A+c&4294967295,g=g+u&4294967295}return(h=f(i)+f(C)+f(p)+f(A)+f(g)).toLowerCase()},r.uuid4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var e=16*Math.random()|0;return("x"===r?e:3&e|8).toString(16)})},r}();exports.RandomGenerator=r;
},{}],"blFa":[function(require,module,exports) {
"use strict";function e(e,r){return void 0===r&&(r=!1),e.replace(/^([A-Z])|[\s-_](\w)/g,function(e,t,n,o){return!0===r&&0===o?t:n?n.toUpperCase():t.toLowerCase()})}function r(e){return e.replace(/(?:([a-z])([A-Z]))|(?:((?!^)[A-Z])([a-z]))/g,"$1_$3$2$4").toLowerCase()}function t(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}function n(e,r){return void 0===r&&(r=1),e.replace(/([a-z\xE0-\xFF])([A-Z\xC0\xDF])/g,"$1 $2").split(" ").reduce(function(e,t){return e+=t.substr(0,r)},"")}function o(e,r){void 0===r&&(r={});var t=r.segmentLength,n=void 0===t?4:t,o=r.separator,s=void 0===o?"__":o,u=r.termLength,a=void 0===u?2:u;return e.split(s).reduce(function(e,r){var t=r.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),o=t.length>1?a:n,s=t.map(function(e){return e.substr(0,o)}).join("");return e.push(s),e},[]).join(s)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.camelCase=e,exports.snakeCase=r,exports.titleCase=t,exports.abbreviate=n,exports.shorten=o;
},{}],"SdPr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TableColumn=void 0;var i=function(){function i(i){this.isNullable=!1,this.isGenerated=!1,this.isPrimary=!1,this.isUnique=!1,this.isArray=!1,this.length="",this.zerofill=!1,this.unsigned=!1,i&&(this.name=i.name,this.type=i.type||"",this.length=i.length||"",this.width=i.width,this.charset=i.charset,this.collation=i.collation,this.precision=i.precision,this.scale=i.scale,this.zerofill=i.zerofill||!1,this.unsigned=!!this.zerofill||(i.unsigned||!1),this.default=i.default,this.onUpdate=i.onUpdate,this.isNullable=i.isNullable||!1,this.isGenerated=i.isGenerated||!1,this.generationStrategy=i.generationStrategy,this.isPrimary=i.isPrimary||!1,this.isUnique=i.isUnique||!1,this.isArray=i.isArray||!1,this.comment=i.comment,this.enum=i.enum,this.asExpression=i.asExpression,this.generatedType=i.generatedType,this.spatialFeatureType=i.spatialFeatureType,this.srid=i.srid)}return i.prototype.clone=function(){return new i({name:this.name,type:this.type,length:this.length,width:this.width,charset:this.charset,collation:this.collation,precision:this.precision,scale:this.scale,zerofill:this.zerofill,unsigned:this.unsigned,enum:this.enum,asExpression:this.asExpression,generatedType:this.generatedType,default:this.default,onUpdate:this.onUpdate,isNullable:this.isNullable,isGenerated:this.isGenerated,generationStrategy:this.generationStrategy,isPrimary:this.isPrimary,isUnique:this.isUnique,isArray:this.isArray,comment:this.comment,spatialFeatureType:this.spatialFeatureType,srid:this.srid})},i}();exports.TableColumn=i;
},{}],"S7W/":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TableIndex=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};s.get||s.set?Object.defineProperty(t,i,s):t[i]=e[i]}return t.default=e,t}var i=function(){function t(e){this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.isUnique=!!e.isUnique,this.isSpatial=!!e.isSpatial,this.isFulltext=!!e.isFulltext,this.where=e.where?e.where:""}return t.prototype.clone=function(){return new t({name:this.name,columnNames:e.__spread(this.columnNames),isUnique:this.isUnique,isSpatial:this.isSpatial,isFulltext:this.isFulltext,where:this.where})},t.create=function(e){return new t({name:e.name,columnNames:e.columns.map(function(e){return e.databaseName}),isUnique:e.isUnique,isSpatial:e.isSpatial,isFulltext:e.isFulltext,where:e.where})},t}();exports.TableIndex=i;
},{"tslib":"c4AP"}],"0LZF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TableForeignKey=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var t=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};t.get||t.set?Object.defineProperty(r,n,t):r[n]=e[n]}return r.default=e,r}var n=function(){function r(e){this.columnNames=[],this.referencedColumnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.referencedColumnNames=e.referencedColumnNames,this.referencedTableName=e.referencedTableName,this.onDelete=e.onDelete,this.onUpdate=e.onUpdate,this.deferrable=e.deferrable}return r.prototype.clone=function(){return new r({name:this.name,columnNames:e.__spread(this.columnNames),referencedColumnNames:e.__spread(this.referencedColumnNames),referencedTableName:this.referencedTableName,onDelete:this.onDelete,onUpdate:this.onUpdate,deferrable:this.deferrable})},r.create=function(e){return new r({name:e.name,columnNames:e.columnNames,referencedColumnNames:e.referencedColumnNames,referencedTableName:e.referencedTablePath,onDelete:e.onDelete,onUpdate:e.onUpdate,deferrable:e.deferrable})},r}();exports.TableForeignKey=n;
},{"tslib":"c4AP"}],"yIl2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TableUtils=void 0;var e=function(){function e(){}return e.createTableColumnOptions=function(e,n){return{name:e.databaseName,length:e.length,width:e.width,charset:e.charset,collation:e.collation,precision:e.precision,scale:e.scale,zerofill:e.zerofill,unsigned:e.unsigned,asExpression:e.asExpression,generatedType:e.generatedType,default:n.normalizeDefault(e),onUpdate:e.onUpdate,comment:e.comment,isGenerated:e.isGenerated,generationStrategy:e.generationStrategy,isNullable:e.isNullable,type:n.normalizeType(e),isPrimary:e.isPrimary,isUnique:n.normalizeIsUnique(e),isArray:e.isArray||!1,enum:e.enum?e.enum.map(function(e){return e+""}):e.enum,spatialFeatureType:e.spatialFeatureType,srid:e.srid}},e}();exports.TableUtils=e;
},{}],"9Ztg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TableUnique=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}var n=function(){function t(e){this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames}return t.prototype.clone=function(){return new t({name:this.name,columnNames:e.__spread(this.columnNames)})},t.create=function(e){return new t({name:e.name,columnNames:e.columns.map(function(e){return e.databaseName})})},t}();exports.TableUnique=n;
},{"tslib":"c4AP"}],"oxtv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TableCheck=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var t=function(){function r(e){this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.expression=e.expression}return r.prototype.clone=function(){return new r({name:this.name,columnNames:this.columnNames?e.__spread(this.columnNames):[],expression:this.expression})},r.create=function(e){return new r({name:e.name,expression:e.expression})},r}();exports.TableCheck=t;
},{"tslib":"c4AP"}],"Lhin":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TableExclusion=void 0;var e=function(){function e(e){this.name=e.name,this.expression=e.expression}return e.prototype.clone=function(){return new e({name:this.name,expression:this.expression})},e.create=function(n){return new e({name:n.name,expression:n.expression})},e}();exports.TableExclusion=e;
},{}],"e+Cn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Table=void 0;var n=require("./TableColumn"),e=require("./TableIndex"),i=require("./TableForeignKey"),t=require("../util/TableUtils"),u=require("./TableUnique"),s=require("./TableCheck"),o=require("./TableExclusion"),r=function(){function r(t){this.columns=[],this.indices=[],this.foreignKeys=[],this.uniques=[],this.checks=[],this.exclusions=[],this.justCreated=!1,t&&(this.name=t.name,t.columns&&(this.columns=t.columns.map(function(e){return new n.TableColumn(e)})),t.indices&&(this.indices=t.indices.map(function(n){return new e.TableIndex(n)})),t.foreignKeys&&(this.foreignKeys=t.foreignKeys.map(function(n){return new i.TableForeignKey(n)})),t.uniques&&(this.uniques=t.uniques.map(function(n){return new u.TableUnique(n)})),t.checks&&(this.checks=t.checks.map(function(n){return new s.TableCheck(n)})),t.exclusions&&(this.exclusions=t.exclusions.map(function(n){return new o.TableExclusion(n)})),void 0!==t.justCreated&&(this.justCreated=t.justCreated),this.engine=t.engine)}return Object.defineProperty(r.prototype,"primaryColumns",{get:function(){return this.columns.filter(function(n){return n.isPrimary})},enumerable:!0,configurable:!0}),r.prototype.clone=function(){return new r({name:this.name,columns:this.columns.map(function(n){return n.clone()}),indices:this.indices.map(function(n){return n.clone()}),foreignKeys:this.foreignKeys.map(function(n){return n.clone()}),uniques:this.uniques.map(function(n){return n.clone()}),checks:this.checks.map(function(n){return n.clone()}),exclusions:this.exclusions.map(function(n){return n.clone()}),justCreated:this.justCreated,engine:this.engine})},r.prototype.addColumn=function(n){this.columns.push(n)},r.prototype.removeColumn=function(n){var e=this.columns.find(function(e){return e.name===n.name});e&&this.columns.splice(this.columns.indexOf(e),1)},r.prototype.addUniqueConstraint=function(n){if(this.uniques.push(n),1===n.columnNames.length){var e=this.columns.find(function(e){return e.name===n.columnNames[0]});e&&(e.isUnique=!0)}},r.prototype.removeUniqueConstraint=function(n){var e=this.uniques.find(function(e){return e.name===n.name});if(e&&(this.uniques.splice(this.uniques.indexOf(e),1),1===e.columnNames.length)){var i=this.columns.find(function(n){return n.name===e.columnNames[0]});i&&(i.isUnique=!1)}},r.prototype.addCheckConstraint=function(n){this.checks.push(n)},r.prototype.removeCheckConstraint=function(n){var e=this.checks.find(function(e){return e.name===n.name});e&&this.checks.splice(this.checks.indexOf(e),1)},r.prototype.addExclusionConstraint=function(n){this.exclusions.push(n)},r.prototype.removeExclusionConstraint=function(n){var e=this.exclusions.find(function(e){return e.name===n.name});e&&this.exclusions.splice(this.exclusions.indexOf(e),1)},r.prototype.addForeignKey=function(n){this.foreignKeys.push(n)},r.prototype.removeForeignKey=function(n){var e=this.foreignKeys.find(function(e){return e.name===n.name});e&&this.foreignKeys.splice(this.foreignKeys.indexOf(e),1)},r.prototype.addIndex=function(n,e){if(void 0===e&&(e=!1),this.indices.push(n),1===n.columnNames.length&&n.isUnique&&e){var i=this.columns.find(function(e){return e.name===n.columnNames[0]});i&&(i.isUnique=!0)}},r.prototype.removeIndex=function(n,e){void 0===e&&(e=!1);var i=this.indices.find(function(e){return e.name===n.name});if(i&&(this.indices.splice(this.indices.indexOf(i),1),1===i.columnNames.length&&i.isUnique&&e)){var t=this.columns.find(function(n){return n.name===i.columnNames[0]});t&&(t.isUnique=this.indices.some(function(n){return 1===n.columnNames.length&&n.columnNames[0]===t.name&&!!i.isUnique}))}},r.prototype.findColumnByName=function(n){return this.columns.find(function(e){return e.name===n})},r.prototype.findColumnIndices=function(n){return this.indices.filter(function(e){return!!e.columnNames.find(function(e){return e===n.name})})},r.prototype.findColumnForeignKeys=function(n){return this.foreignKeys.filter(function(e){return!!e.columnNames.find(function(e){return e===n.name})})},r.prototype.findColumnUniques=function(n){return this.uniques.filter(function(e){return!!e.columnNames.find(function(e){return e===n.name})})},r.prototype.findColumnChecks=function(n){return this.checks.filter(function(e){return!!e.columnNames.find(function(e){return e===n.name})})},r.create=function(n,i){return new r({name:i.buildTableName(n.tableName,n.schema,n.database),engine:n.engine,columns:n.columns.filter(function(n){return n}).map(function(n){return t.TableUtils.createTableColumnOptions(n,i)}),indices:n.indices.filter(function(n){return!0===n.synchronize}).map(function(n){return e.TableIndex.create(n)}),uniques:n.uniques.map(function(n){return u.TableUnique.create(n)}),checks:n.checks.map(function(n){return s.TableCheck.create(n)}),exclusions:n.exclusions.map(function(n){return o.TableExclusion.create(n)})})},r}();exports.Table=r;
},{"./TableColumn":"SdPr","./TableIndex":"S7W/","./TableForeignKey":"0LZF","../util/TableUtils":"yIl2","./TableUnique":"9Ztg","./TableCheck":"oxtv","./TableExclusion":"Lhin"}],"DPOO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DefaultNamingStrategy=void 0;var e=a(require("tslib")),r=require("../util/RandomGenerator"),t=require("../util/StringUtils"),n=require("../schema-builder/table/Table");function a(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var o=function(){function a(){}return a.prototype.tableName=function(e,r){return r||(0,t.snakeCase)(e)},a.prototype.closureJunctionTableName=function(e){return e+"_closure"},a.prototype.columnName=function(e,r,n){return n.length?(0,t.camelCase)(n.join("_"))+(r?(0,t.titleCase)(r):(0,t.titleCase)(e)):r||e},a.prototype.relationName=function(e){return e},a.prototype.primaryKeyName=function(t,a){var o=e.__spread(a);o.sort();var i=(t instanceof n.Table?t.name:t).replace(".","_")+"_"+o.join("_");return"PK_"+r.RandomGenerator.sha1(i).substr(0,27)},a.prototype.uniqueConstraintName=function(t,a){var o=e.__spread(a);o.sort();var i=(t instanceof n.Table?t.name:t).replace(".","_")+"_"+o.join("_");return"UQ_"+r.RandomGenerator.sha1(i).substr(0,27)},a.prototype.relationConstraintName=function(t,a,o){var i=e.__spread(a);i.sort();var u=(t instanceof n.Table?t.name:t).replace(".","_")+"_"+i.join("_");return o&&(u+="_"+o),"REL_"+r.RandomGenerator.sha1(u).substr(0,26)},a.prototype.defaultConstraintName=function(e,t){var a=(e instanceof n.Table?e.name:e).replace(".","_")+"_"+t;return"DF_"+r.RandomGenerator.sha1(a).substr(0,27)},a.prototype.foreignKeyName=function(t,a){var o=e.__spread(a);o.sort();var i=(t instanceof n.Table?t.name:t).replace(".","_")+"_"+o.join("_");return"FK_"+r.RandomGenerator.sha1(i).substr(0,27)},a.prototype.indexName=function(t,a,o){var i=e.__spread(a);i.sort();var u=(t instanceof n.Table?t.name:t).replace(".","_")+"_"+i.join("_");return o&&(u+="_"+o),"IDX_"+r.RandomGenerator.sha1(u).substr(0,26)},a.prototype.checkConstraintName=function(e,t){var a=(e instanceof n.Table?e.name:e).replace(".","_")+"_"+t;return"CHK_"+r.RandomGenerator.sha1(a).substr(0,26)},a.prototype.exclusionConstraintName=function(e,t){var a=(e instanceof n.Table?e.name:e).replace(".","_")+"_"+t;return"XCL_"+r.RandomGenerator.sha1(a).substr(0,26)},a.prototype.joinColumnName=function(e,r){return(0,t.camelCase)(e+"_"+r)},a.prototype.joinTableName=function(e,r,n,a){return(0,t.snakeCase)(e+"_"+n.replace(/\./gi,"_")+"_"+r)},a.prototype.joinTableColumnDuplicationPrefix=function(e,r){return e+"_"+r},a.prototype.joinTableColumnName=function(e,r,n){return(0,t.camelCase)(e+"_"+(n||r))},a.prototype.joinTableInverseColumnName=function(e,r,t){return this.joinTableColumnName(e,r,t)},a.prototype.prefixTableName=function(e,r){return e+r},a.prototype.eagerJoinRelationAlias=function(e,r){return e+"_"+r.replace(".","_")},a}();exports.DefaultNamingStrategy=o;
},{"tslib":"c4AP","../util/RandomGenerator":"TvFb","../util/StringUtils":"blFa","../schema-builder/table/Table":"e+Cn"}],"wK9M":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CannotExecuteNotConnectedError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e){var o=t.call(this)||this;return o.name="CannotExecuteNotConnectedError",Object.setPrototypeOf(o,r.prototype),o.message='Cannot execute operation on "'+e+'" connection because connection is not yet established.',o}return e.__extends(r,t),r}(Error);exports.CannotExecuteNotConnectedError=r;
},{"tslib":"c4AP"}],"I5R+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CannotConnectAlreadyConnectedError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e){var n=t.call(this)||this;return n.name="CannotConnectAlreadyConnectedError",Object.setPrototypeOf(n,r.prototype),n.message='Cannot create a "'+e+'" connection because connection to the database already established.',n}return e.__extends(r,t),r}(Error);exports.CannotConnectAlreadyConnectedError=r;
},{"tslib":"c4AP"}],"vp4m":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityMetadataNotFoundError=void 0;var t=r(require("tslib")),e=require("../index");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};o.get||o.set?Object.defineProperty(e,r,o):e[r]=t[r]}return e.default=t,e}var o=function(r){function o(t){var n,a=r.call(this)||this;return a.name="EntityMetadataNotFound",Object.setPrototypeOf(a,o.prototype),n=t instanceof e.EntitySchema?t.options.name:"function"==typeof t?t.name:t,a.message='No metadata for "'+n+'" was found.',a}return t.__extends(o,r),o}(Error);exports.EntityMetadataNotFoundError=o;
},{"tslib":"c4AP","../index":"wlNf"}],"aCGP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Migration=void 0;var t=function(){return function(t,i,e,s){this.id=t,this.timestamp=i,this.name=e,this.instance=s}}();exports.Migration=t;
},{}],"DcM6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PromiseUtils=void 0;var e=function(){function e(){}return e.create=function(e){var n=Promise.resolve(e);return n.__value__=e,n},e.extractValue=function(e){return e instanceof Promise&&e.__value__?e.__value__:e},e.runInSequence=function(e,n){var t=[];return e.reduce(function(e,r){return e.then(function(){return n(r)}).then(function(e){t.push(e)})},Promise.resolve()).then(function(){return t})},e.settle=function(e){return Promise.all(e.map(function(e){return Promise.resolve(e).then(function(e){return{state:"fulfilled",value:e}},function(e){return{state:"rejected",reason:e}})})).then(function(e){var n=e.find(function(e){return"rejected"===e.state});return n?Promise.reject(n.reason):e.map(function(e){return e.value})})},e}();exports.PromiseUtils=e;
},{}],"jWtv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConnectionIsNotSetError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e){var o=t.call(this)||this;return o.name="ConnectionIsNotSetError",Object.setPrototypeOf(o,r.prototype),o.message="Connection with "+e+" database is not established. Check connection configuration.",o}return e.__extends(r,t),r}(Error);exports.ConnectionIsNotSetError=r;
},{"tslib":"c4AP"}],"NaUg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DriverPackageNotInstalledError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(e,o){var n=r.call(this)||this;return n.name="DriverPackageNotInstalledError",Object.setPrototypeOf(n,t.prototype),n.message=e+" package has not been found installed. Try to install it: npm install "+o+" --save",n}return e.__extends(t,r),t}(Error);exports.DriverPackageNotInstalledError=t;
},{"tslib":"c4AP"}],"hdhF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DriverUtils=void 0;var e=r(require("tslib")),t=require("../util/StringUtils");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};s.get||s.set?Object.defineProperty(t,r,s):t[r]=e[r]}return t.default=e,t}var s=function(){function r(){}return r.buildDriverOptions=function(e,t){if(e.url){var r=this.parseConnectionUrl(e.url),s={type:r.type,host:r.host,username:r.username,password:r.password,port:r.port,database:r.database};return t&&t.useSid&&(s.sid=r.database),Object.assign({},e,s)}return Object.assign({},e)},r.buildColumnAlias=function(e,r,s){var n=e.maxAliasLength,i=r+"_"+s;return n&&n>0&&i.length>n?r.length>s.length?(0,t.shorten)(r)+"_"+s:r+"_"+(0,t.shorten)(s):i},r.parseConnectionUrl=function(t){var r=t.split(":")[0],s=t.indexOf("//"),n=t.substr(s+2),i=n.indexOf("/"),o=-1!==i?n.substr(0,i):n,a=-1!==i?n.substr(i+1):void 0,u=o.lastIndexOf("@"),d=o.substr(0,u),p=o.substr(u+1),l=d,b="",c=d.indexOf(":");-1!==c&&(l=d.substr(0,c),b=d.substr(c+1));var f=e.__read(p.split(":"),2),v=f[0],O=f[1];return{type:r,host:v,username:decodeURIComponent(l),password:decodeURIComponent(b),port:O?parseInt(O):void 0,database:a||void 0}},r}();exports.DriverUtils=s;
},{"tslib":"c4AP","../util/StringUtils":"blFa"}],"41H8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ObjectUtils=void 0;var r=e(require("tslib"));function e(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,t):{};n.get||n.set?Object.defineProperty(e,t,n):e[t]=r[t]}return e.default=r,e}var t=function(){function e(){}return e.assign=function(e){for(var t,n,o,a,l=[],i=1;i<arguments.length;i++)l[i-1]=arguments[i];try{for(var c=r.__values(l),f=c.next();!f.done;f=c.next()){var u=f.value;try{for(var s=r.__values(Object.getOwnPropertyNames(u)),v=s.next();!v.done;v=s.next()){var y=v.value;e[y]=u[y]}}catch(p){o={error:p}}finally{try{v&&!v.done&&(a=s.return)&&a.call(s)}finally{if(o)throw o.error}}}}catch(O){t={error:O}}finally{try{f&&!f.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}},e}();exports.ObjectUtils=t;
},{"tslib":"c4AP"}],"U3oI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QueryFailedError=void 0;var e=t(require("tslib")),r=require("../util/ObjectUtils");function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var o=function(t){function o(i,s,a){var n=t.call(this)||this;return Object.setPrototypeOf(n,o.prototype),n.message=a.toString().replace(/^error: /,"").replace(/^Error: /,"").replace(/^Request/,""),r.ObjectUtils.assign(n,e.__assign({},a,{name:"QueryFailedError",query:i,parameters:s||[]})),n}return e.__extends(o,t),o}(Error);exports.QueryFailedError=o;
},{"tslib":"c4AP","../util/ObjectUtils":"41H8"}],"CGt0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QueryRunnerAlreadyReleasedError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(){var e=r.call(this)||this;return e.name="QueryRunnerAlreadyReleasedError",Object.setPrototypeOf(e,t.prototype),e.message="Query runner already released. Cannot run queries anymore.",e}return e.__extends(t,r),t}(Error);exports.QueryRunnerAlreadyReleasedError=t;
},{"tslib":"c4AP"}],"kZCV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransactionAlreadyStartedError=void 0;var r=e(require("tslib"));function e(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,t):{};o.get||o.set?Object.defineProperty(e,t,o):e[t]=r[t]}return e.default=r,e}var t=function(e){function t(){var r=e.call(this)||this;return r.name="TransactionAlreadyStartedError",Object.setPrototypeOf(r,t.prototype),r.message="Transaction already started for the given connection, commit current transaction before starting a new one.",r}return r.__extends(t,e),t}(Error);exports.TransactionAlreadyStartedError=t;
},{"tslib":"c4AP"}],"nZEx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransactionNotStartedError=void 0;var t=r(require("tslib"));function r(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,e):{};o.get||o.set?Object.defineProperty(r,e,o):r[e]=t[e]}return r.default=t,r}var e=function(r){function e(){var t=r.call(this)||this;return t.name="TransactionNotStartedError",Object.setPrototypeOf(t,e.prototype),t.message="Transaction is not started yet, start transaction before committing or rolling it back.",t}return t.__extends(e,r),e}(Error);exports.TransactionNotStartedError=e;
},{"tslib":"c4AP"}],"CMcp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Query=void 0;var e=function(){return function(e,r){this.query=e,this.parameters=r}}();exports.Query=e;
},{}],"EeOT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SqlInMemory=void 0;var e=function(){return function(){this.upQueries=[],this.downQueries=[]}}();exports.SqlInMemory=e;
},{}],"GBOk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseQueryRunner=void 0;var e=r(require("tslib")),t=require("../driver/Query"),n=require("../driver/SqlInMemory"),i=require("../util/PromiseUtils");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};i.get||i.set?Object.defineProperty(t,n,i):t[n]=e[n]}return t.default=e,t}var o=function(){function r(){this.isReleased=!1,this.isTransactionActive=!1,this.data={},this.loadedTables=[],this.loadedViews=[],this.sqlMemoryMode=!1,this.sqlInMemory=new n.SqlInMemory}return r.prototype.getTable=function(t){return e.__awaiter(this,void 0,void 0,function(){var n;return e.__generator(this,function(e){switch(e.label){case 0:return n=this,[4,this.loadTables([t])];case 1:return n.loadedTables=e.sent(),[2,this.loadedTables.length>0?this.loadedTables[0]:void 0]}})})},r.prototype.getTables=function(t){return e.__awaiter(this,void 0,void 0,function(){var n;return e.__generator(this,function(e){switch(e.label){case 0:return n=this,[4,this.loadTables(t)];case 1:return n.loadedTables=e.sent(),[2,this.loadedTables]}})})},r.prototype.getView=function(t){return e.__awaiter(this,void 0,void 0,function(){var n;return e.__generator(this,function(e){switch(e.label){case 0:return n=this,[4,this.loadViews([t])];case 1:return n.loadedViews=e.sent(),[2,this.loadedViews.length>0?this.loadedViews[0]:void 0]}})})},r.prototype.getViews=function(t){return e.__awaiter(this,void 0,void 0,function(){var n;return e.__generator(this,function(e){switch(e.label){case 0:return n=this,[4,this.loadViews(t)];case 1:return n.loadedViews=e.sent(),[2,this.loadedViews]}})})},r.prototype.enableSqlMemory=function(){this.sqlInMemory=new n.SqlInMemory,this.sqlMemoryMode=!0},r.prototype.disableSqlMemory=function(){this.sqlInMemory=new n.SqlInMemory,this.sqlMemoryMode=!1},r.prototype.clearSqlMemory=function(){this.sqlInMemory=new n.SqlInMemory},r.prototype.getMemorySql=function(){return this.sqlInMemory},r.prototype.executeMemoryUpSql=function(){return e.__awaiter(this,void 0,void 0,function(){var t=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,i.PromiseUtils.runInSequence(this.sqlInMemory.upQueries,function(e){return t.query(e.query,e.parameters)})];case 1:return e.sent(),[2]}})})},r.prototype.executeMemoryDownSql=function(){return e.__awaiter(this,void 0,void 0,function(){var t=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,i.PromiseUtils.runInSequence(this.sqlInMemory.downQueries.reverse(),function(e){return t.query(e.query,e.parameters)})];case 1:return e.sent(),[2]}})})},r.prototype.getCachedView=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,i;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.loadedViews.find(function(e){return e.name===t}))?[2,n]:[4,this.loadViews([t])];case 1:if((i=e.sent()).length>0)return this.loadedViews.push(i[0]),[2,i[0]];throw new Error('View "'+t+'" does not exist.')}})})},r.prototype.getCachedTable=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,i;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.loadedTables.find(function(e){return e.name===t}))?[2,n]:[4,this.loadTables([t])];case 1:if((i=e.sent()).length>0)return this.loadedTables.push(i[0]),[2,i[0]];throw new Error('Table "'+t+'" does not exist.')}})})},r.prototype.replaceCachedTable=function(e,t){var n=this.loadedTables.find(function(t){return t.name===e.name});n&&(n.name=t.name,n.columns=t.columns,n.indices=t.indices,n.foreignKeys=t.foreignKeys,n.uniques=t.uniques,n.checks=t.checks,n.justCreated=t.justCreated,n.engine=t.engine)},r.prototype.getTypeormMetadataTableName=function(){var e=this.connection.driver.options;return this.connection.driver.buildTableName("typeorm_metadata",e.schema,e.database)},r.prototype.isColumnChanged=function(e,t,n,i){return e.charset!==t.charset||e.collation!==t.collation||e.precision!==t.precision||e.scale!==t.scale||e.width!==t.width||e.zerofill!==t.zerofill||e.unsigned!==t.unsigned||e.asExpression!==t.asExpression||n&&e.default!==t.default||e.onUpdate!==t.onUpdate||e.isNullable!==t.isNullable||i&&e.comment!==t.comment||e.enum!==t.enum},r.prototype.isDefaultColumnLength=function(e,t,n){if(this.connection.hasMetadata(e.name)){var i=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(i&&i.length)return!1}return!!(this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].length)&&this.connection.driver.dataTypeDefaults[t.type].length.toString()===n.toString()},r.prototype.isDefaultColumnWidth=function(e,t,n){if(this.connection.hasMetadata(e.name)){var i=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(i&&i.width)return!1}return!!(this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].width)&&this.connection.driver.dataTypeDefaults[t.type].width===n},r.prototype.isDefaultColumnPrecision=function(e,t,n){if(this.connection.hasMetadata(e.name)){var i=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(i&&null!==i.precision&&void 0!==i.precision)return!1}return!(!this.connection.driver.dataTypeDefaults||!this.connection.driver.dataTypeDefaults[t.type]||null===this.connection.driver.dataTypeDefaults[t.type].precision||void 0===this.connection.driver.dataTypeDefaults[t.type].precision)&&this.connection.driver.dataTypeDefaults[t.type].precision===n},r.prototype.isDefaultColumnScale=function(e,t,n){if(this.connection.hasMetadata(e.name)){var i=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(i&&null!==i.scale&&void 0!==i.scale)return!1}return!(!this.connection.driver.dataTypeDefaults||!this.connection.driver.dataTypeDefaults[t.type]||null===this.connection.driver.dataTypeDefaults[t.type].scale||void 0===this.connection.driver.dataTypeDefaults[t.type].scale)&&this.connection.driver.dataTypeDefaults[t.type].scale===n},r.prototype.executeQueries=function(n,r){return e.__awaiter(this,void 0,void 0,function(){var o,a,s=this;return e.__generator(this,function(u){switch(u.label){case 0:return n instanceof t.Query&&(n=[n]),r instanceof t.Query&&(r=[r]),(o=this.sqlInMemory.upQueries).push.apply(o,e.__spread(n)),(a=this.sqlInMemory.downQueries).push.apply(a,e.__spread(r)),!0===this.sqlMemoryMode?[2,Promise.resolve()]:[4,i.PromiseUtils.runInSequence(n,function(e){return s.query(e.query,e.parameters)})];case 1:return u.sent(),[2]}})})},r}();exports.BaseQueryRunner=o;
},{"tslib":"c4AP","../driver/Query":"CMcp","../driver/SqlInMemory":"EeOT","../util/PromiseUtils":"DcM6"}],"fSdu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.View=void 0;var e=function(){function e(e){e&&(this.name=e.name,this.expression=e.expression)}return e.prototype.clone=function(){return new e({name:this.name,expression:this.expression})},e.create=function(n,s){return new e({name:s.buildTableName(n.tableName,n.schema,n.database),expression:n.expression})},e}();exports.View=e;
},{}],"wiLV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Broadcaster=void 0;var e=function(){function e(e){this.queryRunner=e}return e.prototype.broadcastBeforeInsertEvent=function(e,n,r){var t=this;r&&n.beforeInsertListeners.length&&n.beforeInsertListeners.forEach(function(n){if(n.isAllowed(r)){var t=n.execute(r);t instanceof Promise&&e.promises.push(t),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(function(o){if(t.isAllowedSubscriber(o,n.target)&&o.beforeInsert){var s=o.beforeInsert({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager,entity:r,metadata:n});s instanceof Promise&&e.promises.push(s),e.count++}})},e.prototype.broadcastBeforeUpdateEvent=function(e,n,r,t,o,s){var i=this;r&&n.beforeUpdateListeners.length&&n.beforeUpdateListeners.forEach(function(n){if(n.isAllowed(r)){var t=n.execute(r);t instanceof Promise&&e.promises.push(t),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(function(a){if(i.isAllowedSubscriber(a,n.target)&&a.beforeUpdate){var u=a.beforeUpdate({connection:i.queryRunner.connection,queryRunner:i.queryRunner,manager:i.queryRunner.manager,entity:r,metadata:n,databaseEntity:t,updatedColumns:o||[],updatedRelations:s||[]});u instanceof Promise&&e.promises.push(u),e.count++}})},e.prototype.broadcastBeforeRemoveEvent=function(e,n,r,t){var o=this;r&&n.beforeRemoveListeners.length&&n.beforeRemoveListeners.forEach(function(n){if(n.isAllowed(r)){var t=n.execute(r);t instanceof Promise&&e.promises.push(t),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(function(s){if(o.isAllowedSubscriber(s,n.target)&&s.beforeRemove){var i=s.beforeRemove({connection:o.queryRunner.connection,queryRunner:o.queryRunner,manager:o.queryRunner.manager,entity:r,metadata:n,databaseEntity:t,entityId:n.getEntityIdMixedMap(t)});i instanceof Promise&&e.promises.push(i),e.count++}})},e.prototype.broadcastAfterInsertEvent=function(e,n,r){var t=this;r&&n.afterInsertListeners.length&&n.afterInsertListeners.forEach(function(n){if(n.isAllowed(r)){var t=n.execute(r);t instanceof Promise&&e.promises.push(t),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(function(o){if(t.isAllowedSubscriber(o,n.target)&&o.afterInsert){var s=o.afterInsert({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager,entity:r,metadata:n});s instanceof Promise&&e.promises.push(s),e.count++}})},e.prototype.broadcastAfterUpdateEvent=function(e,n,r,t,o,s){var i=this;r&&n.afterUpdateListeners.length&&n.afterUpdateListeners.forEach(function(n){if(n.isAllowed(r)){var t=n.execute(r);t instanceof Promise&&e.promises.push(t),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(function(a){if(i.isAllowedSubscriber(a,n.target)&&a.afterUpdate){var u=a.afterUpdate({connection:i.queryRunner.connection,queryRunner:i.queryRunner,manager:i.queryRunner.manager,entity:r,metadata:n,databaseEntity:t,updatedColumns:o||[],updatedRelations:s||[]});u instanceof Promise&&e.promises.push(u),e.count++}})},e.prototype.broadcastAfterRemoveEvent=function(e,n,r,t){var o=this;r&&n.afterRemoveListeners.length&&n.afterRemoveListeners.forEach(function(n){if(n.isAllowed(r)){var t=n.execute(r);t instanceof Promise&&e.promises.push(t),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(function(s){if(o.isAllowedSubscriber(s,n.target)&&s.afterRemove){var i=s.afterRemove({connection:o.queryRunner.connection,queryRunner:o.queryRunner,manager:o.queryRunner.manager,entity:r,metadata:n,databaseEntity:t,entityId:n.getEntityIdMixedMap(t)});i instanceof Promise&&e.promises.push(i),e.count++}})},e.prototype.broadcastLoadEventsForAll=function(e,n,r){var t=this;r.forEach(function(r){r instanceof Promise||(n.relations.length&&n.relations.forEach(function(n){if(!n.isLazy||r.hasOwnProperty(n.propertyName)){var o=n.getEntityValue(r);o instanceof Object&&t.broadcastLoadEventsForAll(e,n.inverseEntityMetadata,o instanceof Array?o:[o])}}),n.afterLoadListeners.length&&n.afterLoadListeners.forEach(function(n){if(n.isAllowed(r)){var t=n.execute(r);t instanceof Promise&&e.promises.push(t),e.count++}}),t.queryRunner.connection.subscribers.length&&t.queryRunner.connection.subscribers.forEach(function(o){if(t.isAllowedSubscriber(o,n.target)&&o.afterLoad){var s=o.afterLoad(r,{connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager,entity:r,metadata:n});s instanceof Promise&&e.promises.push(s),e.count++}}))})},e.prototype.isAllowedSubscriber=function(e,n){return!e.listenTo||!e.listenTo()||e.listenTo()===Object||e.listenTo()===n||e.listenTo().isPrototypeOf(n)},e}();exports.Broadcaster=e;
},{}],"cfBw":[function(require,module,exports) {
"use strict";exports.byteLength=u,exports.toByteArray=i,exports.fromByteArray=d;for(var r=[],t=[],e="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)r[o]=n[o],t[n.charCodeAt(o)]=o;function h(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=r.indexOf("=");return-1===e&&(e=t),[e,e===t?0:4-e%4]}function u(r){var t=h(r),e=t[0],n=t[1];return 3*(e+n)/4-n}function c(r,t,e){return 3*(t+e)/4-e}function i(r){for(var n,o=h(r),a=o[0],u=o[1],i=new e(c(r,a,u)),f=0,A=u>0?a-4:a,d=0;d<A;d+=4)n=t[r.charCodeAt(d)]<<18|t[r.charCodeAt(d+1)]<<12|t[r.charCodeAt(d+2)]<<6|t[r.charCodeAt(d+3)],i[f++]=n>>16&255,i[f++]=n>>8&255,i[f++]=255&n;return 2===u&&(n=t[r.charCodeAt(d)]<<2|t[r.charCodeAt(d+1)]>>4,i[f++]=255&n),1===u&&(n=t[r.charCodeAt(d)]<<10|t[r.charCodeAt(d+1)]<<4|t[r.charCodeAt(d+2)]>>2,i[f++]=n>>8&255,i[f++]=255&n),i}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function A(r,t,e){for(var n,o=[],a=t;a<e;a+=3)n=(r[a]<<16&16711680)+(r[a+1]<<8&65280)+(255&r[a+2]),o.push(f(n));return o.join("")}function d(t){for(var e,n=t.length,o=n%3,a=[],h=0,u=n-o;h<u;h+=16383)a.push(A(t,h,h+16383>u?u:h+16383));return 1===o?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),a.join("")}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63;
},{}],"hMTg":[function(require,module,exports) {
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};
},{}],"fbtd":[function(require,module,exports) {
var r={}.toString;module.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)};
},{}],"iHVs":[function(require,module,exports) {

var global = arguments[3];
var t=arguments[3],r=require("base64-js"),e=require("ieee754"),n=require("isarray");function i(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(r){return!1}}function o(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,r){if(o()<r)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r)).__proto__=f.prototype:(null===t&&(t=new f(r)),t.length=r),t}function f(t,r,e){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,r,e)}function s(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?g(t,r,e,n):"string"==typeof r?l(t,r,e):y(t,r)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function a(t,r,e,n){return h(r),r<=0?u(t,r):void 0!==e?"string"==typeof n?u(t,r).fill(e,n):u(t,r).fill(e):u(t,r)}function c(t,r){if(h(r),t=u(t,r<0?0:0|w(r)),!f.TYPED_ARRAY_SUPPORT)for(var e=0;e<r;++e)t[e]=0;return t}function l(t,r,e){if("string"==typeof e&&""!==e||(e="utf8"),!f.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(r,e),i=(t=u(t,n)).write(r,e);return i!==n&&(t=t.slice(0,i)),t}function p(t,r){var e=r.length<0?0:0|w(r.length);t=u(t,e);for(var n=0;n<e;n+=1)t[n]=255&r[n];return t}function g(t,r,e,n){if(r.byteLength,e<0||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");return r=void 0===e&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n),f.TYPED_ARRAY_SUPPORT?(t=r).__proto__=f.prototype:t=p(t,r),t}function y(t,r){if(f.isBuffer(r)){var e=0|w(r.length);return 0===(t=u(t,e)).length?t:(r.copy(t,0,0,e),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||W(r.length)?u(t,0):p(t,r);if("Buffer"===r.type&&n(r.data))return p(t,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function w(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function d(t){return+t!=t&&(t=0),f.alloc(+t)}function v(t,r){if(f.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return K(t).length;default:if(n)return $(t).length;r=(""+r).toLowerCase(),n=!0}}function E(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return x(this,r,e);case"utf8":case"utf-8":return Y(this,r,e);case"ascii":return L(this,r,e);case"latin1":case"binary":return D(this,r,e);case"base64":return S(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function R(t,r,e,n,i){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1}else if(e<0){if(!i)return-1;e=0}if("string"==typeof r&&(r=f.from(r,n)),f.isBuffer(r))return 0===r.length?-1:_(t,r,e,n,i);if("number"==typeof r)return r&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):_(t,[r],e,n,i);throw new TypeError("val must be string, number or Buffer")}function _(t,r,e,n,i){var o,u=1,f=t.length,s=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;u=2,f/=2,s/=2,e/=2}function h(t,r){return 1===u?t[r]:t.readUInt16BE(r*u)}if(i){var a=-1;for(o=e;o<f;o++)if(h(t,o)===h(r,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===s)return a*u}else-1!==a&&(o-=o-a),a=-1}else for(e+s>f&&(e=f-s),o=e;o>=0;o--){for(var c=!0,l=0;l<s;l++)if(h(t,o+l)!==h(r,l)){c=!1;break}if(c)return o}return-1}function A(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var o=r.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var f=parseInt(r.substr(2*u,2),16);if(isNaN(f))return u;t[e+u]=f}return u}function m(t,r,e,n){return Q($(r,t.length-e),t,e,n)}function P(t,r,e,n){return Q(G(r),t,e,n)}function T(t,r,e,n){return P(t,r,e,n)}function B(t,r,e,n){return Q(K(r),t,e,n)}function U(t,r,e,n){return Q(H(r,t.length-e),t,e,n)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function Y(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;i<e;){var o,u,f,s,h=t[i],a=null,c=h>239?4:h>223?3:h>191?2:1;if(i+c<=e)switch(c){case 1:h<128&&(a=h);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&h)<<6|63&o)>127&&(a=s);break;case 3:o=t[i+1],u=t[i+2],128==(192&o)&&128==(192&u)&&(s=(15&h)<<12|(63&o)<<6|63&u)>2047&&(s<55296||s>57343)&&(a=s);break;case 4:o=t[i+1],u=t[i+2],f=t[i+3],128==(192&o)&&128==(192&u)&&128==(192&f)&&(s=(15&h)<<18|(63&o)<<12|(63&u)<<6|63&f)>65535&&s<1114112&&(a=s)}null===a?(a=65533,c=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=c}return O(n)}exports.Buffer=f,exports.SlowBuffer=d,exports.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:i(),exports.kMaxLength=o(),f.poolSize=8192,f._augment=function(t){return t.__proto__=f.prototype,t},f.from=function(t,r,e){return s(null,t,r,e)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(t,r,e){return a(null,t,r,e)},f.allocUnsafe=function(t){return c(null,t)},f.allocUnsafeSlow=function(t){return c(null,t)},f.isBuffer=function(t){return!(null==t||!t._isBuffer)},f.compare=function(t,r){if(!f.isBuffer(t)||!f.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,i=0,o=Math.min(e,n);i<o;++i)if(t[i]!==r[i]){e=t[i],n=r[i];break}return e<n?-1:n<e?1:0},f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(t,r){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return f.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var i=f.allocUnsafe(r),o=0;for(e=0;e<t.length;++e){var u=t[e];if(!f.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,o),o+=u.length}return i},f.byteLength=v,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)b(this,r,r+1);return this},f.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)b(this,r,r+3),b(this,r+1,r+2);return this},f.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)b(this,r,r+7),b(this,r+1,r+6),b(this,r+2,r+5),b(this,r+3,r+4);return this},f.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Y(this,0,t):E.apply(this,arguments)},f.prototype.equals=function(t){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===f.compare(this,t)},f.prototype.inspect=function(){var t="",r=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},f.prototype.compare=function(t,r,e,n,i){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),r<0||e>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&r>=e)return 0;if(n>=i)return-1;if(r>=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),u=(e>>>=0)-(r>>>=0),s=Math.min(o,u),h=this.slice(n,i),a=t.slice(r,e),c=0;c<s;++c)if(h[c]!==a[c]){o=h[c],u=a[c];break}return o<u?-1:u<o?1:0},f.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},f.prototype.indexOf=function(t,r,e){return R(this,t,r,e,!0)},f.prototype.lastIndexOf=function(t,r,e){return R(this,t,r,e,!1)},f.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(e)?(e|=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return A(this,t,r,e);case"utf8":case"utf-8":return m(this,t,r,e);case"ascii":return P(this,t,r,e);case"latin1":case"binary":return T(this,t,r,e);case"base64":return B(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function O(t){var r=t.length;if(r<=I)return String.fromCharCode.apply(String,t);for(var e="",n=0;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=I));return e}function L(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(127&t[i]);return n}function D(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n}function x(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;++o)i+=Z(t[o]);return i}function C(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function M(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function k(t,r,e,n,i,o){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<o)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function N(t,r,e,n){r<0&&(r=65535+r+1);for(var i=0,o=Math.min(t.length-e,2);i<o;++i)t[e+i]=(r&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function z(t,r,e,n){r<0&&(r=4294967295+r+1);for(var i=0,o=Math.min(t.length-e,4);i<o;++i)t[e+i]=r>>>8*(n?i:3-i)&255}function F(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function j(t,r,n,i,o){return o||F(t,r,n,4,3.4028234663852886e38,-3.4028234663852886e38),e.write(t,r,n,i,23,4),n+4}function q(t,r,n,i,o){return o||F(t,r,n,8,1.7976931348623157e308,-1.7976931348623157e308),e.write(t,r,n,i,52,8),n+8}f.prototype.slice=function(t,r){var e,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t),f.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,r)).__proto__=f.prototype;else{var i=r-t;e=new f(i,void 0);for(var o=0;o<i;++o)e[o]=this[o+t]}return e},f.prototype.readUIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n},f.prototype.readUIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n},f.prototype.readUInt8=function(t,r){return r||M(t,1,this.length),this[t]},f.prototype.readUInt16LE=function(t,r){return r||M(t,2,this.length),this[t]|this[t+1]<<8},f.prototype.readUInt16BE=function(t,r){return r||M(t,2,this.length),this[t]<<8|this[t+1]},f.prototype.readUInt32LE=function(t,r){return r||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},f.prototype.readUInt32BE=function(t,r){return r||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},f.prototype.readIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*r)),n},f.prototype.readIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*r)),o},f.prototype.readInt8=function(t,r){return r||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},f.prototype.readInt16LE=function(t,r){r||M(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt16BE=function(t,r){r||M(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt32LE=function(t,r){return r||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},f.prototype.readInt32BE=function(t,r){return r||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},f.prototype.readFloatLE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!0,23,4)},f.prototype.readFloatBE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!1,23,4)},f.prototype.readDoubleLE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!0,52,8)},f.prototype.readDoubleBE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!1,52,8)},f.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=1,o=0;for(this[r]=255&t;++o<e&&(i*=256);)this[r+o]=t/i&255;return r+e},f.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=e-1,o=1;for(this[r+i]=255&t;--i>=0&&(o*=256);)this[r+i]=t/o&255;return r+e},f.prototype.writeUInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,255,0),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},f.prototype.writeUInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeUInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeUInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):z(this,t,r,!0),r+4},f.prototype.writeUInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=0,u=1,f=0;for(this[r]=255&t;++o<e&&(u*=256);)t<0&&0===f&&0!==this[r+o-1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=e-1,u=1,f=0;for(this[r+o]=255&t;--o>=0&&(u*=256);)t<0&&0===f&&0!==this[r+o+1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,127,-128),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1},f.prototype.writeInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):z(this,t,r,!0),r+4},f.prototype.writeInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeFloatLE=function(t,r,e){return j(this,t,r,!0,e)},f.prototype.writeFloatBE=function(t,r,e){return j(this,t,r,!1,e)},f.prototype.writeDoubleLE=function(t,r,e){return q(this,t,r,!0,e)},f.prototype.writeDoubleBE=function(t,r,e){return q(this,t,r,!1,e)},f.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var i,o=n-e;if(this===t&&e<r&&r<n)for(i=o-1;i>=0;--i)t[i+r]=this[i+e];else if(o<1e3||!f.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+r]=this[i+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),r);return o},f.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;var o;if(r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(o=r;o<e;++o)this[o]=t;else{var u=f.isBuffer(t)?t:$(new f(t,n).toString()),s=u.length;for(o=0;o<e-r;++o)this[o+r]=u[o%s]}return this};var V=/[^+\/0-9A-Za-z-_]/g;function X(t){if((t=J(t).replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function J(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Z(t){return t<16?"0"+t.toString(16):t.toString(16)}function $(t,r){var e;r=r||1/0;for(var n=t.length,i=null,o=[],u=0;u<n;++u){if((e=t.charCodeAt(u))>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=65536+(i-55296<<10|e-56320)}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e)}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function G(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}function H(t,r){for(var e,n,i,o=[],u=0;u<t.length&&!((r-=2)<0);++u)n=(e=t.charCodeAt(u))>>8,i=e%256,o.push(i),o.push(n);return o}function K(t){return r.toByteArray(X(t))}function Q(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i}function W(t){return t!=t}
},{"base64-js":"cfBw","ieee754":"hMTg","isarray":"fbtd","buffer":"iHVs"}],"R//v":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports.OrmUtils=void 0;var t=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var n=function(){function r(){}return r.chunk=function(e,t){return Array.from(Array(Math.ceil(e.length/t)),function(r,n){return e.slice(n*t,n*t+t)})},r.splitClassesAndStrings=function(e){return[e.filter(function(e){return"string"!=typeof e}),e.filter(function(e){return"string"==typeof e})]},r.groupBy=function(e,t){return e.reduce(function(e,r){var n=t(r),i=e.find(function(e){return e.id===n});return i||(i={id:n,items:[]},e.push(i)),i.items.push(r),e},[])},r.uniq=function(e,t){return e.reduce(function(e,r){var n=!1;if(t instanceof Function){var i=t(r);n=!!e.find(function(e){return t(e)===i})}else n="string"==typeof t?!!e.find(function(e){return e[t]===r[t]}):-1!==e.indexOf(r);return n||e.push(r),e},[])},r.isObject=function(e){return e&&"object"==typeof e&&!Array.isArray(e)},r.mergeDeep=function(r){for(var n,i,o=[],f=1;f<arguments.length;f++)o[f-1]=arguments[f];if(!o.length)return r;var u=o.shift();if(this.isObject(r)&&this.isObject(u))for(var c in u){var s=c;u[c]instanceof Promise||(!this.isObject(u[s])||u[s]instanceof Map||u[s]instanceof Set||u[s]instanceof Date||u[s]instanceof e?Object.assign(r,((i={})[c]=u[s],i)):(r[c]||Object.assign(r,((n={})[c]=Object.create(Object.getPrototypeOf(u[s])),n)),this.mergeDeep(r[c],u[s])))}return this.mergeDeep.apply(this,t.__spread([r],o))},r.deepCompare=function(){for(var e,t,r,n,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];if(arguments.length<1)return!0;for(e=1,t=arguments.length;e<t;e++)if(r=[],n=[],!this.compare2Objects(r,n,arguments[0],arguments[e]))return!1;return!0},r.toBoolean=function(e){return"boolean"==typeof e?e:"string"==typeof e?"true"===e||"1"===e:"number"==typeof e&&e>0},r.zipObject=function(e,t){return e.reduce(function(e,r,n){return e[r]=t[n],e},{})},r.isArraysEqual=function(e,t){return e.length===t.length&&e.every(function(e){return-1!==t.indexOf(e)})},r.compare2Objects=function(e,t,r,n){var i;if(isNaN(r)&&isNaN(n)&&"number"==typeof r&&"number"==typeof n)return!0;if(r===n)return!0;if(null===r||null===n||void 0===r||void 0===n)return!1;if(("function"==typeof r.equals||r.equals instanceof Function)&&r.equals(n))return!0;if("function"==typeof r&&"function"==typeof n||r instanceof Date&&n instanceof Date||r instanceof RegExp&&n instanceof RegExp||r instanceof String&&n instanceof String||r instanceof Number&&n instanceof Number)return r.toString()===n.toString();if(!(r instanceof Object&&n instanceof Object))return!1;if(r.isPrototypeOf(n)||n.isPrototypeOf(r))return!1;if(r.constructor!==n.constructor)return!1;if(r.prototype!==n.prototype)return!1;if(e.indexOf(r)>-1||t.indexOf(n)>-1)return!1;for(i in n){if(n.hasOwnProperty(i)!==r.hasOwnProperty(i))return!1;if(typeof n[i]!=typeof r[i])return!1}for(i in r){if(n.hasOwnProperty(i)!==r.hasOwnProperty(i))return!1;if(typeof n[i]!=typeof r[i])return!1;switch(typeof r[i]){case"object":case"function":if(e.push(r),t.push(n),!this.compare2Objects(e,t,r[i],n[i]))return!1;e.pop(),t.pop();break;default:if(r[i]!==n[i])return!1}}return!0},r}();exports.OrmUtils=n;
},{"tslib":"c4AP","buffer":"iHVs"}],"FBTY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MssqlParameter=void 0;var e=function(){return function(e,t){for(var r=[],s=2;s<arguments.length;s++)r[s-2]=arguments[s];this.value=e,this.type=t,this.params=[],this.params=r||[]}}();exports.MssqlParameter=e;
},{}],"c5/o":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SqlServerQueryRunner=void 0;var e=T(require("tslib")),n=require("../../error/QueryFailedError"),t=require("../../error/QueryRunnerAlreadyReleasedError"),r=require("../../error/TransactionAlreadyStartedError"),i=require("../../error/TransactionNotStartedError"),a=require("../../index"),s=require("../../query-runner/BaseQueryRunner"),o=require("../../schema-builder/table/Table"),u=require("../../schema-builder/table/TableCheck"),c=require("../../schema-builder/table/TableColumn"),h=require("../../schema-builder/table/TableForeignKey"),l=require("../../schema-builder/table/TableIndex"),m=require("../../schema-builder/table/TableUnique"),p=require("../../schema-builder/view/View"),E=require("../../subscriber/Broadcaster"),d=require("../../util/OrmUtils"),A=require("../Query"),f=require("./MssqlParameter");function T(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};r.get||r.set?Object.defineProperty(n,t,r):n[t]=e[t]}return n.default=e,n}var N=function(s){function T(e,n){void 0===n&&(n="master");var t=s.call(this)||this;return t.queryResponsibilityChain=[],t.driver=e,t.connection=e.connection,t.broadcaster=new E.Broadcaster(t),t.mode=n,t}return e.__extends(T,s),T.prototype.connect=function(){return Promise.resolve()},T.prototype.release=function(){return this.isReleased=!0,Promise.resolve()},T.prototype.startTransaction=function(n){return e.__awaiter(this,void 0,void 0,function(){var i=this;return e.__generator(this,function(a){if(this.isReleased)throw new t.QueryRunnerAlreadyReleasedError;if(this.isTransactionActive)throw new r.TransactionAlreadyStartedError;return[2,new Promise(function(t,r){return e.__awaiter(i,void 0,void 0,function(){var i,a,s=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.isTransactionActive=!0,[4,"slave"===this.mode?this.driver.obtainSlaveConnection():this.driver.obtainMasterConnection()];case 1:return i=e.sent(),this.databaseConnection=i.transaction(),a=function(e){if(e)return s.isTransactionActive=!1,r(e);t(),s.connection.logger.logQuery("BEGIN TRANSACTION"),n&&s.connection.logger.logQuery("SET TRANSACTION ISOLATION LEVEL "+n)},n?this.databaseConnection.begin(this.convertIsolationLevel(n),a):this.databaseConnection.begin(a),[2]}})})})]})})},T.prototype.commitTransaction=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(e){if(this.isReleased)throw new t.QueryRunnerAlreadyReleasedError;if(!this.isTransactionActive)throw new i.TransactionNotStartedError;return[2,new Promise(function(e,t){n.databaseConnection.commit(function(r){if(r)return t(r);n.isTransactionActive=!1,n.databaseConnection=null,e(),n.connection.logger.logQuery("COMMIT")})})]})})},T.prototype.rollbackTransaction=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(e){if(this.isReleased)throw new t.QueryRunnerAlreadyReleasedError;if(!this.isTransactionActive)throw new i.TransactionNotStartedError;return[2,new Promise(function(e,t){n.databaseConnection.rollback(function(r){if(r)return t(r);n.isTransactionActive=!1,n.databaseConnection=null,e(),n.connection.logger.logQuery("ROLLBACK")})})]})})},T.prototype.query=function(r,i){return e.__awaiter(this,void 0,void 0,function(){var a,s,o,u,c=this;return e.__generator(this,function(h){switch(h.label){case 0:if(this.isReleased)throw new t.QueryRunnerAlreadyReleasedError;return s=new Promise(function(e){return a=e}),this.queryResponsibilityChain.length?(o=e.__spread(this.queryResponsibilityChain),this.queryResponsibilityChain.push(s),[4,Promise.all(o)]):[3,2];case 1:h.sent(),h.label=2;case 2:return u=new Promise(function(t,o){return e.__awaiter(c,void 0,void 0,function(){var c,h,l,m,p=this;return e.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this.driver.connection.logger.logQuery(r,i,this),[4,"slave"===this.mode?this.driver.obtainSlaveConnection():this.driver.obtainMasterConnection()];case 1:return c=e.sent(),h=new this.driver.mssql.Request(this.isTransactionActive?this.databaseConnection:c),i&&i.length&&i.forEach(function(e,n){if(e instanceof f.MssqlParameter){var t=p.mssqlParameterToNativeParameter(e);t?h.input(n,t,e.value):h.input(n,e.value)}else h.input(n,e)}),l=+new Date,h.query(r,function(e,c){var h=p.driver.connection.options.maxQueryExecutionTime,m=+new Date-l;h&&m>h&&p.driver.connection.logger.logQuerySlow(m,r,i,p);var E=function(){-1!==d&&p.queryResponsibilityChain.splice(d,1),-1!==A&&p.queryResponsibilityChain.splice(A,1),a()},d=p.queryResponsibilityChain.indexOf(u),A=p.queryResponsibilityChain.indexOf(s);if(e)return p.driver.connection.logger.logQueryError(e,r,i,p),E(),o(new n.QueryFailedError(r,i,e));switch(r.slice(0,r.indexOf(" "))){case"DELETE":t([c.recordset,c.rowsAffected[0]]);break;default:t(c.recordset)}E()}),[3,3];case 2:return m=e.sent(),o(m),[3,3];case 3:return[2]}})})}),this.queryResponsibilityChain.push(u),[2,u]}})})},T.prototype.stream=function(n,r,i,a){return e.__awaiter(this,void 0,void 0,function(){var s,o,u,c,h=this;return e.__generator(this,function(l){switch(l.label){case 0:if(this.isReleased)throw new t.QueryRunnerAlreadyReleasedError;return o=new Promise(function(e){return s=e}),this.queryResponsibilityChain.length?(u=e.__spread(this.queryResponsibilityChain),this.queryResponsibilityChain.push(o),[4,Promise.all(u)]):[3,2];case 1:l.sent(),l.label=2;case 2:return c=new Promise(function(t,u){return e.__awaiter(h,void 0,void 0,function(){var h,l,m=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.driver.connection.logger.logQuery(n,r,this),[4,"slave"===this.mode?this.driver.obtainSlaveConnection():this.driver.obtainMasterConnection()];case 1:return h=e.sent(),(l=new this.driver.mssql.Request(this.isTransactionActive?this.databaseConnection:h)).stream=!0,r&&r.length&&r.forEach(function(e,n){e instanceof f.MssqlParameter?l.input(n,m.mssqlParameterToNativeParameter(e),e.value):l.input(n,e)}),l.query(n,function(e,i){var a=function(){-1!==h&&m.queryResponsibilityChain.splice(h,1),-1!==l&&m.queryResponsibilityChain.splice(l,1),s()},h=m.queryResponsibilityChain.indexOf(c),l=m.queryResponsibilityChain.indexOf(o);if(e)return m.driver.connection.logger.logQueryError(e,n,r,m),a(),u(e);t(i.recordset),a()}),i&&l.on("done",i),a&&l.on("error",a),t(l),[2]}})})}),this.isTransactionActive&&this.queryResponsibilityChain.push(c),[2,c]}})})},T.prototype.getDatabases=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.query("EXEC sp_databases")];case 1:return[2,e.sent().map(function(e){return e.DATABASE_NAME})]}})})},T.prototype.getSchemas=function(n){return e.__awaiter(this,void 0,void 0,function(){var t;return e.__generator(this,function(e){switch(e.label){case 0:return t=n?'SELECT * FROM "'+n+'"."sys"."schema"':'SELECT * FROM "sys"."schemas"',[4,this.query(t)];case 1:return[2,e.sent().map(function(e){return e.name})]}})})},T.prototype.hasDatabase=function(n){return e.__awaiter(this,void 0,void 0,function(){var t;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.query("SELECT DB_ID('"+n+'\') as "db_id"')];case 1:return t=e.sent(),[2,!!t[0].db_id]}})})},T.prototype.hasSchema=function(n){return e.__awaiter(this,void 0,void 0,function(){var t;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.query("SELECT SCHEMA_ID('"+n+'\') as "schema_id"')];case 1:return t=e.sent(),[2,!!t[0].schema_id]}})})},T.prototype.hasTable=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,i;return e.__generator(this,function(e){switch(e.label){case 0:return t=this.parseTableName(n),r="SCHEMA_NAME()"===t.schema?t.schema:"'"+t.schema+"'",i='SELECT * FROM "'+t.database+'"."INFORMATION_SCHEMA"."TABLES" WHERE "TABLE_NAME" = \''+t.name+'\' AND "TABLE_SCHEMA" = '+r,[4,this.query(i)];case 1:return[2,!!e.sent().length]}})})},T.prototype.hasColumn=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a;return e.__generator(this,function(e){switch(e.label){case 0:return r=this.parseTableName(n),i="SCHEMA_NAME()"===r.schema?r.schema:"'"+r.schema+"'",a='SELECT * FROM "'+r.database+'"."INFORMATION_SCHEMA"."TABLES" WHERE "TABLE_NAME" = \''+r.name+"' AND \"COLUMN_NAME\" = '"+t+'\' AND "TABLE_SCHEMA" = '+i,[4,this.query(a)];case 1:return[2,!!e.sent().length]}})})},T.prototype.createDatabase=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i;return e.__generator(this,function(e){switch(e.label){case 0:return r=t?"IF DB_ID('"+n+"') IS NULL CREATE DATABASE \""+n+'"':'CREATE DATABASE "'+n+'"',i='DROP DATABASE "'+n+'"',[4,this.executeQueries(new A.Query(r),new A.Query(i))];case 1:return e.sent(),[2]}})})},T.prototype.dropDatabase=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i;return e.__generator(this,function(e){switch(e.label){case 0:return r=t?"IF DB_ID('"+n+"') IS NOT NULL DROP DATABASE \""+n+'"':'DROP DATABASE "'+n+'"',i='CREATE DATABASE "'+n+'"',[4,this.executeQueries(new A.Query(r),new A.Query(i))];case 1:return e.sent(),[2]}})})},T.prototype.createSchema=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s,o,u;return e.__generator(this,function(e){switch(e.label){case 0:return r=[],i=[],-1!==n.indexOf(".")?[3,1]:(u=t?"IF SCHEMA_ID('"+n+"') IS NULL BEGIN EXEC ('CREATE SCHEMA \""+n+"\"') END":'CREATE SCHEMA "'+n+'"',r.push(new A.Query(u)),i.push(new A.Query('DROP SCHEMA "'+n+'"')),[3,3]);case 1:return a=n.split(".")[0],s=n.split(".")[1],[4,this.getCurrentDatabase()];case 2:o=e.sent(),r.push(new A.Query('USE "'+a+'"')),i.push(new A.Query('USE "'+o+'"')),u=t?"IF SCHEMA_ID('"+s+"') IS NULL BEGIN EXEC ('CREATE SCHEMA \""+s+"\"') END":'CREATE SCHEMA "'+s+'"',r.push(new A.Query(u)),i.push(new A.Query('DROP SCHEMA "'+s+'"')),r.push(new A.Query('USE "'+o+'"')),i.push(new A.Query('USE "'+a+'"')),e.label=3;case 3:return[4,this.executeQueries(r,i)];case 4:return e.sent(),[2]}})})},T.prototype.dropSchema=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s,o,u;return e.__generator(this,function(e){switch(e.label){case 0:return r=[],i=[],-1!==n.indexOf(".")?[3,1]:(u=t?"IF SCHEMA_ID('"+n+"') IS NULL BEGIN EXEC ('DROP SCHEMA \""+n+"\"') END":'DROP SCHEMA "'+n+'"',r.push(new A.Query(u)),i.push(new A.Query('CREATE SCHEMA "'+n+'"')),[3,3]);case 1:return a=n.split(".")[0],s=n.split(".")[1],[4,this.getCurrentDatabase()];case 2:o=e.sent(),r.push(new A.Query('USE "'+a+'"')),i.push(new A.Query('USE "'+o+'"')),u=t?"IF SCHEMA_ID('"+s+"') IS NULL BEGIN EXEC ('DROP SCHEMA \""+s+"\"') END":'DROP SCHEMA "'+s+'"',r.push(new A.Query(u)),i.push(new A.Query('CREATE SCHEMA "'+s+'"')),r.push(new A.Query('USE "'+o+'"')),i.push(new A.Query('USE "'+a+'"')),e.label=3;case 3:return[4,this.executeQueries(r,i)];case 4:return e.sent(),[2]}})})},T.prototype.createTable=function(n,t,r,i){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),e.__awaiter(this,void 0,void 0,function(){var a,s,o=this;return e.__generator(this,function(e){switch(e.label){case 0:return t?[4,this.hasTable(n)]:[3,2];case 1:if(e.sent())return[2,Promise.resolve()];e.label=2;case 2:return s=[],(a=[]).push(this.createTableSql(n,r)),s.push(this.dropTableSql(n)),r&&n.foreignKeys.forEach(function(e){return s.push(o.dropForeignKeySql(n,e))}),i&&n.indices.forEach(function(e){e.name||(e.name=o.connection.namingStrategy.indexName(n.name,e.columnNames,e.where)),a.push(o.createIndexSql(n,e)),s.push(o.dropIndexSql(n,e))}),[4,this.executeQueries(a,s)];case 3:return e.sent(),[2]}})})},T.prototype.dropTable=function(n,t,r,i){return void 0===r&&(r=!0),void 0===i&&(i=!0),e.__awaiter(this,void 0,void 0,function(){var a,s,u,c,h,l=this;return e.__generator(this,function(e){switch(e.label){case 0:return t?[4,this.hasTable(n)]:[3,2];case 1:if(!e.sent())return[2,Promise.resolve()];e.label=2;case 2:return a=r,n instanceof o.Table?(u=n,[3,5]):[3,3];case 3:return[4,this.getCachedTable(n)];case 4:u=e.sent(),e.label=5;case 5:return s=u,c=[],h=[],i&&s.indices.forEach(function(e){c.push(l.dropIndexSql(s,e)),h.push(l.createIndexSql(s,e))}),r&&s.foreignKeys.forEach(function(e){return c.push(l.dropForeignKeySql(s,e))}),c.push(this.dropTableSql(s)),h.push(this.createTableSql(s,a)),[4,this.executeQueries(c,h)];case 6:return e.sent(),[2]}})})},T.prototype.createView=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,a,s,o;return e.__generator(this,function(e){switch(e.label){case 0:return r=[],(t=[]).push(this.createViewSql(n)),a=(i=t).push,[4,this.insertViewDefinitionSql(n)];case 1:return a.apply(i,[e.sent()]),r.push(this.dropViewSql(n)),o=(s=r).push,[4,this.deleteViewDefinitionSql(n)];case 2:return o.apply(s,[e.sent()]),[4,this.executeQueries(t,r)];case 3:return e.sent(),[2]}})})},T.prototype.dropView=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,a,s,o,u,c;return e.__generator(this,function(e){switch(e.label){case 0:return t=n instanceof p.View?n.name:n,[4,this.getCachedView(t)];case 1:return r=e.sent(),a=[],o=(s=i=[]).push,[4,this.deleteViewDefinitionSql(r)];case 2:return o.apply(s,[e.sent()]),i.push(this.dropViewSql(r)),c=(u=a).push,[4,this.insertViewDefinitionSql(r)];case 3:return c.apply(u,[e.sent()]),a.push(this.createViewSql(r)),[4,this.executeQueries(i,a)];case 4:return e.sent(),[2]}})})},T.prototype.renameTable=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s,u,c,h,l,m,p,E,d,f,T=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=[],i=[],n instanceof o.Table?(s=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:s=e.sent(),e.label=3;case 3:return u=(a=s).clone(),c=void 0,h=void 0,l=a.name,3===(m=a.name.split(".")).length?(c=m[0],l=m[2],""!==m[1]&&(h=m[1])):2===m.length&&(h=m[0],l=m[1]),u.name=this.driver.buildTableName(t,h,c),[4,this.getCurrentDatabase()];case 4:return p=e.sent(),c&&c!==p&&(r.push(new A.Query('USE "'+c+'"')),i.push(new A.Query('USE "'+p+'"'))),r.push(new A.Query('EXEC sp_rename "'+this.escapePath(a,!0)+'", "'+t+'"')),i.push(new A.Query('EXEC sp_rename "'+this.escapePath(u,!0)+'", "'+l+'"')),u.primaryColumns.length>0&&(E=u.primaryColumns.map(function(e){return e.name}),d=this.connection.namingStrategy.primaryKeyName(a,E),f=this.connection.namingStrategy.primaryKeyName(u,E),r.push(new A.Query('EXEC sp_rename "'+this.escapePath(u,!0)+"."+d+'", "'+f+'"')),i.push(new A.Query('EXEC sp_rename "'+this.escapePath(u,!0)+"."+f+'", "'+d+'"'))),u.uniques.forEach(function(e){var n=T.connection.namingStrategy.uniqueConstraintName(u,e.columnNames);r.push(new A.Query('EXEC sp_rename "'+T.escapePath(u,!0)+"."+e.name+'", "'+n+'"')),i.push(new A.Query('EXEC sp_rename "'+T.escapePath(u,!0)+"."+n+'", "'+e.name+'"')),e.name=n}),u.indices.forEach(function(e){var n=T.connection.namingStrategy.indexName(u,e.columnNames,e.where);r.push(new A.Query('EXEC sp_rename "'+T.escapePath(u,!0)+"."+e.name+'", "'+n+'", "INDEX"')),i.push(new A.Query('EXEC sp_rename "'+T.escapePath(u,!0)+"."+n+'", "'+e.name+'", "INDEX"')),e.name=n}),u.foreignKeys.forEach(function(e){var n=T.connection.namingStrategy.foreignKeyName(u,e.columnNames);r.push(new A.Query('EXEC sp_rename "'+T.buildForeignKeyName(e.name,h,c)+'", "'+n+'"')),i.push(new A.Query('EXEC sp_rename "'+T.buildForeignKeyName(n,h,c)+'", "'+e.name+'"')),e.name=n}),c&&c!==p&&(r.push(new A.Query('USE "'+p+'"')),i.push(new A.Query('USE "'+c+'"'))),[4,this.executeQueries(r,i)];case 5:return e.sent(),a.name=u.name,this.replaceCachedTable(a,u),[2]}})})},T.prototype.addColumn=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s,u,c,h,l,p,E,d,f,T;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return a=(r=i).clone(),u=[],(s=[]).push(new A.Query("ALTER TABLE "+this.escapePath(r)+" ADD "+this.buildCreateColumnSql(r,t,!1,!0))),u.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' DROP COLUMN "'+t.name+'"')),t.isPrimary&&((c=a.primaryColumns).length>0&&(h=this.connection.namingStrategy.primaryKeyName(a.name,c.map(function(e){return e.name})),l=c.map(function(e){return'"'+e.name+'"'}).join(", "),s.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+h+'"')),u.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+h+'" PRIMARY KEY ('+l+")"))),c.push(t),p=this.connection.namingStrategy.primaryKeyName(a.name,c.map(function(e){return e.name})),E=c.map(function(e){return'"'+e.name+'"'}).join(", "),s.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+p+'" PRIMARY KEY ('+E+")")),u.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+p+'"'))),(d=a.indices.find(function(e){return 1===e.columnNames.length&&e.columnNames[0]===t.name}))&&(s.push(this.createIndexSql(r,d)),u.push(this.dropIndexSql(r,d))),t.isUnique&&(f=new m.TableUnique({name:this.connection.namingStrategy.uniqueConstraintName(r.name,[t.name]),columnNames:[t.name]}),a.uniques.push(f),s.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+f.name+'" UNIQUE ("'+t.name+'")')),u.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+f.name+'"'))),null!==t.default&&void 0!==t.default&&(T=this.connection.namingStrategy.defaultConstraintName(r.name,t.name),u.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+T+'"'))),[4,this.executeQueries(s,u)];case 4:return e.sent(),a.addColumn(t),this.replaceCachedTable(r,a),[2]}})})},T.prototype.addColumns=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,a.PromiseUtils.runInSequence(t,function(e){return r.addColumn(n,e)})];case 1:return e.sent(),[2]}})})},T.prototype.renameColumn=function(n,t,r){return e.__awaiter(this,void 0,void 0,function(){var i,a,s,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(a=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:a=e.sent(),e.label=3;case 3:if(i=a,!(s=t instanceof c.TableColumn?t:i.columns.find(function(e){return e.name===t})))throw new Error('Column "'+t+'" was not found in the "'+i.name+'" table.');return u=void 0,r instanceof c.TableColumn?u=r:(u=s.clone()).name=r,[4,this.changeColumn(i,s,u)];case 4:return e.sent(),[2]}})})},T.prototype.changeColumn=function(n,t,r){return e.__awaiter(this,void 0,void 0,function(){var i,a,s,u,h,l,p,E,d,f,T,N,_,y,C,v,S,b,R,O=this;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(a=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:a=e.sent(),e.label=3;case 3:if(s=(i=a).clone(),u=[],h=[],!(l=t instanceof c.TableColumn?t:i.columns.find(function(e){return e.name===t})))throw new Error('Column "'+t+'" was not found in the "'+i.name+'" table.');return r.isGenerated!==l.isGenerated&&"uuid"!==r.generationStrategy||r.type!==l.type||r.length!==l.length?[4,this.dropColumn(i,l)]:[3,6];case 4:return e.sent(),[4,this.addColumn(i,r)];case 5:return e.sent(),s=i.clone(),[3,10];case 6:return r.name===l.name?[3,8]:(p=void 0,E=void 0,3===(d=i.name.split(".")).length?(p=d[0],""!==d[1]&&(E=d[1])):2===d.length&&(E=d[0]),[4,this.getCurrentDatabase()]);case 7:f=e.sent(),p&&p!==f&&(u.push(new A.Query('USE "'+p+'"')),h.push(new A.Query('USE "'+f+'"'))),u.push(new A.Query('EXEC sp_rename "'+this.escapePath(i,!0)+"."+l.name+'", "'+r.name+'"')),h.push(new A.Query('EXEC sp_rename "'+this.escapePath(i,!0)+"."+r.name+'", "'+l.name+'"')),!0===l.isPrimary&&(y=s.primaryColumns,S=y.map(function(e){return e.name}),T=this.connection.namingStrategy.primaryKeyName(s,S),S.splice(S.indexOf(l.name),1),S.push(r.name),N=this.connection.namingStrategy.primaryKeyName(s,S),u.push(new A.Query('EXEC sp_rename "'+this.escapePath(s,!0)+"."+T+'", "'+N+'"')),h.push(new A.Query('EXEC sp_rename "'+this.escapePath(s,!0)+"."+N+'", "'+T+'"'))),s.findColumnIndices(l).forEach(function(e){e.columnNames.splice(e.columnNames.indexOf(l.name),1),e.columnNames.push(r.name);var n=O.connection.namingStrategy.indexName(s,e.columnNames,e.where);u.push(new A.Query('EXEC sp_rename "'+O.escapePath(s,!0)+"."+e.name+'", "'+n+'", "INDEX"')),h.push(new A.Query('EXEC sp_rename "'+O.escapePath(s,!0)+"."+n+'", "'+e.name+'", "INDEX"')),e.name=n}),s.findColumnForeignKeys(l).forEach(function(e){e.columnNames.splice(e.columnNames.indexOf(l.name),1),e.columnNames.push(r.name);var n=O.connection.namingStrategy.foreignKeyName(s,e.columnNames);u.push(new A.Query('EXEC sp_rename "'+O.buildForeignKeyName(e.name,E,p)+'", "'+n+'"')),h.push(new A.Query('EXEC sp_rename "'+O.buildForeignKeyName(n,E,p)+'", "'+e.name+'"')),e.name=n}),s.findColumnChecks(l).forEach(function(e){e.columnNames.splice(e.columnNames.indexOf(l.name),1),e.columnNames.push(r.name);var n=O.connection.namingStrategy.checkConstraintName(s,e.expression);u.push(new A.Query('EXEC sp_rename "'+O.escapePath(s,!0)+"."+e.name+'", "'+n+'"')),h.push(new A.Query('EXEC sp_rename "'+O.escapePath(s,!0)+"."+n+'", "'+e.name+'"')),e.name=n}),s.findColumnUniques(l).forEach(function(e){e.columnNames.splice(e.columnNames.indexOf(l.name),1),e.columnNames.push(r.name);var n=O.connection.namingStrategy.uniqueConstraintName(s,e.columnNames);u.push(new A.Query('EXEC sp_rename "'+O.escapePath(s,!0)+"."+e.name+'", "'+n+'"')),h.push(new A.Query('EXEC sp_rename "'+O.escapePath(s,!0)+"."+n+'", "'+e.name+'"')),e.name=n}),p&&p!==f&&(u.push(new A.Query('USE "'+f+'"')),h.push(new A.Query('USE "'+p+'"'))),_=s.columns.find(function(e){return e.name===l.name}),s.columns[s.columns.indexOf(_)].name=r.name,l.name=r.name,e.label=8;case 8:return this.isColumnChanged(l,r)&&(u.push(new A.Query("ALTER TABLE "+this.escapePath(i)+" ALTER COLUMN "+this.buildCreateColumnSql(i,r,!0,!1))),h.push(new A.Query("ALTER TABLE "+this.escapePath(i)+" ALTER COLUMN "+this.buildCreateColumnSql(i,l,!0,!1)))),r.isPrimary!==l.isPrimary&&((y=s.primaryColumns).length>0&&(v=this.connection.namingStrategy.primaryKeyName(s.name,y.map(function(e){return e.name})),S=y.map(function(e){return'"'+e.name+'"'}).join(", "),u.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' DROP CONSTRAINT "'+v+'"')),h.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' ADD CONSTRAINT "'+v+'" PRIMARY KEY ('+S+")"))),!0===r.isPrimary?(y.push(r),s.columns.find(function(e){return e.name===r.name}).isPrimary=!0,v=this.connection.namingStrategy.primaryKeyName(s.name,y.map(function(e){return e.name})),S=y.map(function(e){return'"'+e.name+'"'}).join(", "),u.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' ADD CONSTRAINT "'+v+'" PRIMARY KEY ('+S+")")),h.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' DROP CONSTRAINT "'+v+'"'))):(C=y.find(function(e){return e.name===r.name}),y.splice(y.indexOf(C),1),s.columns.find(function(e){return e.name===r.name}).isPrimary=!1,y.length>0&&(v=this.connection.namingStrategy.primaryKeyName(s.name,y.map(function(e){return e.name})),S=y.map(function(e){return'"'+e.name+'"'}).join(", "),u.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' ADD CONSTRAINT "'+v+'" PRIMARY KEY ('+S+")")),h.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' DROP CONSTRAINT "'+v+'"'))))),r.isUnique!==l.isUnique&&(!0===r.isUnique?(b=new m.TableUnique({name:this.connection.namingStrategy.uniqueConstraintName(i.name,[r.name]),columnNames:[r.name]}),s.uniques.push(b),u.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' ADD CONSTRAINT "'+b.name+'" UNIQUE ("'+r.name+'")')),h.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' DROP CONSTRAINT "'+b.name+'"'))):(b=s.uniques.find(function(e){return 1===e.columnNames.length&&!!e.columnNames.find(function(e){return e===r.name})}),s.uniques.splice(s.uniques.indexOf(b),1),u.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' DROP CONSTRAINT "'+b.name+'"')),h.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' ADD CONSTRAINT "'+b.name+'" UNIQUE ("'+r.name+'")')))),r.default!==l.default&&(null!==r.default&&void 0!==r.default?(R=this.connection.namingStrategy.defaultConstraintName(i.name,r.name),u.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' ADD CONSTRAINT "'+R+'" DEFAULT '+r.default+' FOR "'+r.name+'"')),h.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' DROP CONSTRAINT "'+R+'"'))):null!==l.default&&void 0!==l.default&&(R=this.connection.namingStrategy.defaultConstraintName(i.name,l.name),u.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' DROP CONSTRAINT "'+R+'"')),h.push(new A.Query("ALTER TABLE "+this.escapePath(i)+' ADD CONSTRAINT "'+R+'" DEFAULT '+l.default+' FOR "'+l.name+'"')))),[4,this.executeQueries(u,h)];case 9:e.sent(),this.replaceCachedTable(i,s),e.label=10;case 10:return[2]}})})},T.prototype.changeColumns=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,a.PromiseUtils.runInSequence(t,function(e){return r.changeColumn(n,e.oldColumn,e.newColumn)})];case 1:return e.sent(),[2]}})})},T.prototype.dropColumn=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s,u,h,l,m,p,E,d,f,T,N;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:if(r=i,!(a=t instanceof c.TableColumn?t:r.findColumnByName(t)))throw new Error('Column "'+t+'" was not found in table "'+r.name+'"');return s=r.clone(),u=[],h=[],a.isPrimary&&(l=this.connection.namingStrategy.primaryKeyName(s.name,s.primaryColumns.map(function(e){return e.name})),m=s.primaryColumns.map(function(e){return'"'+e.name+'"'}).join(", "),u.push(new A.Query("ALTER TABLE "+this.escapePath(s)+' DROP CONSTRAINT "'+l+'"')),h.push(new A.Query("ALTER TABLE "+this.escapePath(s)+' ADD CONSTRAINT "'+l+'" PRIMARY KEY ('+m+")")),s.findColumnByName(a.name).isPrimary=!1,s.primaryColumns.length>0&&(p=this.connection.namingStrategy.primaryKeyName(s.name,s.primaryColumns.map(function(e){return e.name})),E=s.primaryColumns.map(function(e){return'"'+e.name+'"'}).join(", "),u.push(new A.Query("ALTER TABLE "+this.escapePath(s)+' ADD CONSTRAINT "'+p+'" PRIMARY KEY ('+E+")")),h.push(new A.Query("ALTER TABLE "+this.escapePath(s)+' DROP CONSTRAINT "'+p+'"')))),(d=s.indices.find(function(e){return 1===e.columnNames.length&&e.columnNames[0]===a.name}))&&(s.indices.splice(s.indices.indexOf(d),1),u.push(this.dropIndexSql(r,d)),h.push(this.createIndexSql(r,d))),(f=s.checks.find(function(e){return!!e.columnNames&&1===e.columnNames.length&&e.columnNames[0]===a.name}))&&(s.checks.splice(s.checks.indexOf(f),1),u.push(this.dropCheckConstraintSql(r,f)),h.push(this.createCheckConstraintSql(r,f))),(T=s.uniques.find(function(e){return 1===e.columnNames.length&&e.columnNames[0]===a.name}))&&(s.uniques.splice(s.uniques.indexOf(T),1),u.push(this.dropUniqueConstraintSql(r,T)),h.push(this.createUniqueConstraintSql(r,T))),null!==a.default&&void 0!==a.default&&(N=this.connection.namingStrategy.defaultConstraintName(r.name,a.name),u.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+N+'"')),h.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+N+'" DEFAULT '+a.default+' FOR "'+a.name+'"'))),u.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' DROP COLUMN "'+a.name+'"')),h.push(new A.Query("ALTER TABLE "+this.escapePath(r)+" ADD "+this.buildCreateColumnSql(r,a,!1,!1))),[4,this.executeQueries(u,h)];case 4:return e.sent(),s.removeColumn(a),this.replaceCachedTable(r,s),[2]}})})},T.prototype.dropColumns=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,a.PromiseUtils.runInSequence(t,function(e){return r.dropColumn(n,e)})];case 1:return e.sent(),[2]}})})},T.prototype.createPrimaryKey=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return a=(r=i).clone(),s=this.createPrimaryKeySql(r,t),a.columns.forEach(function(e){t.find(function(n){return n===e.name})&&(e.isPrimary=!0)}),u=this.dropPrimaryKeySql(a),[4,this.executeQueries(s,u)];case 4:return e.sent(),this.replaceCachedTable(r,a),[2]}})})},T.prototype.updatePrimaryKeys=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s,u,c,h,l,m,p,E;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return a=(r=i).clone(),s=t.map(function(e){return e.name}),u=[],c=[],(h=a.primaryColumns).length>0&&(l=this.connection.namingStrategy.primaryKeyName(a.name,h.map(function(e){return e.name})),m=h.map(function(e){return'"'+e.name+'"'}).join(", "),u.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+l+'"')),c.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+l+'" PRIMARY KEY ('+m+")"))),a.columns.filter(function(e){return-1!==s.indexOf(e.name)}).forEach(function(e){return e.isPrimary=!0}),p=this.connection.namingStrategy.primaryKeyName(a.name,s),E=s.map(function(e){return'"'+e+'"'}).join(", "),u.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+p+'" PRIMARY KEY ('+E+")")),c.push(new A.Query("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+p+'"')),[4,this.executeQueries(u,c)];case 4:return e.sent(),this.replaceCachedTable(r,a),[2]}})})},T.prototype.dropPrimaryKey=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,a;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(r=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:r=e.sent(),e.label=3;case 3:return t=r,i=this.dropPrimaryKeySql(t),a=this.createPrimaryKeySql(t,t.primaryColumns.map(function(e){return e.name})),[4,this.executeQueries(i,a)];case 4:return e.sent(),t.primaryColumns.forEach(function(e){e.isPrimary=!1}),[2]}})})},T.prototype.createUniqueConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return r=i,t.name||(t.name=this.connection.namingStrategy.uniqueConstraintName(r.name,t.columnNames)),a=this.createUniqueConstraintSql(r,t),s=this.dropUniqueConstraintSql(r,t),[4,this.executeQueries(a,s)];case 4:return e.sent(),r.addUniqueConstraint(t),[2]}})})},T.prototype.createUniqueConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.createUniqueConstraint(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},T.prototype.dropUniqueConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:if(r=i,!(a=t instanceof m.TableUnique?t:r.uniques.find(function(e){return e.name===t})))throw new Error("Supplied unique constraint was not found in table "+r.name);return s=this.dropUniqueConstraintSql(r,a),u=this.createUniqueConstraintSql(r,a),[4,this.executeQueries(s,u)];case 4:return e.sent(),r.removeUniqueConstraint(a),[2]}})})},T.prototype.dropUniqueConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.dropUniqueConstraint(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},T.prototype.createCheckConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return r=i,t.name||(t.name=this.connection.namingStrategy.checkConstraintName(r.name,t.expression)),a=this.createCheckConstraintSql(r,t),s=this.dropCheckConstraintSql(r,t),[4,this.executeQueries(a,s)];case 4:return e.sent(),r.addCheckConstraint(t),[2]}})})},T.prototype.createCheckConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.createCheckConstraint(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},T.prototype.dropCheckConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s,c;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:if(r=i,!(a=t instanceof u.TableCheck?t:r.checks.find(function(e){return e.name===t})))throw new Error("Supplied check constraint was not found in table "+r.name);return s=this.dropCheckConstraintSql(r,a),c=this.createCheckConstraintSql(r,a),[4,this.executeQueries(s,c)];case 4:return e.sent(),r.removeCheckConstraint(a),[2]}})})},T.prototype.dropCheckConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.dropCheckConstraint(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},T.prototype.createExclusionConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("SqlServer does not support exclusion constraints.")})})},T.prototype.createExclusionConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("SqlServer does not support exclusion constraints.")})})},T.prototype.dropExclusionConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("SqlServer does not support exclusion constraints.")})})},T.prototype.dropExclusionConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("SqlServer does not support exclusion constraints.")})})},T.prototype.createForeignKey=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return r=i,t.name||(t.name=this.connection.namingStrategy.foreignKeyName(r.name,t.columnNames)),a=this.createForeignKeySql(r,t),s=this.dropForeignKeySql(r,t),[4,this.executeQueries(a,s)];case 4:return e.sent(),r.addForeignKey(t),[2]}})})},T.prototype.createForeignKeys=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.createForeignKey(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},T.prototype.dropForeignKey=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:if(r=i,!(a=t instanceof h.TableForeignKey?t:r.foreignKeys.find(function(e){return e.name===t})))throw new Error("Supplied foreign key was not found in table "+r.name);return s=this.dropForeignKeySql(r,a),u=this.createForeignKeySql(r,a),[4,this.executeQueries(s,u)];case 4:return e.sent(),r.removeForeignKey(a),[2]}})})},T.prototype.dropForeignKeys=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.dropForeignKey(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},T.prototype.createIndex=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return r=i,t.name||(t.name=this.connection.namingStrategy.indexName(r.name,t.columnNames,t.where)),a=this.createIndexSql(r,t),s=this.dropIndexSql(r,t),[4,this.executeQueries(a,s)];case 4:return e.sent(),r.addIndex(t),[2]}})})},T.prototype.createIndices=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.createIndex(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},T.prototype.dropIndex=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof o.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:if(r=i,!(a=t instanceof l.TableIndex?t:r.indices.find(function(e){return e.name===t})))throw new Error("Supplied index was not found in table "+r.name);return s=this.dropIndexSql(r,a),u=this.createIndexSql(r,a),[4,this.executeQueries(s,u)];case 4:return e.sent(),r.removeIndex(a),[2]}})})},T.prototype.dropIndices=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.dropIndex(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},T.prototype.clearTable=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.query("TRUNCATE TABLE "+this.escapePath(n))];case 1:return e.sent(),[2]}})})},T.prototype.clearDatabase=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,a,s,o=this;return e.__generator(this,function(u){switch(u.label){case 0:return n?[4,this.hasDatabase(n)]:[3,2];case 1:if(!u.sent())return[2,Promise.resolve()];u.label=2;case 2:return[4,this.startTransaction()];case 3:u.sent(),u.label=4;case 4:return u.trys.push([4,11,,16]),t=n?'SELECT * FROM "'+n+'"."INFORMATION_SCHEMA"."VIEWS"':'SELECT * FROM "INFORMATION_SCHEMA"."VIEWS"',[4,this.query(t)];case 5:return r=u.sent(),[4,Promise.all(r.map(function(e){var n='DROP VIEW "'+e.TABLE_SCHEMA+'"."'+e.TABLE_NAME+'"';return o.query(n)}))];case 6:return u.sent(),i=n?'SELECT * FROM "'+n+'"."INFORMATION_SCHEMA"."TABLES" WHERE "TABLE_TYPE" = \'BASE TABLE\'':'SELECT * FROM "INFORMATION_SCHEMA"."TABLES" WHERE "TABLE_TYPE" = \'BASE TABLE\'',[4,this.query(i)];case 7:return a=u.sent(),[4,Promise.all(a.map(function(n){return e.__awaiter(o,void 0,void 0,function(){var t,r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return t="SELECT 'ALTER TABLE \""+n.TABLE_CATALOG+'"."\' + OBJECT_SCHEMA_NAME("fk"."parent_object_id", DB_ID(\''+n.TABLE_CATALOG+'\')) + \'"."\' + OBJECT_NAME("fk"."parent_object_id", DB_ID(\''+n.TABLE_CATALOG+'\')) + \'" DROP CONSTRAINT "\' + "fk"."name" + \'"\' as "query" FROM "'+n.TABLE_CATALOG+'"."sys"."foreign_keys" AS "fk" WHERE "fk"."referenced_object_id" = OBJECT_ID(\'"'+n.TABLE_CATALOG+'"."'+n.TABLE_SCHEMA+'"."'+n.TABLE_NAME+"\"')",[4,this.query(t)];case 1:return r=e.sent(),[2,Promise.all(r.map(function(e){return e.query}).map(function(e){return i.query(e)}))]}})})}))];case 8:return u.sent(),[4,Promise.all(a.map(function(e){var n='DROP TABLE "'+e.TABLE_CATALOG+'"."'+e.TABLE_SCHEMA+'"."'+e.TABLE_NAME+'"';return o.query(n)}))];case 9:return u.sent(),[4,this.commitTransaction()];case 10:return u.sent(),[3,16];case 11:s=u.sent(),u.label=12;case 12:return u.trys.push([12,14,,15]),[4,this.rollbackTransaction()];case 13:return u.sent(),[3,15];case 14:return u.sent(),[3,15];case 15:throw s;case 16:return[2]}})})},T.prototype.getCurrentDatabase=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.query('SELECT DB_NAME() AS "db_name"')];case 1:return[2,e.sent()[0].db_name]}})})},T.prototype.getCurrentSchema=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.query('SELECT SCHEMA_NAME() AS "schema_name"')];case 1:return[2,e.sent()[0].schema_name]}})})},T.prototype.loadViews=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,a,s,o,u=this;return e.__generator(this,function(c){switch(c.label){case 0:return[4,this.hasTable(this.getTypeormMetadataTableName())];case 1:return c.sent()?[4,this.getCurrentSchema()]:[2,Promise.resolve([])];case 2:return t=c.sent(),[4,this.getCurrentDatabase()];case 3:return r=c.sent(),i=function(n){var r=e.__read(n.split("."),3),i=r[0],a=r[1],s=r[2];return s?""===a&&(a=u.driver.options.schema||t):a?(s=a,a=i):(s=i,a=u.driver.options.schema||t),[a,s]},a=n.filter(function(e){return 3===e.split(".").length}).map(function(e){return e.split(".")[0]}),this.driver.database&&!a.find(function(e){return e===u.driver.database})&&a.push(this.driver.database),s=n.map(function(n){var t=e.__read(i(n),2);return'("T"."SCHEMA" = \''+t[0]+'\' AND "T"."NAME" = \''+t[1]+"')"}).join(" OR "),o=a.map(function(e){return'SELECT "T".*, "V"."CHECK_OPTION" FROM '+u.escapePath(u.getTypeormMetadataTableName())+' "t" INNER JOIN "'+e+'"."INFORMATION_SCHEMA"."VIEWS" "V" ON "V"."TABLE_SCHEMA" = "T"."SCHEMA" AND "v"."TABLE_NAME" = "T"."NAME" WHERE "T"."TYPE" = \'VIEW\' '+(s?"AND ("+s+")":"")}).join(" UNION ALL "),[4,this.query(o)];case 4:return[2,c.sent().map(function(e){var n=new p.View,i=e.TABLE_CATALOG===r?void 0:e.TABLE_CATALOG,a=e.schema!==t||u.driver.options.schema?e.schema:void 0;return n.name=u.driver.buildTableName(e.name,a,i),n.expression=e.value,n})]}})})},T.prototype.loadTables=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,a,s,p,E,A,f,T,N,_,y,C,v,S,b,R,O,L,w,g,I=this;return e.__generator(this,function(M){switch(M.label){case 0:return n&&n.length?(t=[],[4,this.getCurrentSchema()]):[2,[]];case 1:return r=M.sent(),[4,this.getCurrentDatabase()];case 2:return i=M.sent(),a=function(n){var t=e.__read(n.split("."),3),i=t[0],a=t[1],s=t[2];return s?""===a&&(a=I.driver.options.schema||r):a?(s=a,a=i):(s=i,a=I.driver.options.schema||r),[a,s]},n.filter(function(e){return-1!==e.indexOf(".")}).forEach(function(e){3===e.split(".").length?""!==e.split(".")[1]&&t.push(e.split(".")[1]):t.push(e.split(".")[0])}),t.push(this.driver.options.schema||r),s=n.filter(function(e){return 3===e.split(".").length}).map(function(e){return e.split(".")[0]}),this.driver.database&&!s.find(function(e){return e===I.driver.database})&&s.push(this.driver.database),p=t.map(function(e){return"'"+e+"'"}).join(", "),E=n.map(function(n){var t=e.__read(a(n),2);return'("TABLE_SCHEMA" = \''+t[0]+"' AND \"TABLE_NAME\" = '"+t[1]+"')"}).join(" OR "),A=s.map(function(e){return'SELECT * FROM "'+e+'"."INFORMATION_SCHEMA"."TABLES" WHERE '+E}).join(" UNION ALL "),f=s.map(function(e){return'SELECT * FROM "'+e+'"."INFORMATION_SCHEMA"."COLUMNS" WHERE '+E}).join(" UNION ALL "),T=n.map(function(n){var t=e.__read(a(n),2),r=t[0],i=t[1];return'("columnUsages"."TABLE_SCHEMA" = \''+r+'\' AND "columnUsages"."TABLE_NAME" = \''+i+'\' AND "tableConstraints"."TABLE_SCHEMA" = \''+r+'\' AND "tableConstraints"."TABLE_NAME" = \''+i+"')"}).join(" OR "),N=s.map(function(e){return'SELECT "columnUsages".*, "tableConstraints"."CONSTRAINT_TYPE", "chk"."definition" FROM "'+e+'"."INFORMATION_SCHEMA"."CONSTRAINT_COLUMN_USAGE" "columnUsages" INNER JOIN "'+e+'"."INFORMATION_SCHEMA"."TABLE_CONSTRAINTS" "tableConstraints" ON "tableConstraints"."CONSTRAINT_NAME" = "columnUsages"."CONSTRAINT_NAME" LEFT JOIN "'+e+'"."sys"."check_constraints" "chk" ON "chk"."name" = "columnUsages"."CONSTRAINT_NAME" WHERE ('+T+") AND \"tableConstraints\".\"CONSTRAINT_TYPE\" IN ('PRIMARY KEY', 'UNIQUE', 'CHECK')"}).join(" UNION ALL "),_=s.map(function(e){return'SELECT "fk"."name" AS "FK_NAME", \''+e+'\' AS "TABLE_CATALOG", "s1"."name" AS "TABLE_SCHEMA", "t1"."name" AS "TABLE_NAME", "col1"."name" AS "COLUMN_NAME", "s2"."name" AS "REF_SCHEMA", "t2"."name" AS "REF_TABLE", "col2"."name" AS "REF_COLUMN", "fk"."delete_referential_action_desc" AS "ON_DELETE", "fk"."update_referential_action_desc" AS "ON_UPDATE" FROM "'+e+'"."sys"."foreign_keys" "fk" INNER JOIN "'+e+'"."sys"."foreign_key_columns" "fkc" ON "fkc"."constraint_object_id" = "fk"."object_id" INNER JOIN "'+e+'"."sys"."tables" "t1" ON "t1"."object_id" = "fk"."parent_object_id" INNER JOIN "'+e+'"."sys"."schemas" "s1" ON "s1"."schema_id" = "t1"."schema_id" INNER JOIN "'+e+'"."sys"."tables" "t2" ON "t2"."object_id" = "fk"."referenced_object_id" INNER JOIN "'+e+'"."sys"."schemas" "s2" ON "s2"."schema_id" = "t2"."schema_id" INNER JOIN "'+e+'"."sys"."columns" "col1" ON "col1"."column_id" = "fkc"."parent_column_id" AND "col1"."object_id" = "fk"."parent_object_id" INNER JOIN "'+e+'"."sys"."columns" "col2" ON "col2"."column_id" = "fkc"."referenced_column_id" AND "col2"."object_id" = "fk"."referenced_object_id"'}).join(" UNION ALL "),y=s.map(function(e){return'SELECT "TABLE_CATALOG", "TABLE_SCHEMA", "COLUMN_NAME", "TABLE_NAME" FROM "'+e+'"."INFORMATION_SCHEMA"."COLUMNS" WHERE COLUMNPROPERTY(object_id("TABLE_CATALOG" + \'.\' + "TABLE_SCHEMA" + \'.\' + "TABLE_NAME"), "COLUMN_NAME", \'IsIdentity\') = 1 AND "TABLE_SCHEMA" IN ('+p+")"}).join(" UNION ALL "),'SELECT "NAME", "COLLATION_NAME" FROM "sys"."databases"',C=s.map(function(e){return"SELECT '"+e+'\' AS "TABLE_CATALOG", "s"."name" AS "TABLE_SCHEMA", "t"."name" AS "TABLE_NAME", "ind"."name" AS "INDEX_NAME", "col"."name" AS "COLUMN_NAME", "ind"."is_unique" AS "IS_UNIQUE", "ind"."filter_definition" as "CONDITION" FROM "'+e+'"."sys"."indexes" "ind" INNER JOIN "'+e+'"."sys"."index_columns" "ic" ON "ic"."object_id" = "ind"."object_id" AND "ic"."index_id" = "ind"."index_id" INNER JOIN "'+e+'"."sys"."columns" "col" ON "col"."object_id" = "ic"."object_id" AND "col"."column_id" = "ic"."column_id" INNER JOIN "'+e+'"."sys"."tables" "t" ON "t"."object_id" = "ind"."object_id" INNER JOIN "'+e+'"."sys"."schemas" "s" ON "s"."schema_id" = "t"."schema_id" WHERE "ind"."is_primary_key" = 0 AND "ind"."is_unique_constraint" = 0 AND "t"."is_ms_shipped" = 0'}).join(" UNION ALL "),[4,Promise.all([this.query(A),this.query(f),this.query(N),this.query(_),this.query(y),this.query('SELECT "NAME", "COLLATION_NAME" FROM "sys"."databases"'),this.query(C)])];case 3:return v=e.__read.apply(void 0,[M.sent(),7]),S=v[0],b=v[1],R=v[2],O=v[3],L=v[4],w=v[5],g=v[6],S.length?[4,Promise.all(S.map(function(n){return e.__awaiter(I,void 0,void 0,function(){var t,a,s,p,E,A,f,T,N,_=this;return e.__generator(this,function(y){return t=new o.Table,a=n.TABLE_CATALOG===i?void 0:n.TABLE_CATALOG,s=n.TABLE_SCHEMA!==r||this.driver.options.schema?n.TABLE_SCHEMA:void 0,t.name=this.driver.buildTableName(n.TABLE_NAME,s,a),p=this.driver.buildTableName(n.TABLE_NAME,n.TABLE_SCHEMA,n.TABLE_CATALOG),E=w.find(function(e){return e.NAME===n.TABLE_CATALOG}),t.columns=b.filter(function(e){return _.driver.buildTableName(e.TABLE_NAME,e.TABLE_SCHEMA,e.TABLE_CATALOG)===p}).map(function(n){var r,i,a=R.filter(function(e){return _.driver.buildTableName(e.TABLE_NAME,e.CONSTRAINT_SCHEMA,e.CONSTRAINT_CATALOG)===p&&e.COLUMN_NAME===n.COLUMN_NAME}),s=a.find(function(e){return"UNIQUE"===e.CONSTRAINT_TYPE}),o=!!s&&!!R.find(function(e){return"UNIQUE"===e.CONSTRAINT_TYPE&&e.CONSTRAINT_NAME===s.CONSTRAINT_NAME&&e.COLUMN_NAME!==n.COLUMN_NAME}),u=!!a.find(function(e){return"PRIMARY KEY"===e.CONSTRAINT_TYPE}),h=!!L.find(function(e){return _.driver.buildTableName(e.TABLE_NAME,e.TABLE_SCHEMA,e.TABLE_CATALOG)===p&&e.COLUMN_NAME===n.COLUMN_NAME}),l=new c.TableColumn;if(l.name=n.COLUMN_NAME,l.type=n.DATA_TYPE.toLowerCase(),-1!==_.driver.withLengthColumnTypes.indexOf(l.type)&&n.CHARACTER_MAXIMUM_LENGTH){var m=n.CHARACTER_MAXIMUM_LENGTH.toString();l.length="-1"===m?"MAX":_.isDefaultColumnLength(t,l,m)?"":m}if("decimal"!==l.type&&"numeric"!==l.type||(null===n.NUMERIC_PRECISION||_.isDefaultColumnPrecision(t,l,n.NUMERIC_PRECISION)||(l.precision=n.NUMERIC_PRECISION),null===n.NUMERIC_SCALE||_.isDefaultColumnScale(t,l,n.NUMERIC_SCALE)||(l.scale=n.NUMERIC_SCALE)),"nvarchar"===l.type){var d=a.filter(function(e){return"CHECK"===e.CONSTRAINT_TYPE});if(d.length){var A=new RegExp("^\\(\\["+l.name+"\\]='[^']+'(?: OR \\["+l.name+"\\]='[^']+')*\\)$");try{for(var f=e.__values(d),T=f.next();!T.done;T=f.next()){var N=T.value;if(A.test(N.definition)){l.type="simple-enum",l.enum=[];for(var y=new RegExp("\\["+l.name+"\\]='([^']+)'","g"),C=void 0;null!==(C=y.exec(N.definition));)l.enum.unshift(C[1]);break}}}catch(v){r={error:v}}finally{try{T&&!T.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}}return l.default=null!==n.COLUMN_DEFAULT&&void 0!==n.COLUMN_DEFAULT?_.removeParenthesisFromDefault(n.COLUMN_DEFAULT):void 0,l.isNullable="YES"===n.IS_NULLABLE,l.isPrimary=u,l.isUnique=!!s&&!o,l.isGenerated=h,h&&(l.generationStrategy="increment"),"newsequentialid()"===l.default&&(l.isGenerated=!0,l.generationStrategy="uuid",l.default=void 0),l.collation=n.COLLATION_NAME===E.COLLATION_NAME?void 0:n.COLLATION_NAME,"datetime2"!==l.type&&"time"!==l.type&&"datetimeoffset"!==l.type||(l.precision=_.isDefaultColumnPrecision(t,l,n.DATETIME_PRECISION)?void 0:n.DATETIME_PRECISION),l}),A=d.OrmUtils.uniq(R.filter(function(e){return _.driver.buildTableName(e.TABLE_NAME,e.CONSTRAINT_SCHEMA,e.CONSTRAINT_CATALOG)===p&&"UNIQUE"===e.CONSTRAINT_TYPE}),function(e){return e.CONSTRAINT_NAME}),t.uniques=A.map(function(e){var n=R.filter(function(n){return n.CONSTRAINT_NAME===e.CONSTRAINT_NAME});return new m.TableUnique({name:e.CONSTRAINT_NAME,columnNames:n.map(function(e){return e.COLUMN_NAME})})}),f=d.OrmUtils.uniq(R.filter(function(e){return _.driver.buildTableName(e.TABLE_NAME,e.CONSTRAINT_SCHEMA,e.CONSTRAINT_CATALOG)===p&&"CHECK"===e.CONSTRAINT_TYPE}),function(e){return e.CONSTRAINT_NAME}),t.checks=f.map(function(e){var n=R.filter(function(n){return n.CONSTRAINT_NAME===e.CONSTRAINT_NAME});return new u.TableCheck({name:e.CONSTRAINT_NAME,columnNames:n.map(function(e){return e.COLUMN_NAME}),expression:e.definition})}),T=d.OrmUtils.uniq(O.filter(function(e){return _.driver.buildTableName(e.TABLE_NAME,e.TABLE_SCHEMA,e.TABLE_CATALOG)===p}),function(e){return e.FK_NAME}),t.foreignKeys=T.map(function(e){var n=O.filter(function(n){return n.FK_NAME===e.FK_NAME}),t=e.TABLE_CATALOG===i?void 0:e.TABLE_CATALOG,a=e.REF_SCHEMA===r?void 0:e.REF_SCHEMA,s=_.driver.buildTableName(e.REF_TABLE,a,t);return new h.TableForeignKey({name:e.FK_NAME,columnNames:n.map(function(e){return e.COLUMN_NAME}),referencedTableName:s,referencedColumnNames:n.map(function(e){return e.REF_COLUMN}),onDelete:e.ON_DELETE.replace("_"," "),onUpdate:e.ON_UPDATE.replace("_"," ")})}),N=d.OrmUtils.uniq(g.filter(function(e){return _.driver.buildTableName(e.TABLE_NAME,e.TABLE_SCHEMA,e.TABLE_CATALOG)===p}),function(e){return e.INDEX_NAME}),t.indices=N.map(function(e){var n=g.filter(function(n){return n.TABLE_CATALOG===e.TABLE_CATALOG&&n.TABLE_SCHEMA===e.TABLE_SCHEMA&&n.TABLE_NAME===e.TABLE_NAME&&n.INDEX_NAME===e.INDEX_NAME});return new l.TableIndex({table:t,name:e.INDEX_NAME,columnNames:n.map(function(e){return e.COLUMN_NAME}),isUnique:e.IS_UNIQUE,where:e.CONDITION})}),[2,t]})})}))]:[2,[]];case 4:return[2,M.sent()]}})})},T.prototype.createTableSql=function(e,n){var t=this,r=e.columns.map(function(n){return t.buildCreateColumnSql(e,n,!1,!0)}).join(", "),i="CREATE TABLE "+this.escapePath(e)+" ("+r;(e.columns.filter(function(e){return e.isUnique}).forEach(function(n){e.uniques.some(function(e){return 1===e.columnNames.length&&e.columnNames[0]===n.name})||e.uniques.push(new m.TableUnique({name:t.connection.namingStrategy.uniqueConstraintName(e.name,[n.name]),columnNames:[n.name]}))}),e.uniques.length>0)&&(i+=", "+e.uniques.map(function(n){return'CONSTRAINT "'+(n.name?n.name:t.connection.namingStrategy.uniqueConstraintName(e.name,n.columnNames))+'" UNIQUE ('+n.columnNames.map(function(e){return'"'+e+'"'}).join(", ")+")"}).join(", "));e.checks.length>0&&(i+=", "+e.checks.map(function(n){return'CONSTRAINT "'+(n.name?n.name:t.connection.namingStrategy.checkConstraintName(e.name,n.expression))+'" CHECK ('+n.expression+")"}).join(", "));e.foreignKeys.length>0&&n&&(i+=", "+e.foreignKeys.map(function(n){var r=n.columnNames.map(function(e){return'"'+e+'"'}).join(", ");n.name||(n.name=t.connection.namingStrategy.foreignKeyName(e.name,n.columnNames));var i=n.referencedColumnNames.map(function(e){return'"'+e+'"'}).join(", "),a='CONSTRAINT "'+n.name+'" FOREIGN KEY ('+r+") REFERENCES "+t.escapePath(n.referencedTableName)+" ("+i+")";return n.onDelete&&(a+=" ON DELETE "+n.onDelete),n.onUpdate&&(a+=" ON UPDATE "+n.onUpdate),a}).join(", "));var a=e.columns.filter(function(e){return e.isPrimary});a.length>0&&(i+=', CONSTRAINT "'+this.connection.namingStrategy.primaryKeyName(e.name,a.map(function(e){return e.name}))+'" PRIMARY KEY ('+a.map(function(e){return'"'+e.name+'"'}).join(", ")+")");return i+=")",new A.Query(i)},T.prototype.dropTableSql=function(e,n){var t=n?"DROP TABLE IF EXISTS "+this.escapePath(e):"DROP TABLE "+this.escapePath(e);return new A.Query(t)},T.prototype.createViewSql=function(e){return"string"==typeof e.expression?new A.Query("CREATE VIEW "+this.escapePath(e)+" AS "+e.expression):new A.Query("CREATE VIEW "+this.escapePath(e)+" AS "+e.expression(this.connection).getQuery())},T.prototype.insertViewDefinitionSql=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,a,s,o;return e.__generator(this,function(u){switch(u.label){case 0:return[4,this.getCurrentSchema()];case 1:return t=u.sent(),r=this.parseTableName(n,t),i="string"==typeof n.expression?n.expression.trim():n.expression(this.connection).getQuery(),a=e.__read(this.connection.createQueryBuilder().insert().into(this.getTypeormMetadataTableName()).values({type:"VIEW",database:r.database,schema:r.schema,name:r.name,value:i}).getQueryAndParameters(),2),s=a[0],o=a[1],[2,new A.Query(s,o)]}})})},T.prototype.dropViewSql=function(e){return new A.Query("DROP VIEW "+this.escapePath(e))},T.prototype.deleteViewDefinitionSql=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,a,s,o;return e.__generator(this,function(u){switch(u.label){case 0:return[4,this.getCurrentSchema()];case 1:return t=u.sent(),r=this.parseTableName(n,t),i=this.connection.createQueryBuilder(),a=e.__read(i.delete().from(this.getTypeormMetadataTableName()).where(i.escape("type")+" = 'VIEW'").andWhere(i.escape("database")+" = :database",{database:r.database}).andWhere(i.escape("schema")+" = :schema",{schema:r.schema}).andWhere(i.escape("name")+" = :name",{name:r.name}).getQueryAndParameters(),2),s=a[0],o=a[1],[2,new A.Query(s,o)]}})})},T.prototype.createIndexSql=function(e,n){var t=n.columnNames.map(function(e){return'"'+e+'"'}).join(", ");return new A.Query("CREATE "+(n.isUnique?"UNIQUE ":"")+'INDEX "'+n.name+'" ON '+this.escapePath(e)+" ("+t+") "+(n.where?"WHERE "+n.where:""))},T.prototype.dropIndexSql=function(e,n){var t=n instanceof l.TableIndex?n.name:n;return new A.Query('DROP INDEX "'+t+'" ON '+this.escapePath(e))},T.prototype.createPrimaryKeySql=function(e,n){var t=this.connection.namingStrategy.primaryKeyName(e.name,n),r=n.map(function(e){return'"'+e+'"'}).join(", ");return new A.Query("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+t+'" PRIMARY KEY ('+r+")")},T.prototype.dropPrimaryKeySql=function(e){var n=e.primaryColumns.map(function(e){return e.name}),t=this.connection.namingStrategy.primaryKeyName(e.name,n);return new A.Query("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+t+'"')},T.prototype.createUniqueConstraintSql=function(e,n){var t=n.columnNames.map(function(e){return'"'+e+'"'}).join(", ");return new A.Query("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+n.name+'" UNIQUE ('+t+")")},T.prototype.dropUniqueConstraintSql=function(e,n){var t=n instanceof m.TableUnique?n.name:n;return new A.Query("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+t+'"')},T.prototype.createCheckConstraintSql=function(e,n){return new A.Query("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+n.name+'" CHECK ('+n.expression+")")},T.prototype.dropCheckConstraintSql=function(e,n){var t=n instanceof u.TableCheck?n.name:n;return new A.Query("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+t+'"')},T.prototype.createForeignKeySql=function(e,n){var t=n.columnNames.map(function(e){return'"'+e+'"'}).join(", "),r=n.referencedColumnNames.map(function(e){return'"'+e+'"'}).join(","),i="ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+n.name+'" FOREIGN KEY ('+t+") REFERENCES "+this.escapePath(n.referencedTableName)+"("+r+")";return n.onDelete&&(i+=" ON DELETE "+n.onDelete),n.onUpdate&&(i+=" ON UPDATE "+n.onUpdate),new A.Query(i)},T.prototype.dropForeignKeySql=function(e,n){var t=n instanceof h.TableForeignKey?n.name:n;return new A.Query("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+t+'"')},T.prototype.escapePath=function(e,n){var t=e instanceof o.Table||e instanceof p.View?e.name:e;if(this.driver.options.schema)if(-1===t.indexOf("."))t=this.driver.options.schema+"."+t;else if(3===t.split(".").length){var r=t.split("."),i=r[0],a=r[2];t=i+"."+this.driver.options.schema+"."+a}return t.split(".").map(function(e){return""===e?e:n?e:'"'+e+'"'}).join(".")},T.prototype.parseTableName=function(e,n){var t=e instanceof o.Table||e instanceof p.View?e.name:e;return 3===t.split(".").length?{database:t.split(".")[0],schema:""===t.split(".")[1]?n||"SCHEMA_NAME()":t.split(".")[1],name:t.split(".")[2]}:2===t.split(".").length?{database:this.driver.database,schema:t.split(".")[0],name:t.split(".")[1]}:{database:this.driver.database,schema:this.driver.options.schema?this.driver.options.schema:n||"SCHEMA_NAME()",name:t}},T.prototype.buildForeignKeyName=function(e,n,t){var r=e;return n&&(r=n+"."+r),t&&(r=t+"."+r),r},T.prototype.removeParenthesisFromDefault=function(e){if("("!==e.substr(0,1))return e;var n=e.substr(1,e.lastIndexOf(")")-1);return this.removeParenthesisFromDefault(n)},T.prototype.buildCreateColumnSql=function(e,n,t,r){var i='"'+n.name+'" '+this.connection.driver.createFullType(n);(n.enum&&(i+=" CHECK( "+n.name+" IN ("+n.enum.map(function(e){return"'"+e+"'"}).join(",")+") )"),n.collation&&(i+=" COLLATE "+n.collation),!0!==n.isNullable&&(i+=" NOT NULL"),!0!==n.isGenerated||"increment"!==n.generationStrategy||t||(i+=" IDENTITY(1,1)"),void 0!==n.default&&null!==n.default&&r)&&(i+=' CONSTRAINT "'+this.connection.namingStrategy.defaultConstraintName(e.name,n.name)+'" DEFAULT '+n.default);n.isGenerated&&"uuid"===n.generationStrategy&&!n.default&&(i+=' CONSTRAINT "'+this.connection.namingStrategy.defaultConstraintName(e.name,n.name)+'" DEFAULT NEWSEQUENTIALID()');return i},T.prototype.mssqlParameterToNativeParameter=function(n){var t,r,i,a,s,o,u,c,h,l;switch(this.driver.normalizeType({type:n.type})){case"bit":return this.driver.mssql.Bit;case"bigint":return this.driver.mssql.BigInt;case"decimal":return(t=this.driver.mssql).Decimal.apply(t,e.__spread(n.params));case"float":return this.driver.mssql.Float;case"int":return this.driver.mssql.Int;case"money":return this.driver.mssql.Money;case"numeric":return(r=this.driver.mssql).Numeric.apply(r,e.__spread(n.params));case"smallint":return this.driver.mssql.SmallInt;case"smallmoney":return this.driver.mssql.SmallMoney;case"real":return this.driver.mssql.Real;case"tinyint":return this.driver.mssql.TinyInt;case"char":return(i=this.driver.mssql).Char.apply(i,e.__spread(n.params));case"nchar":return(a=this.driver.mssql).NChar.apply(a,e.__spread(n.params));case"text":return this.driver.mssql.Text;case"ntext":return this.driver.mssql.Ntext;case"varchar":return(s=this.driver.mssql).VarChar.apply(s,e.__spread(n.params));case"nvarchar":return(o=this.driver.mssql).NVarChar.apply(o,e.__spread(n.params));case"xml":return this.driver.mssql.Xml;case"time":return(u=this.driver.mssql).Time.apply(u,e.__spread(n.params));case"date":return this.driver.mssql.Date;case"datetime":return this.driver.mssql.DateTime;case"datetime2":return(c=this.driver.mssql).DateTime2.apply(c,e.__spread(n.params));case"datetimeoffset":return(h=this.driver.mssql).DateTimeOffset.apply(h,e.__spread(n.params));case"smalldatetime":return this.driver.mssql.SmallDateTime;case"uniqueidentifier":return this.driver.mssql.UniqueIdentifier;case"variant":return this.driver.mssql.Variant;case"binary":return this.driver.mssql.Binary;case"varbinary":return(l=this.driver.mssql).VarBinary.apply(l,e.__spread(n.params));case"image":return this.driver.mssql.Image;case"udt":return this.driver.mssql.UDT;case"rowversion":return this.driver.mssql.RowVersion}},T.prototype.convertIsolationLevel=function(e){var n=this.driver.mssql.ISOLATION_LEVEL;switch(e){case"READ UNCOMMITTED":return n.READ_UNCOMMITTED;case"REPEATABLE READ":return n.REPEATABLE_READ;case"SERIALIZABLE":return n.SERIALIZABLE;case"READ COMMITTED":default:return n.READ_COMMITTED}},T}(s.BaseQueryRunner);exports.SqlServerQueryRunner=N;
},{"tslib":"c4AP","../../error/QueryFailedError":"U3oI","../../error/QueryRunnerAlreadyReleasedError":"CGt0","../../error/TransactionAlreadyStartedError":"kZCV","../../error/TransactionNotStartedError":"nZEx","../../index":"wlNf","../../query-runner/BaseQueryRunner":"GBOk","../../schema-builder/table/Table":"e+Cn","../../schema-builder/table/TableCheck":"oxtv","../../schema-builder/table/TableColumn":"SdPr","../../schema-builder/table/TableForeignKey":"0LZF","../../schema-builder/table/TableIndex":"S7W/","../../schema-builder/table/TableUnique":"9Ztg","../../schema-builder/view/View":"fSdu","../../subscriber/Broadcaster":"wiLV","../../util/OrmUtils":"R//v","../Query":"CMcp","./MssqlParameter":"FBTY"}],"iWm2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DateUtils=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var r=function(){function t(){}return t.normalizeHydratedDate=function(e){return e&&"string"==typeof e?new Date(e):e},t.mixedDateToDateString=function(e){return e instanceof Date?this.formatZerolessValue(e.getFullYear())+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate()):e},t.mixedDateToDate=function(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!0);var n="string"==typeof e?new Date(e):e;return t&&(n=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds())),r||n.setUTCMilliseconds(0),n},t.mixedDateToTimeString=function(e,t){return void 0===t&&(t=!1),e instanceof Date?this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+(t?"":":"+this.formatZerolessValue(e.getSeconds())):e},t.mixedTimeToDate=function(t){if("string"==typeof t){var r=e.__read(t.split(":"),3),n=r[0],s=r[1],i=r[2],o=new Date;return n&&o.setHours(parseInt(n)),s&&o.setMinutes(parseInt(s)),i&&o.setSeconds(parseInt(i)),o}return t},t.mixedTimeToString=function(e,t){return void 0===t&&(t=!1),"string"==typeof(e=e instanceof Date?e.getHours()+":"+e.getMinutes()+(t?"":":"+e.getSeconds()):e)?e.split(":").map(function(e){return 1===e.length?"0"+e:e}).join(":"):e},t.mixedDateToDatetimeString=function(e){return"string"==typeof e&&(e=new Date(e)),e instanceof Date?this.formatZerolessValue(e.getFullYear())+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate())+" "+this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+":"+this.formatZerolessValue(e.getSeconds())+"."+this.formatMilliseconds(e.getMilliseconds()):e},t.mixedDateToUtcDatetimeString=function(e){return"string"==typeof e&&(e=new Date(e)),e instanceof Date?this.formatZerolessValue(e.getUTCFullYear())+"-"+this.formatZerolessValue(e.getUTCMonth()+1)+"-"+this.formatZerolessValue(e.getUTCDate())+" "+this.formatZerolessValue(e.getUTCHours())+":"+this.formatZerolessValue(e.getUTCMinutes())+":"+this.formatZerolessValue(e.getUTCSeconds())+"."+this.formatMilliseconds(e.getUTCMilliseconds()):e},t.simpleArrayToString=function(e){return e instanceof Array?e.map(function(e){return String(e)}).join(","):e},t.stringToSimpleArray=function(e){return e instanceof String||"string"==typeof e?e.length>0?e.split(","):[]:e},t.simpleJsonToString=function(e){return JSON.stringify(e)},t.stringToSimpleJson=function(e){return"string"==typeof e?JSON.parse(e):e},t.simpleEnumToString=function(e){return""+e},t.stringToSimpleEnum=function(e,t){return t.enum&&!isNaN(e)&&t.enum.indexOf(parseInt(e))>=0&&(e=parseInt(e)),e},t.formatZerolessValue=function(e){return e<10?"0"+e:String(e)},t.formatMilliseconds=function(e){return e<10?"00"+e:e<100?"0"+e:String(e)},t}();exports.DateUtils=r;
},{"tslib":"c4AP"}],"HgFv":[function(require,module,exports) {

"use strict";var t=require("base64-js"),r=require("ieee754");exports.Buffer=o,exports.SlowBuffer=g,exports.INSPECT_MAX_BYTES=50;var e=2147483647;function n(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(r){return!1}}function i(t){if(t>e)throw new RangeError('The value "'+t+'" is invalid for option "size"');var r=new Uint8Array(t);return r.__proto__=o.prototype,r}function o(t,r,e){if("number"==typeof t){if("string"==typeof r)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return f(t,r,e)}function f(t,r,e){if("string"==typeof t)return a(t,r);if(ArrayBuffer.isView(t))return p(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Z(t,ArrayBuffer)||t&&Z(t.buffer,ArrayBuffer))return l(t,r,e);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return o.from(n,r,e);var i=c(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return o.from(t[Symbol.toPrimitive]("string"),r,e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function s(t,r,e){return u(t),t<=0?i(t):void 0!==r?"string"==typeof e?i(t).fill(r,e):i(t).fill(r):i(t)}function h(t){return u(t),i(t<0?0:0|y(t))}function a(t,r){if("string"==typeof r&&""!==r||(r="utf8"),!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var e=0|w(t,r),n=i(e),f=n.write(t,r);return f!==e&&(n=n.slice(0,f)),n}function p(t){for(var r=t.length<0?0:0|y(t.length),e=i(r),n=0;n<r;n+=1)e[n]=255&t[n];return e}function l(t,r,e){if(r<0||t.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<r+(e||0))throw new RangeError('"length" is outside of buffer bounds');var n;return(n=void 0===r&&void 0===e?new Uint8Array(t):void 0===e?new Uint8Array(t,r):new Uint8Array(t,r,e)).__proto__=o.prototype,n}function c(t){if(o.isBuffer(t)){var r=0|y(t.length),e=i(r);return 0===e.length?e:(t.copy(e,0,0,r),e)}return void 0!==t.length?"number"!=typeof t.length||$(t.length)?i(0):p(t):"Buffer"===t.type&&Array.isArray(t.data)?p(t.data):void 0}function y(t){if(t>=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+e.toString(16)+" bytes");return 0|t}function g(t){return+t!=t&&(t=0),o.alloc(+t)}function w(t,r){if(o.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Z(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var e=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===e)return 0;for(var i=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":return N(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return X(t).length;default:if(i)return n?-1:N(t).length;r=(""+r).toLowerCase(),i=!0}}function v(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,r,e);case"utf8":case"utf-8":return S(this,r,e);case"ascii":return x(this,r,e);case"latin1":case"binary":return C(this,r,e);case"base64":return I(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function d(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function b(t,r,e,n,i){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),$(e=+e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1}else if(e<0){if(!i)return-1;e=0}if("string"==typeof r&&(r=o.from(r,n)),o.isBuffer(r))return 0===r.length?-1:m(t,r,e,n,i);if("number"==typeof r)return r&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):m(t,[r],e,n,i);throw new TypeError("val must be string, number or Buffer")}function m(t,r,e,n,i){var o,f=1,u=t.length,s=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;f=2,u/=2,s/=2,e/=2}function h(t,r){return 1===f?t[r]:t.readUInt16BE(r*f)}if(i){var a=-1;for(o=e;o<u;o++)if(h(t,o)===h(r,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===s)return a*f}else-1!==a&&(o-=o-a),a=-1}else for(e+s>u&&(e=u-s),o=e;o>=0;o--){for(var p=!0,l=0;l<s;l++)if(h(t,o+l)!==h(r,l)){p=!1;break}if(p)return o}return-1}function E(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var o=r.length;n>o/2&&(n=o/2);for(var f=0;f<n;++f){var u=parseInt(r.substr(2*f,2),16);if($(u))return f;t[e+f]=u}return f}function B(t,r,e,n){return J(N(r,t.length-e),t,e,n)}function A(t,r,e,n){return J(V(r),t,e,n)}function U(t,r,e,n){return A(t,r,e,n)}function T(t,r,e,n){return J(X(r),t,e,n)}function _(t,r,e,n){return J(W(r,t.length-e),t,e,n)}function I(r,e,n){return 0===e&&n===r.length?t.fromByteArray(r):t.fromByteArray(r.slice(e,n))}function S(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;i<e;){var o,f,u,s,h=t[i],a=null,p=h>239?4:h>223?3:h>191?2:1;if(i+p<=e)switch(p){case 1:h<128&&(a=h);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&h)<<6|63&o)>127&&(a=s);break;case 3:o=t[i+1],f=t[i+2],128==(192&o)&&128==(192&f)&&(s=(15&h)<<12|(63&o)<<6|63&f)>2047&&(s<55296||s>57343)&&(a=s);break;case 4:o=t[i+1],f=t[i+2],u=t[i+3],128==(192&o)&&128==(192&f)&&128==(192&u)&&(s=(15&h)<<18|(63&o)<<12|(63&f)<<6|63&u)>65535&&s<1114112&&(a=s)}null===a?(a=65533,p=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=p}return L(n)}exports.kMaxLength=e,o.TYPED_ARRAY_SUPPORT=n(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192,o.from=function(t,r,e){return f(t,r,e)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,o.alloc=function(t,r,e){return s(t,r,e)},o.allocUnsafe=function(t){return h(t)},o.allocUnsafeSlow=function(t){return h(t)},o.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==o.prototype},o.compare=function(t,r){if(Z(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),Z(r,Uint8Array)&&(r=o.from(r,r.offset,r.byteLength)),!o.isBuffer(t)||!o.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===r)return 0;for(var e=t.length,n=r.length,i=0,f=Math.min(e,n);i<f;++i)if(t[i]!==r[i]){e=t[i],n=r[i];break}return e<n?-1:n<e?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,r){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var n=o.allocUnsafe(r),i=0;for(e=0;e<t.length;++e){var f=t[e];if(Z(f,Uint8Array)&&(f=o.from(f)),!o.isBuffer(f))throw new TypeError('"list" argument must be an Array of Buffers');f.copy(n,i),i+=f.length}return n},o.byteLength=w,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)d(this,r,r+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)d(this,r,r+3),d(this,r+1,r+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)d(this,r,r+7),d(this,r+1,r+6),d(this,r+2,r+5),d(this,r+3,r+4);return this},o.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?S(this,0,t):v.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",r=exports.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},o.prototype.compare=function(t,r,e,n,i){if(Z(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),r<0||e>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&r>=e)return 0;if(n>=i)return-1;if(r>=e)return 1;if(this===t)return 0;for(var f=(i>>>=0)-(n>>>=0),u=(e>>>=0)-(r>>>=0),s=Math.min(f,u),h=this.slice(n,i),a=t.slice(r,e),p=0;p<s;++p)if(h[p]!==a[p]){f=h[p],u=a[p];break}return f<u?-1:u<f?1:0},o.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},o.prototype.indexOf=function(t,r,e){return b(this,t,r,e,!0)},o.prototype.lastIndexOf=function(t,r,e){return b(this,t,r,e,!1)},o.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r>>>=0,isFinite(e)?(e>>>=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return E(this,t,r,e);case"utf8":case"utf-8":return B(this,t,r,e);case"ascii":return A(this,t,r,e);case"latin1":case"binary":return U(this,t,r,e);case"base64":return T(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var R=4096;function L(t){var r=t.length;if(r<=R)return String.fromCharCode.apply(String,t);for(var e="",n=0;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=R));return e}function x(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(127&t[i]);return n}function C(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n}function k(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;++o)i+=q(t[o]);return i}function O(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function M(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function P(t,r,e,n,i,f){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<f)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function z(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function j(t,e,n,i,o){return e=+e,n>>>=0,o||z(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),r.write(t,e,n,i,23,4),n+4}function D(t,e,n,i,o){return e=+e,n>>>=0,o||z(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),r.write(t,e,n,i,52,8),n+8}o.prototype.slice=function(t,r){var e=this.length;(t=~~t)<0?(t+=e)<0&&(t=0):t>e&&(t=e),(r=void 0===r?e:~~r)<0?(r+=e)<0&&(r=0):r>e&&(r=e),r<t&&(r=t);var n=this.subarray(t,r);return n.__proto__=o.prototype,n},o.prototype.readUIntLE=function(t,r,e){t>>>=0,r>>>=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n},o.prototype.readUIntBE=function(t,r,e){t>>>=0,r>>>=0,e||M(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n},o.prototype.readUInt8=function(t,r){return t>>>=0,r||M(t,1,this.length),this[t]},o.prototype.readUInt16LE=function(t,r){return t>>>=0,r||M(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUInt16BE=function(t,r){return t>>>=0,r||M(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUInt32LE=function(t,r){return t>>>=0,r||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUInt32BE=function(t,r){return t>>>=0,r||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,r,e){t>>>=0,r>>>=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*r)),n},o.prototype.readIntBE=function(t,r,e){t>>>=0,r>>>=0,e||M(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*r)),o},o.prototype.readInt8=function(t,r){return t>>>=0,r||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},o.prototype.readInt16LE=function(t,r){t>>>=0,r||M(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},o.prototype.readInt16BE=function(t,r){t>>>=0,r||M(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},o.prototype.readInt32LE=function(t,r){return t>>>=0,r||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,r){return t>>>=0,r||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return t>>>=0,e||M(t,4,this.length),r.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return t>>>=0,e||M(t,4,this.length),r.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return t>>>=0,e||M(t,8,this.length),r.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return t>>>=0,e||M(t,8,this.length),r.read(this,t,!1,52,8)},o.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r>>>=0,e>>>=0,n)||P(this,t,r,e,Math.pow(2,8*e)-1,0);var i=1,o=0;for(this[r]=255&t;++o<e&&(i*=256);)this[r+o]=t/i&255;return r+e},o.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r>>>=0,e>>>=0,n)||P(this,t,r,e,Math.pow(2,8*e)-1,0);var i=e-1,o=1;for(this[r+i]=255&t;--i>=0&&(o*=256);)this[r+i]=t/o&255;return r+e},o.prototype.writeUInt8=function(t,r,e){return t=+t,r>>>=0,e||P(this,t,r,1,255,0),this[r]=255&t,r+1},o.prototype.writeUInt16LE=function(t,r,e){return t=+t,r>>>=0,e||P(this,t,r,2,65535,0),this[r]=255&t,this[r+1]=t>>>8,r+2},o.prototype.writeUInt16BE=function(t,r,e){return t=+t,r>>>=0,e||P(this,t,r,2,65535,0),this[r]=t>>>8,this[r+1]=255&t,r+2},o.prototype.writeUInt32LE=function(t,r,e){return t=+t,r>>>=0,e||P(this,t,r,4,4294967295,0),this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t,r+4},o.prototype.writeUInt32BE=function(t,r,e){return t=+t,r>>>=0,e||P(this,t,r,4,4294967295,0),this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t,r+4},o.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r>>>=0,!n){var i=Math.pow(2,8*e-1);P(this,t,r,e,i-1,-i)}var o=0,f=1,u=0;for(this[r]=255&t;++o<e&&(f*=256);)t<0&&0===u&&0!==this[r+o-1]&&(u=1),this[r+o]=(t/f>>0)-u&255;return r+e},o.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r>>>=0,!n){var i=Math.pow(2,8*e-1);P(this,t,r,e,i-1,-i)}var o=e-1,f=1,u=0;for(this[r+o]=255&t;--o>=0&&(f*=256);)t<0&&0===u&&0!==this[r+o+1]&&(u=1),this[r+o]=(t/f>>0)-u&255;return r+e},o.prototype.writeInt8=function(t,r,e){return t=+t,r>>>=0,e||P(this,t,r,1,127,-128),t<0&&(t=255+t+1),this[r]=255&t,r+1},o.prototype.writeInt16LE=function(t,r,e){return t=+t,r>>>=0,e||P(this,t,r,2,32767,-32768),this[r]=255&t,this[r+1]=t>>>8,r+2},o.prototype.writeInt16BE=function(t,r,e){return t=+t,r>>>=0,e||P(this,t,r,2,32767,-32768),this[r]=t>>>8,this[r+1]=255&t,r+2},o.prototype.writeInt32LE=function(t,r,e){return t=+t,r>>>=0,e||P(this,t,r,4,2147483647,-2147483648),this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24,r+4},o.prototype.writeInt32BE=function(t,r,e){return t=+t,r>>>=0,e||P(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t,r+4},o.prototype.writeFloatLE=function(t,r,e){return j(this,t,r,!0,e)},o.prototype.writeFloatBE=function(t,r,e){return j(this,t,r,!1,e)},o.prototype.writeDoubleLE=function(t,r,e){return D(this,t,r,!0,e)},o.prototype.writeDoubleBE=function(t,r,e){return D(this,t,r,!1,e)},o.prototype.copy=function(t,r,e,n){if(!o.isBuffer(t))throw new TypeError("argument should be a Buffer");if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var i=n-e;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(r,e,n);else if(this===t&&e<r&&r<n)for(var f=i-1;f>=0;--f)t[f+r]=this[f+e];else Uint8Array.prototype.set.call(t,this.subarray(e,n),r);return i},o.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var i=t.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(t=i)}}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;var f;if(r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(f=r;f<e;++f)this[f]=t;else{var u=o.isBuffer(t)?t:o.from(t,n),s=u.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(f=0;f<e-r;++f)this[f+r]=u[f%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function Y(t){if((t=(t=t.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function q(t){return t<16?"0"+t.toString(16):t.toString(16)}function N(t,r){var e;r=r||1/0;for(var n=t.length,i=null,o=[],f=0;f<n;++f){if((e=t.charCodeAt(f))>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}if(f+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=65536+(i-55296<<10|e-56320)}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e)}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function V(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}function W(t,r){for(var e,n,i,o=[],f=0;f<t.length&&!((r-=2)<0);++f)n=(e=t.charCodeAt(f))>>8,i=e%256,o.push(i),o.push(n);return o}function X(r){return t.toByteArray(Y(r))}function J(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i}function Z(t,r){return t instanceof r||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===r.name}function $(t){return t!=t}
},{"base64-js":"cfBw","ieee754":"hMTg","buffer":"iHVs"}],"YF44":[function(require,module,exports) {
var global = arguments[3];
var n=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.Writable=exports.Readable=exports.EventEmitter=exports.PlatformTools=void 0;var e=function(){function e(){}return e.getGlobalVariable=function(){return"undefined"!=typeof window?window:n},e.load=function(n){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: require("'+n+'").');return""},e.pathNormalize=function(n){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: path.normalize("'+n+'").');return""},e.pathExtname=function(n){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: path.extname("'+n+'").');return""},e.pathResolve=function(n){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: path.resolve("'+n+'").');return""},e.fileExist=function(n){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: fs.existsSync("'+n+'").');return!1},e.getEnvVariable=function(n){},e.readFileSync=function(n){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: fs.readFileSync("'+n+'").');return null},e.appendFileSync=function(n,e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: fs.appendFileSync("'+n+'").')},e.writeFile=function(n,e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: fs.writeFile("'+n+'").');return Promise.reject(null)},e.highlightSql=function(n){return n},e.highlightJson=function(n){return n},e.logInfo=function(n,e){console.info(n+" ",e)},e.logError=function(n,e){console.error(n+" ",e)},e.logWarn=function(n,e){console.warn(n+" ",e)},e.log=function(n){console.log(n)},e.warn=function(n){return n},e.type="browser",e}();exports.PlatformTools=e;var r=function(){return function(){}}();exports.EventEmitter=r;var o=function(){return function(){}}();exports.Readable=o;var t=function(){return function(){}}();exports.Writable=t,"undefined"!=typeof window&&(window.Buffer=require("buffer/").Buffer),void 0!==n&&(n.Buffer=require("buffer/").Buffer);
},{"buffer/":"HgFv"}],"7vWf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CockroachQueryRunner=void 0;var e=y(require("tslib")),n=require("../../error/TransactionAlreadyStartedError"),t=require("../../error/TransactionNotStartedError"),r=require("../../schema-builder/table/TableColumn"),a=require("../../schema-builder/table/Table"),i=require("../../schema-builder/table/TableIndex"),s=require("../../schema-builder/table/TableForeignKey"),o=require("../../error/QueryRunnerAlreadyReleasedError"),u=require("../../schema-builder/view/View"),c=require("../Query"),l=require("../../error/QueryFailedError"),m=require("../../subscriber/Broadcaster"),h=require("../../schema-builder/table/TableUnique"),p=require("../../query-runner/BaseQueryRunner"),d=require("../../util/OrmUtils"),f=require("../../"),E=require("../../schema-builder/table/TableCheck"),T=require("../../schema-builder/table/TableExclusion");function y(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};r.get||r.set?Object.defineProperty(n,t,r):n[t]=e[t]}return n.default=e,n}var _=function(p){function y(e,n){void 0===n&&(n="master");var t=p.call(this)||this;return t.queries=[],t.storeQueries=!1,t.driver=e,t.connection=e.connection,t.mode=n,t.broadcaster=new m.Broadcaster(t),t}return e.__extends(y,p),y.prototype.connect=function(){var n=this;return this.databaseConnection?Promise.resolve(this.databaseConnection):this.databaseConnectionPromise?this.databaseConnectionPromise:("slave"===this.mode&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then(function(t){var r=e.__read(t,2),a=r[0],i=r[1];return n.driver.connectedQueryRunners.push(n),n.databaseConnection=a,n.releaseCallback=i,n.databaseConnection}):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then(function(t){var r=e.__read(t,2),a=r[0],i=r[1];return n.driver.connectedQueryRunners.push(n),n.databaseConnection=a,n.releaseCallback=i,n.databaseConnection}),this.databaseConnectionPromise)},y.prototype.release=function(){this.isReleased=!0,this.releaseCallback&&this.releaseCallback();var e=this.driver.connectedQueryRunners.indexOf(this);return-1!==e&&this.driver.connectedQueryRunners.splice(e),Promise.resolve()},y.prototype.startTransaction=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:if(this.isTransactionActive)throw new n.TransactionAlreadyStartedError;return this.isTransactionActive=!0,[4,this.query("START TRANSACTION")];case 1:return e.sent(),[4,this.query("SAVEPOINT cockroach_restart")];case 2:return e.sent(),t?[4,this.query("SET TRANSACTION ISOLATION LEVEL "+t)]:[3,4];case 3:e.sent(),e.label=4;case 4:return this.storeQueries=!0,[2]}})})},y.prototype.commitTransaction=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(e){switch(e.label){case 0:if(!this.isTransactionActive)throw new t.TransactionNotStartedError;this.storeQueries=!1,e.label=1;case 1:return e.trys.push([1,4,,9]),[4,this.query("RELEASE SAVEPOINT cockroach_restart")];case 2:return e.sent(),[4,this.query("COMMIT")];case 3:return e.sent(),this.queries=[],this.isTransactionActive=!1,[3,9];case 4:return"40001"!==e.sent().code?[3,8]:[4,this.query("ROLLBACK TO SAVEPOINT cockroach_restart")];case 5:return e.sent(),[4,f.PromiseUtils.runInSequence(this.queries,function(e){return n.query(e.query,e.parameters)})];case 6:return e.sent(),[4,this.commitTransaction()];case 7:e.sent(),e.label=8;case 8:return[3,9];case 9:return[2]}})})},y.prototype.rollbackTransaction=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:if(!this.isTransactionActive)throw new t.TransactionNotStartedError;return this.storeQueries=!1,[4,this.query("ROLLBACK")];case 1:return e.sent(),this.queries=[],this.isTransactionActive=!1,[2]}})})},y.prototype.query=function(n,t,r){var a=this;if(this.isReleased)throw new o.QueryRunnerAlreadyReleasedError;return new Promise(function(r,i){return e.__awaiter(a,void 0,void 0,function(){var a,s,o,u=this;return e.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.connect()];case 1:return a=e.sent(),this.driver.connection.logger.logQuery(n,t,this),s=+new Date,a.query(n,t,function(e,a){u.isTransactionActive&&u.storeQueries&&u.queries.push({query:n,parameters:t});var o=u.driver.connection.options.maxQueryExecutionTime,c=+new Date-s;if(o&&c>o&&u.driver.connection.logger.logQuerySlow(c,n,t,u),e)"40001"!==e.code&&u.driver.connection.logger.logQueryError(e,n,t,u),i(new l.QueryFailedError(n,t,e));else switch(a.command){case"DELETE":r([a.rows,a.rowCount]);break;default:r(a.rows)}}),[3,3];case 2:return o=e.sent(),i(o),[3,3];case 3:return[2]}})})})},y.prototype.stream=function(n,t,r,a){var i=this,s=this.driver.loadStreamDependency();if(this.isReleased)throw new o.QueryRunnerAlreadyReleasedError;return new Promise(function(o,u){return e.__awaiter(i,void 0,void 0,function(){var i,c,l;return e.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.connect()];case 1:return i=e.sent(),this.driver.connection.logger.logQuery(n,t,this),c=i.query(new s(n,t)),r&&c.on("end",r),a&&c.on("error",a),o(c),[3,3];case 2:return l=e.sent(),u(l),[3,3];case 3:return[2]}})})})},y.prototype.getDatabases=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve([])]})})},y.prototype.getSchemas=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve([])]})})},y.prototype.hasDatabase=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.query('SELECT * FROM "pg_database" WHERE "datname" = \''+n+"'")];case 1:return[2,!!e.sent().length]}})})},y.prototype.hasSchema=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.query('SELECT * FROM "information_schema"."schemata" WHERE "schema_name" = \''+n+"'")];case 1:return[2,!!e.sent().length]}})})},y.prototype.hasTable=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r;return e.__generator(this,function(e){switch(e.label){case 0:return t=this.parseTableName(n),r='SELECT * FROM "information_schema"."tables" WHERE "table_schema" = '+t.schema+' AND "table_name" = '+t.tableName,[4,this.query(r)];case 1:return[2,!!e.sent().length]}})})},y.prototype.hasColumn=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a;return e.__generator(this,function(e){switch(e.label){case 0:return r=this.parseTableName(n),a='SELECT * FROM "information_schema"."columns" WHERE "table_schema" = '+r.schema+' AND "table_name" = '+r.tableName+' AND "column_name" = \''+t+"'",[4,this.query(a)];case 1:return[2,!!e.sent().length]}})})},y.prototype.createDatabase=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a;return e.__generator(this,function(e){switch(e.label){case 0:return r="CREATE DATABASE "+(t?"IF NOT EXISTS ":"")+' "'+n+'"',a='DROP DATABASE "'+n+'"',[4,this.executeQueries(new c.Query(r),new c.Query(a))];case 1:return e.sent(),[2]}})})},y.prototype.dropDatabase=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a;return e.__generator(this,function(e){switch(e.label){case 0:return r="DROP DATABASE "+(t?"IF EXISTS ":"")+' "'+n+'"',a='CREATE DATABASE "'+n+'"',[4,this.executeQueries(new c.Query(r),new c.Query(a))];case 1:return e.sent(),[2]}})})},y.prototype.createSchema=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a;return e.__generator(this,function(e){switch(e.label){case 0:return r=t?'CREATE SCHEMA IF NOT EXISTS "'+n+'"':'CREATE SCHEMA "'+n+'"',a='DROP SCHEMA "'+n+'" CASCADE',[4,this.executeQueries(new c.Query(r),new c.Query(a))];case 1:return e.sent(),[2]}})})},y.prototype.dropSchema=function(n,t,r){return e.__awaiter(this,void 0,void 0,function(){var a,i,s;return e.__generator(this,function(e){switch(e.label){case 0:return a=-1===n.indexOf(".")?n:n.split(".")[0],i=t?'DROP SCHEMA IF EXISTS "'+a+'" '+(r?"CASCADE":""):'DROP SCHEMA "'+a+'" '+(r?"CASCADE":""),s='CREATE SCHEMA "'+a+'"',[4,this.executeQueries(new c.Query(i),new c.Query(s))];case 1:return e.sent(),[2]}})})},y.prototype.createTable=function(n,t,r,a){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===a&&(a=!0),e.__awaiter(this,void 0,void 0,function(){var i,s,o=this;return e.__generator(this,function(e){switch(e.label){case 0:return t?[4,this.hasTable(n)]:[3,2];case 1:if(e.sent())return[2,Promise.resolve()];e.label=2;case 2:return i=[],s=[],n.columns.filter(function(e){return e.isGenerated&&"increment"===e.generationStrategy}).forEach(function(e){i.push(new c.Query("CREATE SEQUENCE "+o.buildSequenceName(n,e))),s.push(new c.Query("DROP SEQUENCE "+o.buildSequenceName(n,e)))}),i.push(this.createTableSql(n,r)),s.push(this.dropTableSql(n)),r&&n.foreignKeys.forEach(function(e){return s.push(o.dropForeignKeySql(n,e))}),a&&n.indices.filter(function(e){return!e.isUnique}).forEach(function(e){e.name||(e.name=o.connection.namingStrategy.indexName(n.name,e.columnNames,e.where)),i.push(o.createIndexSql(n,e)),s.push(o.dropIndexSql(n,e))}),[4,this.executeQueries(i,s)];case 3:return e.sent(),[2]}})})},y.prototype.dropTable=function(n,t,r,i){return void 0===r&&(r=!0),void 0===i&&(i=!0),e.__awaiter(this,void 0,void 0,function(){var s,o,u,l,m,h=this;return e.__generator(this,function(e){switch(e.label){case 0:return t?[4,this.hasTable(n)]:[3,2];case 1:if(!e.sent())return[2,Promise.resolve()];e.label=2;case 2:return s=r,o=n instanceof a.Table?n.name:n,[4,this.getCachedTable(o)];case 3:return u=e.sent(),l=[],m=[],r&&u.foreignKeys.forEach(function(e){return l.push(h.dropForeignKeySql(u,e))}),i&&u.indices.forEach(function(e){l.push(h.dropIndexSql(u,e)),m.push(h.createIndexSql(u,e))}),l.push(this.dropTableSql(u)),m.push(this.createTableSql(u,s)),u.columns.filter(function(e){return e.isGenerated&&"increment"===e.generationStrategy}).forEach(function(e){l.push(new c.Query("DROP SEQUENCE "+h.buildSequenceName(u,e))),m.push(new c.Query("CREATE SEQUENCE "+h.buildSequenceName(u,e)))}),[4,this.executeQueries(l,m)];case 4:return e.sent(),[2]}})})},y.prototype.createView=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,a,i,s,o;return e.__generator(this,function(e){switch(e.label){case 0:return r=[],(t=[]).push(this.createViewSql(n)),i=(a=t).push,[4,this.insertViewDefinitionSql(n)];case 1:return i.apply(a,[e.sent()]),r.push(this.dropViewSql(n)),o=(s=r).push,[4,this.deleteViewDefinitionSql(n)];case 2:return o.apply(s,[e.sent()]),[4,this.executeQueries(t,r)];case 3:return e.sent(),[2]}})})},y.prototype.dropView=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,a,i,s,o,c,l;return e.__generator(this,function(e){switch(e.label){case 0:return t=n instanceof u.View?n.name:n,[4,this.getCachedView(t)];case 1:return r=e.sent(),i=[],o=(s=a=[]).push,[4,this.deleteViewDefinitionSql(r)];case 2:return o.apply(s,[e.sent()]),a.push(this.dropViewSql(r)),l=(c=i).push,[4,this.insertViewDefinitionSql(r)];case 3:return l.apply(c,[e.sent()]),i.push(this.createViewSql(r)),[4,this.executeQueries(a,i)];case 4:return e.sent(),[2]}})})},y.prototype.renameTable=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,s,o,u,l,m,h,p,d,f=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=[],i=[],n instanceof a.Table?(o=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:o=e.sent(),e.label=3;case 3:return u=(s=o).clone(),l=-1===s.name.indexOf(".")?s.name:s.name.split(".")[1],m=-1===s.name.indexOf(".")?void 0:s.name.split(".")[0],u.name=m?m+"."+t:t,r.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' RENAME TO "'+t+'"')),i.push(new c.Query("ALTER TABLE "+this.escapePath(u)+' RENAME TO "'+l+'"')),u.primaryColumns.length>0&&(h=u.primaryColumns.map(function(e){return e.name}),p=this.connection.namingStrategy.primaryKeyName(s,h),d=this.connection.namingStrategy.primaryKeyName(u,h),r.push(new c.Query("ALTER TABLE "+this.escapePath(u)+' RENAME CONSTRAINT "'+p+'" TO "'+d+'"')),i.push(new c.Query("ALTER TABLE "+this.escapePath(u)+' RENAME CONSTRAINT "'+d+'" TO "'+p+'"'))),u.uniques.forEach(function(e){var n=f.connection.namingStrategy.uniqueConstraintName(u,e.columnNames);r.push(new c.Query("ALTER TABLE "+f.escapePath(u)+' RENAME CONSTRAINT "'+e.name+'" TO "'+n+'"')),i.push(new c.Query("ALTER TABLE "+f.escapePath(u)+' RENAME CONSTRAINT "'+n+'" TO "'+e.name+'"')),e.name=n}),u.indices.forEach(function(e){var n=f.extractSchema(u),t=f.connection.namingStrategy.indexName(u,e.columnNames,e.where),a=n?'ALTER INDEX "'+n+'"."'+e.name+'" RENAME TO "'+t+'"':'ALTER INDEX "'+e.name+'" RENAME TO "'+t+'"',s=n?'ALTER INDEX "'+n+'"."'+t+'" RENAME TO "'+e.name+'"':'ALTER INDEX "'+t+'" RENAME TO "'+e.name+'"';r.push(new c.Query(a)),i.push(new c.Query(s)),e.name=t}),u.foreignKeys.forEach(function(e){var n=f.connection.namingStrategy.foreignKeyName(u,e.columnNames);r.push(new c.Query("ALTER TABLE "+f.escapePath(u)+' RENAME CONSTRAINT "'+e.name+'" TO "'+n+'"')),i.push(new c.Query("ALTER TABLE "+f.escapePath(u)+' RENAME CONSTRAINT "'+n+'" TO "'+e.name+'"')),e.name=n}),[4,this.executeQueries(r,i)];case 4:return e.sent(),[2]}})})},y.prototype.addColumn=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,s,o,u,l,m,p,d,f,E,T,y;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:if(s=(r=i).clone(),o=[],u=[],"increment"===t.generationStrategy)throw new Error("Adding sequential generated columns into existing table is not supported");return o.push(new c.Query("ALTER TABLE "+this.escapePath(r)+" ADD "+this.buildCreateColumnSql(r,t))),u.push(new c.Query("ALTER TABLE "+this.escapePath(r)+' DROP COLUMN "'+t.name+'"')),t.isPrimary&&((l=s.primaryColumns).length>0&&(m=this.connection.namingStrategy.primaryKeyName(s.name,l.map(function(e){return e.name})),p=l.map(function(e){return'"'+e.name+'"'}).join(", "),o.push(new c.Query("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+m+'"')),u.push(new c.Query("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+m+'" PRIMARY KEY ('+p+")"))),l.push(t),d=this.connection.namingStrategy.primaryKeyName(s.name,l.map(function(e){return e.name})),f=l.map(function(e){return'"'+e.name+'"'}).join(", "),o.push(new c.Query("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+d+'" PRIMARY KEY ('+f+")")),u.push(new c.Query("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+d+'"'))),(E=s.indices.find(function(e){return 1===e.columnNames.length&&e.columnNames[0]===t.name}))&&(E.isUnique?(T=new h.TableUnique({name:this.connection.namingStrategy.uniqueConstraintName(r.name,E.columnNames),columnNames:E.columnNames}),o.push(this.createUniqueConstraintSql(r,T)),u.push(this.dropIndexSql(r,T)),s.uniques.push(T)):(o.push(this.createIndexSql(r,E)),u.push(this.dropIndexSql(r,E)))),t.isUnique&&(y=new h.TableUnique({name:this.connection.namingStrategy.uniqueConstraintName(r.name,[t.name]),columnNames:[t.name]}),s.uniques.push(y),o.push(this.createUniqueConstraintSql(r,y)),u.push(this.dropIndexSql(r,y.name))),[4,this.executeQueries(o,u)];case 4:return e.sent(),s.addColumn(t),this.replaceCachedTable(r,s),[2]}})})},y.prototype.addColumns=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,f.PromiseUtils.runInSequence(t,function(e){return r.addColumn(n,e)})];case 1:return e.sent(),[2]}})})},y.prototype.renameColumn=function(n,t,i){return e.__awaiter(this,void 0,void 0,function(){var s,o,u,c;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(o=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:o=e.sent(),e.label=3;case 3:if(s=o,!(u=t instanceof r.TableColumn?t:s.columns.find(function(e){return e.name===t})))throw new Error('Column "'+t+'" was not found in the "'+s.name+'" table.');return i instanceof r.TableColumn?c=i:(c=u.clone()).name=i,[2,this.changeColumn(s,u,c)]}})})},y.prototype.changeColumn=function(n,t,i){return e.__awaiter(this,void 0,void 0,function(){var s,o,u,l,m,p,d,f,E,T,y,_,N,A,C=this;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(o=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:o=e.sent(),e.label=3;case 3:if(u=(s=o).clone(),l=[],m=[],!(p=t instanceof r.TableColumn?t:s.columns.find(function(e){return e.name===t})))throw new Error('Column "'+t+'" was not found in the "'+s.name+'" table.');return p.type===i.type&&p.length===i.length?[3,6]:[4,this.dropColumn(s,p)];case 4:return e.sent(),[4,this.addColumn(s,i)];case 5:return e.sent(),u=s.clone(),[3,7];case 6:if(p.name!==i.name&&(l.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' RENAME COLUMN "'+p.name+'" TO "'+i.name+'"')),m.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' RENAME COLUMN "'+i.name+'" TO "'+p.name+'"')),!0===p.isPrimary&&(T=u.primaryColumns,N=T.map(function(e){return e.name}),d=this.connection.namingStrategy.primaryKeyName(u,N),N.splice(N.indexOf(p.name),1),N.push(i.name),f=this.connection.namingStrategy.primaryKeyName(u,N),l.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' RENAME CONSTRAINT "'+d+'" TO "'+f+'"')),m.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' RENAME CONSTRAINT "'+f+'" TO "'+d+'"'))),u.findColumnUniques(p).forEach(function(e){e.columnNames.splice(e.columnNames.indexOf(p.name),1),e.columnNames.push(i.name);var n=C.connection.namingStrategy.uniqueConstraintName(u,e.columnNames);l.push(new c.Query("ALTER TABLE "+C.escapePath(s)+' RENAME CONSTRAINT "'+e.name+'" TO "'+n+'"')),m.push(new c.Query("ALTER TABLE "+C.escapePath(s)+' RENAME CONSTRAINT "'+n+'" TO "'+e.name+'"')),e.name=n}),u.findColumnIndices(p).forEach(function(e){e.columnNames.splice(e.columnNames.indexOf(p.name),1),e.columnNames.push(i.name);var n=C.extractSchema(s),t=C.connection.namingStrategy.indexName(u,e.columnNames,e.where),r=n?'ALTER INDEX "'+n+'"."'+e.name+'" RENAME TO "'+t+'"':'ALTER INDEX "'+e.name+'" RENAME TO "'+t+'"',a=n?'ALTER INDEX "'+n+'"."'+t+'" RENAME TO "'+e.name+'"':'ALTER INDEX "'+t+'" RENAME TO "'+e.name+'"';l.push(new c.Query(r)),m.push(new c.Query(a)),e.name=t}),u.findColumnForeignKeys(p).forEach(function(e){e.columnNames.splice(e.columnNames.indexOf(p.name),1),e.columnNames.push(i.name);var n=C.connection.namingStrategy.foreignKeyName(u,e.columnNames);l.push(new c.Query("ALTER TABLE "+C.escapePath(s)+' RENAME CONSTRAINT "'+e.name+'" TO "'+n+'"')),m.push(new c.Query("ALTER TABLE "+C.escapePath(s)+' RENAME CONSTRAINT "'+n+'" TO "'+e.name+'"')),e.name=n}),E=u.columns.find(function(e){return e.name===p.name}),u.columns[u.columns.indexOf(E)].name=i.name,p.name=i.name),i.precision===p.precision&&i.scale===p.scale||(l.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+i.name+'" TYPE '+this.driver.createFullType(i))),m.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+i.name+'" TYPE '+this.driver.createFullType(p)))),p.isNullable!==i.isNullable&&(i.isNullable?(l.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+p.name+'" DROP NOT NULL')),m.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+p.name+'" SET NOT NULL'))):(l.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+p.name+'" SET NOT NULL')),m.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+p.name+'" DROP NOT NULL')))),p.comment!==i.comment&&(l.push(new c.Query("COMMENT ON COLUMN "+this.escapePath(s)+'."'+p.name+"\" IS '"+i.comment+"'")),m.push(new c.Query("COMMENT ON COLUMN "+this.escapePath(s)+'."'+i.name+"\" IS '"+p.comment+"'"))),i.isPrimary!==p.isPrimary&&((T=u.primaryColumns).length>0&&(_=this.connection.namingStrategy.primaryKeyName(u.name,T.map(function(e){return e.name})),N=T.map(function(e){return'"'+e.name+'"'}).join(", "),l.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' DROP CONSTRAINT "'+_+'"')),m.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ADD CONSTRAINT "'+_+'" PRIMARY KEY ('+N+")"))),!0===i.isPrimary?(T.push(i),u.columns.find(function(e){return e.name===i.name}).isPrimary=!0,_=this.connection.namingStrategy.primaryKeyName(u.name,T.map(function(e){return e.name})),N=T.map(function(e){return'"'+e.name+'"'}).join(", "),l.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ADD CONSTRAINT "'+_+'" PRIMARY KEY ('+N+")")),m.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' DROP CONSTRAINT "'+_+'"'))):(y=T.find(function(e){return e.name===i.name}),T.splice(T.indexOf(y),1),u.columns.find(function(e){return e.name===i.name}).isPrimary=!1,T.length>0&&(_=this.connection.namingStrategy.primaryKeyName(u.name,T.map(function(e){return e.name})),N=T.map(function(e){return'"'+e.name+'"'}).join(", "),l.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ADD CONSTRAINT "'+_+'" PRIMARY KEY ('+N+")")),m.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' DROP CONSTRAINT "'+_+'"'))))),i.isUnique!==p.isUnique&&(i.isUnique?(A=new h.TableUnique({name:this.connection.namingStrategy.uniqueConstraintName(s.name,[i.name]),columnNames:[i.name]}),u.uniques.push(A),l.push(this.createUniqueConstraintSql(s,A)),m.push(this.dropIndexSql(s,A))):(A=u.uniques.find(function(e){return 1===e.columnNames.length&&!!e.columnNames.find(function(e){return e===i.name})}),u.uniques.splice(u.uniques.indexOf(A),1),l.push(this.dropIndexSql(s,A)),m.push(this.createUniqueConstraintSql(s,A)))),p.isGenerated!==i.isGenerated&&"uuid"!==i.generationStrategy)if(i.isGenerated){if("increment"===i.generationStrategy)throw new Error("Adding sequential generated columns into existing table is not supported");"rowid"===i.generationStrategy&&(l.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+i.name+'" SET DEFAULT unique_rowid()')),m.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+i.name+'" DROP DEFAULT')))}else l.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+i.name+'" DROP DEFAULT')),m.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+i.name+'" SET DEFAULT unique_rowid()'));i.default!==p.default&&(null!==i.default&&void 0!==i.default?(l.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+i.name+'" SET DEFAULT '+i.default)),null!==p.default&&void 0!==p.default?m.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+i.name+'" SET DEFAULT '+p.default)):m.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+i.name+'" DROP DEFAULT'))):null!==p.default&&void 0!==p.default&&(l.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+i.name+'" DROP DEFAULT')),m.push(new c.Query("ALTER TABLE "+this.escapePath(s)+' ALTER COLUMN "'+i.name+'" SET DEFAULT '+p.default)))),e.label=7;case 7:return[4,this.executeQueries(l,m)];case 8:return e.sent(),this.replaceCachedTable(s,u),[2]}})})},y.prototype.changeColumns=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,f.PromiseUtils.runInSequence(t,function(e){return r.changeColumn(n,e.oldColumn,e.newColumn)})];case 1:return e.sent(),[2]}})})},y.prototype.dropColumn=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var i,s,o,u,l,m,h,p,d,f,E,T,y;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(s=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:s=e.sent(),e.label=3;case 3:if(i=s,!(o=t instanceof r.TableColumn?t:i.findColumnByName(t)))throw new Error('Column "'+t+'" was not found in table "'+i.name+'"');return u=i.clone(),l=[],m=[],o.isPrimary&&(h=this.connection.namingStrategy.primaryKeyName(u.name,u.primaryColumns.map(function(e){return e.name})),p=u.primaryColumns.map(function(e){return'"'+e.name+'"'}).join(", "),l.push(new c.Query("ALTER TABLE "+this.escapePath(u)+' DROP CONSTRAINT "'+h+'"')),m.push(new c.Query("ALTER TABLE "+this.escapePath(u)+' ADD CONSTRAINT "'+h+'" PRIMARY KEY ('+p+")")),u.findColumnByName(o.name).isPrimary=!1,u.primaryColumns.length>0&&(d=this.connection.namingStrategy.primaryKeyName(u.name,u.primaryColumns.map(function(e){return e.name})),f=u.primaryColumns.map(function(e){return'"'+e.name+'"'}).join(", "),l.push(new c.Query("ALTER TABLE "+this.escapePath(u)+' ADD CONSTRAINT "'+d+'" PRIMARY KEY ('+f+")")),m.push(new c.Query("ALTER TABLE "+this.escapePath(u)+' DROP CONSTRAINT "'+d+'"')))),(E=u.indices.find(function(e){return 1===e.columnNames.length&&e.columnNames[0]===o.name}))&&(u.indices.splice(u.indices.indexOf(E),1),l.push(this.dropIndexSql(i,E)),m.push(this.createIndexSql(i,E))),(T=u.checks.find(function(e){return!!e.columnNames&&1===e.columnNames.length&&e.columnNames[0]===o.name}))&&(u.checks.splice(u.checks.indexOf(T),1),l.push(this.dropCheckConstraintSql(i,T)),m.push(this.createCheckConstraintSql(i,T))),(y=u.uniques.find(function(e){return 1===e.columnNames.length&&e.columnNames[0]===o.name}))&&(u.uniques.splice(u.uniques.indexOf(y),1),l.push(this.dropIndexSql(i,y.name)),m.push(this.createUniqueConstraintSql(i,y))),l.push(new c.Query("ALTER TABLE "+this.escapePath(i)+' DROP COLUMN "'+o.name+'"')),m.push(new c.Query("ALTER TABLE "+this.escapePath(i)+" ADD "+this.buildCreateColumnSql(i,o))),"increment"===o.generationStrategy&&(l.push(new c.Query("DROP SEQUENCE "+this.buildSequenceName(i,o))),m.push(new c.Query("CREATE SEQUENCE "+this.buildSequenceName(i,o)))),[4,this.executeQueries(l,m)];case 4:return e.sent(),u.removeColumn(o),this.replaceCachedTable(i,u),[2]}})})},y.prototype.dropColumns=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,f.PromiseUtils.runInSequence(t,function(e){return r.dropColumn(n,e)})];case 1:return e.sent(),[2]}})})},y.prototype.createPrimaryKey=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,s,o,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return s=(r=i).clone(),o=this.createPrimaryKeySql(r,t),s.columns.forEach(function(e){t.find(function(n){return n===e.name})&&(e.isPrimary=!0)}),u=this.dropPrimaryKeySql(s),[4,this.executeQueries(o,u)];case 4:return e.sent(),this.replaceCachedTable(r,s),[2]}})})},y.prototype.updatePrimaryKeys=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,s,o,u,l,m,h,p,d,f;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return s=(r=i).clone(),o=t.map(function(e){return e.name}),u=[],l=[],(m=s.primaryColumns).length>0&&(h=this.connection.namingStrategy.primaryKeyName(s.name,m.map(function(e){return e.name})),p=m.map(function(e){return'"'+e.name+'"'}).join(", "),u.push(new c.Query("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+h+'"')),l.push(new c.Query("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+h+'" PRIMARY KEY ('+p+")"))),s.columns.filter(function(e){return-1!==o.indexOf(e.name)}).forEach(function(e){return e.isPrimary=!0}),d=this.connection.namingStrategy.primaryKeyName(s.name,o),f=o.map(function(e){return'"'+e+'"'}).join(", "),u.push(new c.Query("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+d+'" PRIMARY KEY ('+f+")")),l.push(new c.Query("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+d+'"')),[4,this.executeQueries(u,l)];case 4:return e.sent(),this.replaceCachedTable(r,s),[2]}})})},y.prototype.dropPrimaryKey=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,s;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(r=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:r=e.sent(),e.label=3;case 3:return t=r,i=this.dropPrimaryKeySql(t),s=this.createPrimaryKeySql(t,t.primaryColumns.map(function(e){return e.name})),[4,this.executeQueries(i,s)];case 4:return e.sent(),t.primaryColumns.forEach(function(e){e.isPrimary=!1}),[2]}})})},y.prototype.createUniqueConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,s,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return r=i,t.name||(t.name=this.connection.namingStrategy.uniqueConstraintName(r.name,t.columnNames)),s=this.createUniqueConstraintSql(r,t),o=this.dropIndexSql(r,t),[4,this.executeQueries(s,o)];case 4:return e.sent(),r.addUniqueConstraint(t),[2]}})})},y.prototype.createUniqueConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,f.PromiseUtils.runInSequence(t,function(e){return r.createUniqueConstraint(n,e)})];case 1:return e.sent(),[2]}})})},y.prototype.dropUniqueConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,s,o,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:if(r=i,!(s=t instanceof h.TableUnique?t:r.uniques.find(function(e){return e.name===t})))throw new Error("Supplied unique constraint was not found in table "+r.name);return o=this.dropIndexSql(r,s),u=this.createUniqueConstraintSql(r,s),[4,this.executeQueries(o,u)];case 4:return e.sent(),r.removeUniqueConstraint(s),[2]}})})},y.prototype.dropUniqueConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,f.PromiseUtils.runInSequence(t,function(e){return r.dropUniqueConstraint(n,e)})];case 1:return e.sent(),[2]}})})},y.prototype.createCheckConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,s,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return r=i,t.name||(t.name=this.connection.namingStrategy.checkConstraintName(r.name,t.expression)),s=this.createCheckConstraintSql(r,t),o=this.dropCheckConstraintSql(r,t),[4,this.executeQueries(s,o)];case 4:return e.sent(),r.addCheckConstraint(t),[2]}})})},y.prototype.createCheckConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return a.createCheckConstraint(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},y.prototype.dropCheckConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,s,o,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:if(r=i,!(s=t instanceof E.TableCheck?t:r.checks.find(function(e){return e.name===t})))throw new Error("Supplied check constraint was not found in table "+r.name);return o=this.dropCheckConstraintSql(r,s),u=this.createCheckConstraintSql(r,s),[4,this.executeQueries(o,u)];case 4:return e.sent(),r.removeCheckConstraint(s),[2]}})})},y.prototype.dropCheckConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return a.dropCheckConstraint(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},y.prototype.createExclusionConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("CockroachDB does not support exclusion constraints.")})})},y.prototype.createExclusionConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("CockroachDB does not support exclusion constraints.")})})},y.prototype.dropExclusionConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("CockroachDB does not support exclusion constraints.")})})},y.prototype.dropExclusionConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("CockroachDB does not support exclusion constraints.")})})},y.prototype.createForeignKey=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,s,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return r=i,t.name||(t.name=this.connection.namingStrategy.foreignKeyName(r.name,t.columnNames)),s=this.createForeignKeySql(r,t),o=this.dropForeignKeySql(r,t),[4,this.executeQueries(s,o)];case 4:return e.sent(),r.addForeignKey(t),[2]}})})},y.prototype.createForeignKeys=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,f.PromiseUtils.runInSequence(t,function(e){return r.createForeignKey(n,e)})];case 1:return e.sent(),[2]}})})},y.prototype.dropForeignKey=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o,u,c;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:if(r=i,!(o=t instanceof s.TableForeignKey?t:r.foreignKeys.find(function(e){return e.name===t})))throw new Error("Supplied foreign key was not found in table "+r.name);return u=this.dropForeignKeySql(r,o),c=this.createForeignKeySql(r,o),[4,this.executeQueries(u,c)];case 4:return e.sent(),r.removeForeignKey(o),[2]}})})},y.prototype.dropForeignKeys=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,f.PromiseUtils.runInSequence(t,function(e){return r.dropForeignKey(n,e)})];case 1:return e.sent(),[2]}})})},y.prototype.createIndex=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,s,o,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return r=i,t.name||(t.name=this.connection.namingStrategy.indexName(r.name,t.columnNames,t.where)),t.isUnique?(s=new h.TableUnique({name:t.name,columnNames:t.columnNames}),o=this.createUniqueConstraintSql(r,s),u=this.dropIndexSql(r,s),[4,this.executeQueries(o,u)]):[3,5];case 4:return e.sent(),r.addUniqueConstraint(s),[3,7];case 5:return o=this.createIndexSql(r,t),u=this.dropIndexSql(r,t),[4,this.executeQueries(o,u)];case 6:e.sent(),r.addIndex(t),e.label=7;case 7:return[2]}})})},y.prototype.createIndices=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,f.PromiseUtils.runInSequence(t,function(e){return r.createIndex(n,e)})];case 1:return e.sent(),[2]}})})},y.prototype.dropIndex=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,s,o,u,c;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(s=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:s=e.sent(),e.label=3;case 3:if(r=s,!(o=t instanceof i.TableIndex?t:r.indices.find(function(e){return e.name===t})))throw new Error("Supplied index was not found in table "+r.name);return u=this.dropIndexSql(r,o),c=this.createIndexSql(r,o),[4,this.executeQueries(u,c)];case 4:return e.sent(),r.removeIndex(o),[2]}})})},y.prototype.dropIndices=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,f.PromiseUtils.runInSequence(t,function(e){return r.dropIndex(n,e)})];case 1:return e.sent(),[2]}})})},y.prototype.clearTable=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.query("TRUNCATE TABLE "+this.escapePath(n))];case 1:return e.sent(),[2]}})})},y.prototype.clearDatabase=function(){return e.__awaiter(this,void 0,void 0,function(){var n,t,r,a,i,s,o,u,c,l=this;return e.__generator(this,function(e){switch(e.label){case 0:return n=[],this.connection.entityMetadatas.filter(function(e){return e.schema}).forEach(function(e){!!n.find(function(n){return n===e.schema})||n.push(e.schema)}),n.push(this.driver.options.schema||"current_schema()"),t=n.map(function(e){return"current_schema()"===e?e:"'"+e+"'"}).join(", "),[4,this.startTransaction()];case 1:e.sent(),e.label=2;case 2:return e.trys.push([2,10,,15]),r='SELECT \'DROP VIEW IF EXISTS "\' || schemaname || \'"."\' || viewname || \'" CASCADE;\' as "query" FROM "pg_views" WHERE "schemaname" IN ('+t+")",[4,this.query(r)];case 3:return a=e.sent(),[4,Promise.all(a.map(function(e){return l.query(e.query)}))];case 4:return e.sent(),i='SELECT \'DROP TABLE IF EXISTS "\' || table_schema || \'"."\' || table_name || \'" CASCADE;\' as "query" FROM "information_schema"."tables" WHERE "table_schema" IN ('+t+")",[4,this.query(i)];case 5:return s=e.sent(),[4,Promise.all(s.map(function(e){return l.query(e.query)}))];case 6:return e.sent(),o='SELECT \'DROP SEQUENCE "\' || sequence_schema || \'"."\' || sequence_name || \'";\' as "query" FROM "information_schema"."sequences" WHERE "sequence_schema" IN ('+t+")",[4,this.query(o)];case 7:return u=e.sent(),[4,Promise.all(u.map(function(e){return l.query(e.query)}))];case 8:return e.sent(),[4,this.commitTransaction()];case 9:return e.sent(),[3,15];case 10:c=e.sent(),e.label=11;case 11:return e.trys.push([11,13,,14]),[4,this.rollbackTransaction()];case 12:return e.sent(),[3,14];case 13:return e.sent(),[3,14];case 14:throw c;case 15:return[2]}})})},y.prototype.loadViews=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,a,i,s=this;return e.__generator(this,function(o){switch(o.label){case 0:return[4,this.hasTable(this.getTypeormMetadataTableName())];case 1:return o.sent()?[4,this.query("SELECT * FROM current_schema()")]:[2,Promise.resolve([])];case 2:return t=o.sent(),r=t[0].current_schema,a=n.map(function(n){var t=e.__read(n.split("."),2),a=t[0],i=t[1];return i||(i=a,a=s.driver.options.schema||r),'("t"."schema" = \''+a+'\' AND "t"."name" = \''+i+"')"}).join(" OR "),i='SELECT "t".*, "v"."check_option" FROM '+this.escapePath(this.getTypeormMetadataTableName())+' "t" INNER JOIN "information_schema"."views" "v" ON "v"."table_schema" = "t"."schema" AND "v"."table_name" = "t"."name" WHERE "t"."type" = \'VIEW\' '+(a?"AND ("+a+")":""),[4,this.query(i)];case 3:return[2,o.sent().map(function(e){var n=new u.View,t=e.schema!==r||s.driver.options.schema?e.schema:void 0;return n.name=s.driver.buildTableName(e.name,t),n.expression=e.value,n})]}})})},y.prototype.loadTables=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,o,u,c,l,m,p,f,y,_,N,A,C,b,S,w,R=this;return e.__generator(this,function(v){switch(v.label){case 0:return n&&n.length?[4,this.query("SELECT * FROM current_schema()")]:[2,[]];case 1:return t=v.sent(),o=t[0].current_schema,u=n.map(function(n){var t=e.__read(n.split("."),2),r=t[0],a=t[1];return a||(a=r,r=R.driver.options.schema||o),'("table_schema" = \''+r+"' AND \"table_name\" = '"+a+"')"}).join(" OR "),c='SELECT * FROM "information_schema"."tables" WHERE '+u,l='SELECT * FROM "information_schema"."columns" WHERE "is_hidden" = \'NO\' AND '+u,m=n.map(function(n){var t=e.__read(n.split("."),2),r=t[0],a=t[1];return a||(a=r,r=R.driver.options.schema||o),'("ns"."nspname" = \''+r+'\' AND "t"."relname" = \''+a+"')"}).join(" OR "),p='SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "cnst"."conname" AS "constraint_name", CASE "cnst"."contype" WHEN \'x\' THEN pg_get_constraintdef("cnst"."oid", true) ELSE "cnst"."consrc" END AS "expression", CASE "cnst"."contype" WHEN \'p\' THEN \'PRIMARY\' WHEN \'u\' THEN \'UNIQUE\' WHEN \'c\' THEN \'CHECK\' WHEN \'x\' THEN \'EXCLUDE\' END AS "constraint_type", "a"."attname" AS "column_name" FROM "pg_constraint" "cnst" INNER JOIN "pg_class" "t" ON "t"."oid" = "cnst"."conrelid" INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "cnst"."connamespace" LEFT JOIN "pg_attribute" "a" ON "a"."attrelid" = "cnst"."conrelid" AND "a"."attnum" = ANY ("cnst"."conkey") WHERE "t"."relkind" = \'r\' AND ('+m+")",f='SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "i"."relname" AS "constraint_name", "a"."attname" AS "column_name", CASE "ix"."indisunique" WHEN \'t\' THEN \'TRUE\' ELSE\'FALSE\' END AS "is_unique", pg_get_expr("ix"."indpred", "ix"."indrelid") AS "condition", "types"."typname" AS "type_name" FROM "pg_class" "t" INNER JOIN "pg_index" "ix" ON "ix"."indrelid" = "t"."oid" INNER JOIN "pg_attribute" "a" ON "a"."attrelid" = "t"."oid"  AND "a"."attnum" = ANY ("ix"."indkey") INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "t"."relnamespace" INNER JOIN "pg_class" "i" ON "i"."oid" = "ix"."indexrelid" INNER JOIN "pg_type" "types" ON "types"."oid" = "a"."atttypid" LEFT JOIN "pg_constraint" "cnst" ON "cnst"."conname" = "i"."relname" WHERE "t"."relkind" = \'r\' AND "cnst"."contype" IS NULL AND ('+m+")",y=n.map(function(n){var t=e.__read(n.split("."),2),r=t[0],a=t[1];return a||(a=r,r=R.driver.options.schema||o),'("ns"."nspname" = \''+r+'\' AND "cl"."relname" = \''+a+"')"}).join(" OR "),_='SELECT "con"."conname" AS "constraint_name", "con"."nspname" AS "table_schema", "con"."relname" AS "table_name", "att2"."attname" AS "column_name", "ns"."nspname" AS "referenced_table_schema", "cl"."relname" AS "referenced_table_name", "att"."attname" AS "referenced_column_name", "con"."confdeltype" AS "on_delete", "con"."confupdtype" AS "on_update" FROM ( SELECT UNNEST ("con1"."conkey") AS "parent", UNNEST ("con1"."confkey") AS "child", "con1"."confrelid", "con1"."conrelid", "con1"."conname", "con1"."contype", "ns"."nspname", "cl"."relname", CASE "con1"."confdeltype" WHEN \'a\' THEN \'NO ACTION\' WHEN \'r\' THEN \'RESTRICT\' WHEN \'c\' THEN \'CASCADE\' WHEN \'n\' THEN \'SET NULL\' WHEN \'d\' THEN \'SET DEFAULT\' END as "confdeltype", CASE "con1"."confupdtype" WHEN \'a\' THEN \'NO ACTION\' WHEN \'r\' THEN \'RESTRICT\' WHEN \'c\' THEN \'CASCADE\' WHEN \'n\' THEN \'SET NULL\' WHEN \'d\' THEN \'SET DEFAULT\' END as "confupdtype" FROM "pg_class" "cl" INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_constraint" "con1" ON "con1"."conrelid" = "cl"."oid" WHERE "con1"."contype" = \'f\' AND ('+y+') ) "con" INNER JOIN "pg_attribute" "att" ON "att"."attrelid" = "con"."confrelid" AND "att"."attnum" = "con"."child" INNER JOIN "pg_class" "cl" ON "cl"."oid" = "con"."confrelid" INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_attribute" "att2" ON "att2"."attrelid" = "con"."conrelid" AND "att2"."attnum" = "con"."parent"',[4,Promise.all([this.query(c),this.query(l),this.query(p),this.query(f),this.query(_)])];case 2:return N=e.__read.apply(void 0,[v.sent(),5]),A=N[0],C=N[1],b=N[2],S=N[3],w=N[4],A.length?[2,Promise.all(A.map(function(n){return e.__awaiter(R,void 0,void 0,function(){var t,u,c,l,m,p,f,y,_,N=this;return e.__generator(this,function(A){switch(A.label){case 0:return t=new a.Table,u=n.table_schema!==o||this.driver.options.schema?n.table_schema:void 0,t.name=this.driver.buildTableName(n.table_name,u),c=this.driver.buildTableName(n.table_name,n.table_schema),l=t,[4,Promise.all(C.filter(function(e){return N.driver.buildTableName(e.table_name,e.table_schema)===c}).map(function(n){return e.__awaiter(N,void 0,void 0,function(){var a,i,s,o,u,l,m=this;return e.__generator(this,function(e){return a=b.filter(function(e){return m.driver.buildTableName(e.table_name,e.table_schema)===c&&e.column_name===n.column_name}),(i=new r.TableColumn).name=n.column_name,i.type=n.crdb_sql_type.toLowerCase(),-1!==n.crdb_sql_type.indexOf("COLLATE")&&(i.collation=n.crdb_sql_type.substr(n.crdb_sql_type.indexOf("COLLATE")+"COLLATE".length+1,n.crdb_sql_type.length),i.type=i.type.substr(0,n.crdb_sql_type.indexOf("COLLATE")-1)),-1!==i.type.indexOf("(")&&(i.type=i.type.substr(0,i.type.indexOf("("))),"numeric"!==i.type&&"decimal"!==i.type||(null===n.numeric_precision||this.isDefaultColumnPrecision(t,i,n.numeric_precision)?null===n.numeric_scale||this.isDefaultColumnScale(t,i,n.numeric_scale)||(i.precision=void 0):i.precision=parseInt(n.numeric_precision),null===n.numeric_scale||this.isDefaultColumnScale(t,i,n.numeric_scale)?null===n.numeric_precision||this.isDefaultColumnPrecision(t,i,n.numeric_precision)||(i.scale=void 0):i.scale=parseInt(n.numeric_scale)),"array"===n.data_type.toLowerCase()&&(i.isArray=!0,s=n.crdb_sql_type.replace("[]","").toLowerCase(),i.type=this.connection.driver.normalizeType({type:s})),-1!==this.driver.withLengthColumnTypes.indexOf(i.type)&&n.character_maximum_length&&(o=n.character_maximum_length.toString(),i.length=this.isDefaultColumnLength(t,i,o)?"":o),i.isNullable="YES"===n.is_nullable,i.isPrimary=!!a.find(function(e){return"PRIMARY"===e.constraint_type}),u=a.find(function(e){return"UNIQUE"===e.constraint_type}),l=!!u&&!!b.find(function(e){return"UNIQUE"===e.constraint_type&&e.constraint_name===u.constraint_name&&e.column_name!==n.column_name}),i.isUnique=!!u&&!l,null!==n.column_default&&void 0!==n.column_default&&("unique_rowid()"===n.column_default?(i.isGenerated=!0,i.generationStrategy="rowid"):-1!==n.column_default.indexOf("nextval")?(i.isGenerated=!0,i.generationStrategy="increment"):"gen_random_uuid()"===n.column_default?(i.isGenerated=!0,i.generationStrategy="uuid"):i.default=n.column_default.replace(/:::.*/,"")),i.comment="",n.character_set_name&&(i.charset=n.character_set_name),[2,i]})})}))];case 1:return l.columns=A.sent(),m=d.OrmUtils.uniq(b.filter(function(e){return N.driver.buildTableName(e.table_name,e.table_schema)===c&&"UNIQUE"===e.constraint_type}),function(e){return e.constraint_name}),t.uniques=m.map(function(e){var n=b.filter(function(n){return n.constraint_name===e.constraint_name});return new h.TableUnique({name:e.constraint_name,columnNames:n.map(function(e){return e.column_name})})}),p=d.OrmUtils.uniq(b.filter(function(e){return N.driver.buildTableName(e.table_name,e.table_schema)===c&&"CHECK"===e.constraint_type}),function(e){return e.constraint_name}),t.checks=p.map(function(e){var n=b.filter(function(n){return n.constraint_name===e.constraint_name});return new E.TableCheck({name:e.constraint_name,columnNames:n.map(function(e){return e.column_name}),expression:e.expression})}),f=d.OrmUtils.uniq(b.filter(function(e){return N.driver.buildTableName(e.table_name,e.table_schema)===c&&"EXCLUDE"===e.constraint_type}),function(e){return e.constraint_name}),t.exclusions=f.map(function(e){return new T.TableExclusion({name:e.constraint_name,expression:e.expression.substring(8)})}),y=d.OrmUtils.uniq(w.filter(function(e){return N.driver.buildTableName(e.table_name,e.table_schema)===c}),function(e){return e.constraint_name}),t.foreignKeys=y.map(function(e){var t=w.filter(function(n){return n.constraint_name===e.constraint_name}),r=e.referenced_table_schema===o?void 0:n.referenced_table_schema,a=N.driver.buildTableName(e.referenced_table_name,r);return new s.TableForeignKey({name:e.constraint_name,columnNames:t.map(function(e){return e.column_name}),referencedTableName:a,referencedColumnNames:t.map(function(e){return e.referenced_column_name}),onDelete:e.on_delete,onUpdate:e.on_update})}),_=d.OrmUtils.uniq(S.filter(function(e){return N.driver.buildTableName(e.table_name,e.table_schema)===c}),function(e){return e.constraint_name}),t.indices=_.map(function(e){var n=S.filter(function(n){return n.constraint_name===e.constraint_name});return new i.TableIndex({table:t,name:e.constraint_name,columnNames:n.map(function(e){return e.column_name}),isUnique:"TRUE"===e.is_unique,where:e.condition,isSpatial:n.every(function(e){return N.driver.spatialTypes.indexOf(e.type_name)>=0}),isFulltext:!1})}),[2,t]}})})}))]:[2,[]]}})})},y.prototype.createTableSql=function(e,n){var t=this,r=e.columns.map(function(n){return t.buildCreateColumnSql(e,n)}).join(", "),a="CREATE TABLE "+this.escapePath(e)+" ("+r;(e.columns.filter(function(e){return e.isUnique}).forEach(function(n){e.uniques.some(function(e){return 1===e.columnNames.length&&e.columnNames[0]===n.name})||e.uniques.push(new h.TableUnique({name:t.connection.namingStrategy.uniqueConstraintName(e.name,[n.name]),columnNames:[n.name]}))}),e.indices.filter(function(e){return e.isUnique}).forEach(function(n){e.uniques.push(new h.TableUnique({name:t.connection.namingStrategy.uniqueConstraintName(e.name,n.columnNames),columnNames:n.columnNames}))}),e.uniques.length>0)&&(a+=", "+e.uniques.map(function(n){return'CONSTRAINT "'+(n.name?n.name:t.connection.namingStrategy.uniqueConstraintName(e.name,n.columnNames))+'" UNIQUE ('+n.columnNames.map(function(e){return'"'+e+'"'}).join(", ")+")"}).join(", "));e.checks.length>0&&(a+=", "+e.checks.map(function(n){return'CONSTRAINT "'+(n.name?n.name:t.connection.namingStrategy.checkConstraintName(e.name,n.expression))+'" CHECK ('+n.expression+")"}).join(", "));e.foreignKeys.length>0&&n&&(a+=", "+e.foreignKeys.map(function(n){var r=n.columnNames.map(function(e){return'"'+e+'"'}).join(", ");n.name||(n.name=t.connection.namingStrategy.foreignKeyName(e.name,n.columnNames));var a=n.referencedColumnNames.map(function(e){return'"'+e+'"'}).join(", "),i='CONSTRAINT "'+n.name+'" FOREIGN KEY ('+r+") REFERENCES "+t.escapePath(n.referencedTableName)+" ("+a+")";return n.onDelete&&(i+=" ON DELETE "+n.onDelete),n.onUpdate&&(i+=" ON UPDATE "+n.onUpdate),i}).join(", "));var i=e.columns.filter(function(e){return e.isPrimary});i.length>0&&(a+=', CONSTRAINT "'+this.connection.namingStrategy.primaryKeyName(e.name,i.map(function(e){return e.name}))+'" PRIMARY KEY ('+i.map(function(e){return'"'+e.name+'"'}).join(", ")+")");return a+=")",new c.Query(a)},y.prototype.extractSchema=function(e){var n=e instanceof a.Table?e.name:e;return-1===n.indexOf(".")?this.driver.options.schema:n.split(".")[0]},y.prototype.dropTableSql=function(e){return new c.Query("DROP TABLE "+this.escapePath(e))},y.prototype.createViewSql=function(e){return"string"==typeof e.expression?new c.Query("CREATE VIEW "+this.escapePath(e)+" AS "+e.expression):new c.Query("CREATE VIEW "+this.escapePath(e)+" AS "+e.expression(this.connection).getQuery())},y.prototype.insertViewDefinitionSql=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,a,i,s,o,u,l,m;return e.__generator(this,function(h){switch(h.label){case 0:return[4,this.query("SELECT * FROM current_schema()")];case 1:return t=h.sent(),r=t[0].current_schema,a=n.name.split("."),i=this.driver.options.schema||r,s=n.name,2===a.length&&(i=a[0],s=a[1]),o="string"==typeof n.expression?n.expression.trim():n.expression(this.connection).getQuery(),u=e.__read(this.connection.createQueryBuilder().insert().into(this.getTypeormMetadataTableName()).values({type:"VIEW",schema:i,name:s,value:o}).getQueryAndParameters(),2),l=u[0],m=u[1],[2,new c.Query(l,m)]}})})},y.prototype.dropViewSql=function(e){return new c.Query("DROP VIEW "+this.escapePath(e))},y.prototype.deleteViewDefinitionSql=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,a,i,s,o,l,m,h,p;return e.__generator(this,function(d){switch(d.label){case 0:return[4,this.query("SELECT * FROM current_schema()")];case 1:return t=d.sent(),r=t[0].current_schema,a=n instanceof u.View?n.name:n,i=a.split("."),s=this.driver.options.schema||r,o=a,2===i.length&&(s=i[0],o=i[1]),l=this.connection.createQueryBuilder(),m=e.__read(l.delete().from(this.getTypeormMetadataTableName()).where(l.escape("type")+" = 'VIEW'").andWhere(l.escape("schema")+" = :schema",{schema:s}).andWhere(l.escape("name")+" = :name",{name:o}).getQueryAndParameters(),2),h=m[0],p=m[1],[2,new c.Query(h,p)]}})})},y.prototype.createIndexSql=function(e,n){var t=n.columnNames.map(function(e){return'"'+e+'"'}).join(", ");return new c.Query('CREATE INDEX "'+n.name+'" ON '+this.escapePath(e)+" ("+t+") "+(n.where?"WHERE "+n.where:""))},y.prototype.dropIndexSql=function(e,n){var t=n instanceof i.TableIndex||n instanceof h.TableUnique?n.name:n;return new c.Query("DROP INDEX "+this.escapePath(e)+'@"'+t+'" CASCADE')},y.prototype.createPrimaryKeySql=function(e,n){var t=this.connection.namingStrategy.primaryKeyName(e.name,n),r=n.map(function(e){return'"'+e+'"'}).join(", ");return new c.Query("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+t+'" PRIMARY KEY ('+r+")")},y.prototype.dropPrimaryKeySql=function(e){var n=e.primaryColumns.map(function(e){return e.name}),t=this.connection.namingStrategy.primaryKeyName(e.name,n);return new c.Query("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+t+'"')},y.prototype.createUniqueConstraintSql=function(e,n){var t=n.columnNames.map(function(e){return'"'+e+'"'}).join(", ");return new c.Query("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+n.name+'" UNIQUE ('+t+")")},y.prototype.dropUniqueConstraintSql=function(e,n){var t=n instanceof h.TableUnique?n.name:n;return new c.Query("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+t+'"')},y.prototype.createCheckConstraintSql=function(e,n){return new c.Query("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+n.name+'" CHECK ('+n.expression+")")},y.prototype.dropCheckConstraintSql=function(e,n){var t=n instanceof E.TableCheck?n.name:n;return new c.Query("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+t+'"')},y.prototype.createForeignKeySql=function(e,n){var t=n.columnNames.map(function(e){return'"'+e+'"'}).join(", "),r=n.referencedColumnNames.map(function(e){return'"'+e+'"'}).join(","),a="ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+n.name+'" FOREIGN KEY ('+t+") REFERENCES "+this.escapePath(n.referencedTableName)+"("+r+")";return n.onDelete&&(a+=" ON DELETE "+n.onDelete),n.onUpdate&&(a+=" ON UPDATE "+n.onUpdate),new c.Query(a)},y.prototype.dropForeignKeySql=function(e,n){var t=n instanceof s.TableForeignKey?n.name:n;return new c.Query("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+t+'"')},y.prototype.buildSequenceName=function(e,n,t){var a=n instanceof r.TableColumn?n.name:n;return t?e.name+"_"+a+"_seq":'"'+e.name+"_"+a+'_seq"'},y.prototype.escapePath=function(e,n){var t=e instanceof a.Table||e instanceof u.View?e.name:e;return(t=-1===t.indexOf(".")&&this.driver.options.schema?this.driver.options.schema+"."+t:t).split(".").map(function(e){return n?e:'"'+e+'"'}).join(".")},y.prototype.parseTableName=function(e){var n=e instanceof a.Table?e.name:e;return-1===n.indexOf(".")?{schema:this.driver.options.schema?"'"+this.driver.options.schema+"'":"current_schema()",tableName:"'"+n+"'"}:{schema:"'"+n.split(".")[0]+"'",tableName:"'"+n.split(".")[1]+"'"}},y.prototype.buildCreateColumnSql=function(e,n){var t='"'+n.name+'"';return n.isGenerated&&("increment"===n.generationStrategy?t+=" INT DEFAULT nextval('"+this.buildSequenceName(e,n)+"')":"rowid"===n.generationStrategy?t+=" INT DEFAULT unique_rowid()":"uuid"===n.generationStrategy&&(t+=" UUID DEFAULT gen_random_uuid()")),n.isGenerated||(t+=" "+this.connection.driver.createFullType(n)),n.charset&&(t+=' CHARACTER SET "'+n.charset+'"'),n.collation&&(t+=' COLLATE "'+n.collation+'"'),n.isNullable||(t+=" NOT NULL"),n.isGenerated||void 0===n.default||null===n.default||(t+=" DEFAULT "+n.default),t},y}(p.BaseQueryRunner);exports.CockroachQueryRunner=_;
},{"tslib":"c4AP","../../error/TransactionAlreadyStartedError":"kZCV","../../error/TransactionNotStartedError":"nZEx","../../schema-builder/table/TableColumn":"SdPr","../../schema-builder/table/Table":"e+Cn","../../schema-builder/table/TableIndex":"S7W/","../../schema-builder/table/TableForeignKey":"0LZF","../../error/QueryRunnerAlreadyReleasedError":"CGt0","../../schema-builder/view/View":"fSdu","../Query":"CMcp","../../error/QueryFailedError":"U3oI","../../subscriber/Broadcaster":"wiLV","../../schema-builder/table/TableUnique":"9Ztg","../../query-runner/BaseQueryRunner":"GBOk","../../util/OrmUtils":"R//v","../../":"wlNf","../../schema-builder/table/TableCheck":"oxtv","../../schema-builder/table/TableExclusion":"Lhin"}],"p0mU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApplyValueTransformers=void 0;var r=function(){function r(){}return r.transformFrom=function(r,e){return Array.isArray(r)?r.slice().reverse().reduce(function(r,e){return e.from(r)},e):r.from(e)},r.transformTo=function(r,e){return Array.isArray(r)?r.reduce(function(r,e){return e.to(r)},e):r.to(e)},r}();exports.ApplyValueTransformers=r;
},{}],"mleT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CockroachDriver=void 0;var e=c(require("tslib")),t=require("../../error/ConnectionIsNotSetError"),r=require("../../error/DriverPackageNotInstalledError"),n=require("../DriverUtils"),i=require("../../util/DateUtils"),a=require("../../platform/PlatformTools"),o=require("../../schema-builder/RdbmsSchemaBuilder"),s=require("../../util/OrmUtils"),p=require("./CockroachQueryRunner"),u=require("../../util/ApplyValueTransformers");function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var l=function(){function c(e){this.slaves=[],this.connectedQueryRunners=[],this.isReplicated=!1,this.treeSupport=!0,this.supportedDataTypes=["array","bool","boolean","bytes","bytea","blob","date","numeric","decimal","dec","float","float4","float8","double precision","real","inet","int","int4","integer","int2","int8","int64","smallint","bigint","interval","string","character varying","character","char","char varying","varchar","text","time","time without time zone","timestamp","timestamptz","timestamp without time zone","timestamp with time zone","json","jsonb","uuid"],this.spatialTypes=[],this.withLengthColumnTypes=["character varying","char varying","varchar","character","char","string"],this.withPrecisionColumnTypes=["numeric","decimal","dec"],this.withScaleColumnTypes=["numeric","decimal","dec"],this.mappedDataTypes={createDate:"timestamptz",createDateDefault:"now()",updateDate:"timestamptz",updateDateDefault:"now()",version:Number,treeLevel:Number,migrationId:Number,migrationName:"varchar",migrationTimestamp:"int8",cacheId:Number,cacheIdentifier:"varchar",cacheTime:"int8",cacheDuration:Number,cacheQuery:"string",cacheResult:"string",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"string"},this.dataTypeDefaults={char:{length:1}},this.connection=e,this.options=e.options,this.isReplicated=!!this.options.replication,this.loadDependencies()}return c.prototype.connect=function(){return e.__awaiter(this,void 0,void 0,function(){var t,r,n,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.options.replication?(t=this,[4,Promise.all(this.options.replication.slaves.map(function(e){return i.createPool(i.options,e)}))]):[3,3];case 1:return t.slaves=e.sent(),r=this,[4,this.createPool(this.options,this.options.replication.master)];case 2:return r.master=e.sent(),this.database=this.options.replication.master.database,[3,5];case 3:return n=this,[4,this.createPool(this.options,this.options)];case 4:n.master=e.sent(),this.database=this.options.database,e.label=5;case 5:return[2]}})})},c.prototype.afterConnect=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve()]})})},c.prototype.disconnect=function(){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.master?[4,this.closePool(this.master)]:[2,Promise.reject(new t.ConnectionIsNotSetError("cockroachdb"))];case 1:return e.sent(),[4,Promise.all(this.slaves.map(function(e){return r.closePool(e)}))];case 2:return e.sent(),this.master=void 0,this.slaves=[],[2]}})})},c.prototype.createSchemaBuilder=function(){return new o.RdbmsSchemaBuilder(this.connection)},c.prototype.createQueryRunner=function(e){return void 0===e&&(e="master"),new p.CockroachQueryRunner(this,e)},c.prototype.preparePersistentValue=function(t,r){return r.transformer&&(t=u.ApplyValueTransformers.transformTo(r.transformer,t)),null==t?t:r.type===Boolean?!0===t?1:0:"date"===r.type?i.DateUtils.mixedDateToDateString(t):"time"===r.type?i.DateUtils.mixedDateToTimeString(t):"datetime"===r.type||r.type===Date||"timestamp"===r.type||"timestamptz"===r.type||"timestamp with time zone"===r.type||"timestamp without time zone"===r.type?i.DateUtils.mixedDateToDate(t):e.__spread(["json","jsonb"],this.spatialTypes).indexOf(r.type)>=0?JSON.stringify(t):"simple-array"===r.type?i.DateUtils.simpleArrayToString(t):"simple-json"===r.type?i.DateUtils.simpleJsonToString(t):t},c.prototype.prepareHydratedValue=function(e,t){return null==e?t.transformer?u.ApplyValueTransformers.transformFrom(t.transformer,e):e:(t.type===Number&&!t.isArray||"increment"===t.generationStrategy?e=parseInt(e):t.type===Boolean?e=!!e:"datetime"===t.type||t.type===Date||"timestamp"===t.type||"timestamptz"===t.type||"timestamp with time zone"===t.type||"timestamp without time zone"===t.type?e=i.DateUtils.normalizeHydratedDate(e):"date"===t.type?e=i.DateUtils.mixedDateToDateString(e):"time"===t.type?e=i.DateUtils.mixedTimeToString(e):"simple-array"===t.type?e=i.DateUtils.stringToSimpleArray(e):"simple-json"===t.type&&(e=i.DateUtils.stringToSimpleJson(e)),t.transformer&&(e=u.ApplyValueTransformers.transformFrom(t.transformer,e)),e)},c.prototype.escapeQueryWithParameters=function(e,t,r){var n=Object.keys(r).map(function(e){return r[e]});if(!t||!Object.keys(t).length)return[e,n];var i=Object.keys(t).map(function(e){return"(:(\\.\\.\\.)?"+e+"\\b)"}).join("|");return[e=e.replace(new RegExp(i,"g"),function(e){var r,i=!1;return":..."===e.substr(0,4)?(i=!0,r=t[e.substr(4)]):r=t[e.substr(1)],i?r.map(function(e){return n.push(e),"$"+n.length}).join(", "):r instanceof Function?r():(n.push(r),"$"+n.length)}),n]},c.prototype.escape=function(e){return'"'+e+'"'},c.prototype.buildTableName=function(e,t){return t?t+"."+e:e},c.prototype.normalizeType=function(e){return e.type===Number||"integer"===e.type||"int"===e.type||"bigint"===e.type||"int64"===e.type?"int8":e.type===String||"character varying"===e.type||"char varying"===e.type?"varchar":e.type===Date||"timestamp without time zone"===e.type?"timestamp":"timestamp with time zone"===e.type?"timestamptz":"time without time zone"===e.type?"time":e.type===Boolean||"boolean"===e.type?"bool":"simple-array"===e.type||"simple-json"===e.type||"text"===e.type?"string":"bytea"===e.type||"blob"===e.type?"bytes":"smallint"===e.type?"int2":"numeric"===e.type||"dec"===e.type?"decimal":"double precision"===e.type||"float"===e.type?"float8":"real"===e.type?"float4":"character"===e.type?"char":"json"===e.type?"jsonb":e.type||""},c.prototype.normalizeDefault=function(e){var t=e.default,r=e.isArray?"::"+e.type+"[]":"";return"number"==typeof t?""+t:"boolean"==typeof t?!0===t?"true":"false":"function"==typeof t?t():"string"==typeof t?"'"+t+"'"+r:null===t?"null":"object"==typeof t?"'"+JSON.stringify(t)+"'":t},c.prototype.normalizeIsUnique=function(e){return e.entityMetadata.uniques.some(function(t){return 1===t.columns.length&&t.columns[0]===e})},c.prototype.getColumnLength=function(e){return e.length?e.length.toString():""},c.prototype.createFullType=function(e){var t=e.type;return e.length?t+="("+e.length+")":null!==e.precision&&void 0!==e.precision&&null!==e.scale&&void 0!==e.scale?t+="("+e.precision+","+e.scale+")":null!==e.precision&&void 0!==e.precision&&(t+="("+e.precision+")"),e.isArray&&(t+=" array"),t},c.prototype.obtainMasterConnection=function(){var e=this;return new Promise(function(t,r){e.master.connect(function(e,n,i){e?r(e):t([n,i])})})},c.prototype.obtainSlaveConnection=function(){var e=this;return this.slaves.length?new Promise(function(t,r){var n=Math.floor(Math.random()*e.slaves.length);e.slaves[n].connect(function(e,n,i){e?r(e):t([n,i])})}):this.obtainMasterConnection()},c.prototype.createGeneratedMap=function(e,t){var r=this;if(t)return Object.keys(t).reduce(function(n,i){var a=e.findColumnWithDatabaseName(i);return a&&s.OrmUtils.mergeDeep(n,a.createValueMap(r.prepareHydratedValue(t[i],a))),n},{})},c.prototype.findChangedColumns=function(e,t){var r=this;return t.filter(function(t){var n=e.find(function(e){return e.name===t.databaseName});return!!n&&(n.name!==t.databaseName||n.type!==r.normalizeType(t)||n.length!==t.length||n.precision!==t.precision||n.scale!==t.scale||!n.isGenerated&&r.lowerDefaultValueIfNecessary(r.normalizeDefault(t))!==n.default||n.isPrimary!==t.isPrimary||n.isNullable!==t.isNullable||n.isUnique!==r.normalizeIsUnique(t)||n.isGenerated!==t.isGenerated)})},c.prototype.lowerDefaultValueIfNecessary=function(e){return e?e.split("'").map(function(e,t){return t%2==1?e:e.toLowerCase()}).join("'"):e},c.prototype.isReturningSqlSupported=function(){return!0},c.prototype.isUUIDGenerationSupported=function(){return!0},c.prototype.createParameter=function(e,t){return"$"+(t+1)},c.prototype.loadStreamDependency=function(){try{return a.PlatformTools.load("pg-query-stream")}catch(e){throw new Error("To use streams you should install pg-query-stream package. Please run npm i pg-query-stream --save command.")}},c.prototype.loadDependencies=function(){try{this.postgres=a.PlatformTools.load("pg");try{a.PlatformTools.load("pg-native")&&this.postgres.native&&(this.postgres=this.postgres.native)}catch(e){}}catch(e){throw new r.DriverPackageNotInstalledError("Postgres","pg")}},c.prototype.createPool=function(t,r){return e.__awaiter(this,void 0,void 0,function(){var i,a,o;return e.__generator(this,function(e){return r=Object.assign(r,n.DriverUtils.buildDriverOptions(r)),i=Object.assign({},{host:r.host,user:r.username,password:r.password,database:r.database,port:r.port,ssl:r.ssl},t.extra||{}),a=new this.postgres.Pool(i),o=this.connection.logger,a.on("error",function(e){return o.log("warn","Postgres pool raised an error. "+e)}),[2,new Promise(function(e,t){a.connect(function(r,n,i){if(r)return t(r);i(),e(a)})})]})})},c.prototype.closePool=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,Promise.all(this.connectedQueryRunners.map(function(e){return e.release()}))];case 1:return e.sent(),[2,new Promise(function(e,r){t.end(function(t){return t?r(t):e()})})]}})})},c.prototype.executeQuery=function(e,t){return new Promise(function(r,n){e.query(t,function(e,t){if(e)return n(e);r(t)})})},c}();exports.CockroachDriver=l;
},{"tslib":"c4AP","../../error/ConnectionIsNotSetError":"jWtv","../../error/DriverPackageNotInstalledError":"NaUg","../DriverUtils":"hdhF","../../util/DateUtils":"iWm2","../../platform/PlatformTools":"YF44","../../schema-builder/RdbmsSchemaBuilder":"leiv","../../util/OrmUtils":"R//v","./CockroachQueryRunner":"7vWf","../../util/ApplyValueTransformers":"p0mU"}],"TOLf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OracleDriver=exports.MysqlDriver=exports.SqlServerDriver=exports.PostgresDriver=exports.MongoRepository=exports.MongoEntityManager=exports.MongoQueryRunner=exports.MongoDriver=void 0;var r=function(){return function(){}}();exports.MongoDriver=r;var e=function(){return function(){}}();exports.MongoQueryRunner=e;var o=function(){return function(){}}();exports.MongoEntityManager=o;var n=function(){return function(){}}();exports.MongoRepository=n;var t=function(){return function(){}}();exports.PostgresDriver=t;var i=function(){return function(){}}();exports.SqlServerDriver=i;var u=function(){return function(){}}();exports.MysqlDriver=u;var s=function(){return function(){}}();exports.OracleDriver=s;
},{}],"leiv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RdbmsSchemaBuilder=void 0;var e=m(require("tslib")),n=require("../driver/cockroachdb/CockroachDriver"),t=require("./table/Table"),r=require("./table/TableColumn"),i=require("./table/TableForeignKey"),a=require("./table/TableIndex"),o=require("../util/PromiseUtils"),s=require("./util/TableUtils"),u=require("../driver/postgres/PostgresDriver"),c=require("../driver/mysql/MysqlDriver"),l=require("./table/TableUnique"),d=require("./table/TableCheck"),h=require("./table/TableExclusion"),f=require("./view/View");function m(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};r.get||r.set?Object.defineProperty(n,t,r):n[t]=e[t]}return n.default=e,n}var p=function(){function m(e){this.connection=e}return m.prototype.build=function(){return e.__awaiter(this,void 0,void 0,function(){var t,r;return e.__generator(this,function(e){switch(e.label){case 0:return this.queryRunner=this.connection.createQueryRunner("master"),this.connection.driver instanceof n.CockroachDriver?[3,2]:[4,this.queryRunner.startTransaction()];case 1:e.sent(),e.label=2;case 2:return e.trys.push([2,12,18,20]),t=this.entityToSyncMetadatas.map(function(e){return e.tablePath}),this.viewEntityToSyncMetadatas.length>0?[4,this.createTypeormMetadataTable()]:[3,4];case 3:e.sent(),e.label=4;case 4:return[4,this.queryRunner.getTables(t)];case 5:return e.sent(),[4,this.queryRunner.getViews([])];case 6:return e.sent(),[4,this.executeSchemaSyncOperationsInProperOrder()];case 7:return e.sent(),this.connection.queryResultCache?[4,this.connection.queryResultCache.synchronize(this.queryRunner)]:[3,9];case 8:e.sent(),e.label=9;case 9:return this.connection.driver instanceof n.CockroachDriver?[3,11]:[4,this.queryRunner.commitTransaction()];case 10:e.sent(),e.label=11;case 11:return[3,20];case 12:r=e.sent(),e.label=13;case 13:return e.trys.push([13,16,,17]),this.connection.driver instanceof n.CockroachDriver?[3,15]:[4,this.queryRunner.rollbackTransaction()];case 14:e.sent(),e.label=15;case 15:return[3,17];case 16:return e.sent(),[3,17];case 17:throw r;case 18:return[4,this.queryRunner.release()];case 19:return e.sent(),[7];case 20:return[2]}})})},m.prototype.log=function(){return e.__awaiter(this,void 0,void 0,function(){var n;return e.__generator(this,function(e){switch(e.label){case 0:this.queryRunner=this.connection.createQueryRunner("master"),e.label=1;case 1:return e.trys.push([1,,7,9]),n=this.entityToSyncMetadatas.map(function(e){return e.tablePath}),[4,this.queryRunner.getTables(n)];case 2:return e.sent(),[4,this.queryRunner.getViews([])];case 3:return e.sent(),this.queryRunner.enableSqlMemory(),[4,this.executeSchemaSyncOperationsInProperOrder()];case 4:return e.sent(),this.connection.queryResultCache?[4,this.connection.queryResultCache.synchronize(this.queryRunner)]:[3,6];case 5:e.sent(),e.label=6;case 6:return[2,this.queryRunner.getMemorySql()];case 7:return this.queryRunner.disableSqlMemory(),[4,this.queryRunner.release()];case 8:return e.sent(),[7];case 9:return[2]}})})},Object.defineProperty(m.prototype,"entityToSyncMetadatas",{get:function(){return this.connection.entityMetadatas.filter(function(e){return e.synchronize&&"entity-child"!==e.tableType&&"view"!==e.tableType})},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"viewEntityToSyncMetadatas",{get:function(){return this.connection.entityMetadatas.filter(function(e){return"view"===e.tableType})},enumerable:!0,configurable:!0}),m.prototype.executeSchemaSyncOperationsInProperOrder=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.dropOldViews()];case 1:return e.sent(),[4,this.dropOldForeignKeys()];case 2:return e.sent(),[4,this.dropOldIndices()];case 3:return e.sent(),[4,this.dropOldChecks()];case 4:return e.sent(),[4,this.dropOldExclusions()];case 5:return e.sent(),[4,this.dropCompositeUniqueConstraints()];case 6:return e.sent(),[4,this.renameColumns()];case 7:return e.sent(),[4,this.createNewTables()];case 8:return e.sent(),[4,this.dropRemovedColumns()];case 9:return e.sent(),[4,this.addNewColumns()];case 10:return e.sent(),[4,this.updatePrimaryKeys()];case 11:return e.sent(),[4,this.updateExistColumns()];case 12:return e.sent(),[4,this.createNewIndices()];case 13:return e.sent(),[4,this.createNewChecks()];case 14:return e.sent(),[4,this.createNewExclusions()];case 15:return e.sent(),[4,this.createCompositeUniqueConstraints()];case 16:return e.sent(),[4,this.createForeignKeys()];case 17:return e.sent(),[4,this.createViews()];case 18:return e.sent(),[2]}})})},m.prototype.dropOldForeignKeys=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?0===(r=n.foreignKeys.filter(function(e){var n=t.foreignKeys.find(function(n){return n.name===e.name});return!n||n.onDelete&&n.onDelete!==e.onDelete||n.onUpdate&&n.onUpdate!==e.onUpdate})).length?[2]:(this.connection.logger.logSchemaBuild("dropping old foreign keys of "+n.name+": "+r.map(function(e){return e.name}).join(", ")),[4,this.queryRunner.dropForeignKeys(n,r)]):[2];case 1:return e.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.renameTables=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){return e.__generator(this,function(e){return[2]})})})];case 1:return t.sent(),[2]}})})},m.prototype.renameColumns=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,r,i,a,o=this;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?t.columns.length!==n.columns.length?[2]:0===(r=t.columns.filter(function(e){return!n.columns.find(function(n){return n.name===e.databaseName&&n.type===o.connection.driver.normalizeType(e)&&n.isNullable===e.isNullable&&n.isUnique===o.connection.driver.normalizeIsUnique(e)})})).length||r.length>1?[2]:0===(i=n.columns.filter(function(e){return!t.columns.find(function(n){return n.databaseName===e.name&&o.connection.driver.normalizeType(n)===e.type&&n.isNullable===e.isNullable&&o.connection.driver.normalizeIsUnique(n)===e.isUnique})})).length||i.length>1?[2]:((a=i[0].clone()).name=r[0].databaseName,this.connection.logger.logSchemaBuild('renaming column "'+i[0].name+'" in to "'+a.name+'"'),[4,this.queryRunner.renameColumn(n,i[0],a)]):[2];case 1:return e.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.dropOldIndices=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,r,i=this;return e.__generator(this,function(a){switch(a.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?(r=n.indices.filter(function(e){var n=t.indices.find(function(n){return n.name===e.name});return!n||!1!==n.synchronize&&(n.isUnique!==e.isUnique||(n.isSpatial!==e.isSpatial||(n.isFulltext!==e.isFulltext||(n.columns.length!==e.columnNames.length||!n.columns.every(function(n){return-1!==e.columnNames.indexOf(n.databaseName)})))))}).map(function(t){return e.__awaiter(i,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return this.connection.logger.logSchemaBuild('dropping an index: "'+t.name+'" from table '+n.name),[4,this.queryRunner.dropIndex(n,t)];case 1:return e.sent(),[2]}})})}),[4,Promise.all(r)]):[2];case 1:return a.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.dropOldChecks=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return this.connection.driver instanceof c.MysqlDriver?[2]:[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?0===(r=n.checks.filter(function(e){return!t.checks.find(function(n){return n.name===e.name})})).length?[2]:(this.connection.logger.logSchemaBuild("dropping old check constraint: "+r.map(function(e){return'"'+e.name+'"'}).join(", ")+' from table "'+n.name+'"'),[4,this.queryRunner.dropCheckConstraints(n,r)]):[2];case 1:return e.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.dropCompositeUniqueConstraints=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?0===(r=n.uniques.filter(function(e){return e.columnNames.length>1&&!t.uniques.find(function(n){return n.name===e.name})})).length?[2]:(this.connection.logger.logSchemaBuild("dropping old unique constraint: "+r.map(function(e){return'"'+e.name+'"'}).join(", ")+' from table "'+n.name+'"'),[4,this.queryRunner.dropUniqueConstraints(n,r)]):[2];case 1:return e.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.dropOldExclusions=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return this.connection.driver instanceof u.PostgresDriver?[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?0===(r=n.exclusions.filter(function(e){return!t.exclusions.find(function(n){return n.name===e.name})})).length?[2]:(this.connection.logger.logSchemaBuild("dropping old exclusion constraint: "+r.map(function(e){return'"'+e.name+'"'}).join(", ")+' from table "'+n.name+'"'),[4,this.queryRunner.dropExclusionConstraints(n,r)]):[2];case 1:return e.sent(),[2]}})})})]:[2];case 1:return t.sent(),[2]}})})},m.prototype.createNewTables=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(r){switch(r.label){case 0:return[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(r){return e.__awaiter(n,void 0,void 0,function(){var n,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.queryRunner.loadedTables.find(function(e){var n=r.database&&r.database!==i.connection.driver.database?r.database:void 0,t=r.schema||i.connection.driver.options.schema,a=i.connection.driver.buildTableName(r.tableName,t,n);return e.name===a})?[2]:(this.connection.logger.logSchemaBuild("creating a new table: "+r.tablePath),n=t.Table.create(r,this.connection.driver),[4,this.queryRunner.createTable(n,!1,!1)]);case 1:return e.sent(),this.queryRunner.loadedTables.push(n),[2]}})})})];case 1:return r.sent(),[2]}})})},m.prototype.createViews=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.viewEntityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,r=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.queryRunner.loadedViews.find(function(e){var n=t.database&&t.database!==r.connection.driver.database?t.database:void 0,i=t.schema||r.connection.driver.options.schema,a=r.connection.driver.buildTableName(t.tableName,i,n),o="string"==typeof e.expression?e.expression.trim():e.expression(r.connection).getQuery(),s="string"==typeof t.expression?t.expression.trim():t.expression(r.connection).getQuery();return e.name===a&&o===s})?[2]:(this.connection.logger.logSchemaBuild("creating a new view: "+t.tablePath),n=f.View.create(t,this.connection.driver),[4,this.queryRunner.createView(n)]);case 1:return e.sent(),this.queryRunner.loadedViews.push(n),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.dropOldViews=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.queryRunner.loadedViews,function(t){return e.__awaiter(n,void 0,void 0,function(){var n=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.viewEntityToSyncMetadatas.find(function(e){var r=e.database&&e.database!==n.connection.driver.database?e.database:void 0,i=e.schema||n.connection.driver.options.schema,a=n.connection.driver.buildTableName(e.tableName,i,r),o="string"==typeof t.expression?t.expression.trim():t.expression(n.connection).getQuery(),s="string"==typeof e.expression?e.expression.trim():e.expression(n.connection).getQuery();return t.name===a&&o===s})?[2]:(this.connection.logger.logSchemaBuild("dropping an old view: "+t.name),[4,this.queryRunner.dropView(t)]);case 1:return e.sent(),this.queryRunner.loadedViews.splice(this.queryRunner.loadedViews.indexOf(t),1),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.dropRemovedColumns=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?0===(r=n.columns.filter(function(e){return!t.columns.find(function(n){return n.databaseName===e.name})})).length?[2]:(this.connection.logger.logSchemaBuild("columns dropped in "+n.name+": "+r.map(function(e){return e.name}).join(", ")),[4,this.queryRunner.dropColumns(n,r)]):[2];case 1:return e.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.addNewColumns=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,i,a,o;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?0===(i=t.columns.filter(function(e){return!n.columns.find(function(n){return n.name===e.databaseName})})).length?[2]:(a=this.metadataColumnsToTableColumnOptions(i),0===(o=a.map(function(e){return new r.TableColumn(e)})).length?[2]:(this.connection.logger.logSchemaBuild("new columns added: "+i.map(function(e){return e.databaseName}).join(", ")),[4,this.queryRunner.addColumns(n,o)])):[2];case 1:return e.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.updatePrimaryKeys=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,i,a,o=this;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?(i=t.columns.filter(function(e){return e.isPrimary}),n.columns.filter(function(e){return e.isPrimary}).length!==i.length&&i.length>1?(a=i.map(function(e){return new r.TableColumn(s.TableUtils.createTableColumnOptions(e,o.connection.driver))}),[4,this.queryRunner.updatePrimaryKeys(n,a)]):[3,2]):[2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.updateExistColumns=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,i,a,u=this;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?0===(i=this.connection.driver.findChangedColumns(n.columns,t.columns)).length?[2]:[4,o.PromiseUtils.runInSequence(i,function(e){return u.dropColumnReferencedForeignKeys(t.tablePath,e.databaseName)})]:[2];case 1:return e.sent(),[4,o.PromiseUtils.runInSequence(i,function(e){return u.dropColumnCompositeIndices(t.tablePath,e.databaseName)})];case 2:return e.sent(),this.connection.driver instanceof c.MysqlDriver?[3,4]:[4,o.PromiseUtils.runInSequence(i,function(e){return u.dropColumnCompositeUniques(t.tablePath,e.databaseName)})];case 3:e.sent(),e.label=4;case 4:return 0===(a=i.map(function(e){var t=n.columns.find(function(n){return n.name===e.databaseName}),i=s.TableUtils.createTableColumnOptions(e,u.connection.driver);return{oldColumn:t,newColumn:new r.TableColumn(i)}})).length?[2]:(this.connection.logger.logSchemaBuild('columns changed in "'+n.name+'". updating: '+i.map(function(e){return e.databaseName}).join(", ")),[4,this.queryRunner.changeColumns(n,a)]);case 5:return e.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.createNewIndices=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?0===(r=t.indices.filter(function(e){return!n.indices.find(function(n){return n.name===e.name})&&!0===e.synchronize}).map(function(e){return a.TableIndex.create(e)})).length?[2]:(this.connection.logger.logSchemaBuild("adding new indices "+r.map(function(e){return'"'+e.name+'"'}).join(", ")+' in table "'+n.name+'"'),[4,this.queryRunner.createIndices(n,r)]):[2];case 1:return e.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.createNewChecks=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return this.connection.driver instanceof c.MysqlDriver?[2]:[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?0===(r=t.checks.filter(function(e){return!n.checks.find(function(n){return n.name===e.name})}).map(function(e){return d.TableCheck.create(e)})).length?[2]:(this.connection.logger.logSchemaBuild("adding new check constraints: "+r.map(function(e){return'"'+e.name+'"'}).join(", ")+' in table "'+n.name+'"'),[4,this.queryRunner.createCheckConstraints(n,r)]):[2];case 1:return e.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.createCompositeUniqueConstraints=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?0===(r=t.uniques.filter(function(e){return e.columns.length>1&&!n.uniques.find(function(n){return n.name===e.name})}).map(function(e){return l.TableUnique.create(e)})).length?[2]:(this.connection.logger.logSchemaBuild("adding new unique constraints: "+r.map(function(e){return'"'+e.name+'"'}).join(", ")+' in table "'+n.name+'"'),[4,this.queryRunner.createUniqueConstraints(n,r)]):[2];case 1:return e.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.createNewExclusions=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return this.connection.driver instanceof u.PostgresDriver?[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?0===(r=t.exclusions.filter(function(e){return!n.exclusions.find(function(n){return n.name===e.name})}).map(function(e){return h.TableExclusion.create(e)})).length?[2]:(this.connection.logger.logSchemaBuild("adding new exclusion constraints: "+r.map(function(e){return'"'+e.name+'"'}).join(", ")+' in table "'+n.name+'"'),[4,this.queryRunner.createExclusionConstraints(n,r)]):[2];case 1:return e.sent(),[2]}})})})]:[2];case 1:return t.sent(),[2]}})})},m.prototype.createForeignKeys=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,o.PromiseUtils.runInSequence(this.entityToSyncMetadatas,function(t){return e.__awaiter(n,void 0,void 0,function(){var n,r,a;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.queryRunner.loadedTables.find(function(e){return e.name===t.tablePath}))?0===(r=t.foreignKeys.filter(function(e){return!n.foreignKeys.find(function(n){return n.name===e.name})})).length?[2]:(a=r.map(function(e){return i.TableForeignKey.create(e)}),this.connection.logger.logSchemaBuild("creating a foreign keys: "+r.map(function(e){return e.name}).join(", ")+' on table "'+n.name+'"'),[4,this.queryRunner.createForeignKeys(n,a)]):[2];case 1:return e.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},m.prototype.dropColumnReferencedForeignKeys=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,a,s,u=this;return e.__generator(this,function(e){switch(e.label){case 0:return(r=this.queryRunner.loadedTables.find(function(e){return e.name===n}))?(i=[],(a=r.foreignKeys.find(function(e){return-1!==e.columnNames.indexOf(t)}))&&((s=r.clone()).foreignKeys=[a],i.push(s),r.removeForeignKey(a)),this.queryRunner.loadedTables.forEach(function(e){var r=e.foreignKeys.filter(function(e){return e.referencedTableName===n&&-1!==e.referencedColumnNames.indexOf(t)});if(r.length>0){var a=e.clone();a.foreignKeys=r,i.push(a),r.forEach(function(n){return e.removeForeignKey(n)})}}),i.length>0?[4,o.PromiseUtils.runInSequence(i,function(e){return u.connection.logger.logSchemaBuild("dropping related foreign keys of "+e.name+": "+e.foreignKeys.map(function(e){return e.name}).join(", ")),u.queryRunner.dropForeignKeys(e,e.foreignKeys)})]:[3,2]):[2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},m.prototype.dropColumnCompositeIndices=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i;return e.__generator(this,function(e){switch(e.label){case 0:return(r=this.queryRunner.loadedTables.find(function(e){return e.name===n}))?0===(i=r.indices.filter(function(e){return e.columnNames.length>1&&-1!==e.columnNames.indexOf(t)})).length?[2]:(this.connection.logger.logSchemaBuild('dropping related indices of "'+n+'"."'+t+'": '+i.map(function(e){return e.name}).join(", ")),[4,this.queryRunner.dropIndices(r,i)]):[2];case 1:return e.sent(),[2]}})})},m.prototype.dropColumnCompositeUniques=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i;return e.__generator(this,function(e){switch(e.label){case 0:return(r=this.queryRunner.loadedTables.find(function(e){return e.name===n}))?0===(i=r.uniques.filter(function(e){return e.columnNames.length>1&&-1!==e.columnNames.indexOf(t)})).length?[2]:(this.connection.logger.logSchemaBuild('dropping related unique constraints of "'+n+'"."'+t+'": '+i.map(function(e){return e.name}).join(", ")),[4,this.queryRunner.dropUniqueConstraints(r,i)]):[2];case 1:return e.sent(),[2]}})})},m.prototype.metadataColumnsToTableColumnOptions=function(e){var n=this;return e.map(function(e){return s.TableUtils.createTableColumnOptions(e,n.connection.driver)})},m.prototype.createTypeormMetadataTable=function(){return e.__awaiter(this,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:return n=this.connection.driver.options,r=this.connection.driver.buildTableName("typeorm_metadata",n.schema,n.database),[4,this.queryRunner.createTable(new t.Table({name:r,columns:[{name:"type",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataType}),isNullable:!1},{name:"database",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataDatabase}),isNullable:!0},{name:"schema",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataSchema}),isNullable:!0},{name:"table",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataTable}),isNullable:!0},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataName}),isNullable:!0},{name:"value",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataValue}),isNullable:!0}]}),!0)];case 1:return e.sent(),[2]}})})},m}();exports.RdbmsSchemaBuilder=p;
},{"tslib":"c4AP","../driver/cockroachdb/CockroachDriver":"mleT","./table/Table":"e+Cn","./table/TableColumn":"SdPr","./table/TableForeignKey":"0LZF","./table/TableIndex":"S7W/","../util/PromiseUtils":"DcM6","./util/TableUtils":"yIl2","../driver/postgres/PostgresDriver":"TOLf","../driver/mysql/MysqlDriver":"TOLf","./table/TableUnique":"9Ztg","./table/TableCheck":"oxtv","./table/TableExclusion":"Lhin","./view/View":"fSdu"}],"sMRg":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports.SqlServerDriver=void 0;var t=m(require("tslib")),r=require("../../error/ConnectionIsNotSetError"),i=require("../../error/DriverPackageNotInstalledError"),n=require("../DriverUtils"),a=require("./SqlServerQueryRunner"),o=require("../../util/DateUtils"),s=require("../../platform/PlatformTools"),l=require("../../schema-builder/RdbmsSchemaBuilder"),p=require("./MssqlParameter"),u=require("../../util/OrmUtils"),c=require("../../util/ApplyValueTransformers");function m(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var h=function(){function m(e){this.slaves=[],this.isReplicated=!1,this.treeSupport=!0,this.supportedDataTypes=["int","bigint","bit","decimal","money","numeric","smallint","smallmoney","tinyint","float","real","date","datetime2","datetime","datetimeoffset","smalldatetime","time","char","varchar","text","nchar","nvarchar","ntext","binary","image","varbinary","hierarchyid","sql_variant","timestamp","uniqueidentifier","xml","geometry","geography","rowversion"],this.spatialTypes=["geometry","geography"],this.withLengthColumnTypes=["char","varchar","nchar","nvarchar","binary","varbinary"],this.withPrecisionColumnTypes=["decimal","numeric","time","datetime2","datetimeoffset"],this.withScaleColumnTypes=["decimal","numeric"],this.mappedDataTypes={createDate:"datetime2",createDateDefault:"getdate()",updateDate:"datetime2",updateDateDefault:"getdate()",version:"int",treeLevel:"int",migrationId:"int",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"nvarchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"nvarchar(MAX)",cacheResult:"nvarchar(MAX)",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"nvarchar(MAX)"},this.dataTypeDefaults={char:{length:1},nchar:{length:1},varchar:{length:255},nvarchar:{length:255},binary:{length:1},varbinary:{length:1},decimal:{precision:18,scale:0},numeric:{precision:18,scale:0},time:{precision:7},datetime2:{precision:7},datetimeoffset:{precision:7}},this.maxAliasLength=128,this.connection=e,this.options=e.options,this.isReplicated=!!this.options.replication,this.loadDependencies()}return m.prototype.connect=function(){return t.__awaiter(this,void 0,void 0,function(){var e,r,i,n=this;return t.__generator(this,function(t){switch(t.label){case 0:return this.options.replication?(e=this,[4,Promise.all(this.options.replication.slaves.map(function(e){return n.createPool(n.options,e)}))]):[3,3];case 1:return e.slaves=t.sent(),r=this,[4,this.createPool(this.options,this.options.replication.master)];case 2:return r.master=t.sent(),this.database=this.options.replication.master.database,[3,5];case 3:return i=this,[4,this.createPool(this.options,this.options)];case 4:i.master=t.sent(),this.database=this.options.database,t.label=5;case 5:return[2]}})})},m.prototype.afterConnect=function(){return Promise.resolve()},m.prototype.disconnect=function(){return t.__awaiter(this,void 0,void 0,function(){var e=this;return t.__generator(this,function(t){switch(t.label){case 0:return this.master?[4,this.closePool(this.master)]:[2,Promise.reject(new r.ConnectionIsNotSetError("mssql"))];case 1:return t.sent(),[4,Promise.all(this.slaves.map(function(t){return e.closePool(t)}))];case 2:return t.sent(),this.master=void 0,this.slaves=[],[2]}})})},m.prototype.closePool=function(e){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(t){return[2,new Promise(function(t,r){e.close(function(e){return e?r(e):t()})})]})})},m.prototype.createSchemaBuilder=function(){return new l.RdbmsSchemaBuilder(this.connection)},m.prototype.createQueryRunner=function(e){return void 0===e&&(e="master"),new a.SqlServerQueryRunner(this,e)},m.prototype.escapeQueryWithParameters=function(e,t,r){var i=Object.keys(r).map(function(e){return r[e]});if(!t||!Object.keys(t).length)return[e,i];var n=Object.keys(t).map(function(e){return"(:(\\.\\.\\.)?"+e+"\\b)"}).join("|");return[e=e.replace(new RegExp(n,"g"),function(e){var r,n=!1;return":..."===e.substr(0,4)?(n=!0,r=t[e.substr(4)]):r=t[e.substr(1)],n?r.map(function(e){return i.push(e),"@"+(i.length-1)}).join(", "):r instanceof Function?r():(i.push(r),"@"+(i.length-1))}),i]},m.prototype.escape=function(e){return'"'+e+'"'},m.prototype.buildTableName=function(e,t,r){var i=e;return t&&(i=t+"."+e),r&&(i=t?r+"."+i:r+".."+e),i},m.prototype.preparePersistentValue=function(e,t){return t.transformer&&(e=c.ApplyValueTransformers.transformTo(t.transformer,e)),null==e?e:t.type===Boolean?!0===e?1:0:"date"===t.type?o.DateUtils.mixedDateToDate(e):"time"===t.type?o.DateUtils.mixedTimeToDate(e):"datetime"===t.type||"smalldatetime"===t.type||t.type===Date?o.DateUtils.mixedDateToDate(e,!1,!1):"datetime2"===t.type||"datetimeoffset"===t.type?o.DateUtils.mixedDateToDate(e,!1,!0):"simple-array"===t.type?o.DateUtils.simpleArrayToString(e):"simple-json"===t.type?o.DateUtils.simpleJsonToString(e):"simple-enum"===t.type?o.DateUtils.simpleEnumToString(e):e},m.prototype.prepareHydratedValue=function(e,t){return null==e?t.transformer?c.ApplyValueTransformers.transformFrom(t.transformer,e):e:(t.type===Boolean?e=!!e:"datetime"===t.type||t.type===Date||"datetime2"===t.type||"smalldatetime"===t.type||"datetimeoffset"===t.type?e=o.DateUtils.normalizeHydratedDate(e):"date"===t.type?e=o.DateUtils.mixedDateToDateString(e):"time"===t.type?e=o.DateUtils.mixedTimeToString(e):"simple-array"===t.type?e=o.DateUtils.stringToSimpleArray(e):"simple-json"===t.type?e=o.DateUtils.stringToSimpleJson(e):"simple-enum"===t.type&&(e=o.DateUtils.stringToSimpleEnum(e,t)),t.transformer&&(e=c.ApplyValueTransformers.transformFrom(t.transformer,e)),e)},m.prototype.normalizeType=function(t){return t.type===Number||"integer"===t.type?"int":t.type===String?"nvarchar":t.type===Date?"datetime":t.type===Boolean?"bit":t.type===e?"binary":"uuid"===t.type?"uniqueidentifier":"simple-array"===t.type||"simple-json"===t.type?"ntext":"simple-enum"===t.type?"nvarchar":"dec"===t.type?"decimal":"double precision"===t.type?"float":"rowversion"===t.type?"timestamp":t.type||""},m.prototype.normalizeDefault=function(e){var t=e.default;return"number"==typeof t?""+t:"boolean"==typeof t?!0===t?"1":"0":"function"==typeof t?t():"string"==typeof t?"'"+t+"'":t},m.prototype.normalizeIsUnique=function(e){return e.entityMetadata.uniques.some(function(t){return 1===t.columns.length&&t.columns[0]===e})},m.prototype.getColumnLength=function(e){return e.length?e.length.toString():"varchar"===e.type||"nvarchar"===e.type||e.type===String?"255":""},m.prototype.createFullType=function(e){var t=e.type;return this.getColumnLength(e)?t+="("+this.getColumnLength(e)+")":null!==e.precision&&void 0!==e.precision&&null!==e.scale&&void 0!==e.scale?t+="("+e.precision+","+e.scale+")":null!==e.precision&&void 0!==e.precision&&(t+="("+e.precision+")"),e.isArray&&(t+=" array"),t},m.prototype.obtainMasterConnection=function(){return Promise.resolve(this.master)},m.prototype.obtainSlaveConnection=function(){if(!this.slaves.length)return this.obtainMasterConnection();var e=Math.floor(Math.random()*this.slaves.length);return Promise.resolve(this.slaves[e])},m.prototype.createGeneratedMap=function(e,t){var r=this;if(t)return Object.keys(t).reduce(function(i,n){var a=e.findColumnWithDatabaseName(n);return a&&u.OrmUtils.mergeDeep(i,a.createValueMap(r.prepareHydratedValue(t[n],a))),i},{})},m.prototype.findChangedColumns=function(e,t){var r=this;return t.filter(function(t){var i=e.find(function(e){return e.name===t.databaseName});return!!i&&(i.name!==t.databaseName||i.type!==r.normalizeType(t)||i.length!==t.length||i.precision!==t.precision||i.scale!==t.scale||!i.isGenerated&&r.lowerDefaultValueIfNessesary(r.normalizeDefault(t))!==r.lowerDefaultValueIfNessesary(i.default)||i.isPrimary!==t.isPrimary||i.isNullable!==t.isNullable||i.isUnique!==r.normalizeIsUnique(t)||i.isGenerated!==t.isGenerated)})},m.prototype.lowerDefaultValueIfNessesary=function(e){return e?e.split("'").map(function(e,t){return t%2==1?e:e.toLowerCase()}).join("'"):e},m.prototype.isReturningSqlSupported=function(){return!this.options.options||!this.options.options.disableOutputReturning},m.prototype.isUUIDGenerationSupported=function(){return!0},m.prototype.createParameter=function(e,t){return"@"+t},m.prototype.parametrizeValue=function(e,t){if(t instanceof p.MssqlParameter)return t;var r=this.normalizeType({type:e.type});return e.length?new p.MssqlParameter(t,r,e.length):null!==e.precision&&void 0!==e.precision&&null!==e.scale&&void 0!==e.scale?new p.MssqlParameter(t,r,e.precision,e.scale):null!==e.precision&&void 0!==e.precision?new p.MssqlParameter(t,r,e.precision):null!==e.scale&&void 0!==e.scale?new p.MssqlParameter(t,r,e.scale):new p.MssqlParameter(t,r)},m.prototype.parametrizeMap=function(e,t){var r=this;if(!this.connection.hasMetadata(e))return t;var i=this.connection.getMetadata(e);return Object.keys(t).reduce(function(e,n){var a=t[n],o=i.findColumnWithDatabaseName(n);return o?(e[n]=r.parametrizeValue(o,a),e):a},{})},m.prototype.loadDependencies=function(){try{this.mssql=s.PlatformTools.load("mssql")}catch(e){throw new i.DriverPackageNotInstalledError("SQL Server","mssql")}},m.prototype.createPool=function(e,t){var r=this;t=Object.assign(t,n.DriverUtils.buildDriverOptions(t));var i=Object.assign({},{connectionTimeout:this.options.connectionTimeout,requestTimeout:this.options.requestTimeout,stream:this.options.stream,pool:this.options.pool,options:this.options.options},{server:t.host,user:t.username,password:t.password,database:t.database,port:t.port,domain:t.domain},e.extra||{});return i.options?i.options.useUTC||(i.options.useUTC=!1):i.options={useUTC:!1},new Promise(function(e,t){var n=new r.mssql.ConnectionPool(i),a=r.connection.logger;n.on("error",function(e){return a.log("warn","MSSQL pool raised an error. "+e)});var o=n.connect(function(r){if(r)return t(r);e(o)})})},m}();exports.SqlServerDriver=h;
},{"tslib":"c4AP","../../error/ConnectionIsNotSetError":"jWtv","../../error/DriverPackageNotInstalledError":"NaUg","../DriverUtils":"hdhF","./SqlServerQueryRunner":"c5/o","../../util/DateUtils":"iWm2","../../platform/PlatformTools":"YF44","../../schema-builder/RdbmsSchemaBuilder":"leiv","./MssqlParameter":"FBTY","../../util/OrmUtils":"R//v","../../util/ApplyValueTransformers":"p0mU","buffer":"iHVs"}],"ncIU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MigrationExecutor=void 0;var e=s(require("tslib")),t=require("../schema-builder/table/Table"),n=require("./Migration"),r=require("../util/PromiseUtils"),i=require("../driver/sqlserver/SqlServerDriver"),a=require("../driver/sqlserver/MssqlParameter"),o=require("../driver/mongodb/MongoDriver");function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}var c=function(){function s(e,t){this.connection=e,this.queryRunner=t,this.transaction=!0;var n=this.connection.driver.options;this.migrationsTableName=e.options.migrationsTableName||"migrations",this.migrationsTable=this.connection.driver.buildTableName(this.migrationsTableName,n.schema,n.database)}return s.prototype.showMigrations=function(){return e.__awaiter(this,void 0,void 0,function(){var t,n,r,i,a,o,s,c,u,l,m;return e.__generator(this,function(h){switch(h.label){case 0:return r=!1,i=this.queryRunner||this.connection.createQueryRunner("master"),[4,this.createMigrationsTableIfNotExist(i)];case 1:return h.sent(),[4,this.loadExecutedMigrations(i)];case 2:a=h.sent(),o=this.getMigrations(),s=function(e){a.find(function(t){return t.name===e.name})?c.connection.logger.logSchemaBuild(" [X] "+e.name):(r=!0,c.connection.logger.logSchemaBuild(" [ ] "+e.name))},c=this;try{for(u=e.__values(o),l=u.next();!l.done;l=u.next())m=l.value,s(m)}catch(d){t={error:d}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return this.queryRunner?[3,4]:[4,i.release()];case 3:h.sent(),h.label=4;case 4:return[2,r]}})})},s.prototype.executePendingMigrations=function(){return e.__awaiter(this,void 0,void 0,function(){var t,n,i,a,o,s,c,u,l=this;return e.__generator(this,function(e){switch(e.label){case 0:return t=this.queryRunner||this.connection.createQueryRunner("master"),[4,this.createMigrationsTableIfNotExist(t)];case 1:return e.sent(),[4,this.loadExecutedMigrations(t)];case 2:return n=e.sent(),i=this.getLatestTimestampMigration(n),a=this.getMigrations(),o=[],(s=a.filter(function(e){return!n.find(function(t){return t.name===e.name})})).length?[3,5]:(this.connection.logger.logSchemaBuild("No migrations are pending"),this.queryRunner?[3,4]:[4,t.release()]);case 3:e.sent(),e.label=4;case 4:return[2,[]];case 5:return this.connection.logger.logSchemaBuild(n.length+" migrations are already loaded in the database."),this.connection.logger.logSchemaBuild(a.length+" migrations were found in the source code."),i&&this.connection.logger.logSchemaBuild(i.name+" is the last executed migration. It was executed on "+new Date(i.timestamp).toString()+"."),this.connection.logger.logSchemaBuild(s.length+" migrations are new migrations that needs to be executed."),c=!1,!this.transaction||t.isTransactionActive?[3,7]:[4,t.startTransaction()];case 6:e.sent(),c=!0,e.label=7;case 7:return e.trys.push([7,11,16,19]),[4,r.PromiseUtils.runInSequence(s,function(e){return e.instance.up(t).then(function(){return l.insertExecutedMigration(t,e)}).then(function(){o.push(e),l.connection.logger.logSchemaBuild("Migration "+e.name+" has been executed successfully.")})})];case 8:return e.sent(),c?[4,t.commitTransaction()]:[3,10];case 9:e.sent(),e.label=10;case 10:return[3,19];case 11:if(u=e.sent(),!c)return[3,15];e.label=12;case 12:return e.trys.push([12,14,,15]),[4,t.rollbackTransaction()];case 13:return e.sent(),[3,15];case 14:return e.sent(),[3,15];case 15:throw u;case 16:return this.queryRunner?[3,18]:[4,t.release()];case 17:e.sent(),e.label=18;case 18:return[7];case 19:return[2,o]}})})},s.prototype.undoLastMigration=function(){return e.__awaiter(this,void 0,void 0,function(){var t,n,r,i,a,o,s;return e.__generator(this,function(e){switch(e.label){case 0:return t=this.queryRunner||this.connection.createQueryRunner("master"),[4,this.createMigrationsTableIfNotExist(t)];case 1:return e.sent(),[4,this.loadExecutedMigrations(t)];case 2:if(n=e.sent(),!(r=this.getLatestExecutedMigration(n)))return this.connection.logger.logSchemaBuild("No migrations was found in the database. Nothing to revert!"),[2];if(i=this.getMigrations(),!(a=i.find(function(e){return e.name===r.name})))throw new Error("No migration "+r.name+" was found in the source code. Make sure you have this migration in your codebase and its included in the connection options.");return this.connection.logger.logSchemaBuild(n.length+" migrations are already loaded in the database."),this.connection.logger.logSchemaBuild(r.name+" is the last executed migration. It was executed on "+new Date(r.timestamp).toString()+"."),this.connection.logger.logSchemaBuild("Now reverting it..."),o=!1,!this.transaction||t.isTransactionActive?[3,4]:[4,t.startTransaction()];case 3:e.sent(),o=!0,e.label=4;case 4:return e.trys.push([4,9,14,17]),[4,a.instance.down(t)];case 5:return e.sent(),[4,this.deleteExecutedMigration(t,a)];case 6:return e.sent(),this.connection.logger.logSchemaBuild("Migration "+a.name+" has been reverted successfully."),o?[4,t.commitTransaction()]:[3,8];case 7:e.sent(),e.label=8;case 8:return[3,17];case 9:if(s=e.sent(),!o)return[3,13];e.label=10;case 10:return e.trys.push([10,12,,13]),[4,t.rollbackTransaction()];case 11:return e.sent(),[3,13];case 12:return e.sent(),[3,13];case 13:throw s;case 14:return this.queryRunner?[3,16]:[4,t.release()];case 15:e.sent(),e.label=16;case 16:return[7];case 17:return[2]}})})},s.prototype.createMigrationsTableIfNotExist=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return this.connection.driver instanceof o.MongoDriver?[2]:[4,n.hasTable(this.migrationsTable)];case 1:return e.sent()?[3,3]:[4,n.createTable(new t.Table({name:this.migrationsTable,columns:[{name:"id",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationId}),isGenerated:!0,generationStrategy:"increment",isPrimary:!0,isNullable:!1},{name:"timestamp",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp}),isPrimary:!1,isNullable:!1},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}),isNullable:!1}]}))];case 2:e.sent(),e.label=3;case 3:return[2]}})})},s.prototype.loadExecutedMigrations=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return this.connection.driver instanceof o.MongoDriver?[4,t.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).find().toArray()]:[3,2];case 1:return[2,e.sent()];case 2:return[4,this.connection.manager.createQueryBuilder(t).select().from(this.migrationsTable,this.migrationsTableName).getRawMany()];case 3:return[2,e.sent().map(function(e){return new n.Migration(parseInt(e.id),parseInt(e.timestamp),e.name)})]}})})},s.prototype.getMigrations=function(){return this.connection.migrations.map(function(e){var t=e.constructor.name,r=parseInt(t.substr(-13));if(!r)throw new Error(t+" migration name is wrong. Migration class name should have a JavaScript timestamp appended.");return new n.Migration(void 0,r,t,e)}).sort(function(e,t){return e.timestamp-t.timestamp})},s.prototype.getLatestTimestampMigration=function(e){var t=e.map(function(e){return e}).sort(function(e,t){return-1*(e.timestamp-t.timestamp)});return t.length>0?t[0]:void 0},s.prototype.getLatestExecutedMigration=function(e){var t=e.map(function(e){return e}).sort(function(e,t){return-1*((e.id||0)-(t.id||0))});return t.length>0?t[0]:void 0},s.prototype.insertExecutedMigration=function(t,n){return e.__awaiter(this,void 0,void 0,function(){var r;return e.__generator(this,function(e){switch(e.label){case 0:return r={},this.connection.driver instanceof i.SqlServerDriver?(r.timestamp=new a.MssqlParameter(n.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),r.name=new a.MssqlParameter(n.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(r.timestamp=n.timestamp,r.name=n.name),this.connection.driver instanceof o.MongoDriver?(t.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).insert(r),[3,3]):[3,1];case 1:return[4,t.manager.createQueryBuilder().insert().into(this.migrationsTable).values(r).execute()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},s.prototype.deleteExecutedMigration=function(t,n){return e.__awaiter(this,void 0,void 0,function(){var r,s;return e.__generator(this,function(e){switch(e.label){case 0:return r={},this.connection.driver instanceof i.SqlServerDriver?(r.timestamp=new a.MssqlParameter(n.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),r.name=new a.MssqlParameter(n.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(r.timestamp=n.timestamp,r.name=n.name),this.connection.driver instanceof o.MongoDriver?(t.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).deleteOne(r),[3,3]):[3,1];case 1:return[4,(s=t.manager.createQueryBuilder()).delete().from(this.migrationsTable).where(s.escape("timestamp")+" = :timestamp").andWhere(s.escape("name")+" = :name").setParameters(r).execute()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},s}();exports.MigrationExecutor=c;
},{"tslib":"c4AP","../schema-builder/table/Table":"e+Cn","./Migration":"aCGP","../util/PromiseUtils":"DcM6","../driver/sqlserver/SqlServerDriver":"sMRg","../driver/sqlserver/MssqlParameter":"FBTY","../driver/mongodb/MongoDriver":"TOLf"}],"oIFM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MissingPrimaryColumnError=void 0;var r=e(require("tslib"));function e(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,t):{};o.get||o.set?Object.defineProperty(e,t,o):e[t]=r[t]}return e.default=r,e}var t=function(e){function t(r){var o=e.call(this)||this;return o.name="MissingPrimaryColumnError",Object.setPrototypeOf(o,t.prototype),o.message='Entity "'+r.name+'" does not have a primary column. Primary column is required to have in all your entities. Use @PrimaryColumn decorator to add a primary column to your entity.',o}return r.__extends(t,e),t}(Error);exports.MissingPrimaryColumnError=t;
},{"tslib":"c4AP"}],"Stne":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CircularRelationsError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(e){var o=r.call(this)||this;return o.name="CircularRelationsError",Object.setPrototypeOf(o,t.prototype),o.message="Circular relations detected: "+e+". To resolve this issue you need to set nullable: false somewhere in this dependency structure.",o}return e.__extends(t,r),t}(Error);exports.CircularRelationsError=t;
},{"tslib":"c4AP"}],"4GmG":[function(require,module,exports) {
"use strict";function e(e,o,t){var n=[],i={};return function s(r){i[r]=!0,n.push(r),e[r].forEach(function(e){if(i[e]){if(n.indexOf(e)>=0)throw n.push(e),new Error("Dependency Cycle Found: "+n.join(" -> "))}else s(e)}),n.pop(),o&&0!==e[r].length||-1!==t.indexOf(r)||t.push(r)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.DepGraph=void 0;var o=function(){function o(){this.nodes={},this.outgoingEdges={},this.incomingEdges={}}return o.prototype.addNode=function(e,o){this.hasNode(e)||(2===arguments.length?this.nodes[e]=o:this.nodes[e]=e,this.outgoingEdges[e]=[],this.incomingEdges[e]=[])},o.prototype.removeNode=function(e){this.hasNode(e)&&(delete this.nodes[e],delete this.outgoingEdges[e],delete this.incomingEdges[e],[this.incomingEdges,this.outgoingEdges].forEach(function(o){Object.keys(o).forEach(function(t){var n=o[t].indexOf(e);n>=0&&o[t].splice(n,1)},this)}))},o.prototype.hasNode=function(e){return this.nodes.hasOwnProperty(e)},o.prototype.getNodeData=function(e){if(this.hasNode(e))return this.nodes[e];throw new Error("Node does not exist: "+e)},o.prototype.setNodeData=function(e,o){if(!this.hasNode(e))throw new Error("Node does not exist: "+e);this.nodes[e]=o},o.prototype.addDependency=function(e,o){if(!this.hasNode(e))throw new Error("Node does not exist: "+e);if(!this.hasNode(o))throw new Error("Node does not exist: "+o);return-1===this.outgoingEdges[e].indexOf(o)&&this.outgoingEdges[e].push(o),-1===this.incomingEdges[o].indexOf(e)&&this.incomingEdges[o].push(e),!0},o.prototype.removeDependency=function(e,o){var t;this.hasNode(e)&&(t=this.outgoingEdges[e].indexOf(o))>=0&&this.outgoingEdges[e].splice(t,1),this.hasNode(o)&&(t=this.incomingEdges[o].indexOf(e))>=0&&this.incomingEdges[o].splice(t,1)},o.prototype.dependenciesOf=function(o,t){if(this.hasNode(o)){var n=[];e(this.outgoingEdges,t,n)(o);var i=n.indexOf(o);return i>=0&&n.splice(i,1),n}throw new Error("Node does not exist: "+o)},o.prototype.dependantsOf=function(o,t){if(this.hasNode(o)){var n=[];e(this.incomingEdges,t,n)(o);var i=n.indexOf(o);return i>=0&&n.splice(i,1),n}throw new Error("Node does not exist: "+o)},o.prototype.overallOrder=function(o){var t=this,n=[],i=Object.keys(this.nodes);if(0===i.length)return n;var s=e(this.outgoingEdges,!1,[]);i.forEach(function(e){s(e)});var r=e(this.outgoingEdges,o,n);return i.filter(function(e){return 0===t.incomingEdges[e].length}).forEach(function(e){r(e)}),n},o}();exports.DepGraph=o;
},{}],"37ah":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DataTypeNotSupportedError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e,o,a){var p=t.call(this)||this;p.name="DataTypeNotSupportedError",Object.setPrototypeOf(p,r.prototype);var n="string"==typeof o?o:o.name;return p.message='Data type "'+n+'" in "'+e.entityMetadata.targetName+"."+e.propertyName+'" is not supported by "'+a+'" database.',p}return e.__extends(r,t),r}(Error);exports.DataTypeNotSupportedError=r;
},{"tslib":"c4AP"}],"R1xW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NoConnectionOptionError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,o):{};r.get||r.set?Object.defineProperty(t,o,r):t[o]=e[o]}return t.default=e,t}var o=function(t){function o(e){var r=t.call(this)||this;return Object.setPrototypeOf(r,o.prototype),r.message='Option "'+e+'" is not set in your connection options, please define "'+e+'" option in your connection options or ormconfig.json',r}return e.__extends(o,t),o}(Error);exports.NoConnectionOptionError=o;
},{"tslib":"c4AP"}],"AZNW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InitializedRelationError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(e){var o=r.call(this)||this;return Object.setPrototypeOf(o,t.prototype),o.message='Array initializations are not allowed in entity relations. Please remove array initialization (= []) from "'+e.entityMetadata.targetName+"#"+e.propertyPath+'". This is ORM requirement to make relations to work properly. Refer docs for more information.',o}return e.__extends(t,r),t}(Error);exports.InitializedRelationError=t;
},{"tslib":"c4AP"}],"A5sy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityMetadataValidator=void 0;var e=require("../error/MissingPrimaryColumnError"),r=require("../error/CircularRelationsError"),n=require("../util/DepGraph"),t=require("../error/DataTypeNotSupportedError"),i=require("../driver/mongodb/MongoDriver"),o=require("../driver/sqlserver/SqlServerDriver"),a=require("../driver/mysql/MysqlDriver"),s=require("../error/NoConnectionOptionError"),l=require("../error/InitializedRelationError"),u=function(){function u(){}return u.prototype.validateMany=function(e,r){var n=this;e.forEach(function(t){return n.validate(t,e,r)}),this.validateDependencies(e),this.validateEagerRelations(e)},u.prototype.validate=function(r,n,u){if(!r.primaryColumns.length&&!r.isJunction)throw new e.MissingPrimaryColumnError(r);if("STI"===r.inheritancePattern){if(!r.discriminatorColumn)throw new Error("Entity "+r.name+" using single-table inheritance, it should also have a discriminator column. Did you forget to put discriminator column options?");if(-1!==["",void 0,null].indexOf(r.discriminatorValue))throw new Error("Entity "+r.name+" has empty discriminator value. Discriminator value should not be empty.");var c=n.find(function(e){return e!==r&&e.discriminatorValue===r.discriminatorValue});if(c)throw new Error("Entities "+r.name+" and "+c.name+" as equal discriminator values. Make sure their discriminator values are not equal using @DiscriminatorValue decorator.")}if((r.relationCounts.forEach(function(e){if(e.relation.isManyToOne||e.relation.isOneToOne)throw new Error("Relation count can not be implemented on ManyToOne or OneToOne relations.")}),u instanceof i.MongoDriver||r.columns.forEach(function(e){var n=u.normalizeType(e);if(-1===u.supportedDataTypes.indexOf(n))throw new t.DataTypeNotSupportedError(e,n,u.options.type);if(e.length&&-1===u.withLengthColumnTypes.indexOf(n))throw new Error("Column "+e.propertyName+" of Entity "+r.name+" does not support length property.")}),u instanceof a.MysqlDriver)&&r.columns.filter(function(e){return e.isGenerated&&"uuid"!==e.generationStrategy}).length>1)throw new Error("Error in "+r.name+" entity. There can be only one auto-increment column in MySql table.");if(u instanceof a.MysqlDriver&&(0===n.filter(function(e){return e.database}).length&&!u.database))throw new s.NoConnectionOptionError("database");if(u instanceof o.SqlServerDriver&&r.columns.filter(function(e){return e.charset}).length>1)throw new Error("Character set specifying is not supported in Sql Server");var d=r.create();r.relations.forEach(function(e){if(e.isManyToMany||e.isOneToMany){if(!1===e.persistenceEnabled)return;if(e.getEntityValue(d)instanceof Array)throw new l.InitializedRelationError(e)}}),r.relations.forEach(function(e){}),r.relations.forEach(function(e){if(e.isCascadeRemove&&e.inverseRelation&&e.inverseRelation.isCascadeRemove)throw new Error("Relation "+r.name+"#"+e.propertyName+" and "+e.inverseRelation.entityMetadata.name+"#"+e.inverseRelation.propertyName+" both has cascade remove set. This may lead to unexpected circular removals. Please set cascade remove only from one side of relationship.")}),r.eagerRelations.forEach(function(e){})},u.prototype.validateDependencies=function(e){var t=new n.DepGraph;e.forEach(function(e){t.addNode(e.name)}),e.forEach(function(e){e.relationsWithJoinColumns.filter(function(e){return!e.isNullable}).forEach(function(r){t.addDependency(e.name,r.inverseEntityMetadata.name)})});try{t.overallOrder()}catch(i){throw new r.CircularRelationsError(i.toString().replace("Error: Dependency Cycle Found: ",""))}},u.prototype.validateEagerRelations=function(e){e.forEach(function(e){e.eagerRelations.forEach(function(r){if(r.inverseRelation&&r.inverseRelation.isEager)throw new Error("Circular eager relations are disallowed. "+e.targetName+"#"+r.propertyPath+' contains "eager: true", and its inverse side '+r.inverseEntityMetadata.targetName+"#"+r.inverseRelation.propertyPath+' contains "eager: true" as well. Remove "eager: true" from one side of the relation.')})})},u}();exports.EntityMetadataValidator=u;
},{"../error/MissingPrimaryColumnError":"oIFM","../error/CircularRelationsError":"Stne","../util/DepGraph":"4GmG","../error/DataTypeNotSupportedError":"37ah","../driver/mongodb/MongoDriver":"TOLf","../driver/sqlserver/SqlServerDriver":"sMRg","../driver/mysql/MysqlDriver":"TOLf","../error/NoConnectionOptionError":"R1xW","../error/InitializedRelationError":"AZNW"}],"sQhW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QueryRunnerProviderAlreadyReleasedError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(){var e=r.call(this)||this;return e.name="QueryRunnerProviderAlreadyReleasedError",Object.setPrototypeOf(e,t.prototype),e.message="Database connection provided by a query runner was already released, cannot continue to use its querying methods anymore.",e}return e.__extends(t,r),t}(Error);exports.QueryRunnerProviderAlreadyReleasedError=t;
},{"tslib":"c4AP"}],"SRxF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityNotFoundError=void 0;var t=r(require("tslib")),e=require("../index");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}var n=function(r){function n(t,o){var i,u=r.call(this)||this;u.name="EntityNotFound",Object.setPrototypeOf(u,n.prototype),i=t instanceof e.EntitySchema?t.options.name:"function"==typeof t?t.name:t;var a=u.stringifyCriteria(o);return u.message='Could not find any entity of type "'+i+'" matching: '+a,u}return t.__extends(n,r),n.prototype.stringifyCriteria=function(t){try{return JSON.stringify(t,null,4)}catch(e){}return""+t},n}(Error);exports.EntityNotFoundError=n;
},{"tslib":"c4AP","../index":"wlNf"}],"JlY9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NoNeedToReleaseEntityManagerError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(){var e=t.call(this)||this;return e.name="NoNeedToReleaseEntityManagerError",Object.setPrototypeOf(e,r.prototype),e.message="Entity manager is not using single database connection and cannot be released. Only entity managers created by connection#createEntityManagerWithSingleDatabaseConnection methods have a single database connection and they should be released.",e}return e.__extends(r,t),r}(Error);exports.NoNeedToReleaseEntityManagerError=r;
},{"tslib":"c4AP"}],"ZbgY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Repository=void 0;var t=e(require("tslib"));function e(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};a.get||a.set?Object.defineProperty(e,r,a):e[r]=t[r]}return e.default=t,e}var r=function(){function e(){}return e.prototype.createQueryBuilder=function(t,e){return this.manager.createQueryBuilder(this.metadata.target,t||this.metadata.targetName,e||this.queryRunner)},Object.defineProperty(e.prototype,"target",{get:function(){return this.metadata.target},enumerable:!0,configurable:!0}),e.prototype.hasId=function(t){return this.manager.hasId(this.metadata.target,t)},e.prototype.getId=function(t){return this.manager.getId(this.metadata.target,t)},e.prototype.create=function(t){return this.manager.create(this.metadata.target,t)},e.prototype.merge=function(e){for(var r,a=[],n=1;n<arguments.length;n++)a[n-1]=arguments[n];return(r=this.manager).merge.apply(r,t.__spread([this.metadata.target,e],a))},e.prototype.preload=function(t){return this.manager.preload(this.metadata.target,t)},e.prototype.save=function(t,e){return this.manager.save(this.metadata.target,t,e)},e.prototype.remove=function(t,e){return this.manager.remove(this.metadata.target,t,e)},e.prototype.insert=function(t){return this.manager.insert(this.metadata.target,t)},e.prototype.update=function(t,e){return this.manager.update(this.metadata.target,t,e)},e.prototype.delete=function(t){return this.manager.delete(this.metadata.target,t)},e.prototype.count=function(t){return this.manager.count(this.metadata.target,t)},e.prototype.find=function(t){return this.manager.find(this.metadata.target,t)},e.prototype.findAndCount=function(t){return this.manager.findAndCount(this.metadata.target,t)},e.prototype.findByIds=function(t,e){return this.manager.findByIds(this.metadata.target,t,e)},e.prototype.findOne=function(t,e){return this.manager.findOne(this.metadata.target,t,e)},e.prototype.findOneOrFail=function(t,e){return this.manager.findOneOrFail(this.metadata.target,t,e)},e.prototype.query=function(t,e){return this.manager.query(t,e)},e.prototype.clear=function(){return this.manager.clear(this.metadata.target)},e.prototype.increment=function(t,e,r){return this.manager.increment(this.metadata.target,t,e,r)},e.prototype.decrement=function(t,e,r){return this.manager.decrement(this.metadata.target,t,e,r)},e}();exports.Repository=r;
},{"tslib":"c4AP"}],"1srY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractSqliteDriver=void 0;var e=i(require("tslib")),t=require("../../util/DateUtils"),r=require("../../schema-builder/RdbmsSchemaBuilder"),n=require("../../util/OrmUtils"),a=require("../../util/ApplyValueTransformers");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var o=function(){function i(e){this.isReplicated=!1,this.treeSupport=!0,this.supportedDataTypes=["int","integer","tinyint","smallint","mediumint","bigint","unsigned big int","int2","int8","integer","character","varchar","varying character","nchar","native character","nvarchar","text","clob","text","blob","real","double","double precision","float","real","numeric","decimal","boolean","date","time","datetime"],this.withLengthColumnTypes=["character","varchar","varying character","nchar","native character","nvarchar","text","blob","clob"],this.spatialTypes=[],this.withPrecisionColumnTypes=[],this.withScaleColumnTypes=[],this.mappedDataTypes={createDate:"datetime",createDateDefault:"datetime('now')",updateDate:"datetime",updateDateDefault:"datetime('now')",version:"integer",treeLevel:"integer",migrationId:"integer",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.connection=e,this.options=e.options}return i.prototype.connect=function(){return e.__awaiter(this,void 0,void 0,function(){var t;return e.__generator(this,function(e){switch(e.label){case 0:return t=this,[4,this.createDatabaseConnection()];case 1:return t.databaseConnection=e.sent(),[2]}})})},i.prototype.afterConnect=function(){return Promise.resolve()},i.prototype.disconnect=function(){return e.__awaiter(this,void 0,void 0,function(){var t=this;return e.__generator(this,function(e){return[2,new Promise(function(e,r){t.queryRunner=void 0,t.databaseConnection.close(function(t){return t?r(t):e()})})]})})},i.prototype.createSchemaBuilder=function(){return new r.RdbmsSchemaBuilder(this.connection)},i.prototype.preparePersistentValue=function(e,r){return r.transformer&&(e=a.ApplyValueTransformers.transformTo(r.transformer,e)),null==e?e:r.type===Boolean||"boolean"===r.type?!0===e?1:0:"date"===r.type?t.DateUtils.mixedDateToDateString(e):"time"===r.type?t.DateUtils.mixedDateToTimeString(e):"datetime"===r.type||r.type===Date?t.DateUtils.mixedDateToUtcDatetimeString(e):"simple-array"===r.type?t.DateUtils.simpleArrayToString(e):"simple-json"===r.type?t.DateUtils.simpleJsonToString(e):"simple-enum"===r.type?t.DateUtils.simpleEnumToString(e):e},i.prototype.prepareHydratedValue=function(e,r){return null==e?r.transformer?a.ApplyValueTransformers.transformFrom(r.transformer,e):e:(r.type===Boolean||"boolean"===r.type?e=!!e:"datetime"===r.type||r.type===Date?(e&&"string"==typeof e&&(/^\d\d\d\d-\d\d-\d\d \d\d:\d\d/.test(e)&&(e=e.replace(" ","T")),/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d(:\d\d(\.\d\d\d)?)?$/.test(e)&&(e+="Z")),e=t.DateUtils.normalizeHydratedDate(e)):"date"===r.type?e=t.DateUtils.mixedDateToDateString(e):"time"===r.type?e=t.DateUtils.mixedTimeToString(e):"simple-array"===r.type?e=t.DateUtils.stringToSimpleArray(e):"simple-json"===r.type?e=t.DateUtils.stringToSimpleJson(e):"simple-enum"===r.type&&(e=t.DateUtils.stringToSimpleEnum(e,r)),r.transformer&&(e=a.ApplyValueTransformers.transformFrom(r.transformer,e)),e)},i.prototype.escapeQueryWithParameters=function(e,t,r){var n=Object.keys(r).map(function(e){return"boolean"==typeof r[e]?!0===r[e]?1:0:r[e]});if(!t||!Object.keys(t).length)return[e,n];var a=Object.keys(t).map(function(e){return"(:(\\.\\.\\.)?"+e+"\\b)"}).join("|");return[e=e.replace(new RegExp(a,"g"),function(e){var r,a=!1;return":..."===e.substr(0,4)?(a=!0,r=t[e.substr(4)]):r=t[e.substr(1)],a?r.map(function(e){return n.push(e),"?"}).join(", "):r instanceof Function?r():(n.push(r),"?")}),n]},i.prototype.escape=function(e){return'"'+e+'"'},i.prototype.buildTableName=function(e,t,r){return e},i.prototype.normalizeType=function(e){return e.type===Number||"int"===e.type?"integer":e.type===String?"varchar":e.type===Date?"datetime":e.type===Boolean?"boolean":"uuid"===e.type?"varchar":"simple-array"===e.type?"text":"simple-json"===e.type?"text":"simple-enum"===e.type?"varchar":e.type||""},i.prototype.normalizeDefault=function(e){var t=e.default;return"number"==typeof t?""+t:"boolean"==typeof t?!0===t?"1":"0":"function"==typeof t?t():"string"==typeof t?"'"+t+"'":t},i.prototype.normalizeIsUnique=function(e){return e.entityMetadata.uniques.some(function(t){return 1===t.columns.length&&t.columns[0]===e})},i.prototype.getColumnLength=function(e){return e.length?e.length.toString():""},i.prototype.createFullType=function(e){var t=e.type;return e.length?t+="("+e.length+")":null!==e.precision&&void 0!==e.precision&&null!==e.scale&&void 0!==e.scale?t+="("+e.precision+","+e.scale+")":null!==e.precision&&void 0!==e.precision&&(t+="("+e.precision+")"),e.isArray&&(t+=" array"),t},i.prototype.obtainMasterConnection=function(){return Promise.resolve()},i.prototype.obtainSlaveConnection=function(){return Promise.resolve()},i.prototype.createGeneratedMap=function(e,t){var r=e.generatedColumns.reduce(function(e,r){var a;return"increment"===r.generationStrategy&&t&&(a=t),a?n.OrmUtils.mergeDeep(e,r.createValueMap(a)):e},{});return Object.keys(r).length>0?r:void 0},i.prototype.findChangedColumns=function(e,t){var r=this;return t.filter(function(t){var n=e.find(function(e){return e.name===t.databaseName});return!!n&&(n.name!==t.databaseName||n.type!==r.normalizeType(t)||n.length!==t.length||n.precision!==t.precision||n.scale!==t.scale||r.normalizeDefault(t)!==n.default||n.isPrimary!==t.isPrimary||n.isNullable!==t.isNullable||n.isUnique!==r.normalizeIsUnique(t)||"uuid"!==t.generationStrategy&&n.isGenerated!==t.isGenerated)})},i.prototype.isReturningSqlSupported=function(){return!1},i.prototype.isUUIDGenerationSupported=function(){return!1},i.prototype.createParameter=function(e,t){return"?"},i.prototype.createDatabaseConnection=function(){throw new Error("Do not use AbstractSqlite directly, it has to be used with one of the sqlite drivers")},i.prototype.loadDependencies=function(){},i}();exports.AbstractSqliteDriver=o;
},{"tslib":"c4AP","../../util/DateUtils":"iWm2","../../schema-builder/RdbmsSchemaBuilder":"leiv","../../util/OrmUtils":"R//v","../../util/ApplyValueTransformers":"p0mU"}],"Ayc+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TreeRepository=void 0;var e=a(require("tslib")),t=require("./Repository"),r=require("../driver/sqlite-abstract/AbstractSqliteDriver");function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}var n=function(t){function a(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(a,t),a.prototype.findTrees=function(){return e.__awaiter(this,void 0,void 0,function(){var t,r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.findRoots()];case 1:return t=e.sent(),[4,Promise.all(t.map(function(e){return r.findDescendantsTree(e)}))];case 2:return e.sent(),[2,t]}})})},a.prototype.findRoots=function(){var e,t,r=this,a=this.manager.connection.namingStrategy.joinColumnName(this.metadata.treeParentRelation.propertyName,"id");return this.createQueryBuilder("treeEntity").where((t="treeEntity",r.manager.connection.driver.escape(t)+"."+(e=a,r.manager.connection.driver.escape(e))+" IS NULL")).getMany()},a.prototype.findDescendants=function(e){return this.createDescendantsQueryBuilder("treeEntity","treeClosure",e).getMany()},a.prototype.findDescendantsTree=function(e){var t=this;return this.createDescendantsQueryBuilder("treeEntity","treeClosure",e).getRawAndEntities().then(function(r){var a=t.createRelationMaps("treeEntity",r.raw);return t.buildChildrenEntityTree(e,r.entities,a),e})},a.prototype.countDescendants=function(e){return this.createDescendantsQueryBuilder("treeEntity","treeClosure",e).getCount()},a.prototype.createDescendantsQueryBuilder=function(e,t,a){var n=this,i=function(e){return n.manager.connection.driver.escape(e)};if("closure-table"===this.metadata.treeType){var o=this.metadata.closureJunctionTable.descendantColumns.map(function(r){return i(t)+"."+i(r.propertyPath)+" = "+i(e)+"."+i(r.referencedColumn.propertyPath)}).join(" AND "),u={},s=this.metadata.closureJunctionTable.ancestorColumns.map(function(e){return u[e.referencedColumn.propertyName]=e.referencedColumn.getEntityValue(a),i(t)+"."+i(e.propertyPath)+" = :"+e.referencedColumn.propertyName}).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,o).where(s).setParameters(u)}if("nested-set"===this.metadata.treeType){s=e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN joined."+this.metadata.nestedSetLeftColumn.propertyPath+" AND joined."+this.metadata.nestedSetRightColumn.propertyPath;var d={};o=this.metadata.treeParentRelation.joinColumns.map(function(e){var t=e.referencedColumn.propertyPath.replace(".","_");return d[t]=e.referencedColumn.getEntityValue(a),"joined."+e.referencedColumn.propertyPath+" = :"+t}).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",s).where(o,d)}if("materialized-path"===this.metadata.treeType)return this.createQueryBuilder(e).where(function(t){var i=t.subQuery().select(n.metadata.targetName+"."+n.metadata.materializedPathColumn.propertyPath,"path").from(n.metadata.target,n.metadata.targetName).whereInIds(n.metadata.getEntityIdMap(a));return t.setNativeParameters(i.expressionMap.nativeParameters),n.manager.connection.driver instanceof r.AbstractSqliteDriver?e+"."+n.metadata.materializedPathColumn.propertyPath+" LIKE "+i.getQuery()+" || '%'":e+"."+n.metadata.materializedPathColumn.propertyPath+" LIKE CONCAT("+i.getQuery()+", '%')"});throw new Error("Supported only in tree entities")},a.prototype.findAncestors=function(e){return this.createAncestorsQueryBuilder("treeEntity","treeClosure",e).getMany()},a.prototype.findAncestorsTree=function(e){var t=this;return this.createAncestorsQueryBuilder("treeEntity","treeClosure",e).getRawAndEntities().then(function(r){var a=t.createRelationMaps("treeEntity",r.raw);return t.buildParentEntityTree(e,r.entities,a),e})},a.prototype.countAncestors=function(e){return this.createAncestorsQueryBuilder("treeEntity","treeClosure",e).getCount()},a.prototype.createAncestorsQueryBuilder=function(e,t,a){var n=this;if("closure-table"===this.metadata.treeType){var i=this.metadata.closureJunctionTable.ancestorColumns.map(function(r){return t+"."+r.propertyPath+" = "+e+"."+r.referencedColumn.propertyPath}).join(" AND "),o={},u=this.metadata.closureJunctionTable.descendantColumns.map(function(e){return o[e.referencedColumn.propertyName]=e.referencedColumn.getEntityValue(a),t+"."+e.propertyPath+" = :"+e.referencedColumn.propertyName}).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,i).where(u).setParameters(o)}if("nested-set"===this.metadata.treeType){i="joined."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN "+e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" AND "+e+"."+this.metadata.nestedSetRightColumn.propertyPath;var s={};u=this.metadata.treeParentRelation.joinColumns.map(function(e){var t=e.referencedColumn.propertyPath.replace(".","_");return s[t]=e.referencedColumn.getEntityValue(a),"joined."+e.referencedColumn.propertyPath+" = :"+t}).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",i).where(u,s)}if("materialized-path"===this.metadata.treeType)return this.createQueryBuilder(e).where(function(t){var i=t.subQuery().select(n.metadata.targetName+"."+n.metadata.materializedPathColumn.propertyPath,"path").from(n.metadata.target,n.metadata.targetName).whereInIds(n.metadata.getEntityIdMap(a));return t.setNativeParameters(i.expressionMap.nativeParameters),n.manager.connection.driver instanceof r.AbstractSqliteDriver?i.getQuery()+" LIKE "+e+"."+n.metadata.materializedPathColumn.propertyPath+" || '%'":i.getQuery()+" LIKE CONCAT("+e+"."+n.metadata.materializedPathColumn.propertyPath+", '%')"});throw new Error("Supported only in tree entities")},a.prototype.createRelationMaps=function(e,t){var r=this;return t.map(function(t){var a=r.metadata.treeParentRelation.joinColumns[0],n=a.givenDatabaseName||a.databaseName,i=t[e+"_"+r.metadata.primaryColumns[0].databaseName],o=t[e+"_"+n];return{id:r.manager.connection.driver.prepareHydratedValue(i,r.metadata.primaryColumns[0]),parentId:r.manager.connection.driver.prepareHydratedValue(o,a)}})},a.prototype.buildChildrenEntityTree=function(e,t,r){var a=this,n=this.metadata.treeChildrenRelation.propertyName,i=this.metadata.primaryColumns[0].getEntityValue(e),o=r.filter(function(e){return e.parentId===i}).map(function(e){return e.id});e[n]=t.filter(function(e){return-1!==o.indexOf(e.id)}),e[n].forEach(function(e){a.buildChildrenEntityTree(e,t,r)})},a.prototype.buildParentEntityTree=function(e,t,r){var a=this,n=this.metadata.treeParentRelation.propertyName,i=this.metadata.primaryColumns[0].getEntityValue(e),o=r.find(function(e){return e.id===i}),u=t.find(function(e){return!!o&&e[a.metadata.primaryColumns[0].propertyName]===o.parentId});u&&(e[n]=u,this.buildParentEntityTree(e[n],t,r))},a}(t.Repository);exports.TreeRepository=n;
},{"tslib":"c4AP","./Repository":"ZbgY","../driver/sqlite-abstract/AbstractSqliteDriver":"1srY"}],"HV8p":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindRelationsNotFoundError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e){var o=t.call(this)||this;return Object.setPrototypeOf(o,r.prototype),1===e.length?o.message='Relation "'+e[0]+'" was not found, please check if it is correct and really exist in your entity.':o.message="Relations "+e.map(function(e){return'"'+e+'"'}).join(", ")+" were not found, please check if relations are correct and they exist in your entities.",o}return e.__extends(r,t),r}(Error);exports.FindRelationsNotFoundError=r;
},{"tslib":"c4AP"}],"oXmh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindOptionsUtils=void 0;var e=require("../error/FindRelationsNotFoundError"),n=require("../util/StringUtils"),i=function(){function i(){}return i.isFindOneOptions=function(e){var n=e;return n&&(n.select instanceof Array||n.where instanceof Object||"string"==typeof n.where||n.relations instanceof Array||n.join instanceof Object||n.order instanceof Object||n.cache instanceof Object||"boolean"==typeof n.cache||"number"==typeof n.cache||n.lock instanceof Object||n.loadRelationIds instanceof Object||"boolean"==typeof n.loadRelationIds||"boolean"==typeof n.loadEagerRelations)},i.isFindManyOptions=function(e){var n=e;return n&&(this.isFindOneOptions(n)||"number"==typeof n.skip||"number"==typeof n.take||"string"==typeof n.skip||"string"==typeof n.take)},i.extractFindManyOptionsAlias=function(e){if(this.isFindManyOptions(e)&&e.join)return e.join.alias},i.applyFindManyOptionsOrConditionsToQueryBuilder=function(e,n){return this.isFindManyOptions(n)?this.applyOptionsToQueryBuilder(e,n):n?e.where(n):e},i.applyOptionsToQueryBuilder=function(n,i){if(!i||!this.isFindOneOptions(i)&&!this.isFindManyOptions(i))return n;if(!n.expressionMap.mainAlias||!n.expressionMap.mainAlias.hasMetadata)return n;var t=n.expressionMap.mainAlias.metadata;if(i.select&&(n.select([]),i.select.forEach(function(e){if(!t.findColumnWithPropertyPath(String(e)))throw new Error(e+" column was not found in the "+t.name+" entity.");n.addSelect(n.alias+"."+e)})),i.where&&n.where(i.where),i.skip&&n.skip(i.skip),i.take&&n.take(i.take),i.order&&Object.keys(i.order).forEach(function(e){var o=i.order[e];if(!t.findColumnWithPropertyPath(e))throw new Error(e+" column was not found in the "+t.name+" entity.");switch(o){case 1:n.addOrderBy(n.alias+"."+e,"ASC");break;case-1:n.addOrderBy(n.alias+"."+e,"DESC");break;case"ASC":n.addOrderBy(n.alias+"."+e,"ASC");break;case"DESC":n.addOrderBy(n.alias+"."+e,"DESC")}}),i.relations){var o=i.relations.map(function(e){return e});if(this.applyRelationsRecursively(n,o,n.expressionMap.mainAlias.name,n.expressionMap.mainAlias.metadata,""),o.length>0)throw new e.FindRelationsNotFoundError(o)}if(i.join&&(i.join.leftJoin&&Object.keys(i.join.leftJoin).forEach(function(e){n.leftJoin(i.join.leftJoin[e],e)}),i.join.innerJoin&&Object.keys(i.join.innerJoin).forEach(function(e){n.innerJoin(i.join.innerJoin[e],e)}),i.join.leftJoinAndSelect&&Object.keys(i.join.leftJoinAndSelect).forEach(function(e){n.leftJoinAndSelect(i.join.leftJoinAndSelect[e],e)}),i.join.innerJoinAndSelect&&Object.keys(i.join.innerJoinAndSelect).forEach(function(e){n.innerJoinAndSelect(i.join.innerJoinAndSelect[e],e)})),i.cache)if(i.cache instanceof Object){var a=i.cache;n.cache(a.id,a.milliseconds)}else n.cache(i.cache);return i.lock&&("optimistic"===i.lock.mode?n.setLock(i.lock.mode,i.lock.version):"pessimistic_read"!==i.lock.mode&&"pessimistic_write"!==i.lock.mode&&"dirty_read"!==i.lock.mode||n.setLock(i.lock.mode)),!0===i.loadRelationIds?n.loadAllRelationIds():i.loadRelationIds instanceof Object&&n.loadAllRelationIds(i.loadRelationIds),n},i.applyRelationsRecursively=function(e,i,t,o,a){var r=this,s=[];if(a){var c=new RegExp("^"+a.replace(".","\\.")+"\\.");s=i.filter(function(e){return e.match(c)}).map(function(e){return e.replace(c,"")}).filter(function(e){return o.findRelationWithPropertyPath(e)})}else s=i.filter(function(e){return o.findRelationWithPropertyPath(e)});s.forEach(function(s){var c=t+"__"+s;e.connection.driver.maxAliasLength&&c.length>e.connection.driver.maxAliasLength&&(c=(0,n.shorten)(c));var l=t+"."+s;e.leftJoinAndSelect(l,c);var d=o.relations.find(function(e){return e.propertyName===s});d&&r.joinEagerRelations(e,c,d.inverseEntityMetadata),i.splice(i.indexOf(a?a+"."+s:s),1);var f=e.expressionMap.joinAttributes.find(function(e){return e.entityOrProperty===l});r.applyRelationsRecursively(e,i,f.alias.name,f.metadata,a?a+"."+s:s)})},i.joinEagerRelations=function(e,n,i){var t=this;i.eagerRelations.forEach(function(i){var o=e.connection.namingStrategy.eagerJoinRelationAlias(n,i.propertyPath);e.leftJoinAndSelect(n+"."+i.propertyPath,o),t.joinEagerRelations(e,o,i.inverseEntityMetadata)})},i}();exports.FindOptionsUtils=i;
},{"../error/FindRelationsNotFoundError":"HV8p","../util/StringUtils":"blFa"}],"vHgx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlainObjectToNewEntityTransformer=void 0;var t=function(){function t(){}return t.prototype.transform=function(t,n,e,r){return void 0===r&&(r=!1),this.groupAndTransform(t,n,e,r),t},t.prototype.groupAndTransform=function(t,n,e,r){var i=this;void 0===r&&(r=!1),e.nonVirtualColumns.forEach(function(e){var r=e.getEntityValue(n);void 0!==r&&e.setEntityValue(t,r)}),e.relations.length&&e.relations.forEach(function(e){var a=e.getEntityValue(t),o=e.getEntityValue(n,r);if(void 0!==o)if(e.isOneToMany||e.isManyToMany){if(!(o instanceof Array))return;a||(a=[],e.setEntityValue(t,a)),o.forEach(function(t){var n=a.find(function(n){return e.inverseEntityMetadata.compareEntities(t,n)});n||(n=e.inverseEntityMetadata.create(),a.push(n)),i.groupAndTransform(n,t,e.inverseEntityMetadata,r)})}else{if(!(o instanceof Object))return void(a instanceof Object||e.setEntityValue(t,o));a||(a=e.inverseEntityMetadata.create(),e.setEntityValue(t,a)),i.groupAndTransform(a,o,e.inverseEntityMetadata,r)}})},t}();exports.PlainObjectToNewEntityTransformer=t;
},{}],"vDKi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlainObjectToDatabaseEntityTransformer=void 0;var t=e(require("tslib"));function e(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}var r=function(){function t(t,e,r,n){this.plainEntity=t,this.metadata=e,this.parentLoadMapItem=r,this.relation=n}return Object.defineProperty(t.prototype,"target",{get:function(){return this.metadata.target},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.metadata.getEntityIdMixedMap(this.plainEntity)},enumerable:!0,configurable:!0}),t}(),n=function(){function t(){this.loadMapItems=[]}return Object.defineProperty(t.prototype,"mainLoadMapItem",{get:function(){return this.loadMapItems.find(function(t){return!t.relation&&!t.parentLoadMapItem})},enumerable:!0,configurable:!0}),t.prototype.addLoadMap=function(t){this.loadMapItems.find(function(e){return e.target===t.target&&e.id===t.id})||this.loadMapItems.push(t)},t.prototype.fillEntities=function(t,e){var r=this;e.forEach(function(e){var n=r.loadMapItems.find(function(r){return r.target===t&&r.metadata.compareEntities(e,r.plainEntity)});n&&(n.entity=e)})},t.prototype.groupByTargetIds=function(){var t=[];return this.loadMapItems.forEach(function(e){var r=t.find(function(t){return t.target===e.target});r||(r={target:e.target,ids:[]},t.push(r)),r.ids.push(e.id)}),t},t}(),a=function(){function e(t){this.manager=t}return e.prototype.transform=function(e,a){return t.__awaiter(this,void 0,void 0,function(){var i,o,p=this;return t.__generator(this,function(u){switch(u.label){case 0:return a.hasAllPrimaryKeys(e)?(i=new n,(o=function(e,n,p,u){var s=new r(e,n,p,u);i.addLoadMap(s),n.extractRelationValuesFromEntity(e,a.relations).filter(function(t){return null!=t}).forEach(function(e){var r=t.__read(e,3),n=r[0],a=r[1],i=r[2];return o(a,i,s,n)})})(e,a),[4,Promise.all(i.groupByTargetIds().map(function(t){return p.manager.findByIds(t.target,t.ids).then(function(e){return i.fillEntities(t.target,e)})}))]):[2,Promise.reject("Given object does not have a primary column, cannot transform it to database entity.")];case 1:return u.sent(),i.loadMapItems.forEach(function(t){t.relation&&t.entity&&t.parentLoadMapItem&&t.parentLoadMapItem.entity&&(t.relation.isManyToMany||t.relation.isOneToMany?(t.parentLoadMapItem.entity[t.relation.propertyName]||(t.parentLoadMapItem.entity[t.relation.propertyName]=[]),t.parentLoadMapItem.entity[t.relation.propertyName].push(t.entity)):t.parentLoadMapItem.entity[t.relation.propertyName]=t.entity)}),[2,i.mainLoadMapItem?i.mainLoadMapItem.entity:void 0]}})})},e}();exports.PlainObjectToDatabaseEntityTransformer=a;
},{"tslib":"c4AP"}],"Jczh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CustomRepositoryNotFoundError=void 0;var t=r(require("tslib"));function r(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var e=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,o):{};e.get||e.set?Object.defineProperty(r,o,e):r[o]=t[o]}return r.default=t,r}var o=function(r){function o(t){var e=r.call(this)||this;return e.name="CustomRepositoryNotFoundError",Object.setPrototypeOf(e,o.prototype),e.message="Custom repository "+(t instanceof Function?t.name:t.constructor.name)+" was not found. Did you forgot to put @EntityRepository decorator on it?",e}return t.__extends(o,r),o}(Error);exports.CustomRepositoryNotFoundError=o;
},{"tslib":"c4AP"}],"+WKR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CustomRepositoryDoesNotHaveEntityError=void 0;var t=e(require("tslib"));function e(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};o.get||o.set?Object.defineProperty(e,r,o):e[r]=t[r]}return e.default=t,e}var r=function(e){function r(t){var o=e.call(this)||this;return o.name="CustomRepositoryDoesNotHaveEntityError",Object.setPrototypeOf(o,r.prototype),o.message="Custom repository "+(t instanceof Function?t.name:t.constructor.name)+" does not have managed entity. Did you forget to specify entity for it @EntityRepository(MyEntity)? ",o}return t.__extends(r,e),r}(Error);exports.CustomRepositoryDoesNotHaveEntityError=r;
},{"tslib":"c4AP"}],"7cL5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractRepository=void 0;var t=require("../error/CustomRepositoryDoesNotHaveEntityError"),r=require("../index"),e=require("../error/CustomRepositoryNotFoundError"),o=function(){function o(){}return Object.defineProperty(o.prototype,"repository",{get:function(){var r=this.getCustomRepositoryTarget(this);if(!r)throw new t.CustomRepositoryDoesNotHaveEntityError(this.constructor);return this.manager.getRepository(r)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"treeRepository",{get:function(){var r=this.getCustomRepositoryTarget(this);if(!r)throw new t.CustomRepositoryDoesNotHaveEntityError(this.constructor);return this.manager.getTreeRepository(r)},enumerable:!0,configurable:!0}),o.prototype.createQueryBuilder=function(r){var e=this.getCustomRepositoryTarget(this.constructor);if(!e)throw new t.CustomRepositoryDoesNotHaveEntityError(this.constructor);return this.manager.getRepository(e).createQueryBuilder(r)},o.prototype.createQueryBuilderFor=function(t,r){return this.getRepositoryFor(t).createQueryBuilder(r)},o.prototype.getRepositoryFor=function(t){return this.manager.getRepository(t)},o.prototype.getTreeRepositoryFor=function(t){return this.manager.getTreeRepository(t)},o.prototype.getCustomRepositoryTarget=function(t){var o=(0,r.getMetadataArgsStorage)().entityRepositories.find(function(r){return r.target===(t instanceof Function?t:t.constructor)});if(!o)throw new e.CustomRepositoryNotFoundError(t);return o.entity},o}();exports.AbstractRepository=o;
},{"../error/CustomRepositoryDoesNotHaveEntityError":"+WKR","../index":"wlNf","../error/CustomRepositoryNotFoundError":"Jczh"}],"kYQb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CustomRepositoryCannotInheritRepositoryError=void 0;var t=e(require("tslib"));function e(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};o.get||o.set?Object.defineProperty(e,r,o):e[r]=t[r]}return e.default=t,e}var r=function(e){function r(t){var o=e.call(this)||this;return o.name="CustomRepositoryCannotInheritRepositoryError",Object.setPrototypeOf(o,r.prototype),o.message="Custom entity repository "+(t instanceof Function?t.name:t.constructor.name)+"  cannot inherit Repository class without entity being set in the @EntityRepository decorator.",o}return t.__extends(r,e),r}(Error);exports.CustomRepositoryCannotInheritRepositoryError=r;
},{"tslib":"c4AP"}],"H39D":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RepositoryNotFoundError=void 0;var e=t(require("tslib")),r=require("../index");function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var o=function(t){function o(e,n){var i,s=t.call(this)||this;return s.name="RepositoryNotFoundError",Object.setPrototypeOf(s,o.prototype),i=n instanceof r.EntitySchema?n.options.name:"function"==typeof n?n.name:n,s.message='No repository for "'+i+'" was found. Looks like this entity is not registered in current "'+e+'" connection?',s}return e.__extends(o,t),o}(Error);exports.RepositoryNotFoundError=o;
},{"tslib":"c4AP","../index":"wlNf"}],"/l60":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RepositoryNotTreeError=void 0;var e=t(require("tslib")),r=require("../index");function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var o=function(t){function o(e){var n,i=t.call(this)||this;return i.name="RepositoryNotTreeError",Object.setPrototypeOf(i,o.prototype),n=e instanceof r.EntitySchema?e.options.name:"function"==typeof e?e.name:e,i.message='Repository of the "'+n+'" class is not a TreeRepository. Try to apply @Tree decorator on your entity.',i}return e.__extends(o,t),o}(Error);exports.RepositoryNotTreeError=o;
},{"tslib":"c4AP","../index":"wlNf"}],"1+Od":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RepositoryFactory=void 0;var e=require("./TreeRepository"),r=require("./Repository"),o=require("../driver/mongodb/MongoDriver"),t=require("./MongoRepository"),n=function(){function n(){}return n.prototype.create=function(n,i,a){if(i.treeType){var s=new e.TreeRepository;return Object.assign(s,{manager:n,metadata:i,queryRunner:a}),s}s=void 0;return s=n.connection.driver instanceof o.MongoDriver?new t.MongoRepository:new r.Repository,Object.assign(s,{manager:n,metadata:i,queryRunner:a}),s},n}();exports.RepositoryFactory=n;
},{"./TreeRepository":"Ayc+","./Repository":"ZbgY","../driver/mongodb/MongoDriver":"TOLf","./MongoRepository":"TOLf"}],"vqHB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TreeRepositoryNotSupportedError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(e){var o=r.call(this)||this;return o.name="TreeRepositoryNotSupportedError",Object.setPrototypeOf(o,t.prototype),o.message="Tree repositories are not supported in "+e.options.type+" driver.",o}return e.__extends(t,r),t}(Error);exports.TreeRepositoryNotSupportedError=t;
},{"tslib":"c4AP"}],"HMqo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MustBeEntityError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e,n){var o=t.call(this)||this;return o.name="MustBeEntityError",Object.setPrototypeOf(o,r.prototype),o.message="Cannot "+e+', given value must be an entity, instead "'+n+'" is given.',o}return e.__extends(r,t),r}(Error);exports.MustBeEntityError=r;
},{"tslib":"c4AP"}],"q3Bi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SubjectTopoligicalSorter=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var r=function(){function t(t){this.subjects=e.__spread(t),this.metadatas=this.getUniqueMetadatas(this.subjects)}return t.prototype.sort=function(t){var r=this;if(!this.metadatas.length)return this.subjects;var n=[];if("delete"===t){var a=this.subjects.filter(function(e){return!e.entity&&!e.databaseEntity});n.push.apply(n,e.__spread(a)),this.removeAlreadySorted(a)}var o=this.getNonNullableDependencies(),i=this.toposort(o);"insert"===t&&(i=i.reverse()),i.forEach(function(t){var a=r.subjects.filter(function(e){return e.metadata.targetName===t});n.push.apply(n,e.__spread(a)),r.removeAlreadySorted(a)});var s=this.getDependencies(),u=this.toposort(s);return"insert"===t&&(u=u.reverse()),u.forEach(function(t){var a=r.subjects.filter(function(e){return e.metadata.targetName===t});n.push.apply(n,e.__spread(a)),r.removeAlreadySorted(a)}),n.push.apply(n,e.__spread(this.subjects)),n},t.prototype.removeAlreadySorted=function(e){var t=this;e.forEach(function(e){t.subjects.splice(t.subjects.indexOf(e),1)})},t.prototype.getUniqueMetadatas=function(e){var t=[];return e.forEach(function(e){-1===t.indexOf(e.metadata)&&t.push(e.metadata)}),t},t.prototype.getNonNullableDependencies=function(){return this.metadatas.reduce(function(e,t){return t.relationsWithJoinColumns.forEach(function(r){r.isNullable||e.push([t.targetName,r.inverseEntityMetadata.targetName])}),e},[])},t.prototype.getDependencies=function(){return this.metadatas.reduce(function(e,t){return t.relationsWithJoinColumns.forEach(function(r){r.inverseEntityMetadata!==t&&e.push([t.targetName,r.inverseEntityMetadata.targetName])}),e},[])},t.prototype.toposort=function(e){for(var t=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var a=e[r];t.indexOf(a[0])<0&&t.push(a[0]),t.indexOf(a[1])<0&&t.push(a[1])}return t}(e),r=t.length,n=new Array(r),a={},o=r;o--;)a[o]||i(t[o],o,[]);function i(o,s,u){if(u.indexOf(o)>=0)throw new Error("Cyclic dependency: "+JSON.stringify(o));if(!~t.indexOf(o))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(o));if(!a[s]){a[s]=!0;var c=e.filter(function(e){return e[0]===o});if(s=c.length){var p=u.concat(o);do{var d=c[--s][1];i(d,t.indexOf(d),p)}while(s)}n[--r]=o}}return n},t}();exports.SubjectTopoligicalSorter=r;
},{"tslib":"c4AP"}],"qo0Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CannotCreateEntityIdMapError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e,n){var o=t.call(this)||this;o.name="CannotCreateEntityIdMapError",Object.setPrototypeOf(o,r.prototype);var i=e.primaryColumns.reduce(function(e,t,r){return t.setEntityValue(e,r+1),e},{});return o.message='Cannot use given entity id "'+n+'" because "'+e.targetName+'" contains multiple primary columns, you must provide object in following form: '+JSON.stringify(i)+" as an id.",o}return e.__extends(r,t),r}(Error);exports.CannotCreateEntityIdMapError=r;
},{"tslib":"c4AP"}],"Raef":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityMetadata=void 0;var t=s(require("tslib")),e=require("../driver/postgres/PostgresDriver"),i=require("../driver/sqlserver/SqlServerDriver"),a=require("../error/CannotCreateEntityIdMapError"),r=require("../util/OrmUtils"),n=require("../util/StringUtils");function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};a.get||a.set?Object.defineProperty(e,i,a):e[i]=t[i]}return e.default=t,e}var o=function(){function s(t){this.childEntityMetadatas=[],this.inheritanceTree=[],this.tableType="regular",this.synchronize=!0,this.hasNonNullableRelations=!1,this.isJunction=!1,this.isClosureJunction=!1,this.hasMultiplePrimaryKeys=!1,this.hasUUIDGeneratedColumns=!1,this.ownColumns=[],this.columns=[],this.ancestorColumns=[],this.descendantColumns=[],this.nonVirtualColumns=[],this.ownerColumns=[],this.inverseColumns=[],this.generatedColumns=[],this.primaryColumns=[],this.ownRelations=[],this.relations=[],this.eagerRelations=[],this.lazyRelations=[],this.oneToOneRelations=[],this.ownerOneToOneRelations=[],this.oneToManyRelations=[],this.manyToOneRelations=[],this.manyToManyRelations=[],this.ownerManyToManyRelations=[],this.relationsWithJoinColumns=[],this.relationIds=[],this.relationCounts=[],this.foreignKeys=[],this.embeddeds=[],this.allEmbeddeds=[],this.ownIndices=[],this.indices=[],this.uniques=[],this.ownUniques=[],this.checks=[],this.exclusions=[],this.ownListeners=[],this.listeners=[],this.afterLoadListeners=[],this.beforeInsertListeners=[],this.afterInsertListeners=[],this.beforeUpdateListeners=[],this.afterUpdateListeners=[],this.beforeRemoveListeners=[],this.afterRemoveListeners=[],this.connection=t.connection,this.inheritanceTree=t.inheritanceTree||[],this.inheritancePattern=t.inheritancePattern,this.treeType=t.tableTree?t.tableTree.type:void 0,this.parentClosureEntityMetadata=t.parentClosureEntityMetadata,this.tableMetadataArgs=t.args,this.target=this.tableMetadataArgs.target,this.tableType=this.tableMetadataArgs.type,this.expression=this.tableMetadataArgs.expression}return s.prototype.create=function(t){var e,i=this;if(this.target instanceof Function)return e=new this.target,this.lazyRelations.forEach(function(a){return i.connection.relationLoader.enableLazyLoad(a,e,t)}),e;var a={};return this.lazyRelations.forEach(function(e){return i.connection.relationLoader.enableLazyLoad(e,a,t)}),a},s.prototype.hasId=function(t){return!!t&&this.primaryColumns.every(function(e){var i=e.getEntityValue(t);return null!=i&&""!==i})},s.prototype.hasAllPrimaryKeys=function(t){return this.primaryColumns.every(function(e){var i=e.getEntityValue(t);return null!=i})},s.prototype.ensureEntityIdMap=function(t){if(t instanceof Object)return t;if(this.hasMultiplePrimaryKeys)throw new a.CannotCreateEntityIdMapError(this,t);return this.primaryColumns[0].createValueMap(t)},s.prototype.getEntityIdMap=function(t){if(t)return s.getValueMap(t,this.primaryColumns,{skipNulls:!0})},s.prototype.getEntityIdMixedMap=function(t){if(!t)return t;var e=this.getEntityIdMap(t);return this.hasMultiplePrimaryKeys?e:e?this.primaryColumns[0].getEntityValue(e):e},s.prototype.compareEntities=function(t,e){var i=this.getEntityIdMap(t);if(!i)return!1;var a=this.getEntityIdMap(e);return!!a&&s.compareIds(i,a)},s.prototype.findColumnWithPropertyName=function(t){return this.columns.find(function(e){return e.propertyName===t})},s.prototype.findColumnWithDatabaseName=function(t){return this.columns.find(function(e){return e.databaseName===t})},s.prototype.findColumnWithPropertyPath=function(t){var e=this.columns.find(function(e){return e.propertyPath===t});if(e)return e;var i=this.relations.find(function(e){return e.propertyPath===t});return i&&1===i.joinColumns.length?i.joinColumns[0]:void 0},s.prototype.findColumnsWithPropertyPath=function(t){var e=this.columns.find(function(e){return e.propertyPath===t});if(e)return[e];var i=this.relations.find(function(e){return e.propertyPath===t});return i&&i.joinColumns?i.joinColumns:[]},s.prototype.findRelationWithPropertyPath=function(t){return this.relations.find(function(e){return e.propertyPath===t})},s.prototype.hasEmbeddedWithPropertyPath=function(t){return this.allEmbeddeds.some(function(e){return e.propertyPath===t})},s.prototype.findEmbeddedWithPropertyPath=function(t){return this.allEmbeddeds.find(function(e){return e.propertyPath===t})},s.prototype.extractRelationValuesFromEntity=function(t,e){var i=[];return e.forEach(function(e){var a=e.getEntityValue(t);a instanceof Array?a.forEach(function(t){return i.push([e,t,e.inverseEntityMetadata])}):a&&i.push([e,a,e.inverseEntityMetadata])}),i},s.createPropertyPath=function(e,i,a){var r=this;void 0===a&&(a="");var n=[];return Object.keys(i).forEach(function(s){var o=a?a+"."+s:s;if(e.hasEmbeddedWithPropertyPath(o)){var h=r.createPropertyPath(e,i[s],o);n.push.apply(n,t.__spread(h))}else{var u=a?a+"."+s:s;n.push(u)}}),n},s.difference=function(t,e){return t.filter(function(t){return!e.find(function(e){return r.OrmUtils.deepCompare(t,e)})})},s.compareIds=function(t,e){return null!=t&&null!=e&&r.OrmUtils.deepCompare(t,e)},s.getValueMap=function(t,e,i){return e.reduce(function(e,a){var n=a.getEntityValueMap(t,i);if(void 0!==e&&null!=n)return a.isObjectId?Object.assign(e,n):r.OrmUtils.mergeDeep(e,n)},{})},s.prototype.build=function(){var t=this.connection.namingStrategy,e=this.connection.options.entityPrefix;this.engine=this.tableMetadataArgs.engine,this.database="entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.parentEntityMetadata.database:this.tableMetadataArgs.database,this.tableMetadataArgs.schema?this.schema=this.tableMetadataArgs.schema:"entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.schema=this.parentEntityMetadata.schema:this.schema=this.connection.options.schema,this.givenTableName="entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.parentEntityMetadata.givenTableName:this.tableMetadataArgs.name,this.synchronize=!1!==this.tableMetadataArgs.synchronize,this.targetName=this.tableMetadataArgs.target instanceof Function?this.tableMetadataArgs.target.name:this.tableMetadataArgs.target,"closure-junction"===this.tableMetadataArgs.type?this.tableNameWithoutPrefix=t.closureJunctionTableName(this.givenTableName):"entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.tableNameWithoutPrefix=t.tableName(this.parentEntityMetadata.targetName,this.parentEntityMetadata.givenTableName):(this.tableNameWithoutPrefix=t.tableName(this.targetName,this.givenTableName),this.connection.driver.maxAliasLength&&this.connection.driver.maxAliasLength>0&&this.tableNameWithoutPrefix.length>this.connection.driver.maxAliasLength&&(this.tableNameWithoutPrefix=(0,n.shorten)(this.tableNameWithoutPrefix,{separator:"_",segmentLength:3}))),this.tableName=e?t.prefixTableName(e,this.tableNameWithoutPrefix):this.tableNameWithoutPrefix,this.target=this.target?this.target:this.tableName,this.name=this.targetName?this.targetName:this.tableName,this.expression=this.tableMetadataArgs.expression,this.tablePath=this.buildTablePath(),this.schemaPath=this.buildSchemaPath(),this.orderBy=this.tableMetadataArgs.orderBy instanceof Function?this.tableMetadataArgs.orderBy(this.propertiesMap):this.tableMetadataArgs.orderBy,this.isJunction="closure-junction"===this.tableMetadataArgs.type||"junction"===this.tableMetadataArgs.type,this.isClosureJunction="closure-junction"===this.tableMetadataArgs.type},s.prototype.registerColumn=function(t){-1===this.ownColumns.indexOf(t)&&(this.ownColumns.push(t),this.columns=this.embeddeds.reduce(function(t,e){return t.concat(e.columnsFromTree)},this.ownColumns),this.primaryColumns=this.columns.filter(function(t){return t.isPrimary}),this.hasMultiplePrimaryKeys=this.primaryColumns.length>1,this.hasUUIDGeneratedColumns=this.columns.filter(function(t){return t.isGenerated||"uuid"===t.generationStrategy}).length>0,this.propertiesMap=this.createPropertiesMap(),this.childEntityMetadatas&&this.childEntityMetadatas.forEach(function(e){return e.registerColumn(t)}))},s.prototype.createPropertiesMap=function(){var t={};return this.columns.forEach(function(e){return r.OrmUtils.mergeDeep(t,e.createValueMap(e.propertyPath))}),this.relations.forEach(function(e){return r.OrmUtils.mergeDeep(t,e.createValueMap(e.propertyPath))}),t},s.prototype.buildTablePath=function(){var t=this.tableName;return this.schema&&(t=this.schema+"."+t),!this.database||this.connection.driver instanceof e.PostgresDriver||(t=!this.schema&&this.connection.driver instanceof i.SqlServerDriver?this.database+".."+t:this.database+"."+t),t},s.prototype.buildSchemaPath=function(){if(this.schema)return!this.database||this.connection.driver instanceof e.PostgresDriver?this.schema:this.database+"."+this.schema},s}();exports.EntityMetadata=o;
},{"tslib":"c4AP","../driver/postgres/PostgresDriver":"TOLf","../driver/sqlserver/SqlServerDriver":"sMRg","../error/CannotCreateEntityIdMapError":"qo0Z","../util/OrmUtils":"R//v","../util/StringUtils":"blFa"}],"NYPL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SubjectChangedColumnsComputer=void 0;var t=require("../util/DateUtils"),e=require("../metadata/EntityMetadata"),i=require("../util/OrmUtils"),a=function(){function a(){}return a.prototype.compute=function(t){var e=this;t.forEach(function(i){e.computeDiffColumns(i),e.computeDiffRelationalColumns(t,i)})},a.prototype.computeDiffColumns=function(e){e.entity&&e.metadata.columns.forEach(function(a){if(!(a.isVirtual||a.isDiscriminator||a.isUpdateDate||a.isVersion||a.isCreateDate)){var n=e.changeMaps.find(function(t){return t.column===a});n&&e.changeMaps.splice(e.changeMaps.indexOf(n),1);var r=a.getEntityValue(e.entity);if(void 0!==r){if(e.databaseEntity){var o=a.getEntityValue(e.databaseEntity);if(a.relationMetadata){var s=a.relationMetadata.getEntityValue(e.entity);if(null!=s)return}var u=r;if(null!==r)if("date"===a.type)u=t.DateUtils.mixedDateToDateString(r);else if("time"===a.type)u=t.DateUtils.mixedDateToTimeString(r);else if("datetime"===a.type||a.type===Date)u=t.DateUtils.mixedDateToUtcDatetimeString(r),o=t.DateUtils.mixedDateToUtcDatetimeString(o);else if("json"===a.type||"jsonb"===a.type){if(i.OrmUtils.deepCompare(r,o))return}else"simple-array"===a.type?(u=t.DateUtils.simpleArrayToString(r),o=t.DateUtils.simpleArrayToString(o)):"simple-enum"===a.type&&(u=t.DateUtils.simpleEnumToString(r),o=t.DateUtils.simpleEnumToString(o));if(u===o)return}e.diffColumns.push(a),e.changeMaps.push({column:a,value:r})}}})},a.prototype.computeDiffRelationalColumns=function(t,i){i.entity&&i.metadata.relationsWithJoinColumns.forEach(function(a){var n=a.getEntityValue(i.entity);if(void 0!==n){if(i.databaseEntity){var r=n;null!==r&&r instanceof Object&&(r=a.getRelationIdMap(r));var o=a.getEntityValue(i.databaseEntity);if(e.EntityMetadata.compareIds(r,o))return;i.diffRelations.push(a)}var s=t.find(function(t){return t.mustBeInserted&&t.entity===n});s&&(n=s);var u=i.changeMaps.find(function(t){return t.relation===a});u?u.value=n:i.changeMaps.push({relation:a,value:n})}})},a}();exports.SubjectChangedColumnsComputer=a;
},{"../util/DateUtils":"iWm2","../metadata/EntityMetadata":"Raef","../util/OrmUtils":"R//v"}],"TEoI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SubjectWithoutIdentifierError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(e){var o=r.call(this)||this;return o.name="SubjectWithoutIdentifierError",Object.setPrototypeOf(o,t.prototype),o.message="Internal error. Subject "+e.metadata.targetName+" must have an identifier to perform operation. Please report a github issue if you face this error.",o}return e.__extends(t,r),t}(Error);exports.SubjectWithoutIdentifierError=t;
},{"tslib":"c4AP"}],"/e5P":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SubjectRemovedAndUpdatedError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e){var o=t.call(this)||this;return o.name="SubjectRemovedAndUpdatedError",Object.setPrototypeOf(o,r.prototype),o.message='Removed entity "'+e.metadata.name+'" is also scheduled for update operation. Make sure you are not updating and removing same object (note that update or remove may be executed by cascade operations).',o}return e.__extends(r,t),r}(Error);exports.SubjectRemovedAndUpdatedError=r;
},{"tslib":"c4AP"}],"thBa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BroadcasterResult=void 0;var e=function(){return function(){this.count=0,this.promises=[]}}();exports.BroadcasterResult=e;
},{}],"3nMO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OracleQueryRunner=void 0;var e=p(require("tslib")),n=require("../../error/TransactionAlreadyStartedError"),t=require("../../error/TransactionNotStartedError"),r=require("../../schema-builder/table/TableColumn"),i=require("../../schema-builder/table/Table"),a=require("../../schema-builder/table/TableForeignKey"),o=require("../../schema-builder/table/TableIndex"),u=require("../../error/QueryRunnerAlreadyReleasedError"),s=require("../../schema-builder/view/View"),c=require("../Query"),m=require("../../error/QueryFailedError"),l=require("../../schema-builder/table/TableUnique"),h=require("../../subscriber/Broadcaster"),T=require("../../query-runner/BaseQueryRunner"),E=require("../../util/OrmUtils"),N=require("../../schema-builder/table/TableCheck"),f=require("../../index");function p(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};r.get||r.set?Object.defineProperty(n,t,r):n[t]=e[t]}return n.default=e,n}var A=function(T){function p(e,n){void 0===n&&(n="master");var t=T.call(this)||this;return t.driver=e,t.connection=e.connection,t.broadcaster=new h.Broadcaster(t),t.mode=n,t}return e.__extends(p,T),p.prototype.connect=function(){var e=this;return this.databaseConnection?Promise.resolve(this.databaseConnection):this.databaseConnectionPromise?this.databaseConnectionPromise:("slave"===this.mode&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then(function(n){return e.databaseConnection=n,e.databaseConnection}):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then(function(n){return e.databaseConnection=n,e.databaseConnection}),this.databaseConnectionPromise)},p.prototype.release=function(){var e=this;return new Promise(function(n,t){e.isReleased=!0,e.databaseConnection?e.databaseConnection.close(function(e){if(e)return t(e);n()}):n()})},p.prototype.startTransaction=function(t){return void 0===t&&(t="READ COMMITTED"),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:if(this.isReleased)throw new u.QueryRunnerAlreadyReleasedError;if(this.isTransactionActive)throw new n.TransactionAlreadyStartedError;if("SERIALIZABLE"!==t&&"READ COMMITTED"!==t)throw new Error("Oracle only supports SERIALIZABLE and READ COMMITTED isolation");return[4,this.query("SET TRANSACTION ISOLATION LEVEL "+t)];case 1:return e.sent(),this.isTransactionActive=!0,[2]}})})},p.prototype.commitTransaction=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:if(!this.isTransactionActive)throw new t.TransactionNotStartedError;return[4,this.query("COMMIT")];case 1:return e.sent(),this.isTransactionActive=!1,[2]}})})},p.prototype.rollbackTransaction=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:if(!this.isTransactionActive)throw new t.TransactionNotStartedError;return[4,this.query("ROLLBACK")];case 1:return e.sent(),this.isTransactionActive=!1,[2]}})})},p.prototype.query=function(n,t){var r=this;if(this.isReleased)throw new u.QueryRunnerAlreadyReleasedError;return new Promise(function(i,a){return e.__awaiter(r,void 0,void 0,function(){var r,o,u,s,c=this;return e.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this.driver.connection.logger.logQuery(n,t,this),r=+new Date,o=function(e,o){var u=c.driver.connection.options.maxQueryExecutionTime,s=+new Date-r;if(u&&s>u&&c.driver.connection.logger.logQuerySlow(s,n,t,c),e)return c.driver.connection.logger.logQueryError(e,n,t,c),a(new m.QueryFailedError(n,t,e));i(o.rows||o.outBinds||o.rowsAffected)},u={autoCommit:!this.isTransactionActive},[4,this.connect()];case 1:return e.sent().execute(n,t||{},u,o),[3,3];case 2:return s=e.sent(),a(s),[3,3];case 3:return[2]}})})})},p.prototype.stream=function(e,n,t,r){throw new Error("Stream is not supported by Oracle driver.")},p.prototype.getDatabases=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve([])]})})},p.prototype.getSchemas=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve([])]})})},p.prototype.hasDatabase=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve(!1)]})})},p.prototype.hasSchema=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve(!1)]})})},p.prototype.hasTable=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r;return e.__generator(this,function(e){switch(e.label){case 0:return t=n instanceof i.Table?n.name:n,r='SELECT "TABLE_NAME" FROM "USER_TABLES" WHERE "TABLE_NAME" = \''+t+"'",[4,this.query(r)];case 1:return[2,!!e.sent().length]}})})},p.prototype.hasColumn=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a;return e.__generator(this,function(e){switch(e.label){case 0:return r=n instanceof i.Table?n.name:n,a='SELECT "COLUMN_NAME" FROM "USER_TAB_COLS" WHERE "TABLE_NAME" = \''+r+"' AND \"COLUMN_NAME\" = '"+t+"'",[4,this.query(a)];case 1:return[2,!!e.sent().length]}})})},p.prototype.createDatabase=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.query('CREATE DATABASE IF NOT EXISTS "'+n+'"')];case 1:return e.sent(),[2]}})})},p.prototype.dropDatabase=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve()]})})},p.prototype.createSchema=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("Schema create queries are not supported by Oracle driver.")})})},p.prototype.dropSchema=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("Schema drop queries are not supported by Oracle driver.")})})},p.prototype.createTable=function(n,t,r,i){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),e.__awaiter(this,void 0,void 0,function(){var a,o,u=this;return e.__generator(this,function(e){switch(e.label){case 0:return t?[4,this.hasTable(n)]:[3,2];case 1:if(e.sent())return[2,Promise.resolve()];e.label=2;case 2:return o=[],(a=[]).push(this.createTableSql(n,r)),o.push(this.dropTableSql(n)),r&&n.foreignKeys.forEach(function(e){return o.push(u.dropForeignKeySql(n,e))}),i&&n.indices.forEach(function(e){e.name||(e.name=u.connection.namingStrategy.indexName(n.name,e.columnNames,e.where)),a.push(u.createIndexSql(n,e)),o.push(u.dropIndexSql(e))}),[4,this.executeQueries(a,o)];case 3:return e.sent(),[2]}})})},p.prototype.dropTable=function(n,t,r,a){return void 0===r&&(r=!0),void 0===a&&(a=!0),e.__awaiter(this,void 0,void 0,function(){var o,u,s,c,m,l=this;return e.__generator(this,function(e){switch(e.label){case 0:return t?[4,this.hasTable(n)]:[3,2];case 1:if(!e.sent())return[2,Promise.resolve()];e.label=2;case 2:return o=r,n instanceof i.Table?(s=n,[3,5]):[3,3];case 3:return[4,this.getCachedTable(n)];case 4:s=e.sent(),e.label=5;case 5:return u=s,c=[],m=[],a&&u.indices.forEach(function(e){c.push(l.dropIndexSql(e)),m.push(l.createIndexSql(u,e))}),r&&u.foreignKeys.forEach(function(e){return c.push(l.dropForeignKeySql(u,e))}),c.push(this.dropTableSql(u)),m.push(this.createTableSql(u,o)),[4,this.executeQueries(c,m)];case 6:return e.sent(),[2]}})})},p.prototype.createView=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r;return e.__generator(this,function(e){switch(e.label){case 0:return r=[],(t=[]).push(this.createViewSql(n)),t.push(this.insertViewDefinitionSql(n)),r.push(this.dropViewSql(n)),r.push(this.deleteViewDefinitionSql(n)),[4,this.executeQueries(t,r)];case 1:return e.sent(),[2]}})})},p.prototype.dropView=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,a;return e.__generator(this,function(e){switch(e.label){case 0:return t=n instanceof s.View?n.name:n,[4,this.getCachedView(t)];case 1:return r=e.sent(),a=[],(i=[]).push(this.deleteViewDefinitionSql(r)),i.push(this.dropViewSql(r)),a.push(this.insertViewDefinitionSql(r)),a.push(this.createViewSql(r)),[4,this.executeQueries(i,a)];case 2:return e.sent(),[2]}})})},p.prototype.renameTable=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a,o,u,s,m,l,h,T=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=[],a=[],n instanceof i.Table?(u=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:u=e.sent(),e.label=3;case 3:return s=(o=u).clone(),t instanceof i.Table?s=t:s.name=t,r.push(new c.Query('ALTER TABLE "'+o.name+'" RENAME TO "'+s.name+'"')),a.push(new c.Query('ALTER TABLE "'+s.name+'" RENAME TO "'+o.name+'"')),s.primaryColumns.length>0&&(m=s.primaryColumns.map(function(e){return e.name}),l=this.connection.namingStrategy.primaryKeyName(o,m),h=this.connection.namingStrategy.primaryKeyName(s,m),r.push(new c.Query('ALTER TABLE "'+s.name+'" RENAME CONSTRAINT "'+l+'" TO "'+h+'"')),a.push(new c.Query('ALTER TABLE "'+s.name+'" RENAME CONSTRAINT "'+h+'" TO "'+l+'"'))),s.uniques.forEach(function(e){var n=T.connection.namingStrategy.uniqueConstraintName(s,e.columnNames);r.push(new c.Query('ALTER TABLE "'+s.name+'" RENAME CONSTRAINT "'+e.name+'" TO "'+n+'"')),a.push(new c.Query('ALTER TABLE "'+s.name+'" RENAME CONSTRAINT "'+n+'" TO "'+e.name+'"')),e.name=n}),s.indices.forEach(function(e){var n=T.connection.namingStrategy.indexName(s,e.columnNames,e.where);r.push(new c.Query('ALTER INDEX "'+e.name+'" RENAME TO "'+n+'"')),a.push(new c.Query('ALTER INDEX "'+n+'" RENAME TO "'+e.name+'"')),e.name=n}),s.foreignKeys.forEach(function(e){var n=T.connection.namingStrategy.foreignKeyName(s,e.columnNames);r.push(new c.Query('ALTER TABLE "'+s.name+'" RENAME CONSTRAINT "'+e.name+'" TO "'+n+'"')),a.push(new c.Query('ALTER TABLE "'+s.name+'" RENAME CONSTRAINT "'+n+'" TO "'+e.name+'"')),e.name=n}),[4,this.executeQueries(r,a)];case 4:return e.sent(),o.name=s.name,this.replaceCachedTable(o,s),[2]}})})},p.prototype.addColumn=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a,o,u,s,m,h,T,E,N,f,p;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(a=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:a=e.sent(),e.label=3;case 3:return o=(r=a).clone(),s=[],(u=[]).push(new c.Query('ALTER TABLE "'+r.name+'" ADD '+this.buildCreateColumnSql(t))),s.push(new c.Query('ALTER TABLE "'+r.name+'" DROP COLUMN "'+t.name+'"')),t.isPrimary&&((m=o.primaryColumns).length>0&&(h=this.connection.namingStrategy.primaryKeyName(o.name,m.map(function(e){return e.name})),T=m.map(function(e){return'"'+e.name+'"'}).join(", "),u.push(new c.Query('ALTER TABLE "'+r.name+'" DROP CONSTRAINT "'+h+'"')),s.push(new c.Query('ALTER TABLE "'+r.name+'" ADD CONSTRAINT "'+h+'" PRIMARY KEY ('+T+")"))),m.push(t),E=this.connection.namingStrategy.primaryKeyName(o.name,m.map(function(e){return e.name})),N=m.map(function(e){return'"'+e.name+'"'}).join(", "),u.push(new c.Query('ALTER TABLE "'+r.name+'" ADD CONSTRAINT "'+E+'" PRIMARY KEY ('+N+")")),s.push(new c.Query('ALTER TABLE "'+r.name+'" DROP CONSTRAINT "'+E+'"'))),(f=o.indices.find(function(e){return 1===e.columnNames.length&&e.columnNames[0]===t.name}))&&(o.indices.splice(o.indices.indexOf(f),1),u.push(this.createIndexSql(r,f)),s.push(this.dropIndexSql(f))),t.isUnique&&(p=new l.TableUnique({name:this.connection.namingStrategy.uniqueConstraintName(r.name,[t.name]),columnNames:[t.name]}),o.uniques.push(p),u.push(new c.Query('ALTER TABLE "'+r.name+'" ADD CONSTRAINT "'+p.name+'" UNIQUE ("'+t.name+'")')),s.push(new c.Query('ALTER TABLE "'+r.name+'" DROP CONSTRAINT "'+p.name+'"'))),[4,this.executeQueries(u,s)];case 4:return e.sent(),o.addColumn(t),this.replaceCachedTable(r,o),[2]}})})},p.prototype.addColumns=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,f.PromiseUtils.runInSequence(t,function(e){return r.addColumn(n,e)})];case 1:return e.sent(),[2]}})})},p.prototype.renameColumn=function(n,t,a){return e.__awaiter(this,void 0,void 0,function(){var o,u,s,c;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(u=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:u=e.sent(),e.label=3;case 3:if(o=u,!(s=t instanceof r.TableColumn?t:o.columns.find(function(e){return e.name===t})))throw new Error('Column "'+t+'" was not found in the "'+o.name+'" table.');return c=void 0,a instanceof r.TableColumn?c=a:(c=s.clone()).name=a,[4,this.changeColumn(o,s,c)];case 4:return e.sent(),[2]}})})},p.prototype.changeColumn=function(n,t,a){return e.__awaiter(this,void 0,void 0,function(){var o,u,s,m,h,T,E,N,f,p,A,d,C,y,_,R,S,O,L=this;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(u=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:u=e.sent(),e.label=3;case 3:if(s=(o=u).clone(),m=[],h=[],!(T=t instanceof r.TableColumn?t:o.columns.find(function(e){return e.name===t})))throw new Error('Column "'+t+'" was not found in the "'+o.name+'" table.');return a.isGenerated!==T.isGenerated&&"uuid"!==a.generationStrategy||T.type!==a.type||T.length!==a.length?[4,this.dropColumn(o,T)]:[3,6];case 4:return e.sent(),[4,this.addColumn(o,a)];case 5:return e.sent(),s=o.clone(),[3,8];case 6:return a.name!==T.name&&(m.push(new c.Query('ALTER TABLE "'+o.name+'" RENAME COLUMN "'+T.name+'" TO "'+a.name+'"')),h.push(new c.Query('ALTER TABLE "'+o.name+'" RENAME COLUMN "'+a.name+'" TO "'+T.name+'"')),!0===T.isPrimary&&(y=s.primaryColumns,S=y.map(function(e){return e.name}),E=this.connection.namingStrategy.primaryKeyName(s,S),S.splice(S.indexOf(T.name),1),S.push(a.name),N=this.connection.namingStrategy.primaryKeyName(s,S),m.push(new c.Query('ALTER TABLE "'+o.name+'" RENAME CONSTRAINT "'+E+'" TO "'+N+'"')),h.push(new c.Query('ALTER TABLE "'+o.name+'" RENAME CONSTRAINT "'+N+'" TO "'+E+'"'))),s.findColumnUniques(T).forEach(function(e){e.columnNames.splice(e.columnNames.indexOf(T.name),1),e.columnNames.push(a.name);var n=L.connection.namingStrategy.uniqueConstraintName(s,e.columnNames);m.push(new c.Query('ALTER TABLE "'+o.name+'" RENAME CONSTRAINT "'+e.name+'" TO "'+n+'"')),h.push(new c.Query('ALTER TABLE "'+o.name+'" RENAME CONSTRAINT "'+n+'" TO "'+e.name+'"')),e.name=n}),s.findColumnIndices(T).forEach(function(e){e.columnNames.splice(e.columnNames.indexOf(T.name),1),e.columnNames.push(a.name);var n=L.connection.namingStrategy.indexName(s,e.columnNames,e.where);m.push(new c.Query('ALTER INDEX "'+e.name+'" RENAME TO "'+n+'"')),h.push(new c.Query('ALTER INDEX "'+n+'" RENAME TO "'+e.name+'"')),e.name=n}),s.findColumnForeignKeys(T).forEach(function(e){e.columnNames.splice(e.columnNames.indexOf(T.name),1),e.columnNames.push(a.name);var n=L.connection.namingStrategy.foreignKeyName(s,e.columnNames);m.push(new c.Query('ALTER TABLE "'+o.name+'" RENAME CONSTRAINT "'+e.name+'" TO "'+n+'"')),h.push(new c.Query('ALTER TABLE "'+o.name+'" RENAME CONSTRAINT "'+n+'" TO "'+e.name+'"')),e.name=n}),f=s.columns.find(function(e){return e.name===T.name}),s.columns[s.columns.indexOf(f)].name=a.name,T.name=a.name),this.isColumnChanged(T,a,!0)&&(p="",A="",d="",C="",null!==a.default&&void 0!==a.default?(p="DEFAULT "+a.default,A=null!==T.default&&void 0!==T.default?"DEFAULT "+T.default:"DEFAULT NULL"):null!==T.default&&void 0!==T.default&&(p="DEFAULT NULL",A="DEFAULT "+T.default),a.isNullable!==T.isNullable&&(!0===a.isNullable?(d="NULL",C="NOT NULL"):(d="NOT NULL",C="NULL")),m.push(new c.Query('ALTER TABLE "'+o.name+'" MODIFY "'+T.name+'" '+this.connection.driver.createFullType(a)+" "+p+" "+d)),h.push(new c.Query('ALTER TABLE "'+o.name+'" MODIFY "'+T.name+'" '+this.connection.driver.createFullType(T)+" "+A+" "+C))),a.isPrimary!==T.isPrimary&&((y=s.primaryColumns).length>0&&(R=this.connection.namingStrategy.primaryKeyName(s.name,y.map(function(e){return e.name})),S=y.map(function(e){return'"'+e.name+'"'}).join(", "),m.push(new c.Query('ALTER TABLE "'+o.name+'" DROP CONSTRAINT "'+R+'"')),h.push(new c.Query('ALTER TABLE "'+o.name+'" ADD CONSTRAINT "'+R+'" PRIMARY KEY ('+S+")"))),!0===a.isPrimary?(y.push(a),s.columns.find(function(e){return e.name===a.name}).isPrimary=!0,R=this.connection.namingStrategy.primaryKeyName(s.name,y.map(function(e){return e.name})),S=y.map(function(e){return'"'+e.name+'"'}).join(", "),m.push(new c.Query('ALTER TABLE "'+o.name+'" ADD CONSTRAINT "'+R+'" PRIMARY KEY ('+S+")")),h.push(new c.Query('ALTER TABLE "'+o.name+'" DROP CONSTRAINT "'+R+'"'))):(_=y.find(function(e){return e.name===a.name}),y.splice(y.indexOf(_),1),s.columns.find(function(e){return e.name===a.name}).isPrimary=!1,y.length>0&&(R=this.connection.namingStrategy.primaryKeyName(s.name,y.map(function(e){return e.name})),S=y.map(function(e){return'"'+e.name+'"'}).join(", "),m.push(new c.Query('ALTER TABLE "'+o.name+'" ADD CONSTRAINT "'+R+'" PRIMARY KEY ('+S+")")),h.push(new c.Query('ALTER TABLE "'+o.name+'" DROP CONSTRAINT "'+R+'"'))))),a.isUnique!==T.isUnique&&(!0===a.isUnique?(O=new l.TableUnique({name:this.connection.namingStrategy.uniqueConstraintName(o.name,[a.name]),columnNames:[a.name]}),s.uniques.push(O),m.push(new c.Query('ALTER TABLE "'+o.name+'" ADD CONSTRAINT "'+O.name+'" UNIQUE ("'+a.name+'")')),h.push(new c.Query('ALTER TABLE "'+o.name+'" DROP CONSTRAINT "'+O.name+'"'))):(O=s.uniques.find(function(e){return 1===e.columnNames.length&&!!e.columnNames.find(function(e){return e===a.name})}),s.uniques.splice(s.uniques.indexOf(O),1),m.push(new c.Query('ALTER TABLE "'+o.name+'" DROP CONSTRAINT "'+O.name+'"')),h.push(new c.Query('ALTER TABLE "'+o.name+'" ADD CONSTRAINT "'+O.name+'" UNIQUE ("'+a.name+'")')))),[4,this.executeQueries(m,h)];case 7:e.sent(),this.replaceCachedTable(o,s),e.label=8;case 8:return[2]}})})},p.prototype.changeColumns=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,f.PromiseUtils.runInSequence(t,function(e){return r.changeColumn(n,e.oldColumn,e.newColumn)})];case 1:return e.sent(),[2]}})})},p.prototype.dropColumn=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var a,o,u,s,m,l,h,T,E,N,f,p,A;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(o=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:o=e.sent(),e.label=3;case 3:if(a=o,!(u=t instanceof r.TableColumn?t:a.findColumnByName(t)))throw new Error('Column "'+t+'" was not found in table "'+a.name+'"');return s=a.clone(),m=[],l=[],u.isPrimary&&(h=this.connection.namingStrategy.primaryKeyName(s.name,s.primaryColumns.map(function(e){return e.name})),T=s.primaryColumns.map(function(e){return'"'+e.name+'"'}).join(", "),m.push(new c.Query('ALTER TABLE "'+s.name+'" DROP CONSTRAINT "'+h+'"')),l.push(new c.Query('ALTER TABLE "'+s.name+'" ADD CONSTRAINT "'+h+'" PRIMARY KEY ('+T+")")),s.findColumnByName(u.name).isPrimary=!1,s.primaryColumns.length>0&&(E=this.connection.namingStrategy.primaryKeyName(s.name,s.primaryColumns.map(function(e){return e.name})),N=s.primaryColumns.map(function(e){return'"'+e.name+'"'}).join(", "),m.push(new c.Query('ALTER TABLE "'+s.name+'" ADD CONSTRAINT "'+E+'" PRIMARY KEY ('+N+")")),l.push(new c.Query('ALTER TABLE "'+s.name+'" DROP CONSTRAINT "'+E+'"')))),(f=s.indices.find(function(e){return 1===e.columnNames.length&&e.columnNames[0]===u.name}))&&(m.push(this.dropIndexSql(f)),l.push(this.createIndexSql(a,f))),(p=s.checks.find(function(e){return!!e.columnNames&&1===e.columnNames.length&&e.columnNames[0]===u.name}))&&(s.checks.splice(s.checks.indexOf(p),1),m.push(this.dropCheckConstraintSql(a,p)),l.push(this.createCheckConstraintSql(a,p))),(A=s.uniques.find(function(e){return 1===e.columnNames.length&&e.columnNames[0]===u.name}))&&(s.uniques.splice(s.uniques.indexOf(A),1),m.push(this.dropUniqueConstraintSql(a,A)),l.push(this.createUniqueConstraintSql(a,A))),m.push(new c.Query('ALTER TABLE "'+a.name+'" DROP COLUMN "'+u.name+'"')),l.push(new c.Query('ALTER TABLE "'+a.name+'" ADD '+this.buildCreateColumnSql(u))),[4,this.executeQueries(m,l)];case 4:return e.sent(),s.removeColumn(u),this.replaceCachedTable(a,s),[2]}})})},p.prototype.dropColumns=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,f.PromiseUtils.runInSequence(t,function(e){return r.dropColumn(n,e)})];case 1:return e.sent(),[2]}})})},p.prototype.createPrimaryKey=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a,o,u,s;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(a=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:a=e.sent(),e.label=3;case 3:return o=(r=a).clone(),u=this.createPrimaryKeySql(r,t),o.columns.forEach(function(e){t.find(function(n){return n===e.name})&&(e.isPrimary=!0)}),s=this.dropPrimaryKeySql(o),[4,this.executeQueries(u,s)];case 4:return e.sent(),this.replaceCachedTable(r,o),[2]}})})},p.prototype.updatePrimaryKeys=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a,o,u,s,m,l,h,T,E,N;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(a=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:a=e.sent(),e.label=3;case 3:return r=a,o=t.map(function(e){return e.name}),u=r.clone(),s=[],m=[],(l=u.primaryColumns).length>0&&(h=this.connection.namingStrategy.primaryKeyName(u.name,l.map(function(e){return e.name})),T=l.map(function(e){return'"'+e.name+'"'}).join(", "),s.push(new c.Query('ALTER TABLE "'+r.name+'" DROP CONSTRAINT "'+h+'"')),m.push(new c.Query('ALTER TABLE "'+r.name+'" ADD CONSTRAINT "'+h+'" PRIMARY KEY ('+T+")"))),u.columns.filter(function(e){return-1!==o.indexOf(e.name)}).forEach(function(e){return e.isPrimary=!0}),E=this.connection.namingStrategy.primaryKeyName(u.name,o),N=o.map(function(e){return'"'+e+'"'}).join(", "),s.push(new c.Query('ALTER TABLE "'+r.name+'" ADD CONSTRAINT "'+E+'" PRIMARY KEY ('+N+")")),m.push(new c.Query('ALTER TABLE "'+r.name+'" DROP CONSTRAINT "'+E+'"')),[4,this.executeQueries(s,m)];case 4:return e.sent(),this.replaceCachedTable(r,u),[2]}})})},p.prototype.dropPrimaryKey=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,a,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(r=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:r=e.sent(),e.label=3;case 3:return t=r,a=this.dropPrimaryKeySql(t),o=this.createPrimaryKeySql(t,t.primaryColumns.map(function(e){return e.name})),[4,this.executeQueries(a,o)];case 4:return e.sent(),t.primaryColumns.forEach(function(e){e.isPrimary=!1}),[2]}})})},p.prototype.createUniqueConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a,o,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(a=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:a=e.sent(),e.label=3;case 3:return r=a,t.name||(t.name=this.connection.namingStrategy.uniqueConstraintName(r.name,t.columnNames)),o=this.createUniqueConstraintSql(r,t),u=this.dropUniqueConstraintSql(r,t),[4,this.executeQueries(o,u)];case 4:return e.sent(),r.addUniqueConstraint(t),[2]}})})},p.prototype.createUniqueConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.createUniqueConstraint(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},p.prototype.dropUniqueConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a,o,u,s;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(a=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:a=e.sent(),e.label=3;case 3:if(r=a,!(o=t instanceof l.TableUnique?t:r.uniques.find(function(e){return e.name===t})))throw new Error("Supplied unique constraint was not found in table "+r.name);return u=this.dropUniqueConstraintSql(r,o),s=this.createUniqueConstraintSql(r,o),[4,this.executeQueries(u,s)];case 4:return e.sent(),r.removeUniqueConstraint(o),[2]}})})},p.prototype.dropUniqueConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.dropUniqueConstraint(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},p.prototype.createCheckConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a,o,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(a=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:a=e.sent(),e.label=3;case 3:return r=a,t.name||(t.name=this.connection.namingStrategy.checkConstraintName(r.name,t.expression)),o=this.createCheckConstraintSql(r,t),u=this.dropCheckConstraintSql(r,t),[4,this.executeQueries(o,u)];case 4:return e.sent(),r.addCheckConstraint(t),[2]}})})},p.prototype.createCheckConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.createCheckConstraint(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},p.prototype.dropCheckConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a,o,u,s;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(a=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:a=e.sent(),e.label=3;case 3:if(r=a,!(o=t instanceof N.TableCheck?t:r.checks.find(function(e){return e.name===t})))throw new Error("Supplied check constraint was not found in table "+r.name);return u=this.dropCheckConstraintSql(r,o),s=this.createCheckConstraintSql(r,o),[4,this.executeQueries(u,s)];case 4:return e.sent(),r.removeCheckConstraint(o),[2]}})})},p.prototype.dropCheckConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.dropCheckConstraint(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},p.prototype.createExclusionConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("Oracle does not support exclusion constraints.")})})},p.prototype.createExclusionConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("Oracle does not support exclusion constraints.")})})},p.prototype.dropExclusionConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("Oracle does not support exclusion constraints.")})})},p.prototype.dropExclusionConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("Oracle does not support exclusion constraints.")})})},p.prototype.createForeignKey=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a,o,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(a=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:a=e.sent(),e.label=3;case 3:return r=a,t.name||(t.name=this.connection.namingStrategy.foreignKeyName(r.name,t.columnNames)),o=this.createForeignKeySql(r,t),u=this.dropForeignKeySql(r,t),[4,this.executeQueries(o,u)];case 4:return e.sent(),r.addForeignKey(t),[2]}})})},p.prototype.createForeignKeys=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.createForeignKey(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},p.prototype.dropForeignKey=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,o,u,s,c;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(o=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:o=e.sent(),e.label=3;case 3:if(r=o,!(u=t instanceof a.TableForeignKey?t:r.foreignKeys.find(function(e){return e.name===t})))throw new Error("Supplied foreign key was not found in table "+r.name);return s=this.dropForeignKeySql(r,u),c=this.createForeignKeySql(r,u),[4,this.executeQueries(s,c)];case 4:return e.sent(),r.removeForeignKey(u),[2]}})})},p.prototype.dropForeignKeys=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.dropForeignKey(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},p.prototype.createIndex=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a,o,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(a=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:a=e.sent(),e.label=3;case 3:return r=a,t.name||(t.name=this.connection.namingStrategy.indexName(r.name,t.columnNames,t.where)),o=this.createIndexSql(r,t),u=this.dropIndexSql(t),[4,this.executeQueries(o,u)];case 4:return e.sent(),r.addIndex(t),[2]}})})},p.prototype.createIndices=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.createIndex(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},p.prototype.dropIndex=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,a,u,s,c;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof i.Table?(a=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:a=e.sent(),e.label=3;case 3:if(r=a,!(u=t instanceof o.TableIndex?t:r.indices.find(function(e){return e.name===t})))throw new Error("Supplied index was not found in table "+r.name);return s=this.dropIndexSql(u),c=this.createIndexSql(r,u),[4,this.executeQueries(s,c)];case 4:return e.sent(),r.removeIndex(u),[2]}})})},p.prototype.dropIndices=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.dropIndex(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},p.prototype.clearTable=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.query('TRUNCATE TABLE "'+n+'"')];case 1:return e.sent(),[2]}})})},p.prototype.clearDatabase=function(){return e.__awaiter(this,void 0,void 0,function(){var n,t,r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.startTransaction()];case 1:e.sent(),e.label=2;case 2:return e.trys.push([2,8,,13]),'SELECT \'DROP VIEW "\' || VIEW_NAME || \'"\' AS "query" FROM "USER_VIEWS"',[4,this.query('SELECT \'DROP VIEW "\' || VIEW_NAME || \'"\' AS "query" FROM "USER_VIEWS"')];case 3:return n=e.sent(),[4,Promise.all(n.map(function(e){return i.query(e.query)}))];case 4:return e.sent(),'SELECT \'DROP TABLE "\' || TABLE_NAME || \'" CASCADE CONSTRAINTS\' AS "query" FROM "USER_TABLES"',[4,this.query('SELECT \'DROP TABLE "\' || TABLE_NAME || \'" CASCADE CONSTRAINTS\' AS "query" FROM "USER_TABLES"')];case 5:return t=e.sent(),[4,Promise.all(t.map(function(e){return i.query(e.query)}))];case 6:return e.sent(),[4,this.commitTransaction()];case 7:return e.sent(),[3,13];case 8:r=e.sent(),e.label=9;case 9:return e.trys.push([9,11,,12]),[4,this.rollbackTransaction()];case 10:return e.sent(),[3,12];case 11:return e.sent(),[3,12];case 12:throw r;case 13:return[2]}})})},p.prototype.loadViews=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.hasTable(this.getTypeormMetadataTableName())];case 1:return e.sent()?(t=n.map(function(e){return"'"+e+"'"}).join(", "),r='SELECT "T".* FROM "'+this.getTypeormMetadataTableName()+'" "T" INNER JOIN "USER_VIEWS" "V" ON "V"."VIEW_NAME" = "T"."name" WHERE "T"."type" = \'VIEW\'',t.length>0&&(r+=' AND "T"."name" IN ('+t+")"),[4,this.query(r)]):[2,Promise.resolve([])];case 2:return[2,e.sent().map(function(e){var n=new s.View;return n.name=e.name,n.expression=e.value,n})]}})})},p.prototype.loadTables=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,u,s,c,m,h,T,f,p,A,d,C,y=this;return e.__generator(this,function(_){switch(_.label){case 0:return n&&n.length?(t=n.map(function(e){return"'"+e+"'"}).join(", "),u='SELECT * FROM "USER_TABLES" WHERE "TABLE_NAME" IN ('+t+")",s='SELECT * FROM "USER_TAB_COLS" WHERE "TABLE_NAME" IN ('+t+")",c='SELECT "IND"."INDEX_NAME", "IND"."TABLE_NAME", "IND"."UNIQUENESS", LISTAGG ("COL"."COLUMN_NAME", \',\') WITHIN GROUP (ORDER BY "COL"."COLUMN_NAME") AS "COLUMN_NAMES" FROM "USER_INDEXES" "IND" INNER JOIN "USER_IND_COLUMNS" "COL" ON "COL"."INDEX_NAME" = "IND"."INDEX_NAME" LEFT JOIN "USER_CONSTRAINTS" "CON" ON "CON"."CONSTRAINT_NAME" = "IND"."INDEX_NAME" WHERE "IND"."TABLE_NAME" IN ('+t+') AND "CON"."CONSTRAINT_NAME" IS NULL GROUP BY "IND"."INDEX_NAME", "IND"."TABLE_NAME", "IND"."UNIQUENESS"',m='SELECT "C"."CONSTRAINT_NAME", "C"."TABLE_NAME", "COL"."COLUMN_NAME", "REF_COL"."TABLE_NAME" AS "REFERENCED_TABLE_NAME", "REF_COL"."COLUMN_NAME" AS "REFERENCED_COLUMN_NAME", "C"."DELETE_RULE" AS "ON_DELETE" FROM "USER_CONSTRAINTS" "C" INNER JOIN "USER_CONS_COLUMNS" "COL" ON "COL"."OWNER" = "C"."OWNER" AND "COL"."CONSTRAINT_NAME" = "C"."CONSTRAINT_NAME" INNER JOIN "USER_CONS_COLUMNS" "REF_COL" ON "REF_COL"."OWNER" = "C"."R_OWNER" AND "REF_COL"."CONSTRAINT_NAME" = "C"."R_CONSTRAINT_NAME" AND "REF_COL"."POSITION" = "COL"."POSITION" WHERE "C"."TABLE_NAME" IN ('+t+') AND "C"."CONSTRAINT_TYPE" = \'R\'',h='SELECT "C"."CONSTRAINT_NAME", "C"."CONSTRAINT_TYPE", "C"."TABLE_NAME", "COL"."COLUMN_NAME", "C"."SEARCH_CONDITION" FROM "USER_CONSTRAINTS" "C" INNER JOIN "USER_CONS_COLUMNS" "COL" ON "COL"."OWNER" = "C"."OWNER" AND "COL"."CONSTRAINT_NAME" = "C"."CONSTRAINT_NAME" WHERE "C"."TABLE_NAME" IN ('+t+") AND \"C\".\"CONSTRAINT_TYPE\" IN ('C', 'U', 'P') AND \"C\".\"GENERATED\" = 'USER NAME'",[4,Promise.all([this.query(u),this.query(s),this.query(c),this.query(m),this.query(h)])]):[2,[]];case 1:return T=e.__read.apply(void 0,[_.sent(),5]),f=T[0],p=T[1],A=T[2],d=T[3],C=T[4],f.length?[2,f.map(function(e){var n=new i.Table;n.name=e.TABLE_NAME,n.columns=p.filter(function(e){return e.TABLE_NAME===n.name}).map(function(e){var t=C.filter(function(t){return t.TABLE_NAME===n.name&&t.COLUMN_NAME===e.COLUMN_NAME}),i=t.find(function(e){return"U"===e.CONSTRAINT_TYPE}),a=!!i&&!!C.find(function(n){return"U"===n.CONSTRAINT_TYPE&&n.CONSTRAINT_NAME===i.CONSTRAINT_NAME&&n.COLUMN_NAME!==e.COLUMN_NAME}),o=!!i&&!a,u=!!t.find(function(e){return"P"===e.CONSTRAINT_TYPE}),s=new r.TableColumn;if(s.name=e.COLUMN_NAME,s.type=e.DATA_TYPE.toLowerCase(),-1!==s.type.indexOf("(")&&(s.type=s.type.replace(/\([0-9]*\)/,"")),-1!==y.driver.withLengthColumnTypes.indexOf(s.type)){var c="raw"===s.type?e.DATA_LENGTH:e.CHAR_COL_DECL_LENGTH;s.length=c&&!y.isDefaultColumnLength(n,s,c)?c.toString():""}return"number"===s.type||"float"===s.type?(null===e.DATA_PRECISION||y.isDefaultColumnPrecision(n,s,e.DATA_PRECISION)||(s.precision=e.DATA_PRECISION),null===e.DATA_SCALE||y.isDefaultColumnScale(n,s,e.DATA_SCALE)||(s.scale=e.DATA_SCALE)):"timestamp"!==s.type&&"timestamp with time zone"!==s.type&&"timestamp with local time zone"!==s.type||null===e.DATA_SCALE||(s.precision=y.isDefaultColumnPrecision(n,s,e.DATA_SCALE)?void 0:e.DATA_SCALE),s.default=null!==e.DATA_DEFAULT&&void 0!==e.DATA_DEFAULT&&"NULL"!==e.DATA_DEFAULT.trim()?s.default=e.DATA_DEFAULT.trim():void 0,s.isNullable="Y"===e.NULLABLE,s.isUnique=o,s.isPrimary=u,s.isGenerated="YES"===e.IDENTITY_COLUMN,s.isGenerated&&(s.generationStrategy="increment",s.default=void 0),s.comment="",s});var t=E.OrmUtils.uniq(C.filter(function(e){return e.TABLE_NAME===n.name&&"U"===e.CONSTRAINT_TYPE}),function(e){return e.CONSTRAINT_NAME});n.uniques=t.map(function(e){var n=C.filter(function(n){return n.CONSTRAINT_NAME===e.CONSTRAINT_NAME});return new l.TableUnique({name:e.CONSTRAINT_NAME,columnNames:n.map(function(e){return e.COLUMN_NAME})})});var u=E.OrmUtils.uniq(C.filter(function(e){return e.TABLE_NAME===n.name&&"C"===e.CONSTRAINT_TYPE}),function(e){return e.CONSTRAINT_NAME});n.checks=u.map(function(e){var n=C.filter(function(n){return n.CONSTRAINT_NAME===e.CONSTRAINT_NAME});return new N.TableCheck({name:e.CONSTRAINT_NAME,columnNames:n.map(function(e){return e.COLUMN_NAME}),expression:e.SEARCH_CONDITION})});var s=E.OrmUtils.uniq(d.filter(function(e){return e.TABLE_NAME===n.name}),function(e){return e.CONSTRAINT_NAME});return n.foreignKeys=s.map(function(e){var n=d.filter(function(n){return n.CONSTRAINT_NAME===e.CONSTRAINT_NAME});return new a.TableForeignKey({name:e.CONSTRAINT_NAME,columnNames:n.map(function(e){return e.COLUMN_NAME}),referencedTableName:e.REFERENCED_TABLE_NAME,referencedColumnNames:n.map(function(e){return e.REFERENCED_COLUMN_NAME}),onDelete:e.ON_DELETE,onUpdate:"NO ACTION"})}),n.indices=A.filter(function(e){return e.TABLE_NAME===n.name}).map(function(e){return new o.TableIndex({name:e.INDEX_NAME,columnNames:e.COLUMN_NAMES.split(","),isUnique:"UNIQUE"===e.UNIQUENESS})}),n})]:[2,[]]}})})},p.prototype.createTableSql=function(e,n){var t=this,r=e.columns.map(function(e){return t.buildCreateColumnSql(e)}).join(", "),i='CREATE TABLE "'+e.name+'" ('+r;(e.columns.filter(function(e){return e.isUnique}).forEach(function(n){e.uniques.some(function(e){return 1===e.columnNames.length&&e.columnNames[0]===n.name})||e.uniques.push(new l.TableUnique({name:t.connection.namingStrategy.uniqueConstraintName(e.name,[n.name]),columnNames:[n.name]}))}),e.uniques.length>0)&&(i+=", "+e.uniques.map(function(n){return'CONSTRAINT "'+(n.name?n.name:t.connection.namingStrategy.uniqueConstraintName(e.name,n.columnNames))+'" UNIQUE ('+n.columnNames.map(function(e){return'"'+e+'"'}).join(", ")+")"}).join(", "));e.checks.length>0&&(i+=", "+e.checks.map(function(n){return'CONSTRAINT "'+(n.name?n.name:t.connection.namingStrategy.checkConstraintName(e.name,n.expression))+'" CHECK ('+n.expression+")"}).join(", "));e.foreignKeys.length>0&&n&&(i+=", "+e.foreignKeys.map(function(n){var r=n.columnNames.map(function(e){return'"'+e+'"'}).join(", ");n.name||(n.name=t.connection.namingStrategy.foreignKeyName(e.name,n.columnNames));var i=n.referencedColumnNames.map(function(e){return'"'+e+'"'}).join(", "),a='CONSTRAINT "'+n.name+'" FOREIGN KEY ('+r+') REFERENCES "'+n.referencedTableName+'" ('+i+")";return n.onDelete&&"NO ACTION"!==n.onDelete&&(a+=" ON DELETE "+n.onDelete),a}).join(", "));var a=e.columns.filter(function(e){return e.isPrimary});a.length>0&&(i+=', CONSTRAINT "'+this.connection.namingStrategy.primaryKeyName(e.name,a.map(function(e){return e.name}))+'" PRIMARY KEY ('+a.map(function(e){return'"'+e.name+'"'}).join(", ")+")");return i+=")",new c.Query(i)},p.prototype.dropTableSql=function(e,n){var t=e instanceof i.Table?e.name:e,r=n?'DROP TABLE IF EXISTS "'+t+'"':'DROP TABLE "'+t+'"';return new c.Query(r)},p.prototype.createViewSql=function(e){return"string"==typeof e.expression?new c.Query('CREATE VIEW "'+e.name+'" AS '+e.expression):new c.Query('CREATE VIEW "'+e.name+'" AS '+e.expression(this.connection).getQuery())},p.prototype.insertViewDefinitionSql=function(n){var t="string"==typeof n.expression?n.expression.trim():n.expression(this.connection).getQuery(),r=e.__read(this.connection.createQueryBuilder().insert().into(this.getTypeormMetadataTableName()).values({type:"VIEW",name:n.name,value:t}).getQueryAndParameters(),2),i=r[0],a=r[1];return new c.Query(i,a)},p.prototype.dropViewSql=function(e){var n=e instanceof s.View?e.name:e;return new c.Query('DROP VIEW "'+n+'"')},p.prototype.deleteViewDefinitionSql=function(n){var t=n instanceof s.View?n.name:n,r=this.connection.createQueryBuilder(),i=e.__read(r.delete().from(this.getTypeormMetadataTableName()).where(r.escape("type")+" = 'VIEW'").andWhere(r.escape("name")+" = :name",{name:t}).getQueryAndParameters(),2),a=i[0],o=i[1];return new c.Query(a,o)},p.prototype.createIndexSql=function(e,n){var t=n.columnNames.map(function(e){return'"'+e+'"'}).join(", ");return new c.Query("CREATE "+(n.isUnique?"UNIQUE ":"")+'INDEX "'+n.name+'" ON "'+e.name+'" ('+t+")")},p.prototype.dropIndexSql=function(e){var n=e instanceof o.TableIndex?e.name:e;return new c.Query('DROP INDEX "'+n+'"')},p.prototype.createPrimaryKeySql=function(e,n){var t=this.connection.namingStrategy.primaryKeyName(e.name,n),r=n.map(function(e){return'"'+e+'"'}).join(", ");return new c.Query('ALTER TABLE "'+e.name+'" ADD CONSTRAINT "'+t+'" PRIMARY KEY ('+r+")")},p.prototype.dropPrimaryKeySql=function(e){var n=e.primaryColumns.map(function(e){return e.name}),t=this.connection.namingStrategy.primaryKeyName(e.name,n);return new c.Query('ALTER TABLE "'+e.name+'" DROP CONSTRAINT "'+t+'"')},p.prototype.createUniqueConstraintSql=function(e,n){var t=n.columnNames.map(function(e){return'"'+e+'"'}).join(", ");return new c.Query('ALTER TABLE "'+e.name+'" ADD CONSTRAINT "'+n.name+'" UNIQUE ('+t+")")},p.prototype.dropUniqueConstraintSql=function(e,n){var t=n instanceof l.TableUnique?n.name:n;return new c.Query('ALTER TABLE "'+e.name+'" DROP CONSTRAINT "'+t+'"')},p.prototype.createCheckConstraintSql=function(e,n){return new c.Query('ALTER TABLE "'+e.name+'" ADD CONSTRAINT "'+n.name+'" CHECK ('+n.expression+")")},p.prototype.dropCheckConstraintSql=function(e,n){var t=n instanceof N.TableCheck?n.name:n;return new c.Query('ALTER TABLE "'+e.name+'" DROP CONSTRAINT "'+t+'"')},p.prototype.createForeignKeySql=function(e,n){var t=n.columnNames.map(function(e){return'"'+e+'"'}).join(", "),r=n.referencedColumnNames.map(function(e){return'"'+e+'"'}).join(","),i='ALTER TABLE "'+e.name+'" ADD CONSTRAINT "'+n.name+'" FOREIGN KEY ('+t+') REFERENCES "'+n.referencedTableName+'" ('+r+")";return n.onDelete&&"NO ACTION"!==n.onDelete&&(i+=" ON DELETE "+n.onDelete),new c.Query(i)},p.prototype.dropForeignKeySql=function(e,n){var t=n instanceof a.TableForeignKey?n.name:n;return new c.Query('ALTER TABLE "'+e.name+'" DROP CONSTRAINT "'+t+'"')},p.prototype.buildCreateColumnSql=function(e){var n='"'+e.name+'" '+this.connection.driver.createFullType(e);return e.charset&&(n+=" CHARACTER SET "+e.charset),e.collation&&(n+=" COLLATE "+e.collation),void 0!==e.default&&null!==e.default&&(n+=" DEFAULT "+e.default),!0===e.isNullable||e.isGenerated||(n+=" NOT NULL"),!0===e.isGenerated&&"increment"===e.generationStrategy&&(n+=" GENERATED ALWAYS AS IDENTITY"),n},p}(T.BaseQueryRunner);exports.OracleQueryRunner=A;
},{"tslib":"c4AP","../../error/TransactionAlreadyStartedError":"kZCV","../../error/TransactionNotStartedError":"nZEx","../../schema-builder/table/TableColumn":"SdPr","../../schema-builder/table/Table":"e+Cn","../../schema-builder/table/TableForeignKey":"0LZF","../../schema-builder/table/TableIndex":"S7W/","../../error/QueryRunnerAlreadyReleasedError":"CGt0","../../schema-builder/view/View":"fSdu","../Query":"CMcp","../../error/QueryFailedError":"U3oI","../../schema-builder/table/TableUnique":"9Ztg","../../subscriber/Broadcaster":"wiLV","../../query-runner/BaseQueryRunner":"GBOk","../../util/OrmUtils":"R//v","../../schema-builder/table/TableCheck":"oxtv","../../index":"wlNf"}],"l9nz":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports.OracleDriver=void 0;var t=p(require("tslib")),r=require("../../error/ConnectionIsNotSetError"),a=require("../../error/DriverPackageNotInstalledError"),n=require("./OracleQueryRunner"),i=require("../../util/DateUtils"),o=require("../../platform/PlatformTools"),s=require("../../schema-builder/RdbmsSchemaBuilder"),c=require("../DriverUtils"),l=require("../../util/OrmUtils"),u=require("../../util/ApplyValueTransformers");function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}var m=function(){function p(e){this.slaves=[],this.isReplicated=!1,this.treeSupport=!0,this.supportedDataTypes=["char","nchar","nvarchar2","varchar2","long","raw","long raw","number","numeric","float","dec","decimal","integer","int","smallint","real","double precision","date","timestamp","timestamp with time zone","timestamp with local time zone","interval year to month","interval day to second","bfile","blob","clob","nclob","rowid","urowid"],this.spatialTypes=[],this.withLengthColumnTypes=["char","nchar","nvarchar2","varchar2","varchar","raw"],this.withPrecisionColumnTypes=["number","float","timestamp","timestamp with time zone","timestamp with local time zone"],this.withScaleColumnTypes=["number"],this.mappedDataTypes={createDate:"timestamp",createDateDefault:"CURRENT_TIMESTAMP",updateDate:"timestamp",updateDateDefault:"CURRENT_TIMESTAMP",version:"number",treeLevel:"number",migrationId:"number",migrationName:"varchar2",migrationTimestamp:"number",cacheId:"number",cacheIdentifier:"varchar2",cacheTime:"number",cacheDuration:"number",cacheQuery:"clob",cacheResult:"clob",metadataType:"varchar2",metadataDatabase:"varchar2",metadataSchema:"varchar2",metadataTable:"varchar2",metadataName:"varchar2",metadataValue:"clob"},this.dataTypeDefaults={char:{length:1},nchar:{length:1},varchar:{length:255},varchar2:{length:255},nvarchar2:{length:255},raw:{length:2e3},float:{precision:126},timestamp:{precision:6},"timestamp with time zone":{precision:6},"timestamp with local time zone":{precision:6}},this.maxAliasLength=30,this.connection=e,this.options=e.options,this.loadDependencies(),this.oracle.outFormat=this.oracle.OBJECT}return p.prototype.connect=function(){return t.__awaiter(this,void 0,void 0,function(){var e,r,a,n=this;return t.__generator(this,function(t){switch(t.label){case 0:return this.oracle.fetchAsString=[this.oracle.CLOB],this.oracle.fetchAsBuffer=[this.oracle.BLOB],this.options.replication?(e=this,[4,Promise.all(this.options.replication.slaves.map(function(e){return n.createPool(n.options,e)}))]):[3,3];case 1:return e.slaves=t.sent(),r=this,[4,this.createPool(this.options,this.options.replication.master)];case 2:return r.master=t.sent(),this.database=this.options.replication.master.database,[3,5];case 3:return a=this,[4,this.createPool(this.options,this.options)];case 4:a.master=t.sent(),this.database=this.options.database,t.label=5;case 5:return[2]}})})},p.prototype.afterConnect=function(){return Promise.resolve()},p.prototype.disconnect=function(){return t.__awaiter(this,void 0,void 0,function(){var e=this;return t.__generator(this,function(t){switch(t.label){case 0:return this.master?[4,this.closePool(this.master)]:[2,Promise.reject(new r.ConnectionIsNotSetError("oracle"))];case 1:return t.sent(),[4,Promise.all(this.slaves.map(function(t){return e.closePool(t)}))];case 2:return t.sent(),this.master=void 0,this.slaves=[],[2]}})})},p.prototype.createSchemaBuilder=function(){return new s.RdbmsSchemaBuilder(this.connection)},p.prototype.createQueryRunner=function(e){return void 0===e&&(e="master"),new n.OracleQueryRunner(this,e)},p.prototype.escapeQueryWithParameters=function(e,t,r){var a=Object.keys(r).map(function(e){return"boolean"==typeof r[e]?r[e]?1:0:r[e]});if(!t||!Object.keys(t).length)return[e,a];var n=Object.keys(t).map(function(e){return"(:(\\.\\.\\.)?"+e+"\\b)"}).join("|");return[e=e.replace(new RegExp(n,"g"),function(e){var r,n=!1;return":..."===e.substr(0,4)?(n=!0,r=t[e.substr(4)]):r=t[e.substr(1)],n?r.map(function(t,r){return a.push(t),":"+e.substr(4)+r}).join(", "):r instanceof Function?r():"boolean"==typeof r?r?1:0:(a.push(r),e)}),a]},p.prototype.escape=function(e){return'"'+e+'"'},p.prototype.buildTableName=function(e,t,r){return e},p.prototype.preparePersistentValue=function(e,t){return t.transformer&&(e=u.ApplyValueTransformers.transformTo(t.transformer,e)),null==e?e:t.type===Boolean?e?1:0:"date"===t.type?("string"==typeof e&&(e=e.replace(/[^0-9-]/g,"")),function(){return"TO_DATE('"+i.DateUtils.mixedDateToDateString(e)+"', 'YYYY-MM-DD')"}):t.type===Date||"timestamp"===t.type||"timestamp with time zone"===t.type||"timestamp with local time zone"===t.type?i.DateUtils.mixedDateToDate(e):"simple-array"===t.type?i.DateUtils.simpleArrayToString(e):"simple-json"===t.type?i.DateUtils.simpleJsonToString(e):e},p.prototype.prepareHydratedValue=function(e,t){return null==e?t.transformer?u.ApplyValueTransformers.transformFrom(t.transformer,e):e:(t.type===Boolean?e=!!e:"date"===t.type?e=i.DateUtils.mixedDateToDateString(e):"time"===t.type?e=i.DateUtils.mixedTimeToString(e):t.type===Date||"timestamp"===t.type||"timestamp with time zone"===t.type||"timestamp with local time zone"===t.type?e=i.DateUtils.normalizeHydratedDate(e):"json"===t.type?e=JSON.parse(e):"simple-array"===t.type?e=i.DateUtils.stringToSimpleArray(e):"simple-json"===t.type&&(e=i.DateUtils.stringToSimpleJson(e)),t.transformer&&(e=u.ApplyValueTransformers.transformFrom(t.transformer,e)),e)},p.prototype.normalizeType=function(t){return t.type===Number||t.type===Boolean||"numeric"===t.type||"dec"===t.type||"decimal"===t.type||"int"===t.type||"integer"===t.type||"smallint"===t.type?"number":"real"===t.type||"double precision"===t.type?"float":t.type===String||"varchar"===t.type?"varchar2":t.type===Date?"timestamp":t.type===e?"blob":"uuid"===t.type?"varchar2":"simple-array"===t.type?"clob":"simple-json"===t.type?"clob":t.type||""},p.prototype.normalizeDefault=function(e){var t=e.default;return"number"==typeof t?""+t:"boolean"==typeof t?!0===t?"1":"0":"function"==typeof t?t():"string"==typeof t?"'"+t+"'":t},p.prototype.normalizeIsUnique=function(e){return e.entityMetadata.uniques.some(function(t){return 1===t.columns.length&&t.columns[0]===e})},p.prototype.getColumnLength=function(e){if(e.length)return e.length.toString();switch(e.type){case String:case"varchar":case"varchar2":case"nvarchar2":return"255";case"raw":return"2000";case"uuid":return"36";default:return""}},p.prototype.createFullType=function(e){var t=e.type;return this.getColumnLength(e)?t+="("+this.getColumnLength(e)+")":null!==e.precision&&void 0!==e.precision&&null!==e.scale&&void 0!==e.scale?t+="("+e.precision+","+e.scale+")":null!==e.precision&&void 0!==e.precision&&(t+="("+e.precision+")"),"timestamp with time zone"===e.type?t="TIMESTAMP"+(null!==e.precision&&void 0!==e.precision?"("+e.precision+")":"")+" WITH TIME ZONE":"timestamp with local time zone"===e.type&&(t="TIMESTAMP"+(null!==e.precision&&void 0!==e.precision?"("+e.precision+")":"")+" WITH LOCAL TIME ZONE"),e.isArray&&(t+=" array"),t},p.prototype.obtainMasterConnection=function(){var e=this;return new Promise(function(t,r){e.master.getConnection(function(e,a,n){if(e)return r(e);t(a)})})},p.prototype.obtainSlaveConnection=function(){var e=this;return this.slaves.length?new Promise(function(t,r){var a=Math.floor(Math.random()*e.slaves.length);e.slaves[a].getConnection(function(e,a){if(e)return r(e);t(a)})}):this.obtainMasterConnection()},p.prototype.createGeneratedMap=function(e,t){var r=this;if(t)return Object.keys(t).reduce(function(a,n){var i=e.findColumnWithDatabaseName(n);return i&&l.OrmUtils.mergeDeep(a,i.createValueMap(r.prepareHydratedValue(t[n],i))),a},{})},p.prototype.findChangedColumns=function(e,t){var r=this;return t.filter(function(t){var a=e.find(function(e){return e.name===t.databaseName});return!!a&&(a.name!==t.databaseName||a.type!==r.normalizeType(t)||a.length!==t.length||a.precision!==t.precision||a.scale!==t.scale||r.normalizeDefault(t)!==a.default||a.isPrimary!==t.isPrimary||a.isNullable!==t.isNullable||a.isUnique!==r.normalizeIsUnique(t)||"uuid"!==t.generationStrategy&&a.isGenerated!==t.isGenerated)})},p.prototype.isReturningSqlSupported=function(){return!0},p.prototype.isUUIDGenerationSupported=function(){return!1},p.prototype.createParameter=function(e,t){return":"+e},p.prototype.columnTypeToNativeParameter=function(e){switch(this.normalizeType({type:e})){case"number":case"numeric":case"int":case"integer":case"smallint":case"dec":case"decimal":return this.oracle.NUMBER;case"char":case"nchar":case"nvarchar2":case"varchar2":return this.oracle.STRING;case"blob":return this.oracle.BLOB;case"clob":return this.oracle.CLOB;case"date":case"timestamp":case"timestamp with time zone":case"timestamp with local time zone":return this.oracle.DATE}},p.prototype.loadDependencies=function(){try{this.oracle=o.PlatformTools.load("oracledb")}catch(e){throw new a.DriverPackageNotInstalledError("Oracle","oracledb")}},p.prototype.createPool=function(e,r){return t.__awaiter(this,void 0,void 0,function(){var a,n=this;return t.__generator(this,function(t){return r=Object.assign(r,c.DriverUtils.buildDriverOptions(r)),a=Object.assign({},{user:r.username,password:r.password,connectString:r.connectString?r.connectString:r.host+":"+r.port+"/"+r.sid},e.extra||{}),[2,new Promise(function(e,t){n.oracle.createPool(a,function(r,a){if(r)return t(r);e(a)})})]})})},p.prototype.closePool=function(e){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(t){return[2,new Promise(function(t,r){e.close(function(e){return e?r(e):t()}),e=void 0})]})})},p}();exports.OracleDriver=m;
},{"tslib":"c4AP","../../error/ConnectionIsNotSetError":"jWtv","../../error/DriverPackageNotInstalledError":"NaUg","./OracleQueryRunner":"3nMO","../../util/DateUtils":"iWm2","../../platform/PlatformTools":"YF44","../../schema-builder/RdbmsSchemaBuilder":"leiv","../DriverUtils":"hdhF","../../util/OrmUtils":"R//v","../../util/ApplyValueTransformers":"p0mU","buffer":"iHVs"}],"9HjS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NestedSetSubjectExecutor=void 0;var e=r(require("tslib")),t=require("../../util/OrmUtils");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}var a=function(){function r(e){this.queryRunner=e}return r.prototype.insert=function(r){return e.__awaiter(this,void 0,void 0,function(){var a,n,u,i,o,s,c,d=this;return e.__generator(this,function(e){switch(e.label){case 0:return a=function(e){return d.queryRunner.connection.driver.escape(e)},n=this.getTableName(r.metadata.tablePath),u=a(r.metadata.nestedSetLeftColumn.databaseName),i=a(r.metadata.nestedSetRightColumn.databaseName),!(o=r.metadata.treeParentRelation.getEntityValue(r.entity))&&r.parentSubject&&r.parentSubject.entity&&(o=r.parentSubject.insertedValueSet?r.parentSubject.insertedValueSet:r.parentSubject.entity),s=r.metadata.getEntityIdMap(o),c=void 0,s?[4,this.queryRunner.manager.createQueryBuilder().select(r.metadata.targetName+"."+r.metadata.nestedSetRightColumn.propertyPath,"right").from(r.metadata.target,r.metadata.targetName).whereInIds(s).getRawOne().then(function(e){var t=e?e.right:void 0;return"string"==typeof t?parseInt(t):t})]:[3,2];case 1:c=e.sent(),e.label=2;case 2:return void 0===c?[3,4]:[4,this.queryRunner.query("UPDATE "+n+" SET "+u+" = CASE WHEN "+u+" > "+c+" THEN "+u+" + 2 ELSE "+u+" END,"+i+" = "+i+" + 2 WHERE "+i+" >= "+c)];case 3:return e.sent(),t.OrmUtils.mergeDeep(r.insertedValueSet,r.metadata.nestedSetLeftColumn.createValueMap(c),r.metadata.nestedSetRightColumn.createValueMap(c+1)),[3,5];case 4:t.OrmUtils.mergeDeep(r.insertedValueSet,r.metadata.nestedSetLeftColumn.createValueMap(1),r.metadata.nestedSetRightColumn.createValueMap(2)),e.label=5;case 5:return[2]}})})},r.prototype.getTableName=function(e){var t=this;return e.split(".").map(function(e){return""===e?e:t.queryRunner.connection.driver.escape(e)}).join(".")},r}();exports.NestedSetSubjectExecutor=a;
},{"tslib":"c4AP","../../util/OrmUtils":"R//v"}],"6XmX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CannotAttachTreeChildrenEntityError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e){var n=t.call(this)||this;return n.name="CannotAttachTreeChildrenEntityError",Object.setPrototypeOf(n,r.prototype),n.message='Cannot attach entity "'+e+'" to its parent. Please make sure parent is saved in the database before saving children nodes.',n}return e.__extends(r,t),r}(Error);exports.CannotAttachTreeChildrenEntityError=r;
},{"tslib":"c4AP"}],"9R6c":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClosureSubjectExecutor=void 0;var e=n(require("tslib")),t=require("../../error/CannotAttachTreeChildrenEntityError");function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}var r=function(){function n(e){this.queryRunner=e}return n.prototype.insert=function(n){return e.__awaiter(this,void 0,void 0,function(){var r,a,u,i,o,c,s,l,d,m,p=this;return e.__generator(this,function(b){switch(b.label){case 0:return r={},n.metadata.closureJunctionTable.ancestorColumns.forEach(function(e){r[e.databaseName]=n.identifier}),n.metadata.closureJunctionTable.descendantColumns.forEach(function(e){r[e.databaseName]=n.identifier}),[4,this.queryRunner.manager.createQueryBuilder().insert().into(n.metadata.closureJunctionTable.tablePath).values(r).updateEntity(!1).callListeners(!1).execute()];case 1:return b.sent(),!(a=n.metadata.treeParentRelation.getEntityValue(n.entity))&&n.parentSubject&&n.parentSubject.entity&&(a=n.parentSubject.insertedValueSet?n.parentSubject.insertedValueSet:n.parentSubject.entity),a?(u=function(e){return p.queryRunner.connection.driver.escape(e)},i=this.getTableName(n.metadata.closureJunctionTable.tablePath),o=n.metadata.closureJunctionTable.ancestorColumns.map(function(e){return u(e.databaseName)}),c=n.metadata.closureJunctionTable.descendantColumns.map(function(e){return u(e.databaseName)}),s=[],l=n.metadata.primaryColumns.map(function(e){return e.getEntityValue(n.insertedValueSet)}),d=n.metadata.primaryColumns.map(function(e,t){return s.push(l[t]),p.queryRunner.connection.driver.createParameter("child_entity_"+e.databaseName,s.length-1)}),m=n.metadata.primaryColumns.map(function(e){var r=u(e.databaseName+"_descendant"),i=e.getEntityValue(a);if(!i)throw new t.CannotAttachTreeChildrenEntityError(n.metadata.name);return s.push(i),r+" = "+p.queryRunner.connection.driver.createParameter("parent_entity_"+e.databaseName,s.length-1)}).join(", "),[4,this.queryRunner.query("INSERT INTO "+i+" ("+e.__spread(o,c).join(", ")+") SELECT "+o.join(", ")+", "+d.join(", ")+" FROM "+i+" WHERE "+m,s)]):[3,3];case 2:b.sent(),b.label=3;case 3:return[2]}})})},n.prototype.getTableName=function(e){var t=this;return e.split(".").map(function(e){return""===e?e:t.queryRunner.connection.driver.escape(e)}).join(".")},n}();exports.ClosureSubjectExecutor=r;
},{"tslib":"c4AP","../../error/CannotAttachTreeChildrenEntityError":"6XmX"}],"XjrW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MaterializedPathSubjectExecutor=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}var r=function(){function t(e){this.queryRunner=e}return t.prototype.insert=function(t){return e.__awaiter(this,void 0,void 0,function(){var r,a,n,i,u;return e.__generator(this,function(e){switch(e.label){case 0:return!(a=t.metadata.treeParentRelation.getEntityValue(t.entity))&&t.parentSubject&&t.parentSubject.entity&&(a=t.parentSubject.insertedValueSet?t.parentSubject.insertedValueSet:t.parentSubject.entity),n=t.metadata.getEntityIdMap(a),i="",n?[4,this.queryRunner.manager.createQueryBuilder().select(t.metadata.targetName+"."+t.metadata.materializedPathColumn.propertyPath,"path").from(t.metadata.target,t.metadata.targetName).whereInIds(n).getRawOne().then(function(e){return e?e.path:void 0})]:[3,2];case 1:i=e.sent(),e.label=2;case 2:return u=t.metadata.treeParentRelation.joinColumns.map(function(e){return e.referencedColumn.getEntityValue(t.insertedValueSet)}).join("_"),[4,this.queryRunner.manager.createQueryBuilder().update(t.metadata.target).set((r={},r[t.metadata.materializedPathColumn.propertyPath]=i+u+".",r)).where(t.identifier).execute()];case 3:return e.sent(),[2]}})})},t}();exports.MaterializedPathSubjectExecutor=r;
},{"tslib":"c4AP"}],"oKMZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SubjectExecutor=void 0;var e=m(require("tslib")),t=require("../util/PromiseUtils"),r=require("./SubjectTopoligicalSorter"),n=require("./SubjectChangedColumnsComputer"),a=require("../error/SubjectWithoutIdentifierError"),i=require("../error/SubjectRemovedAndUpdatedError"),u=require("../driver/mongodb/MongoQueryRunner"),s=require("../driver/mongodb/MongoDriver"),o=require("../subscriber/BroadcasterResult"),c=require("../driver/oracle/OracleDriver"),d=require("./tree/NestedSetSubjectExecutor"),l=require("./tree/ClosureSubjectExecutor"),h=require("./tree/MaterializedPathSubjectExecutor"),p=require("../util/OrmUtils");function m(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var f=function(){function m(e,t,r){this.hasExecutableOperations=!1,this.insertSubjects=[],this.updateSubjects=[],this.removeSubjects=[],this.queryRunner=e,this.allSubjects=t,this.options=r,this.validate(),this.recompute()}return m.prototype.execute=function(){return e.__awaiter(this,void 0,void 0,function(){var t;return e.__generator(this,function(e){switch(e.label){case 0:return t=void 0,this.options&&!1===this.options.listeners?[3,2]:(t=this.broadcastBeforeEventsForAll()).promises.length>0?[4,Promise.all(t.promises)]:[3,2];case 1:e.sent(),e.label=2;case 2:return t&&t.count>0&&(this.insertSubjects.forEach(function(e){return e.recompute()}),this.updateSubjects.forEach(function(e){return e.recompute()}),this.removeSubjects.forEach(function(e){return e.recompute()}),this.recompute()),this.insertSubjects=new r.SubjectTopoligicalSorter(this.insertSubjects).sort("insert"),[4,this.executeInsertOperations()];case 3:return e.sent(),this.updateSubjects=this.allSubjects.filter(function(e){return e.mustBeUpdated}),[4,this.executeUpdateOperations()];case 4:return e.sent(),this.removeSubjects=new r.SubjectTopoligicalSorter(this.removeSubjects).sort("delete"),[4,this.executeRemoveOperations()];case 5:return e.sent(),[4,this.updateSpecialColumnsInPersistedEntities()];case 6:return e.sent(),this.options&&!1===this.options.listeners?[3,8]:(t=this.broadcastAfterEventsForAll()).promises.length>0?[4,Promise.all(t.promises)]:[3,8];case 7:e.sent(),e.label=8;case 8:return[2]}})})},m.prototype.validate=function(){this.allSubjects.forEach(function(e){if(e.mustBeUpdated&&e.mustBeRemoved)throw new i.SubjectRemovedAndUpdatedError(e)})},m.prototype.recompute=function(){(new n.SubjectChangedColumnsComputer).compute(this.allSubjects),this.insertSubjects=this.allSubjects.filter(function(e){return e.mustBeInserted}),this.updateSubjects=this.allSubjects.filter(function(e){return e.mustBeUpdated}),this.removeSubjects=this.allSubjects.filter(function(e){return e.mustBeRemoved}),this.hasExecutableOperations=this.insertSubjects.length>0||this.updateSubjects.length>0||this.removeSubjects.length>0},m.prototype.broadcastBeforeEventsForAll=function(){var e=this,t=new o.BroadcasterResult;return this.insertSubjects.length&&this.insertSubjects.forEach(function(r){return e.queryRunner.broadcaster.broadcastBeforeInsertEvent(t,r.metadata,r.entity)}),this.updateSubjects.length&&this.updateSubjects.forEach(function(r){return e.queryRunner.broadcaster.broadcastBeforeUpdateEvent(t,r.metadata,r.entity,r.databaseEntity,r.diffColumns,r.diffRelations)}),this.removeSubjects.length&&this.removeSubjects.forEach(function(r){return e.queryRunner.broadcaster.broadcastBeforeRemoveEvent(t,r.metadata,r.entity,r.databaseEntity)}),t},m.prototype.broadcastAfterEventsForAll=function(){var e=this,t=new o.BroadcasterResult;return this.insertSubjects.length&&this.insertSubjects.forEach(function(r){return e.queryRunner.broadcaster.broadcastAfterInsertEvent(t,r.metadata,r.entity)}),this.updateSubjects.length&&this.updateSubjects.forEach(function(r){return e.queryRunner.broadcaster.broadcastAfterUpdateEvent(t,r.metadata,r.entity,r.databaseEntity,r.diffColumns,r.diffRelations)}),this.removeSubjects.length&&this.removeSubjects.forEach(function(r){return e.queryRunner.broadcaster.broadcastAfterRemoveEvent(t,r.metadata,r.entity,r.databaseEntity)}),t},m.prototype.executeInsertOperations=function(){return e.__awaiter(this,void 0,void 0,function(){var r,n,a,i=this;return e.__generator(this,function(o){switch(o.label){case 0:return r=e.__read(this.groupBulkSubjects(this.insertSubjects,"insert"),2),n=r[0],a=r[1],[4,t.PromiseUtils.runInSequence(a,function(r){return e.__awaiter(i,void 0,void 0,function(){var a,i,o,p,m,f,b=this;return e.__generator(this,function(y){switch(y.label){case 0:return a=n[r],i=[],o=[],p=[],this.queryRunner.connection.driver instanceof s.MongoDriver?a.forEach(function(e){e.metadata.createDateColumn&&e.entity&&(e.entity[e.metadata.createDateColumn.databaseName]=new Date),e.metadata.updateDateColumn&&e.entity&&(e.entity[e.metadata.updateDateColumn.databaseName]=new Date),e.createValueSetAndPopChangeMap(),o.push(e),i.push(e.entity)}):this.queryRunner.connection.driver instanceof c.OracleDriver?a.forEach(function(e){p.push(e)}):a.forEach(function(e){0===e.changeMaps.length||e.metadata.treeType||b.queryRunner.connection.driver instanceof c.OracleDriver?p.push(e):(o.push(e),i.push(e.createValueSetAndPopChangeMap()))}),this.queryRunner instanceof u.MongoQueryRunner?[4,this.queryRunner.manager.insert(a[0].metadata.target,i)]:[3,2];case 1:return m=y.sent(),a.forEach(function(e,t){e.identifier=m.identifiers[t],e.generatedMap=m.generatedMaps[t],e.insertedValueSet=i[t]}),[3,6];case 2:return i.length>0?[4,this.queryRunner.manager.createQueryBuilder().insert().into(a[0].metadata.target).values(i).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1).execute()]:[3,4];case 3:f=y.sent(),o.forEach(function(e,t){e.identifier=f.identifiers[t],e.generatedMap=f.generatedMaps[t],e.insertedValueSet=i[t]}),y.label=4;case 4:return p.length>0?[4,t.PromiseUtils.runInSequence(p,function(t){return e.__awaiter(b,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return t.insertedValueSet=t.createValueSetAndPopChangeMap(),"nested-set"!==t.metadata.treeType?[3,2]:[4,new d.NestedSetSubjectExecutor(this.queryRunner).insert(t)];case 1:e.sent(),e.label=2;case 2:return[4,this.queryRunner.manager.createQueryBuilder().insert().into(t.metadata.target).values(t.insertedValueSet).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1).execute().then(function(e){t.identifier=e.identifiers[0],t.generatedMap=e.generatedMaps[0]})];case 3:return e.sent(),"closure-table"!==t.metadata.treeType?[3,5]:[4,new l.ClosureSubjectExecutor(this.queryRunner).insert(t)];case 4:return e.sent(),[3,7];case 5:return"materialized-path"!==t.metadata.treeType?[3,7]:[4,new h.MaterializedPathSubjectExecutor(this.queryRunner).insert(t)];case 6:e.sent(),e.label=7;case 7:return[2]}})})})]:[3,6];case 5:y.sent(),y.label=6;case 6:return a.forEach(function(e){e.generatedMap&&e.metadata.columns.forEach(function(t){var r=t.getEntityValue(e.generatedMap);if(null!=r){var n=b.queryRunner.connection.driver.prepareHydratedValue(r,t);t.setEntityValue(e.generatedMap,n)}})}),[2]}})})})];case 1:return o.sent(),[2]}})})},m.prototype.executeUpdateOperations=function(){return e.__awaiter(this,void 0,void 0,function(){var t=this;return e.__generator(this,function(r){switch(r.label){case 0:return[4,Promise.all(this.updateSubjects.map(function(r){return e.__awaiter(t,void 0,void 0,function(){var t,n,i,s,o=this;return e.__generator(this,function(e){switch(e.label){case 0:if(!r.identifier)throw new a.SubjectWithoutIdentifierError(r);return this.queryRunner instanceof u.MongoQueryRunner?(t=p.OrmUtils.mergeDeep({},r.entity),r.metadata.objectIdColumn&&r.metadata.objectIdColumn.propertyName&&delete t[r.metadata.objectIdColumn.propertyName],r.metadata.createDateColumn&&r.metadata.createDateColumn.propertyName&&delete t[r.metadata.createDateColumn.propertyName],r.metadata.updateDateColumn&&r.metadata.updateDateColumn.propertyName&&(t[r.metadata.updateDateColumn.propertyName]=new Date),[4,this.queryRunner.manager.update(r.metadata.target,r.identifier,t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return n=r.createValueSetAndPopChangeMap(),i=this.queryRunner.manager.createQueryBuilder().update(r.metadata.target).set(n).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1),r.entity?i.whereEntity(r.identifier):i.where(r.identifier),[4,i.execute()];case 3:s=e.sent(),r.generatedMap=s.generatedMaps[0],r.generatedMap&&r.metadata.columns.forEach(function(e){var t=e.getEntityValue(r.generatedMap);if(null!=t){var n=o.queryRunner.connection.driver.prepareHydratedValue(t,e);e.setEntityValue(r.generatedMap,n)}}),e.label=4;case 4:return[2]}})})}))];case 1:return r.sent(),[2]}})})},m.prototype.executeRemoveOperations=function(){return e.__awaiter(this,void 0,void 0,function(){var r,n,i,s=this;return e.__generator(this,function(o){switch(o.label){case 0:return r=e.__read(this.groupBulkSubjects(this.removeSubjects,"delete"),2),n=r[0],i=r[1],[4,t.PromiseUtils.runInSequence(i,function(t){return e.__awaiter(s,void 0,void 0,function(){var r,i;return e.__generator(this,function(e){switch(e.label){case 0:return r=n[t],i=r.map(function(e){if(!e.identifier)throw new a.SubjectWithoutIdentifierError(e);return e.identifier}),this.queryRunner instanceof u.MongoQueryRunner?[4,this.queryRunner.manager.delete(r[0].metadata.target,i)]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,this.queryRunner.manager.createQueryBuilder().delete().from(r[0].metadata.target).where(i).callListeners(!1).execute()];case 3:e.sent(),e.label=4;case 4:return[2]}})})})];case 1:return o.sent(),[2]}})})},m.prototype.updateSpecialColumnsInPersistedEntities=function(){var e=this;this.insertSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.insertSubjects),this.updateSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.updateSubjects),this.removeSubjects.length&&this.removeSubjects.forEach(function(e){e.entity&&e.metadata.primaryColumns.forEach(function(t){t.setEntityValue(e.entity,void 0)})}),this.allSubjects.forEach(function(t){t.entity&&(t.metadata.relationIds.forEach(function(e){e.setValue(t.entity)}),e.queryRunner instanceof u.MongoQueryRunner&&t.metadata.objectIdColumn&&t.metadata.objectIdColumn.databaseName&&t.metadata.objectIdColumn.databaseName!==t.metadata.objectIdColumn.propertyName&&delete t.entity[t.metadata.objectIdColumn.databaseName])})},m.prototype.updateSpecialColumnsInInsertedAndUpdatedEntities=function(e){var t=this;e.forEach(function(e){e.entity&&(e.metadata.columns.forEach(function(t){if(!(e.metadata.childEntityMetadatas.length>0&&-1!==e.metadata.childEntityMetadatas.map(function(e){return e.target}).indexOf(t.target)||t.isVirtual)){if(t.isNullable)void 0===t.getEntityValue(e.entity)&&t.setEntityValue(e.entity,null);e.updatedRelationMaps.length>0&&e.updatedRelationMaps.forEach(function(t){t.relation.joinColumns.forEach(function(r){!0!==r.isVirtual&&r.setEntityValue(e.entity,t.value instanceof Object?r.referencedColumn.getEntityValue(t.value):t.value)})})}}),e.generatedMap&&t.queryRunner.manager.merge(e.metadata.target,e.entity,e.generatedMap))})},m.prototype.groupBulkSubjects=function(e,t){var r={},n=[],a="delete"===t||this.queryRunner.connection.driver.isReturningSqlSupported();return e.forEach(function(e,t){var i=a||e.metadata.isJunction?e.metadata.name:e.metadata.name+"_"+t;r[i]?r[i].push(e):(r[i]=[e],n.push(i))}),[r,n]},m}();exports.SubjectExecutor=f;
},{"tslib":"c4AP","../util/PromiseUtils":"DcM6","./SubjectTopoligicalSorter":"q3Bi","./SubjectChangedColumnsComputer":"NYPL","../error/SubjectWithoutIdentifierError":"TEoI","../error/SubjectRemovedAndUpdatedError":"/e5P","../driver/mongodb/MongoQueryRunner":"TOLf","../driver/mongodb/MongoDriver":"TOLf","../subscriber/BroadcasterResult":"thBa","../driver/oracle/OracleDriver":"l9nz","./tree/NestedSetSubjectExecutor":"9HjS","./tree/ClosureSubjectExecutor":"9R6c","./tree/MaterializedPathSubjectExecutor":"XjrW","../util/OrmUtils":"R//v"}],"7UFp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CannotDetermineEntityError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e){var n=t.call(this)||this;return n.name="CannotDetermineEntityError",Object.setPrototypeOf(n,r.prototype),n.message="Cannot "+e+", given value must be instance of entity class, instead object literal is given. Or you must specify an entity target to method call.",n}return e.__extends(r,t),r}(Error);exports.CannotDetermineEntityError=r;
},{"tslib":"c4AP"}],"JBjA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Subject=void 0;var e=a(require("tslib")),t=require("../util/OrmUtils");function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};i.get||i.set?Object.defineProperty(t,a,i):t[a]=e[a]}return t.default=e,t}var i=function(){function a(t){var a;this.identifier=void 0,this.entityWithFulfilledIds=void 0,this.databaseEntityLoaded=!1,this.changeMaps=[],this.canBeInserted=!1,this.canBeUpdated=!1,this.mustBeRemoved=!1,this.updatedRelationMaps=[],this.diffColumns=[],this.diffRelations=[],this.metadata=t.metadata,this.entity=t.entity,this.parentSubject=t.parentSubject,void 0!==t.canBeInserted&&(this.canBeInserted=t.canBeInserted),void 0!==t.canBeUpdated&&(this.canBeUpdated=t.canBeUpdated),void 0!==t.mustBeRemoved&&(this.mustBeRemoved=t.mustBeRemoved),void 0!==t.identifier&&(this.identifier=t.identifier),void 0!==t.changeMaps&&(a=this.changeMaps).push.apply(a,e.__spread(t.changeMaps)),this.recompute()}return Object.defineProperty(a.prototype,"mustBeInserted",{get:function(){return this.canBeInserted&&!this.databaseEntity},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"mustBeUpdated",{get:function(){return this.canBeUpdated&&this.identifier&&(!1===this.databaseEntityLoaded||this.databaseEntityLoaded&&this.databaseEntity)&&this.changeMaps.length>0},enumerable:!0,configurable:!0}),a.prototype.createValueSetAndPopChangeMap=function(){var e=this,i=[],n=this.changeMaps.reduce(function(n,r){var s,d=r.value;if(d instanceof a&&(d=d.insertedValueSet?d.insertedValueSet:d.entity),e.metadata.isJunction&&r.column)s=r.column.createValueMap(r.column.referencedColumn.getEntityValue(d));else if(r.column)s=r.column.createValueMap(d);else if(r.relation)if(d instanceof Object){var o=r.relation.getRelationIdMap(d);if(void 0===o)return i.push(r),e.canBeUpdated=!0,n;s=r.relation.createValueMap(o),e.updatedRelationMaps.push({relation:r.relation,value:o})}else s=r.relation.createValueMap(d),e.updatedRelationMaps.push({relation:r.relation,value:d});return t.OrmUtils.mergeDeep(n,s),n},{});return this.changeMaps=i,n},a.prototype.recompute=function(){var e=this;this.entity?(this.entityWithFulfilledIds=Object.assign({},this.entity),this.parentSubject&&this.metadata.primaryColumns.forEach(function(t){t.relationMetadata&&t.relationMetadata.inverseEntityMetadata===e.parentSubject.metadata&&t.setEntityValue(e.entityWithFulfilledIds,e.parentSubject.entity)}),this.identifier=this.metadata.getEntityIdMap(this.entityWithFulfilledIds)):this.databaseEntity&&(this.identifier=this.metadata.getEntityIdMap(this.databaseEntity))},a}();exports.Subject=i;
},{"tslib":"c4AP","../util/OrmUtils":"R//v"}],"syJv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OneToManySubjectBuilder=void 0;var e=require("../Subject"),t=require("../../util/OrmUtils"),a=require("../../metadata/EntityMetadata"),n=function(){function n(e){this.subjects=e}return n.prototype.build=function(){var e=this;this.subjects.forEach(function(t){t.metadata.oneToManyRelations.forEach(function(a){!1!==a.persistenceEnabled&&e.buildForSubjectRelation(t,a)})})},n.prototype.buildForSubjectRelation=function(n,i){var r=this,u=[];n.databaseEntity&&(u=i.getEntityValue(n.databaseEntity));var s=i.getEntityValue(n.entity);if(null===s&&(s=[]),void 0!==s){var o=[];s.forEach(function(a){var s=i.inverseEntityMetadata.getEntityIdMap(a),c=r.subjects.find(function(e){return e.entity===a});if(c&&(s=c.identifier),s){u.find(function(e){return t.OrmUtils.deepCompare(s,e)})||(c||(c=new e.Subject({metadata:i.inverseEntityMetadata,parentSubject:n,canBeUpdated:!0,identifier:s}),r.subjects.push(c)),c.changeMaps.push({relation:i.inverseRelation,value:n})),o.push(s)}else{if(!c)return;c.changeMaps.push({relation:i.inverseRelation,value:n})}}),a.EntityMetadata.difference(u,o).forEach(function(t){var a=new e.Subject({metadata:i.inverseEntityMetadata,parentSubject:n,canBeUpdated:!0,identifier:t,changeMaps:[{relation:i.inverseRelation,value:null}]});r.subjects.push(a)})}},n}();exports.OneToManySubjectBuilder=n;
},{"../Subject":"JBjA","../../util/OrmUtils":"R//v","../../metadata/EntityMetadata":"Raef"}],"YNjO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OneToOneInverseSideSubjectBuilder=void 0;var e=require("../Subject"),t=require("../../util/OrmUtils"),i=function(){function i(e){this.subjects=e}return i.prototype.build=function(){var e=this;this.subjects.forEach(function(t){t.metadata.oneToOneRelations.forEach(function(i){i.isOwning||!1===i.persistenceEnabled||e.buildForSubjectRelation(t,i)})})},i.prototype.buildForSubjectRelation=function(i,n){var a=void 0;i.databaseEntity&&(a=n.getEntityValue(i.databaseEntity));var r=n.getEntityValue(i.entity);if(void 0!==r)if(null!==r){var s=n.inverseEntityMetadata.getEntityIdMap(r),u=this.subjects.find(function(e){return!!e.entity&&e.entity===r});if(u&&(s=u.identifier),!s){if(!u)return;u.changeMaps.push({relation:n.inverseRelation,value:i})}a&&t.OrmUtils.deepCompare(s,a)||(u||(u=new e.Subject({metadata:n.inverseEntityMetadata,canBeUpdated:!0,identifier:s}),this.subjects.push(u)),u.changeMaps.push({relation:n.inverseRelation,value:i}))}else if(a){var o=new e.Subject({metadata:n.inverseEntityMetadata,parentSubject:i,canBeUpdated:!0,identifier:a,changeMaps:[{relation:n.inverseRelation,value:null}]});this.subjects.push(o)}},i}();exports.OneToOneInverseSideSubjectBuilder=i;
},{"../Subject":"JBjA","../../util/OrmUtils":"R//v"}],"QtJn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ManyToManySubjectBuilder=void 0;var t=require("../Subject"),e=require("../../util/OrmUtils"),n=require("../../metadata/EntityMetadata"),a=function(){function a(t){this.subjects=t}return a.prototype.build=function(){var t=this;this.subjects.forEach(function(e){e.entity&&e.metadata.manyToManyRelations.forEach(function(n){!1!==n.persistenceEnabled&&t.buildForSubjectRelation(e,n)})})},a.prototype.buildForAllRemoval=function(e){var n=this;e.databaseEntity&&e.metadata.manyToManyRelations.forEach(function(a){!1!==a.persistenceEnabled&&a.getEntityValue(e.databaseEntity).forEach(function(i){var u=new t.Subject({metadata:a.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:n.buildJunctionIdentifier(e,a,i)});n.subjects.push(u)})})},a.prototype.buildForSubjectRelation=function(e,a){var i=this,u=[];e.databaseEntity&&(u=a.getEntityValue(e.databaseEntity));var r=a.getEntityValue(e.entity);if(null===r&&(r=[]),r instanceof Array){r.forEach(function(r){var o=a.inverseEntityMetadata.getEntityIdMap(r),c=i.subjects.find(function(t){return t.entity===r});if((c&&(o=c.identifier),o||c)&&!u.find(function(t){return n.EntityMetadata.compareIds(t,o)})){var s=a.isOwning?e:c||r,d=a.isOwning?c||r:e,f=new t.Subject({metadata:a.junctionEntityMetadata,parentSubject:e,canBeInserted:!0});i.subjects.push(f),a.junctionEntityMetadata.ownerColumns.forEach(function(t){f.changeMaps.push({column:t,value:s})}),a.junctionEntityMetadata.inverseColumns.forEach(function(t){f.changeMaps.push({column:t,value:d})})}});var o=[];r.forEach(function(t){var e=a.inverseEntityMetadata.getEntityIdMap(t),n=i.subjects.find(function(e){return e.entity===t});n&&(e=n.identifier),null!=e&&o.push(e)}),u.filter(function(t){return!o.find(function(e){return n.EntityMetadata.compareIds(e,t)})}).forEach(function(n){var u=new t.Subject({metadata:a.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:i.buildJunctionIdentifier(e,a,n)});i.subjects.push(u)})}},a.prototype.buildJunctionIdentifier=function(t,n,a){var i=n.isOwning?t.entity:a,u=n.isOwning?a:t.entity,r={};return n.junctionEntityMetadata.ownerColumns.forEach(function(t){e.OrmUtils.mergeDeep(r,t.createValueMap(t.referencedColumn.getEntityValue(i)))}),n.junctionEntityMetadata.inverseColumns.forEach(function(t){e.OrmUtils.mergeDeep(r,t.createValueMap(t.referencedColumn.getEntityValue(u)))}),r},a}();exports.ManyToManySubjectBuilder=a;
},{"../Subject":"JBjA","../../util/OrmUtils":"R//v","../../metadata/EntityMetadata":"Raef"}],"GUG5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SubjectDatabaseEntityLoader=void 0;var t=e(require("tslib"));function e(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};a.get||a.set?Object.defineProperty(e,r,a):e[r]=t[r]}return e.default=t,e}var r=function(){function e(t,e){this.queryRunner=t,this.subjects=e}return e.prototype.load=function(e){return t.__awaiter(this,void 0,void 0,function(){var r,a=this;return t.__generator(this,function(n){switch(n.label){case 0:return r=this.groupByEntityTargets().map(function(r){return t.__awaiter(a,void 0,void 0,function(){var a,n,i,o,s,u,c,d,f=this;return t.__generator(this,function(y){switch(y.label){case 0:return i=[],o=[],r.subjects.forEach(function(t){!t.databaseEntity&&t.identifier&&(i.push(t.identifier),o.push(t))}),i.length?(s=[],"save"===e?r.subjects.forEach(function(t){t.metadata.relations.forEach(function(e){void 0!==e.getEntityValue(t.entityWithFulfilledIds)&&-1===s.indexOf(e.propertyPath)&&s.push(e.propertyPath)})}):s.push.apply(s,t.__spread(r.subjects[0].metadata.manyToManyRelations.map(function(t){return t.propertyPath}))),u={loadEagerRelations:!1,loadRelationIds:{relations:s,disableMixedMap:!0}},[4,this.queryRunner.manager.getRepository(r.target).findByIds(i,u)]):[2];case 1:y.sent().forEach(function(t){f.findByPersistEntityLike(r.target,t).forEach(function(e){e.databaseEntity=t,e.identifier||(e.identifier=e.metadata.hasAllPrimaryKeys(t)?e.metadata.getEntityIdMap(t):void 0)})});try{for(c=t.__values(o),d=c.next();!d.done;d=c.next())d.value.databaseEntityLoaded=!0}catch(l){a={error:l}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(a)throw a.error}}return[2]}})})}),[4,Promise.all(r)];case 1:return n.sent(),[2]}})})},e.prototype.findByPersistEntityLike=function(t,e){return this.subjects.filter(function(r){return!!r.entity&&(r.entity===e||r.metadata.target===t&&r.metadata.compareEntities(r.entityWithFulfilledIds,e))})},e.prototype.groupByEntityTargets=function(){return this.subjects.reduce(function(t,e){var r=t.find(function(t){return t.target===e.metadata.target});return r||(r={target:e.metadata.target,subjects:[]},t.push(r)),r.subjects.push(e),t},[])},e}();exports.SubjectDatabaseEntityLoader=r;
},{"tslib":"c4AP"}],"Nv+a":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CascadesSubjectBuilder=void 0;var e=a(require("tslib")),t=require("../Subject");function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}var r=function(){function a(e){this.allSubjects=e}return a.prototype.build=function(a){var r=this;a.metadata.extractRelationValuesFromEntity(a.entity,a.metadata.relations).forEach(function(i){var n=e.__read(i,3),s=n[0],c=n[1],d=n[2];if(null!=c&&(s.isCascadeInsert||s.isCascadeUpdate)&&c instanceof Object){var u=r.findByPersistEntityLike(d.target,c);if(u)return!1===u.canBeInserted&&(u.canBeInserted=!0===s.isCascadeInsert),void(!1===u.canBeUpdated&&(u.canBeUpdated=!0===s.isCascadeUpdate));var o=new t.Subject({metadata:d,parentSubject:a,entity:c,canBeInserted:!0===s.isCascadeInsert,canBeUpdated:!0===s.isCascadeUpdate});r.allSubjects.push(o),r.build(o)}})},a.prototype.findByPersistEntityLike=function(e,t){return this.allSubjects.find(function(a){return!!a.entity&&(a.entity===t||a.metadata.target===e&&a.metadata.compareEntities(a.entityWithFulfilledIds,t))})},a}();exports.CascadesSubjectBuilder=r;
},{"tslib":"c4AP","../Subject":"JBjA"}],"5i6a":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityPersistExecutor=void 0;var e=h(require("tslib")),t=require("../error/MustBeEntityError"),r=require("./SubjectExecutor"),n=require("../error/CannotDetermineEntityError"),i=require("./Subject"),s=require("./subject-builder/OneToManySubjectBuilder"),u=require("./subject-builder/OneToOneInverseSideSubjectBuilder"),o=require("./subject-builder/ManyToManySubjectBuilder"),a=require("./SubjectDatabaseEntityLoader"),c=require("./subject-builder/CascadesSubjectBuilder"),l=require("../util/OrmUtils"),d=require("../util/PromiseUtils");function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var b=function(){function h(e,t,r,n,i,s){this.connection=e,this.queryRunner=t,this.mode=r,this.target=n,this.entity=i,this.options=s}return h.prototype.execute=function(){var h=this;return this.entity&&this.entity instanceof Object?Promise.resolve().then(function(){return e.__awaiter(h,void 0,void 0,function(){var t,h,b,y,p,f,j,m=this;return e.__generator(this,function(v){switch(v.label){case 0:t=this.queryRunner||this.connection.createQueryRunner("master"),this.options&&this.options.data&&(t.data=this.options.data),v.label=1;case 1:return v.trys.push([1,,15,18]),h=this.entity instanceof Array?this.entity:[this.entity],b=this.options&&this.options.chunk&&this.options.chunk>0?l.OrmUtils.chunk(h,this.options.chunk):[h],[4,Promise.all(b.map(function(l){return e.__awaiter(m,void 0,void 0,function(){var d,h,b=this;return e.__generator(this,function(e){switch(e.label){case 0:return d=[],l.forEach(function(e){var t=b.target?b.target:e.constructor;if(t===Object)throw new n.CannotDetermineEntityError(b.mode);d.push(new i.Subject({metadata:b.connection.getMetadata(t),entity:e,canBeInserted:"save"===b.mode,canBeUpdated:"save"===b.mode,mustBeRemoved:"remove"===b.mode}))}),h=new c.CascadesSubjectBuilder(d),d.forEach(function(e){h.build(e)}),[4,new a.SubjectDatabaseEntityLoader(t,d).load(this.mode)];case 1:return e.sent(),"save"===this.mode?(new s.OneToManySubjectBuilder(d).build(),new u.OneToOneInverseSideSubjectBuilder(d).build(),new o.ManyToManySubjectBuilder(d).build()):d.forEach(function(e){e.mustBeRemoved&&new o.ManyToManySubjectBuilder(d).buildForAllRemoval(e)}),[2,new r.SubjectExecutor(t,d,this.options)]}})})}))];case 2:if(y=v.sent(),0===(p=y.filter(function(e){return e.hasExecutableOperations})).length)return[2];f=!1,v.label=3;case 3:return v.trys.push([3,9,,14]),t.isTransactionActive?[3,5]:this.options&&!1===this.options.transaction?[3,5]:(f=!0,[4,t.startTransaction()]);case 4:v.sent(),v.label=5;case 5:return[4,d.PromiseUtils.runInSequence(p,function(e){return e.execute()})];case 6:return v.sent(),!0!==f?[3,8]:[4,t.commitTransaction()];case 7:v.sent(),v.label=8;case 8:return[3,14];case 9:if(j=v.sent(),!f)return[3,13];v.label=10;case 10:return v.trys.push([10,12,,13]),[4,t.rollbackTransaction()];case 11:return v.sent(),[3,13];case 12:return v.sent(),[3,13];case 13:throw j;case 14:return[3,18];case 15:return this.queryRunner?[3,17]:[4,t.release()];case 16:v.sent(),v.label=17;case 17:return[7];case 18:return[2]}})})}):Promise.reject(new t.MustBeEntityError(this.mode,this.entity))},h}();exports.EntityPersistExecutor=b;
},{"tslib":"c4AP","../error/MustBeEntityError":"HMqo","./SubjectExecutor":"oKMZ","../error/CannotDetermineEntityError":"7UFp","./Subject":"JBjA","./subject-builder/OneToManySubjectBuilder":"syJv","./subject-builder/OneToOneInverseSideSubjectBuilder":"YNjO","./subject-builder/ManyToManySubjectBuilder":"QtJn","./SubjectDatabaseEntityLoader":"GUG5","./subject-builder/CascadesSubjectBuilder":"Nv+a","../util/OrmUtils":"R//v","../util/PromiseUtils":"DcM6"}],"oI6K":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityManager=void 0;var e=R(require("tslib")),t=require("../error/EntityNotFoundError"),r=require("../error/QueryRunnerProviderAlreadyReleasedError"),n=require("../error/NoNeedToReleaseEntityManagerError"),i=require("../repository/TreeRepository"),o=require("../repository/Repository"),a=require("../find-options/FindOptionsUtils"),s=require("../query-builder/transformer/PlainObjectToNewEntityTransformer"),u=require("../query-builder/transformer/PlainObjectToDatabaseEntityTransformer"),c=require("../error/CustomRepositoryNotFoundError"),d=require("../index"),p=require("../repository/AbstractRepository"),y=require("../error/CustomRepositoryCannotInheritRepositoryError"),l=require("../driver/mongodb/MongoDriver"),h=require("../error/RepositoryNotFoundError"),f=require("../error/RepositoryNotTreeError"),g=require("../repository/RepositoryFactory"),v=require("../error/TreeRepositoryNotSupportedError"),m=require("../persistence/EntityPersistExecutor"),w=require("../driver/oracle/OracleDriver"),O=require("../util/ObjectUtils");function R(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var _=function(){function R(e,t){this.repositories=[],this.plainObjectToEntityTransformer=new s.PlainObjectToNewEntityTransformer,this.connection=e,t&&(this.queryRunner=t,O.ObjectUtils.assign(this.queryRunner,{manager:this}))}return R.prototype.transaction=function(t,n){return e.__awaiter(this,void 0,void 0,function(){var i,o,a,s,u;return e.__generator(this,function(e){switch(e.label){case 0:if(i="string"==typeof t?t:void 0,!(o="function"==typeof t?t:n))throw new Error("Transaction method requires callback in second paramter if isolation level is supplied.");if(this.connection.driver instanceof l.MongoDriver)throw new Error("Transactions aren't supported by MongoDB.");if(this.queryRunner&&this.queryRunner.isReleased)throw new r.QueryRunnerProviderAlreadyReleasedError;if(this.queryRunner&&this.queryRunner.isTransactionActive)throw new Error("Cannot start transaction because its already started");a=this.queryRunner||this.connection.createQueryRunner("master"),e.label=1;case 1:return e.trys.push([1,8,13,16]),i?[4,a.startTransaction(i)]:[3,3];case 2:return e.sent(),[3,5];case 3:return[4,a.startTransaction()];case 4:e.sent(),e.label=5;case 5:return[4,o(a.manager)];case 6:return s=e.sent(),[4,a.commitTransaction()];case 7:return e.sent(),[2,s];case 8:u=e.sent(),e.label=9;case 9:return e.trys.push([9,11,,12]),[4,a.rollbackTransaction()];case 10:return e.sent(),[3,12];case 11:return e.sent(),[3,12];case 12:throw u;case 13:return this.queryRunner?[3,15]:[4,a.release()];case 14:e.sent(),e.label=15;case 15:return[7];case 16:return[2]}})})},R.prototype.query=function(t,r){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,this.connection.query(t,r,this.queryRunner)]})})},R.prototype.createQueryBuilder=function(e,t,r){return t?this.connection.createQueryBuilder(e,t,r||this.queryRunner):this.connection.createQueryBuilder(e||r||this.queryRunner)},R.prototype.hasId=function(e,t){var r=2===arguments.length?e:e.constructor,n=2===arguments.length?t:e;return this.connection.getMetadata(r).hasId(n)},R.prototype.getId=function(e,t){var r=2===arguments.length?e:e.constructor,n=2===arguments.length?t:e;return this.connection.getMetadata(r).getEntityIdMixedMap(n)},R.prototype.create=function(e,t){var r=this,n=this.connection.getMetadata(e);if(!t)return n.create(this.queryRunner);if(t instanceof Array)return t.map(function(t){return r.create(e,t)});var i=n.create(this.queryRunner);return this.plainObjectToEntityTransformer.transform(i,t,n,!0),i},R.prototype.merge=function(e,t){for(var r=this,n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=this.connection.getMetadata(e);return n.forEach(function(e){return r.plainObjectToEntityTransformer.transform(t,e,o)}),t},R.prototype.preload=function(t,r){return e.__awaiter(this,void 0,void 0,function(){var n,i;return e.__generator(this,function(e){switch(e.label){case 0:return n=this.connection.getMetadata(t),[4,new u.PlainObjectToDatabaseEntityTransformer(this.connection.manager).transform(r,n)];case 1:return(i=e.sent())?[2,this.merge(t,i,r)]:[2,void 0]}})})},R.prototype.save=function(e,t,r){var n=arguments.length>1&&(e instanceof Function||e instanceof d.EntitySchema||"string"==typeof e)?e:void 0,i=n?t:e,o=n?r:t;return n instanceof d.EntitySchema&&(n=n.options.name),i instanceof Array&&0===i.length?Promise.resolve(i):new m.EntityPersistExecutor(this.connection,this.queryRunner,"save",n,i,o).execute().then(function(){return i})},R.prototype.remove=function(e,t,r){var n=arguments.length>1&&(e instanceof Function||"string"==typeof e)?e:void 0,i=n?t:e,o=n?r:t;return i instanceof Array&&0===i.length?Promise.resolve(i):new m.EntityPersistExecutor(this.connection,this.queryRunner,"remove",n,i,o).execute().then(function(){return i})},R.prototype.insert=function(t,r){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.connection.driver instanceof w.OracleDriver&&r instanceof Array?[4,Promise.all(r.map(function(e){return n.insert(t,e)}))]:[3,2];case 1:return[2,e.sent().reduce(function(e,t){return Object.assign(e,t)},{})];case 2:return[2,this.createQueryBuilder().insert().into(t).values(r).execute()]}})})},R.prototype.update=function(e,t,r){return null==t||""===t||t instanceof Array&&0===t.length?Promise.reject(new Error("Empty criteria(s) are not allowed for the update method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||t instanceof Array?this.createQueryBuilder().update(e).set(r).whereInIds(t).execute():this.createQueryBuilder().update(e).set(r).where(t).execute()},R.prototype.delete=function(e,t){return null==t||""===t||t instanceof Array&&0===t.length?Promise.reject(new Error("Empty criteria(s) are not allowed for the delete method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||t instanceof Array?this.createQueryBuilder().delete().from(e).whereInIds(t).execute():this.createQueryBuilder().delete().from(e).where(t).execute()},R.prototype.count=function(t,r){return e.__awaiter(this,void 0,void 0,function(){var n,i;return e.__generator(this,function(e){return n=this.connection.getMetadata(t),i=this.createQueryBuilder(t,a.FindOptionsUtils.extractFindManyOptionsAlias(r)||n.name),[2,a.FindOptionsUtils.applyFindManyOptionsOrConditionsToQueryBuilder(i,r).getCount()]})})},R.prototype.find=function(t,r){return e.__awaiter(this,void 0,void 0,function(){var n,i;return e.__generator(this,function(e){return n=this.connection.getMetadata(t),i=this.createQueryBuilder(t,a.FindOptionsUtils.extractFindManyOptionsAlias(r)||n.name),a.FindOptionsUtils.isFindManyOptions(r)&&!1===r.loadEagerRelations||a.FindOptionsUtils.joinEagerRelations(i,i.alias,n),[2,a.FindOptionsUtils.applyFindManyOptionsOrConditionsToQueryBuilder(i,r).getMany()]})})},R.prototype.findAndCount=function(t,r){return e.__awaiter(this,void 0,void 0,function(){var n,i;return e.__generator(this,function(e){return n=this.connection.getMetadata(t),i=this.createQueryBuilder(t,a.FindOptionsUtils.extractFindManyOptionsAlias(r)||n.name),a.FindOptionsUtils.isFindManyOptions(r)&&!1===r.loadEagerRelations||a.FindOptionsUtils.joinEagerRelations(i,i.alias,n),[2,a.FindOptionsUtils.applyFindManyOptionsOrConditionsToQueryBuilder(i,r).getManyAndCount()]})})},R.prototype.findByIds=function(t,r,n){return e.__awaiter(this,void 0,void 0,function(){var i,o;return e.__generator(this,function(e){return r.length?(i=this.connection.getMetadata(t),o=this.createQueryBuilder(t,a.FindOptionsUtils.extractFindManyOptionsAlias(n)||i.name),a.FindOptionsUtils.applyFindManyOptionsOrConditionsToQueryBuilder(o,n),a.FindOptionsUtils.isFindManyOptions(n)&&!1===n.loadEagerRelations||a.FindOptionsUtils.joinEagerRelations(o,o.alias,i),[2,o.andWhereInIds(r).getMany()]):[2,Promise.resolve([])]})})},R.prototype.findOne=function(t,r,n){return e.__awaiter(this,void 0,void 0,function(){var i,o,s,u,c;return e.__generator(this,function(d){return i=void 0,a.FindOptionsUtils.isFindOneOptions(r)?i=r:n&&a.FindOptionsUtils.isFindOneOptions(n)&&(i=n),o=void 0,r instanceof Object&&!a.FindOptionsUtils.isFindOneOptions(r)&&(o=r),s=this.connection.getMetadata(t),u=s.name,i&&i.join?u=i.join.alias:n&&a.FindOptionsUtils.isFindOneOptions(n)&&n.join&&(u=n.join.alias),c=this.createQueryBuilder(t,u),i&&!1===i.loadEagerRelations||a.FindOptionsUtils.joinEagerRelations(c,c.alias,c.expressionMap.mainAlias.metadata),i=e.__assign({},i||{},{take:1}),a.FindOptionsUtils.applyOptionsToQueryBuilder(c,i),o?c.where(o):("string"==typeof r||"number"==typeof r||r instanceof Date)&&c.andWhereInIds(s.ensureEntityIdMap(r)),[2,c.getOne()]})})},R.prototype.findOneOrFail=function(r,n,i){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,this.findOne(r,n,i).then(function(e){return void 0===e?Promise.reject(new t.EntityNotFoundError(r,n)):Promise.resolve(e)})]})})},R.prototype.clear=function(t){return e.__awaiter(this,void 0,void 0,function(){var r,n;return e.__generator(this,function(e){switch(e.label){case 0:r=this.connection.getMetadata(t),n=this.queryRunner||this.connection.createQueryRunner("master"),e.label=1;case 1:return e.trys.push([1,,3,6]),[4,n.clearTable(r.tablePath)];case 2:return[2,e.sent()];case 3:return this.queryRunner?[3,5]:[4,n.release()];case 4:e.sent(),e.label=5;case 5:return[7];case 6:return[2]}})})},R.prototype.increment=function(t,r,n,i){return e.__awaiter(this,void 0,void 0,function(){var o,a,s,u=this;return e.__generator(this,function(e){if(o=this.connection.getMetadata(t),!(a=o.findColumnWithPropertyPath(n)))throw new Error("Column "+n+" was not found in "+o.targetName+" entity.");if(isNaN(Number(i)))throw new Error('Value "'+i+'" is not a number.');return s=n.split(".").reduceRight(function(e,t){var r;return(r={})[t]=e,r},function(){return u.connection.driver.escape(a.databaseName)+" + "+i}),[2,this.createQueryBuilder(t,"entity").update(t).set(s).where(r).execute()]})})},R.prototype.decrement=function(t,r,n,i){return e.__awaiter(this,void 0,void 0,function(){var o,a,s,u=this;return e.__generator(this,function(e){if(o=this.connection.getMetadata(t),!(a=o.findColumnWithPropertyPath(n)))throw new Error("Column "+n+" was not found in "+o.targetName+" entity.");if(isNaN(Number(i)))throw new Error('Value "'+i+'" is not a number.');return s=n.split(".").reduceRight(function(e,t){var r;return(r={})[t]=e,r},function(){return u.connection.driver.escape(a.databaseName)+" - "+i}),[2,this.createQueryBuilder(t,"entity").update(t).set(s).where(r).execute()]})})},R.prototype.getRepository=function(e){if(!this.connection.hasMetadata(e))throw new h.RepositoryNotFoundError(this.connection.name,e);var t=this.connection.getMetadata(e),r=this.repositories.find(function(e){return e.metadata===t});if(r)return r;var n=(new g.RepositoryFactory).create(this,t,this.queryRunner);return this.repositories.push(n),n},R.prototype.getTreeRepository=function(e){if(!1===this.connection.driver.treeSupport)throw new v.TreeRepositoryNotSupportedError(this.connection.driver);var t=this.getRepository(e);if(!(t instanceof i.TreeRepository))throw new f.RepositoryNotTreeError(e);return t},R.prototype.getMongoRepository=function(e){return this.connection.getMongoRepository(e)},R.prototype.getCustomRepository=function(e){var t=(0,d.getMetadataArgsStorage)().entityRepositories.find(function(t){return t.target===(e instanceof Function?e:e.constructor)});if(!t)throw new c.CustomRepositoryNotFoundError(e);var r=t.entity?this.connection.getMetadata(t.entity):void 0,n=new t.target(this,r);if(n instanceof p.AbstractRepository&&(n.manager||(n.manager=this)),n instanceof o.Repository){if(!r)throw new y.CustomRepositoryCannotInheritRepositoryError(e);n.manager=this,n.metadata=r}return n},R.prototype.release=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){if(!this.queryRunner)throw new n.NoNeedToReleaseEntityManagerError;return[2,this.queryRunner.release()]})})},R}();exports.EntityManager=_;
},{"tslib":"c4AP","../error/EntityNotFoundError":"SRxF","../error/QueryRunnerProviderAlreadyReleasedError":"sQhW","../error/NoNeedToReleaseEntityManagerError":"JlY9","../repository/TreeRepository":"Ayc+","../repository/Repository":"ZbgY","../find-options/FindOptionsUtils":"oXmh","../query-builder/transformer/PlainObjectToNewEntityTransformer":"vHgx","../query-builder/transformer/PlainObjectToDatabaseEntityTransformer":"vDKi","../error/CustomRepositoryNotFoundError":"Jczh","../index":"wlNf","../repository/AbstractRepository":"7cL5","../error/CustomRepositoryCannotInheritRepositoryError":"kYQb","../driver/mongodb/MongoDriver":"TOLf","../error/RepositoryNotFoundError":"H39D","../error/RepositoryNotTreeError":"/l60","../repository/RepositoryFactory":"1+Od","../error/TreeRepositoryNotSupportedError":"vqHB","../persistence/EntityPersistExecutor":"5i6a","../driver/oracle/OracleDriver":"l9nz","../util/ObjectUtils":"41H8"}],"Bmim":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SqljsEntityManager=void 0;var e=r(require("tslib")),t=require("./EntityManager");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var n=function(t){function r(e,r){var n=t.call(this,e,r)||this;return n.driver=e.driver,n}return e.__extends(r,t),r.prototype.loadDatabase=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.driver.load(t)];case 1:return e.sent(),[2]}})})},r.prototype.saveDatabase=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.driver.save(t)];case 1:return e.sent(),[2]}})})},r.prototype.exportDatabase=function(){return this.driver.export()},r}(t.EntityManager);exports.SqljsEntityManager=n;
},{"tslib":"c4AP","./EntityManager":"oI6K"}],"YWTi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindOperator=void 0;var e=function(){function e(e,t,r,a){void 0===r&&(r=!0),void 0===a&&(a=!1),this._type=e,this._value=t,this._useParameter=r,this._multipleParameters=a}return Object.defineProperty(e.prototype,"useParameter",{get:function(){return this._value instanceof e?this._value.useParameter:this._useParameter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multipleParameters",{get:function(){return this._value instanceof e?this._value.multipleParameters:this._multipleParameters},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value instanceof e?this._value.value:this._value},enumerable:!0,configurable:!0}),e.prototype.toSql=function(t,r,a){switch(this._type){case"not":return this._value instanceof e?"NOT("+this._value.toSql(t,r,a)+")":r+" != "+a[0];case"lessThan":return r+" < "+a[0];case"lessThanOrEqual":return r+" <= "+a[0];case"moreThan":return r+" > "+a[0];case"moreThanOrEqual":return r+" >= "+a[0];case"equal":return r+" = "+a[0];case"like":return r+" LIKE "+a[0];case"between":return r+" BETWEEN "+a[0]+" AND "+a[1];case"in":return r+" IN ("+a.join(", ")+")";case"any":return r+" = ANY("+a[0]+")";case"isNull":return r+" IS NULL";case"raw":return this.value instanceof Function?this.value(r):r+" = "+this.value}return""},e}();exports.FindOperator=e;
},{}],"bJDV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColumnMetadata=void 0;var e=o(require("tslib")),t=require("../util/OrmUtils"),i=require("../driver/mongodb/MongoDriver"),a=require("../util/PromiseUtils"),r=require("../find-options/FindOperator"),s=require("../util/ApplyValueTransformers");function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};a.get||a.set?Object.defineProperty(t,i,a):t[i]=e[i]}return t.default=e,t}var n=function(){function o(e){this.length="",this.isPrimary=!1,this.isGenerated=!1,this.isNullable=!1,this.isSelect=!0,this.isInsert=!0,this.isUpdate=!0,this.comment="",this.zerofill=!1,this.unsigned=!1,this.isArray=!1,this.isVirtual=!1,this.isDiscriminator=!1,this.isTreeLevel=!1,this.isCreateDate=!1,this.isUpdateDate=!1,this.isVersion=!1,this.isObjectId=!1,this.isNestedSetLeft=!1,this.isNestedSetRight=!1,this.isMaterializedPath=!1,this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,this.referencedColumn=e.referencedColumn,e.args.target&&(this.target=e.args.target),e.args.propertyName&&(this.propertyName=e.args.propertyName),e.args.options.name&&(this.givenDatabaseName=e.args.options.name),e.args.options.type&&(this.type=e.args.options.type),e.args.options.length&&(this.length=e.args.options.length?e.args.options.length.toString():""),e.args.options.width&&(this.width=e.args.options.width),e.args.options.charset&&(this.charset=e.args.options.charset),e.args.options.collation&&(this.collation=e.args.options.collation),e.args.options.primary&&(this.isPrimary=e.args.options.primary),null===e.args.options.default&&(this.isNullable=!0),void 0!==e.args.options.nullable&&(this.isNullable=e.args.options.nullable),void 0!==e.args.options.select&&(this.isSelect=e.args.options.select),void 0!==e.args.options.insert&&(this.isInsert=e.args.options.insert),void 0!==e.args.options.update&&(this.isUpdate=e.args.options.update),void 0!==e.args.options.readonly&&(this.isUpdate=!e.args.options.readonly),e.args.options.comment&&(this.comment=e.args.options.comment),void 0!==e.args.options.default&&(this.default=e.args.options.default),e.args.options.onUpdate&&(this.onUpdate=e.args.options.onUpdate),null!==e.args.options.scale&&void 0!==e.args.options.scale&&(this.scale=e.args.options.scale),e.args.options.zerofill&&(this.zerofill=e.args.options.zerofill,this.unsigned=!0),e.args.options.unsigned&&(this.unsigned=e.args.options.unsigned),void 0!==e.args.options.precision&&(this.precision=e.args.options.precision),e.args.options.enum&&(e.args.options.enum instanceof Object&&!Array.isArray(e.args.options.enum)?this.enum=Object.keys(e.args.options.enum).filter(function(e){return isNaN(+e)}).map(function(t){return e.args.options.enum[t]}):this.enum=e.args.options.enum),e.args.options.asExpression&&(this.asExpression=e.args.options.asExpression,this.generatedType=e.args.options.generatedType?e.args.options.generatedType:"VIRTUAL"),e.args.options.hstoreType&&(this.hstoreType=e.args.options.hstoreType),e.args.options.array&&(this.isArray=e.args.options.array),e.args.mode&&(this.isVirtual="virtual"===e.args.mode,this.isTreeLevel="treeLevel"===e.args.mode,this.isCreateDate="createDate"===e.args.mode,this.isUpdateDate="updateDate"===e.args.mode,this.isVersion="version"===e.args.mode,this.isObjectId="objectId"===e.args.mode),e.args.options.transformer&&(this.transformer=e.args.options.transformer),e.args.options.spatialFeatureType&&(this.spatialFeatureType=e.args.options.spatialFeatureType),e.args.options.srid&&(this.srid=e.args.options.srid),this.isTreeLevel&&(this.type=e.connection.driver.mappedDataTypes.treeLevel),this.isCreateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.createDate),this.default||(this.default=function(){return e.connection.driver.mappedDataTypes.createDateDefault}),void 0===this.precision&&e.connection.driver.mappedDataTypes.createDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.createDatePrecision)),this.isUpdateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.updateDate),this.default||(this.default=function(){return e.connection.driver.mappedDataTypes.updateDateDefault}),void 0===this.precision&&e.connection.driver.mappedDataTypes.updateDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.updateDatePrecision)),this.isVersion&&(this.type=e.connection.driver.mappedDataTypes.version),e.closureType&&(this.closureType=e.closureType),e.nestedSetLeft&&(this.isNestedSetLeft=e.nestedSetLeft),e.nestedSetRight&&(this.isNestedSetRight=e.nestedSetRight),e.materializedPath&&(this.isMaterializedPath=e.materializedPath)}return o.prototype.createValueMap=function(t,i){var a,r=this;if(void 0===i&&(i=!1),this.embeddedMetadata){var s=e.__spread(this.embeddedMetadata.parentPropertyNames),o=function(e,a){var s=e.shift();return s?(a[s]={},o(e,a[s]),a):("increment"!==r.generationStrategy&&"rowid"!==r.generationStrategy||"bigint"!==r.type||(t=String(t)),a[i?r.databaseName:r.propertyName]=t,a)};return o(s,{})}return"increment"!==this.generationStrategy&&"rowid"!==this.generationStrategy||"bigint"!==this.type||(t=String(t)),(a={})[i?this.databaseName:this.propertyName]=t,a},o.prototype.getEntityValueMap=function(i,a){var r,s,o=this;if(this.embeddedMetadata){var n=e.__spread(this.embeddedMetadata.parentPropertyNames),p=function(e,t,i){var a=e.shift();if(void 0===t)return i;if(a){var r={};return p(e,t[a],r),Object.keys(r).length>0&&(i[a]=r),i}return void 0!==t[o.propertyName]&&(i[o.propertyName]=t[o.propertyName]),i};return p(n,i,d={}),Object.keys(d).length>0?d:void 0}if(this.relationMetadata&&i[this.propertyName]&&i[this.propertyName]instanceof Object){var d=this.relationMetadata.joinColumns.reduce(function(e,a){var r=a.referencedColumn.getEntityValueMap(i[o.propertyName]);return void 0===r?e:t.OrmUtils.mergeDeep(e,r)},{});return Object.keys(d).length>0?((r={})[this.propertyName]=d,r):void 0}return void 0!==i[this.propertyName]?((s={})[this.propertyName]=i[this.propertyName],s):void 0},o.prototype.getEntityValue=function(t,i){if(void 0===i&&(i=!1),null!=t){var o=void 0;if(this.embeddedMetadata){var n=e.__spread(this.embeddedMetadata.parentPropertyNames),p=function(e,t){var i=e.shift();return i&&t?p(e,t[i]):t},d=p(n,t);if(d)if(this.relationMetadata&&this.referencedColumn)o=(h=this.relationMetadata.getEntityValue(d))&&h instanceof Object&&!(h instanceof r.FindOperator)?this.referencedColumn.getEntityValue(a.PromiseUtils.extractValue(h)):d[this.propertyName]&&d[this.propertyName]instanceof Object&&!(d[this.propertyName]instanceof r.FindOperator)?this.referencedColumn.getEntityValue(a.PromiseUtils.extractValue(d[this.propertyName])):a.PromiseUtils.extractValue(d[this.propertyName]);else o=this.referencedColumn?this.referencedColumn.getEntityValue(a.PromiseUtils.extractValue(d[this.propertyName])):a.PromiseUtils.extractValue(d[this.propertyName])}else{var h;if(this.relationMetadata&&this.referencedColumn)o=!((h=this.relationMetadata.getEntityValue(t))&&h instanceof Object)||h instanceof r.FindOperator||h instanceof Function?!(t[this.propertyName]&&t[this.propertyName]instanceof Object)||t[this.propertyName]instanceof r.FindOperator||t[this.propertyName]instanceof Function?t[this.propertyName]:this.referencedColumn.getEntityValue(a.PromiseUtils.extractValue(t[this.propertyName])):this.referencedColumn.getEntityValue(a.PromiseUtils.extractValue(h));else o=this.referencedColumn?this.referencedColumn.getEntityValue(a.PromiseUtils.extractValue(t[this.propertyName])):t[this.propertyName]}return i&&this.transformer&&(o=s.ApplyValueTransformers.transformTo(this.transformer,o)),o}},o.prototype.setEntityValue=function(t,i){var a=this;if(this.embeddedMetadata){var r=function(e,t){var s=e.shift();return s?(t[s.propertyName]||(t[s.propertyName]=s.create()),r(e,t[s.propertyName]),t):(t[a.propertyName]=i,t)};return r(e.__spread(this.embeddedMetadata.embeddedMetadataTree),t)}t[this.propertyName]=i},o.prototype.build=function(e){return this.propertyPath=this.buildPropertyPath(),this.propertyAliasName=this.propertyPath.replace(".","_"),this.databaseName=this.buildDatabaseName(e),this.databasePath=this.buildDatabasePath(),this.databaseNameWithoutPrefixes=e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,[]),this},o.prototype.buildPropertyPath=function(){var e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.propertyName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.propertyName!==this.propertyName&&(e+="."+this.referencedColumn.propertyName),e},o.prototype.buildDatabasePath=function(){var e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.databaseName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.databaseName!==this.databaseName&&(e+="."+this.referencedColumn.databaseName),e},o.prototype.buildDatabaseName=function(e){var t=this.embeddedMetadata?this.embeddedMetadata.parentPrefixes:[];return e.driver instanceof i.MongoDriver&&(t=[]),e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,t)},o}();exports.ColumnMetadata=n;
},{"tslib":"c4AP","../util/OrmUtils":"R//v","../driver/mongodb/MongoDriver":"TOLf","../util/PromiseUtils":"DcM6","../find-options/FindOperator":"YWTi","../util/ApplyValueTransformers":"p0mU"}],"EN8B":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractSqliteQueryRunner=void 0;var e=d(require("tslib")),n=require("../../error/TransactionAlreadyStartedError"),t=require("../../error/TransactionNotStartedError"),r=require("../../schema-builder/table/TableColumn"),i=require("../../metadata/ColumnMetadata"),a=require("../../schema-builder/table/Table"),o=require("../../schema-builder/table/TableIndex"),s=require("../../schema-builder/table/TableForeignKey"),u=require("../../schema-builder/view/View"),c=require("../Query"),l=require("../../schema-builder/table/TableUnique"),h=require("../../query-runner/BaseQueryRunner"),f=require("../../util/OrmUtils"),m=require("../../schema-builder/table/TableCheck");function d(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};r.get||r.set?Object.defineProperty(n,t,r):n[t]=e[t]}return n.default=e,n}var p=function(h){function d(){return h.call(this)||this}return e.__extends(d,h),d.prototype.connect=function(){return Promise.resolve(this.driver.databaseConnection)},d.prototype.release=function(){return this.loadedTables=[],this.clearSqlMemory(),Promise.resolve()},d.prototype.startTransaction=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:if(this.isTransactionActive)throw new n.TransactionAlreadyStartedError;if(this.isTransactionActive=!0,!t)return[3,4];if("READ UNCOMMITTED"!==t&&"SERIALIZABLE"!==t)throw new Error("SQLite only supports SERIALIZABLE and READ UNCOMMITTED isolation");return"READ UNCOMMITTED"!==t?[3,2]:[4,this.query("PRAGMA read_uncommitted = true")];case 1:return e.sent(),[3,4];case 2:return[4,this.query("PRAGMA read_uncommitted = false")];case 3:e.sent(),e.label=4;case 4:return[4,this.query("BEGIN TRANSACTION")];case 5:return e.sent(),[2]}})})},d.prototype.commitTransaction=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:if(!this.isTransactionActive)throw new t.TransactionNotStartedError;return[4,this.query("COMMIT")];case 1:return e.sent(),this.isTransactionActive=!1,[2]}})})},d.prototype.rollbackTransaction=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:if(!this.isTransactionActive)throw new t.TransactionNotStartedError;return[4,this.query("ROLLBACK")];case 1:return e.sent(),this.isTransactionActive=!1,[2]}})})},d.prototype.stream=function(e,n,t,r){throw new Error("Stream is not supported by sqlite driver.")},d.prototype.getDatabases=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve([])]})})},d.prototype.getSchemas=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve([])]})})},d.prototype.hasDatabase=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve(!1)]})})},d.prototype.hasSchema=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("This driver does not support table schemas")})})},d.prototype.hasTable=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r;return e.__generator(this,function(e){switch(e.label){case 0:return t=n instanceof a.Table?n.name:n,r='SELECT * FROM "sqlite_master" WHERE "type" = \'table\' AND "name" = \''+t+"'",[4,this.query(r)];case 1:return[2,!!e.sent().length]}})})},d.prototype.hasColumn=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i;return e.__generator(this,function(e){switch(e.label){case 0:return r=n instanceof a.Table?n.name:n,i='PRAGMA table_info("'+r+'")',[4,this.query(i)];case 1:return[2,!!e.sent().find(function(e){return e.name===t})]}})})},d.prototype.createDatabase=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve()]})})},d.prototype.dropDatabase=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve()]})})},d.prototype.createSchema=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve()]})})},d.prototype.dropSchema=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,Promise.resolve()]})})},d.prototype.createTable=function(n,t,r,i){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),e.__awaiter(this,void 0,void 0,function(){var a,o,s=this;return e.__generator(this,function(e){switch(e.label){case 0:return a=[],o=[],t?[4,this.hasTable(n)]:[3,2];case 1:if(e.sent())return[2,Promise.resolve()];e.label=2;case 2:return a.push(this.createTableSql(n,r)),o.push(this.dropTableSql(n)),i&&n.indices.forEach(function(e){e.name||(e.name=s.connection.namingStrategy.indexName(n.name,e.columnNames,e.where)),a.push(s.createIndexSql(n,e)),o.push(s.dropIndexSql(e))}),[4,this.executeQueries(a,o)];case 3:return e.sent(),[2]}})})},d.prototype.dropTable=function(n,t,r,i){return void 0===r&&(r=!0),void 0===i&&(i=!0),e.__awaiter(this,void 0,void 0,function(){var o,s,u,c,l,h=this;return e.__generator(this,function(e){switch(e.label){case 0:return t?[4,this.hasTable(n)]:[3,2];case 1:if(!e.sent())return[2,Promise.resolve()];e.label=2;case 2:return o=r,n instanceof a.Table?(u=n,[3,5]):[3,3];case 3:return[4,this.getCachedTable(n)];case 4:u=e.sent(),e.label=5;case 5:return s=u,c=[],l=[],i&&s.indices.forEach(function(e){c.push(h.dropIndexSql(e)),l.push(h.createIndexSql(s,e))}),c.push(this.dropTableSql(s,t)),l.push(this.createTableSql(s,o)),[4,this.executeQueries(c,l)];case 6:return e.sent(),[2]}})})},d.prototype.createView=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r;return e.__generator(this,function(e){switch(e.label){case 0:return r=[],(t=[]).push(this.createViewSql(n)),t.push(this.insertViewDefinitionSql(n)),r.push(this.dropViewSql(n)),r.push(this.deleteViewDefinitionSql(n)),[4,this.executeQueries(t,r)];case 1:return e.sent(),[2]}})})},d.prototype.dropView=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,a;return e.__generator(this,function(e){switch(e.label){case 0:return t=n instanceof u.View?n.name:n,[4,this.getCachedView(t)];case 1:return r=e.sent(),a=[],(i=[]).push(this.deleteViewDefinitionSql(r)),i.push(this.dropViewSql(r)),a.push(this.insertViewDefinitionSql(r)),a.push(this.createViewSql(r)),[4,this.executeQueries(i,a)];case 2:return e.sent(),[2]}})})},d.prototype.renameTable=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o,s,u,l=this;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return(o=(r=i).clone()).name=t,s=new c.Query('ALTER TABLE "'+r.name+'" RENAME TO "'+t+'"'),u=new c.Query('ALTER TABLE "'+t+'" RENAME TO "'+r.name+'"'),[4,this.executeQueries(s,u)];case 4:return e.sent(),r.name=o.name,o.uniques.forEach(function(e){e.name=l.connection.namingStrategy.uniqueConstraintName(o,e.columnNames)}),o.foreignKeys.forEach(function(e){e.name=l.connection.namingStrategy.foreignKeyName(o,e.columnNames)}),o.indices.forEach(function(e){e.name=l.connection.namingStrategy.indexName(o,e.columnNames,e.where)}),[4,this.recreateTable(o,r)];case 5:return e.sent(),[2]}})})},d.prototype.addColumn=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return r=i,[2,this.addColumns(r,[t])]}})})},d.prototype.addColumns=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return o=(r=i).clone(),t.forEach(function(e){return o.addColumn(e)}),[4,this.recreateTable(o,r)];case 4:return e.sent(),[2]}})})},d.prototype.renameColumn=function(n,t,i){return e.__awaiter(this,void 0,void 0,function(){var o,s,u,c;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(s=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:s=e.sent(),e.label=3;case 3:if(o=s,!(u=t instanceof r.TableColumn?t:o.columns.find(function(e){return e.name===t})))throw new Error('Column "'+t+'" was not found in the "'+o.name+'" table.');return c=void 0,i instanceof r.TableColumn?c=i:(c=u.clone()).name=i,[2,this.changeColumn(o,u,c)]}})})},d.prototype.changeColumn=function(n,t,i){return e.__awaiter(this,void 0,void 0,function(){var o,s,u;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(s=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:s=e.sent(),e.label=3;case 3:if(o=s,!(u=t instanceof r.TableColumn?t:o.columns.find(function(e){return e.name===t})))throw new Error('Column "'+t+'" was not found in the "'+o.name+'" table.');return[4,this.changeColumns(o,[{oldColumn:u,newColumn:i}])];case 4:return e.sent(),[2]}})})},d.prototype.changeColumns=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o,s=this;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return o=(r=i).clone(),t.forEach(function(e){e.newColumn.name!==e.oldColumn.name&&(o.findColumnUniques(e.oldColumn).forEach(function(n){n.columnNames.splice(n.columnNames.indexOf(e.oldColumn.name),1),n.columnNames.push(e.newColumn.name),n.name=s.connection.namingStrategy.uniqueConstraintName(o,n.columnNames)}),o.findColumnForeignKeys(e.oldColumn).forEach(function(n){n.columnNames.splice(n.columnNames.indexOf(e.oldColumn.name),1),n.columnNames.push(e.newColumn.name),n.name=s.connection.namingStrategy.foreignKeyName(o,n.columnNames)}),o.findColumnIndices(e.oldColumn).forEach(function(n){n.columnNames.splice(n.columnNames.indexOf(e.oldColumn.name),1),n.columnNames.push(e.newColumn.name),n.name=s.connection.namingStrategy.indexName(o,n.columnNames,n.where)}));var n=o.columns.find(function(n){return n.name===e.oldColumn.name});n&&(o.columns[o.columns.indexOf(n)]=e.newColumn)}),[4,this.recreateTable(o,r)];case 4:return e.sent(),[2]}})})},d.prototype.dropColumn=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var i,o,s;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(o=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:o=e.sent(),e.label=3;case 3:if(i=o,!(s=t instanceof r.TableColumn?t:i.findColumnByName(t)))throw new Error('Column "'+t+'" was not found in table "'+i.name+'"');return[4,this.dropColumns(i,[s])];case 4:return e.sent(),[2]}})})},d.prototype.dropColumns=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return o=(r=i).clone(),t.forEach(function(e){o.removeColumn(e),o.findColumnUniques(e).forEach(function(e){return o.removeUniqueConstraint(e)}),o.findColumnIndices(e).forEach(function(e){return o.removeIndex(e)}),o.findColumnForeignKeys(e).forEach(function(e){return o.removeForeignKey(e)})}),[4,this.recreateTable(o,r)];case 4:return e.sent(),t.forEach(function(e){r.removeColumn(e),r.findColumnUniques(e).forEach(function(e){return r.removeUniqueConstraint(e)}),r.findColumnIndices(e).forEach(function(e){return r.removeIndex(e)}),r.findColumnForeignKeys(e).forEach(function(e){return r.removeForeignKey(e)})}),[2]}})})},d.prototype.createPrimaryKey=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return(o=(r=i).clone()).columns.forEach(function(e){t.find(function(n){return n===e.name})&&(e.isPrimary=!0)}),[4,this.recreateTable(o,r)];case 4:return e.sent(),r.columns.forEach(function(e){t.find(function(n){return n===e.name})&&(e.isPrimary=!0)}),[2]}})})},d.prototype.updatePrimaryKeys=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,Promise.resolve()];case 1:return e.sent(),[2]}})})},d.prototype.dropPrimaryKey=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r,i;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(r=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:r=e.sent(),e.label=3;case 3:return(i=(t=r).clone()).primaryColumns.forEach(function(e){e.isPrimary=!1}),[4,this.recreateTable(i,t)];case 4:return e.sent(),t.primaryColumns.forEach(function(e){e.isPrimary=!1}),[2]}})})},d.prototype.createUniqueConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.createUniqueConstraints(n,[t])];case 1:return e.sent(),[2]}})})},d.prototype.createUniqueConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return o=(r=i).clone(),t.forEach(function(e){return o.addUniqueConstraint(e)}),[4,this.recreateTable(o,r)];case 4:return e.sent(),[2]}})})},d.prototype.dropUniqueConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:if(r=i,!(o=t instanceof l.TableUnique?t:r.uniques.find(function(e){return e.name===t})))throw new Error("Supplied unique constraint was not found in table "+r.name);return[4,this.dropUniqueConstraints(r,[o])];case 4:return e.sent(),[2]}})})},d.prototype.dropUniqueConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return o=(r=i).clone(),t.forEach(function(e){return o.removeUniqueConstraint(e)}),[4,this.recreateTable(o,r)];case 4:return e.sent(),[2]}})})},d.prototype.createCheckConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.createCheckConstraints(n,[t])];case 1:return e.sent(),[2]}})})},d.prototype.createCheckConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return o=(r=i).clone(),t.forEach(function(e){return o.addCheckConstraint(e)}),[4,this.recreateTable(o,r)];case 4:return e.sent(),[2]}})})},d.prototype.dropCheckConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:if(r=i,!(o=t instanceof m.TableCheck?t:r.checks.find(function(e){return e.name===t})))throw new Error("Supplied check constraint was not found in table "+r.name);return[4,this.dropCheckConstraints(r,[o])];case 4:return e.sent(),[2]}})})},d.prototype.dropCheckConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return o=(r=i).clone(),t.forEach(function(e){return o.removeCheckConstraint(e)}),[4,this.recreateTable(o,r)];case 4:return e.sent(),[2]}})})},d.prototype.createExclusionConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("Sqlite does not support exclusion constraints.")})})},d.prototype.createExclusionConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("Sqlite does not support exclusion constraints.")})})},d.prototype.dropExclusionConstraint=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("Sqlite does not support exclusion constraints.")})})},d.prototype.dropExclusionConstraints=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){throw new Error("Sqlite does not support exclusion constraints.")})})},d.prototype.createForeignKey=function(n,t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.createForeignKeys(n,[t])];case 1:return e.sent(),[2]}})})},d.prototype.createForeignKeys=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return o=(r=i).clone(),t.forEach(function(e){return o.addForeignKey(e)}),[4,this.recreateTable(o,r)];case 4:return e.sent(),[2]}})})},d.prototype.dropForeignKey=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:if(r=i,!(o=t instanceof s.TableForeignKey?t:r.foreignKeys.find(function(e){return e.name===t})))throw new Error("Supplied foreign key was not found in table "+r.name);return[4,this.dropForeignKeys(n,[o])];case 4:return e.sent(),[2]}})})},d.prototype.dropForeignKeys=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return o=(r=i).clone(),t.forEach(function(e){return o.removeForeignKey(e)}),[4,this.recreateTable(o,r)];case 4:return e.sent(),[2]}})})},d.prototype.createIndex=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,o,s;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:return r=i,t.name||(t.name=this.connection.namingStrategy.indexName(r.name,t.columnNames,t.where)),o=this.createIndexSql(r,t),s=this.dropIndexSql(t),[4,this.executeQueries(o,s)];case 4:return e.sent(),r.addIndex(t),[2]}})})},d.prototype.createIndices=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.createIndex(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},d.prototype.dropIndex=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i,s,u,c;return e.__generator(this,function(e){switch(e.label){case 0:return n instanceof a.Table?(i=n,[3,3]):[3,1];case 1:return[4,this.getCachedTable(n)];case 2:i=e.sent(),e.label=3;case 3:if(r=i,!(s=t instanceof o.TableIndex?t:r.indices.find(function(e){return e.name===t})))throw new Error("Supplied index was not found in table "+r.name);return u=this.dropIndexSql(s),c=this.createIndexSql(r,s),[4,this.executeQueries(u,c)];case 4:return e.sent(),r.removeIndex(s),[2]}})})},d.prototype.dropIndices=function(n,t){return e.__awaiter(this,void 0,void 0,function(){var r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=t.map(function(e){return i.dropIndex(n,e)}),[4,Promise.all(r)];case 1:return e.sent(),[2]}})})},d.prototype.clearTable=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.query('DELETE FROM "'+n+'"')];case 1:return e.sent(),[2]}})})},d.prototype.clearDatabase=function(){return e.__awaiter(this,void 0,void 0,function(){var n,t,r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.query("PRAGMA foreign_keys = OFF;")];case 1:return e.sent(),[4,this.startTransaction()];case 2:e.sent(),e.label=3;case 3:return e.trys.push([3,9,14,16]),"SELECT 'DROP VIEW \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'view'",[4,this.query("SELECT 'DROP VIEW \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'view'")];case 4:return n=e.sent(),[4,Promise.all(n.map(function(e){return i.query(e.query)}))];case 5:return e.sent(),"SELECT 'DROP TABLE \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'table' AND \"name\" != 'sqlite_sequence'",[4,this.query("SELECT 'DROP TABLE \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'table' AND \"name\" != 'sqlite_sequence'")];case 6:return t=e.sent(),[4,Promise.all(t.map(function(e){return i.query(e.query)}))];case 7:return e.sent(),[4,this.commitTransaction()];case 8:return e.sent(),[3,16];case 9:r=e.sent(),e.label=10;case 10:return e.trys.push([10,12,,13]),[4,this.rollbackTransaction()];case 11:return e.sent(),[3,13];case 12:return e.sent(),[3,13];case 13:throw r;case 14:return[4,this.query("PRAGMA foreign_keys = ON;")];case 15:return e.sent(),[7];case 16:return[2]}})})},d.prototype.loadViews=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,r;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.hasTable(this.getTypeormMetadataTableName())];case 1:return e.sent()?(t=n.map(function(e){return"'"+e+"'"}).join(", "),r='SELECT "t".* FROM "'+this.getTypeormMetadataTableName()+'" "t" INNER JOIN "sqlite_master" s ON "s"."name" = "t"."name" AND "s"."type" = \'view\' WHERE "t"."type" = \'VIEW\'',t.length>0&&(r+=' AND "t"."name" IN ('+t+")"),[4,this.query(r)]):[2,Promise.resolve([])];case 2:return[2,e.sent().map(function(e){var n=new u.View;return n.name=e.name,n.expression=e.value,n})]}})})},d.prototype.loadTables=function(n){return e.__awaiter(this,void 0,void 0,function(){var t,i,u,c=this;return e.__generator(this,function(h){switch(h.label){case 0:return n&&n.length?(t=n.map(function(e){return"'"+e+"'"}).join(", "),[4,this.query('SELECT * FROM "sqlite_master" WHERE "type" = \'table\' AND "name" IN ('+t+")")]):[2,[]];case 1:return i=h.sent(),[4,this.query('SELECT * FROM "sqlite_master" WHERE "type" = \'index\' AND "tbl_name" IN ('+t+")")];case 2:return u=h.sent(),i&&i.length?[2,Promise.all(i.map(function(n){return e.__awaiter(c,void 0,void 0,function(){var t,i,c,h,d,p,_,b,v,y,w,T,g,E,C,q,N,S,I=this;return e.__generator(this,function(A){switch(A.label){case 0:return t=new a.Table({name:n.name}),i=n.sql,[4,Promise.all([this.query('PRAGMA table_info("'+n.name+'")'),this.query('PRAGMA index_list("'+n.name+'")'),this.query('PRAGMA foreign_key_list("'+n.name+'")')])];case 1:return c=e.__read.apply(void 0,[A.sent(),3]),h=c[0],d=c[1],p=c[2],_=void 0,b=n.sql,-1!==(v=b.toUpperCase().indexOf("AUTOINCREMENT"))&&(_=b.substr(0,v),y=_.lastIndexOf(","),w=_.lastIndexOf("("),-1!==y?_=(_=(_=_.substr(y)).substr(0,_.lastIndexOf('"'))).substr(_.indexOf('"')+1):-1!==w&&(_=(_=(_=_.substr(w)).substr(0,_.lastIndexOf('"'))).substr(_.indexOf('"')+1))),t.columns=h.map(function(e){var n=new r.TableColumn;if(n.name=e.name,n.type=e.type.toLowerCase(),n.default=null!==e.dflt_value&&void 0!==e.dflt_value?e.dflt_value:void 0,n.isNullable=0===e.notnull,n.isPrimary=e.pk>0,n.comment="",n.isGenerated=_===e.name,n.isGenerated&&(n.generationStrategy="increment"),"varchar"===n.type){var t=i.match(new RegExp('"('+n.name+")\" varchar CHECK\\s*\\(\\s*\\1\\s+IN\\s*\\(('[^']+'(?:\\s*,\\s*'[^']+')+)\\s*\\)\\s*\\)"));t&&(n.type="simple-enum",n.enum=t[2].substr(1,t[2].length-2).split("','"))}var a=n.type.indexOf("(");if(-1!==a){var o=n.type.substr(0,a);if(I.driver.withLengthColumnTypes.find(function(e){return e===o})){var s=parseInt(n.type.substring(a+1,n.type.length-1));s&&(n.length=s.toString(),n.type=o)}}return n}),T=f.OrmUtils.uniq(p,function(e){return e.id}),t.foreignKeys=T.map(function(e){var n=p.filter(function(n){return n.id===e.id&&n.table===e.table}),r=n.map(function(e){return e.from}),i=n.map(function(e){return e.to}),a=I.connection.namingStrategy.foreignKeyName(t,r);return new s.TableForeignKey({name:a,columnNames:r,referencedTableName:e.table,referencedColumnNames:i,onDelete:e.on_delete,onUpdate:e.on_update})}),g=d.filter(function(e){return"u"===e.origin}).map(function(e){return e.name}).filter(function(e,n,t){return t.indexOf(e)===n}).map(function(n){return e.__awaiter(I,void 0,void 0,function(){var r,i,a,o;return e.__generator(this,function(e){switch(e.label){case 0:return r=d.find(function(e){return e.name===n}),[4,this.query('PRAGMA index_info("'+r.name+'")')];case 1:return i=e.sent(),1===(a=i.sort(function(e,n){return parseInt(e.seqno)-parseInt(n.seqno)}).map(function(e){return e.name})).length&&(o=t.columns.find(function(e){return!!a.find(function(n){return n===e.name})}))&&(o.isUnique=!0),[2,new l.TableUnique({name:this.connection.namingStrategy.uniqueConstraintName(t,a),columnNames:a})]}})})}),E=t,[4,Promise.all(g)];case 2:for(E.uniques=A.sent(),q=/CONSTRAINT "([^"]*)" CHECK (\(.*?\))([,]|[)]$)/g;null!==(C=q.exec(i));)t.checks.push(new m.TableCheck({name:C[1],expression:C[2]}));return N=d.filter(function(e){return"c"===e.origin}).map(function(e){return e.name}).filter(function(e,n,t){return t.indexOf(e)===n}).map(function(n){return e.__awaiter(I,void 0,void 0,function(){var r,i,a,s,c,l;return e.__generator(this,function(e){switch(e.label){case 0:return r=u.find(function(e){return e.name===n}),i=/WHERE (.*)/.exec(r.sql),a=d.find(function(e){return e.name===n}),[4,this.query('PRAGMA index_info("'+a.name+'")')];case 1:return s=e.sent(),c=s.sort(function(e,n){return parseInt(e.seqno)-parseInt(n.seqno)}).map(function(e){return e.name}),l="1"===a.unique||1===a.unique,[2,new o.TableIndex({table:t,name:a.name,columnNames:c,isUnique:l,where:i?i[1]:void 0})]}})})}),[4,Promise.all(N)];case 3:return S=A.sent(),t.indices=S.filter(function(e){return!!e}),[2,t]}})})}))]:[2,[]]}})})},d.prototype.createTableSql=function(e,n){var t=this,r=e.columns.filter(function(e){return e.isPrimary}),i=r.find(function(e){return e.isGenerated&&"increment"===e.generationStrategy}),a=r.length>1;if(a&&i)throw new Error("Sqlite does not support AUTOINCREMENT on composite primary key");var o=e.columns.map(function(e){return t.buildCreateColumnSql(e,a)}).join(", "),s='CREATE TABLE "'+e.name+'" ('+o;(e.columns.filter(function(e){return e.isUnique}).forEach(function(n){e.uniques.some(function(e){return 1===e.columnNames.length&&e.columnNames[0]===n.name})||e.uniques.push(new l.TableUnique({name:t.connection.namingStrategy.uniqueConstraintName(e.name,[n.name]),columnNames:[n.name]}))}),e.uniques.length>0)&&(s+=", "+e.uniques.map(function(n){return'CONSTRAINT "'+(n.name?n.name:t.connection.namingStrategy.uniqueConstraintName(e.name,n.columnNames))+'" UNIQUE ('+n.columnNames.map(function(e){return'"'+e+'"'}).join(", ")+")"}).join(", "));e.checks.length>0&&(s+=", "+e.checks.map(function(n){return'CONSTRAINT "'+(n.name?n.name:t.connection.namingStrategy.checkConstraintName(e.name,n.expression))+'" CHECK ('+n.expression+")"}).join(", "));e.foreignKeys.length>0&&n&&(s+=", "+e.foreignKeys.map(function(n){var r=n.columnNames.map(function(e){return'"'+e+'"'}).join(", ");n.name||(n.name=t.connection.namingStrategy.foreignKeyName(e.name,n.columnNames));var i=n.referencedColumnNames.map(function(e){return'"'+e+'"'}).join(", "),a='CONSTRAINT "'+n.name+'" FOREIGN KEY ('+r+') REFERENCES "'+n.referencedTableName+'" ('+i+")";return n.onDelete&&(a+=" ON DELETE "+n.onDelete),n.onUpdate&&(a+=" ON UPDATE "+n.onUpdate),a}).join(", "));r.length>1&&(s+=", PRIMARY KEY ("+r.map(function(e){return'"'+e.name+'"'}).join(", ")+")");return s+=")",new c.Query(s)},d.prototype.dropTableSql=function(e,n){var t=e instanceof a.Table?e.name:e,r=n?'DROP TABLE IF EXISTS "'+t+'"':'DROP TABLE "'+t+'"';return new c.Query(r)},d.prototype.createViewSql=function(e){return"string"==typeof e.expression?new c.Query('CREATE VIEW "'+e.name+'" AS '+e.expression):new c.Query('CREATE VIEW "'+e.name+'" AS '+e.expression(this.connection).getQuery())},d.prototype.insertViewDefinitionSql=function(n){var t="string"==typeof n.expression?n.expression.trim():n.expression(this.connection).getQuery(),r=e.__read(this.connection.createQueryBuilder().insert().into(this.getTypeormMetadataTableName()).values({type:"VIEW",name:n.name,value:t}).getQueryAndParameters(),2),i=r[0],a=r[1];return new c.Query(i,a)},d.prototype.dropViewSql=function(e){var n=e instanceof u.View?e.name:e;return new c.Query('DROP VIEW "'+n+'"')},d.prototype.deleteViewDefinitionSql=function(n){var t=n instanceof u.View?n.name:n,r=this.connection.createQueryBuilder(),i=e.__read(r.delete().from(this.getTypeormMetadataTableName()).where(r.escape("type")+" = 'VIEW'").andWhere(r.escape("name")+" = :name",{name:t}).getQueryAndParameters(),2),a=i[0],o=i[1];return new c.Query(a,o)},d.prototype.createIndexSql=function(e,n){var t=n.columnNames.map(function(e){return'"'+e+'"'}).join(", ");return new c.Query("CREATE "+(n.isUnique?"UNIQUE ":"")+'INDEX "'+n.name+'" ON "'+e.name+'" ('+t+") "+(n.where?"WHERE "+n.where:""))},d.prototype.dropIndexSql=function(e){var n=e instanceof o.TableIndex?e.name:e;return new c.Query('DROP INDEX "'+n+'"')},d.prototype.buildCreateColumnSql=function(e,n){var t='"'+e.name+'"';return e instanceof i.ColumnMetadata?t+=" "+this.driver.normalizeType(e):t+=" "+this.connection.driver.createFullType(e),e.enum&&(t+=" CHECK( "+e.name+" IN ("+e.enum.map(function(e){return"'"+e+"'"}).join(",")+") )"),e.isPrimary&&!n&&(t+=" PRIMARY KEY"),!0===e.isGenerated&&"increment"===e.generationStrategy&&(t+=" AUTOINCREMENT"),e.collation&&(t+=" COLLATE "+e.collation),!0!==e.isNullable&&(t+=" NOT NULL"),void 0!==e.default&&null!==e.default&&(t+=" DEFAULT ("+e.default+")"),t},d.prototype.recreateTable=function(n,t,r){return void 0===r&&(r=!0),e.__awaiter(this,void 0,void 0,function(){var i,a,o,s,u=this;return e.__generator(this,function(e){switch(e.label){case 0:return i=[],a=[],t.indices.forEach(function(e){i.push(u.dropIndexSql(e)),a.push(u.createIndexSql(t,e))}),n.name="temporary_"+n.name,i.push(this.createTableSql(n,!0)),a.push(this.dropTableSql(n)),r&&(o=n.columns.map(function(e){return'"'+e.name+'"'}).join(", "),s=t.columns.map(function(e){return'"'+e.name+'"'}).join(", "),t.columns.length<n.columns.length?o=n.columns.filter(function(e){return t.columns.find(function(n){return n.name===e.name})}).map(function(e){return'"'+e.name+'"'}).join(", "):t.columns.length>n.columns.length&&(s=t.columns.filter(function(e){return n.columns.find(function(n){return n.name===e.name})}).map(function(e){return'"'+e.name+'"'}).join(", ")),i.push(new c.Query('INSERT INTO "'+n.name+'"('+o+") SELECT "+s+' FROM "'+t.name+'"')),a.push(new c.Query('INSERT INTO "'+t.name+'"('+s+") SELECT "+o+' FROM "'+n.name+'"'))),i.push(this.dropTableSql(t)),a.push(this.createTableSql(t,!0)),i.push(new c.Query('ALTER TABLE "'+n.name+'" RENAME TO "'+t.name+'"')),a.push(new c.Query('ALTER TABLE "'+t.name+'" RENAME TO "'+n.name+'"')),n.name=t.name,n.indices.forEach(function(e){e.name||(e.name=u.connection.namingStrategy.indexName(n.name,e.columnNames,e.where)),i.push(u.createIndexSql(n,e)),a.push(u.dropIndexSql(e))}),[4,this.executeQueries(i,a)];case 1:return e.sent(),this.replaceCachedTable(t,n),[2]}})})},d}(h.BaseQueryRunner);exports.AbstractSqliteQueryRunner=p;
},{"tslib":"c4AP","../../error/TransactionAlreadyStartedError":"kZCV","../../error/TransactionNotStartedError":"nZEx","../../schema-builder/table/TableColumn":"SdPr","../../metadata/ColumnMetadata":"bJDV","../../schema-builder/table/Table":"e+Cn","../../schema-builder/table/TableIndex":"S7W/","../../schema-builder/table/TableForeignKey":"0LZF","../../schema-builder/view/View":"fSdu","../Query":"CMcp","../../schema-builder/table/TableUnique":"9Ztg","../../query-runner/BaseQueryRunner":"GBOk","../../util/OrmUtils":"R//v","../../schema-builder/table/TableCheck":"oxtv"}],"HUxk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SqljsQueryRunner=void 0;var e=o(require("tslib")),r=require("../../error/QueryRunnerAlreadyReleasedError"),t=require("../sqlite-abstract/AbstractSqliteQueryRunner"),n=require("../../subscriber/Broadcaster"),i=require("../../error/QueryFailedError");function o(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var s=function(t){function o(e){var r=t.call(this)||this;return r.driver=e,r.connection=e.connection,r.broadcaster=new n.Broadcaster(r),r}return e.__extends(o,t),o.prototype.commitTransaction=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,t.prototype.commitTransaction.call(this)];case 1:return e.sent(),[4,this.driver.autoSave()];case 2:return e.sent(),[2]}})})},o.prototype.query=function(t,n){var o=this;if(this.isReleased)throw new r.QueryRunnerAlreadyReleasedError;return new Promise(function(r,s){return e.__awaiter(o,void 0,void 0,function(){var o,u,a,c,l,d,y;return e.__generator(this,function(e){o=this.driver.databaseConnection,this.driver.connection.logger.logQuery(t,n,this),u=+new Date;try{for((a=o.prepare(t)).bind(n),c=this.driver.connection.options.maxQueryExecutionTime,l=+new Date,d=l-u,c&&d>c&&this.driver.connection.logger.logQuerySlow(d,t,n,this),y=[];a.step();)y.push(a.getAsObject());a.free(),r(y)}catch(p){a&&a.free(),this.driver.connection.logger.logQueryError(p,t,n,this),s(new i.QueryFailedError(t,n,p))}return[2]})})})},o}(t.AbstractSqliteQueryRunner);exports.SqljsQueryRunner=s;
},{"tslib":"c4AP","../../error/QueryRunnerAlreadyReleasedError":"CGt0","../sqlite-abstract/AbstractSqliteQueryRunner":"EN8B","../../subscriber/Broadcaster":"wiLV","../../error/QueryFailedError":"U3oI"}],"dW+p":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DriverOptionNotSetError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(e){var o=r.call(this)||this;return o.name="DriverOptionNotSetError",Object.setPrototypeOf(o,t.prototype),o.message="Driver option ("+e+") is not set. Please set it to perform connection to the database.",o}return e.__extends(t,r),t}(Error);exports.DriverOptionNotSetError=t;
},{"tslib":"c4AP"}],"qCTI":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports.SqljsDriver=void 0;var t=c(require("tslib")),r=require("../sqlite-abstract/AbstractSqliteDriver"),o=require("./SqljsQueryRunner"),n=require("../../error/DriverPackageNotInstalledError"),a=require("../../error/DriverOptionNotSetError"),i=require("../../platform/PlatformTools"),s=require("../../util/OrmUtils");function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}var l=function(r){function c(e){var t=r.call(this,e)||this;if(t.options.autoSave&&!t.options.location&&!t.options.autoSaveCallback)throw new a.DriverOptionNotSetError("location or autoSaveCallback");return t.loadDependencies(),t}return t.__extends(c,r),c.prototype.connect=function(){return t.__awaiter(this,void 0,void 0,function(){var e;return t.__generator(this,function(t){switch(t.label){case 0:return e=this,[4,this.createDatabaseConnection()];case 1:return e.databaseConnection=t.sent(),[2]}})})},c.prototype.disconnect=function(){return t.__awaiter(this,void 0,void 0,function(){var e=this;return t.__generator(this,function(t){return[2,new Promise(function(t,r){try{e.queryRunner=void 0,e.databaseConnection.close(),t()}catch(o){r(o)}})]})})},c.prototype.createQueryRunner=function(e){return void 0===e&&(e="master"),this.queryRunner||(this.queryRunner=new o.SqljsQueryRunner(this)),this.queryRunner},c.prototype.load=function(e,r){return void 0===r&&(r=!0),t.__awaiter(this,void 0,void 0,function(){var o,n;return t.__generator(this,function(t){switch(t.label){case 0:if("string"!=typeof e)return[3,8];if("node"!==i.PlatformTools.type)return[3,1];if(i.PlatformTools.fileExist(e))return o=i.PlatformTools.readFileSync(e),[2,this.createDatabaseConnectionWithImport(o)];if(r)throw new Error("File "+e+" does not exist");return[2,this.createDatabaseConnectionWithImport()];case 1:return n=null,this.options.useLocalForage?window.localforage?[4,window.localforage.getItem(e)]:[3,3]:[3,5];case 2:return n=t.sent(),[3,4];case 3:throw new Error("localforage is not defined - please import localforage.js into your site");case 4:return[3,6];case 5:n=i.PlatformTools.getGlobalVariable().localStorage.getItem(e),t.label=6;case 6:if(null!=n)return[2,this.createDatabaseConnectionWithImport(JSON.parse(n))];if(r)throw new Error("File "+e+" does not exist");return[2,this.createDatabaseConnectionWithImport()];case 7:return[3,9];case 8:return[2,this.createDatabaseConnectionWithImport(e)];case 9:return[2]}})})},c.prototype.save=function(r){return t.__awaiter(this,void 0,void 0,function(){var o,n,a,s,c;return t.__generator(this,function(t){switch(t.label){case 0:if(!r&&!this.options.location)throw new Error("No location is set, specify a location parameter or add the location option to your configuration");if(o="",r?o=r:this.options.location&&(o=this.options.location),"node"!==i.PlatformTools.type)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),n=new e(this.databaseConnection.export()),[4,i.PlatformTools.writeFile(o,n)];case 2:return t.sent(),[3,4];case 3:throw a=t.sent(),new Error("Could not save database, error: "+a);case 4:return[3,10];case 5:return s=this.databaseConnection.export(),c=[].slice.call(s),this.options.useLocalForage?window.localforage?[4,window.localforage.setItem(o,JSON.stringify(c))]:[3,7]:[3,9];case 6:return t.sent(),[3,8];case 7:throw new Error("localforage is not defined - please import localforage.js into your site");case 8:return[3,10];case 9:i.PlatformTools.getGlobalVariable().localStorage.setItem(o,JSON.stringify(c)),t.label=10;case 10:return[2]}})})},c.prototype.autoSave=function(){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(e){switch(e.label){case 0:return this.options.autoSave?this.options.autoSaveCallback?[4,this.options.autoSaveCallback(this.export())]:[3,2]:[3,4];case 1:return e.sent(),[3,4];case 2:return[4,this.save()];case 3:e.sent(),e.label=4;case 4:return[2]}})})},c.prototype.export=function(){return this.databaseConnection.export()},c.prototype.createGeneratedMap=function(e,t){var r=this,o=e.generatedColumns.reduce(function(e,t){if(t.isPrimary&&"increment"===t.generationStrategy){var o="SELECT last_insert_rowid()";try{var n=r.databaseConnection.exec(o);return r.connection.logger.logQuery(o),s.OrmUtils.mergeDeep(e,t.createValueMap(n[0].values[0][0]))}catch(a){r.connection.logger.logQueryError(a,o,[])}}return e},{});return Object.keys(o).length>0?o:void 0},c.prototype.createDatabaseConnection=function(){return this.options.location?this.load(this.options.location,!1):this.createDatabaseConnectionWithImport(this.options.database)},c.prototype.createDatabaseConnectionWithImport=function(e){return t.__awaiter(this,void 0,void 0,function(){var r,o,n=this;return t.__generator(this,function(t){switch(t.label){case 0:return"function"==typeof this.sqlite.Database?(o=this.sqlite,[3,3]):[3,1];case 1:return[4,this.sqlite()];case 2:o=t.sent(),t.label=3;case 3:return r=o,e&&e.length>0?this.databaseConnection=new r.Database(e):this.databaseConnection=new r.Database,[2,new Promise(function(e,t){try{n.databaseConnection.exec("PRAGMA foreign_keys = ON;"),e(n.databaseConnection)}catch(r){t(r)}})]}})})},c.prototype.loadDependencies=function(){if("browser"===i.PlatformTools.type)this.sqlite=window.SQL;else try{this.sqlite=i.PlatformTools.load("sql.js")}catch(e){throw new n.DriverPackageNotInstalledError("sql.js","sql.js")}},c}(r.AbstractSqliteDriver);exports.SqljsDriver=l;
},{"tslib":"c4AP","../sqlite-abstract/AbstractSqliteDriver":"1srY","./SqljsQueryRunner":"HUxk","../../error/DriverPackageNotInstalledError":"NaUg","../../error/DriverOptionNotSetError":"dW+p","../../platform/PlatformTools":"YF44","../../util/OrmUtils":"R//v","buffer":"iHVs"}],"cdud":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityManagerFactory=void 0;var r=require("./EntityManager"),e=require("./MongoEntityManager"),n=require("../driver/mongodb/MongoDriver"),t=require("./SqljsEntityManager"),i=require("../driver/sqljs/SqljsDriver"),o=function(){function o(){}return o.prototype.create=function(o,a){return o.driver instanceof n.MongoDriver?new e.MongoEntityManager(o):o.driver instanceof i.SqljsDriver?new t.SqljsEntityManager(o,a):new r.EntityManager(o,a)},o}();exports.EntityManagerFactory=o;
},{"./EntityManager":"oI6K","./MongoEntityManager":"TOLf","../driver/mongodb/MongoDriver":"TOLf","./SqljsEntityManager":"Bmim","../driver/sqljs/SqljsDriver":"qCTI"}],"KQ8P":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MissingDriverError=void 0;var r=e(require("tslib"));function e(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,t):{};o.get||o.set?Object.defineProperty(e,t,o):e[t]=r[t]}return e.default=r,e}var t=function(e){function t(r){var o=e.call(this)||this;return o.name="MissingDriverError",Object.setPrototypeOf(o,t.prototype),o.message='Wrong driver: "'+r+'" given. Supported drivers are: "cordova", "expo", "mariadb", "mongodb", "mssql", "mysql", "oracle", "postgres", "sqlite", "sqljs", "react-native".',o}return r.__extends(t,e),t}(Error);exports.MissingDriverError=t;
},{"tslib":"c4AP"}],"nKQP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SqliteQueryRunner=void 0;var r=o(require("tslib")),e=require("../../error/QueryRunnerAlreadyReleasedError"),t=require("../../error/QueryFailedError"),n=require("../sqlite-abstract/AbstractSqliteQueryRunner"),i=require("../../subscriber/Broadcaster");function o(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,t):{};n.get||n.set?Object.defineProperty(e,t,n):e[t]=r[t]}return e.default=r,e}var u=function(n){function o(r){var e=n.call(this)||this;return e.driver=r,e.connection=r.connection,e.broadcaster=new i.Broadcaster(e),e}return r.__extends(o,n),o.prototype.query=function(n,i){var o=this;if(this.isReleased)throw new e.QueryRunnerAlreadyReleasedError;var u=this.driver.connection;return new Promise(function(e,s){return r.__awaiter(o,void 0,void 0,function(){var o,a,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return o=function(r,o){var a=u.options.maxQueryExecutionTime,d=+new Date-c;a&&d>a&&u.logger.logQuerySlow(d,n,i,this),r?(u.logger.logQueryError(r,n,i,this),s(new t.QueryFailedError(n,i,r))):e(l?this.lastID:o)},[4,this.connect()];case 1:return a=r.sent(),this.driver.connection.logger.logQuery(n,i,this),c=+new Date,(l="INSERT INTO"===n.substr(0,11))?a.run(n,i,o):a.all(n,i,o),[2]}})})})},o}(n.AbstractSqliteQueryRunner);exports.SqliteQueryRunner=u;
},{"tslib":"c4AP","../../error/QueryRunnerAlreadyReleasedError":"CGt0","../../error/QueryFailedError":"U3oI","../sqlite-abstract/AbstractSqliteQueryRunner":"EN8B","../../subscriber/Broadcaster":"wiLV"}],"2OT/":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports.SqliteDriver=void 0;var r=s(require("tslib")),t=require("../../error/DriverPackageNotInstalledError"),n=require("./SqliteQueryRunner"),o=require("../../error/DriverOptionNotSetError"),i=require("../../platform/PlatformTools"),a=require("../sqlite-abstract/AbstractSqliteDriver");function s(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var u=function(a){function s(e){var r=a.call(this,e)||this;if(r.connection=e,r.options=e.options,r.database=r.options.database,!r.options.database)throw new o.DriverOptionNotSetError("database");return r.loadDependencies(),r}return r.__extends(s,a),s.prototype.disconnect=function(){return r.__awaiter(this,void 0,void 0,function(){var e=this;return r.__generator(this,function(r){return[2,new Promise(function(r,t){e.queryRunner=void 0,e.databaseConnection.close(function(e){return e?t(e):r()})})]})})},s.prototype.createQueryRunner=function(e){return void 0===e&&(e="master"),this.queryRunner||(this.queryRunner=new n.SqliteQueryRunner(this)),this.queryRunner},s.prototype.normalizeType=function(r){return r.type===e?"blob":a.prototype.normalizeType.call(this,r)},s.prototype.createDatabaseConnection=function(){return r.__awaiter(this,void 0,void 0,function(){function e(e){return new Promise(function(r,n){t.run(e,function(e){if(e)return n(e);r()})})}var t,n=this;return r.__generator(this,function(r){switch(r.label){case 0:return[4,this.createDatabaseDirectory(this.options.database)];case 1:return r.sent(),[4,new Promise(function(e,r){var t=new n.sqlite.Database(n.options.database,function(n){if(n)return r(n);e(t)})})];case 2:return t=r.sent(),[4,e("PRAGMA foreign_keys = ON;")];case 3:return r.sent(),this.options.key?[4,e("PRAGMA key = "+JSON.stringify(this.options.key)+";")]:[3,5];case 4:r.sent(),r.label=5;case 5:return[2,t]}})})},s.prototype.loadDependencies=function(){try{this.sqlite=i.PlatformTools.load("sqlite3").verbose()}catch(e){throw new t.DriverPackageNotInstalledError("SQLite","sqlite3")}},s.prototype.createDatabaseDirectory=function(e){return new Promise(function(r,t){i.PlatformTools.load("mkdirp")(i.PlatformTools.load("path").dirname(e),function(e){return e?t(e):r()})})},s}(a.AbstractSqliteDriver);exports.SqliteDriver=u;
},{"tslib":"c4AP","../../error/DriverPackageNotInstalledError":"NaUg","./SqliteQueryRunner":"nKQP","../../error/DriverOptionNotSetError":"dW+p","../../platform/PlatformTools":"YF44","../sqlite-abstract/AbstractSqliteDriver":"1srY","buffer":"iHVs"}],"0kK6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CordovaQueryRunner=void 0;var e=i(require("tslib")),r=require("../../error/QueryRunnerAlreadyReleasedError"),t=require("../../error/QueryFailedError"),n=require("../sqlite-abstract/AbstractSqliteQueryRunner"),o=require("../../subscriber/Broadcaster");function i(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var u=function(n){function i(e){var r=n.call(this)||this;return r.driver=e,r.connection=e.connection,r.broadcaster=new o.Broadcaster(r),r}return e.__extends(i,n),i.prototype.query=function(n,o){var i=this;if(this.isReleased)throw new r.QueryRunnerAlreadyReleasedError;return new Promise(function(r,u){return e.__awaiter(i,void 0,void 0,function(){var i,c,s=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.connect()];case 1:return i=e.sent(),this.driver.connection.logger.logQuery(n,o,this),c=+new Date,i.executeSql(n,o,function(e){var t=s.driver.connection.options.maxQueryExecutionTime,i=+new Date-c;if(t&&i>t&&s.driver.connection.logger.logQuerySlow(i,n,o,s),"INSERT INTO"===n.substr(0,11))r(e.insertId);else{for(var u=[],a=0;a<e.rows.length;a++)u.push(e.rows.item(a));r(u)}},function(e){s.driver.connection.logger.logQueryError(e,n,o,s),u(new t.QueryFailedError(n,o,e))}),[2]}})})})},i.prototype.parametrize=function(e,r){return void 0===r&&(r=0),Object.keys(e).map(function(e,r){return'"'+e+'"=?'})},i}(n.AbstractSqliteQueryRunner);exports.CordovaQueryRunner=u;
},{"tslib":"c4AP","../../error/QueryRunnerAlreadyReleasedError":"CGt0","../../error/QueryFailedError":"U3oI","../sqlite-abstract/AbstractSqliteQueryRunner":"EN8B","../../subscriber/Broadcaster":"wiLV"}],"Srag":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CordovaDriver=void 0;var e=i(require("tslib")),r=require("../sqlite-abstract/AbstractSqliteDriver"),t=require("./CordovaQueryRunner"),o=require("../../error/DriverOptionNotSetError"),n=require("../../error/DriverPackageNotInstalledError");function i(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var a=function(r){function i(e){var t=r.call(this,e)||this;if(t.database=t.options.database,!t.options.database)throw new o.DriverOptionNotSetError("database");if(!t.options.location)throw new o.DriverOptionNotSetError("location");return t.loadDependencies(),t}return e.__extends(i,r),i.prototype.disconnect=function(){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){return[2,new Promise(function(e,t){r.queryRunner=void 0,r.databaseConnection.close(e,t)})]})})},i.prototype.createQueryRunner=function(e){return void 0===e&&(e="master"),this.queryRunner||(this.queryRunner=new t.CordovaQueryRunner(this)),this.queryRunner},i.prototype.createDatabaseConnection=function(){var e=this;return new Promise(function(r,t){var o=Object.assign({},{name:e.options.database,location:e.options.location},e.options.extra||{});e.sqlite.openDatabase(o,function(e){var o=e;o.executeSql("PRAGMA foreign_keys = ON;",[],function(e){r(o)},function(e){t(e)})},function(e){t(e)})})},i.prototype.loadDependencies=function(){try{this.sqlite=window.sqlitePlugin}catch(e){throw new n.DriverPackageNotInstalledError("Cordova-SQLite","cordova-sqlite-storage")}},i}(r.AbstractSqliteDriver);exports.CordovaDriver=a;
},{"tslib":"c4AP","../sqlite-abstract/AbstractSqliteDriver":"1srY","./CordovaQueryRunner":"0kK6","../../error/DriverOptionNotSetError":"dW+p","../../error/DriverPackageNotInstalledError":"NaUg"}],"+G/2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReactNativeQueryRunner=void 0;var e=i(require("tslib")),r=require("../../error/QueryRunnerAlreadyReleasedError"),t=require("../../error/QueryFailedError"),n=require("../sqlite-abstract/AbstractSqliteQueryRunner"),o=require("../../subscriber/Broadcaster");function i(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var u=function(n){function i(e){var r=n.call(this)||this;return r.driver=e,r.connection=e.connection,r.broadcaster=new o.Broadcaster(r),r}return e.__extends(i,n),i.prototype.query=function(n,o){var i=this;if(this.isReleased)throw new r.QueryRunnerAlreadyReleasedError;return new Promise(function(r,u){return e.__awaiter(i,void 0,void 0,function(){var i,c,s=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.connect()];case 1:return i=e.sent(),this.driver.connection.logger.logQuery(n,o,this),c=+new Date,i.executeSql(n,o,function(e){var t=s.driver.connection.options.maxQueryExecutionTime,i=+new Date-c;if(t&&i>t&&s.driver.connection.logger.logQuerySlow(i,n,o,s),"INSERT INTO"===n.substr(0,11))r(e.insertId);else{for(var u=[],a=0;a<e.rows.length;a++)u.push(e.rows.item(a));r(u)}},function(e){s.driver.connection.logger.logQueryError(e,n,o,s),u(new t.QueryFailedError(n,o,e))}),[2]}})})})},i.prototype.parametrize=function(e,r){return void 0===r&&(r=0),Object.keys(e).map(function(e,r){return'"'+e+'"=?'})},i}(n.AbstractSqliteQueryRunner);exports.ReactNativeQueryRunner=u;
},{"tslib":"c4AP","../../error/QueryRunnerAlreadyReleasedError":"CGt0","../../error/QueryFailedError":"U3oI","../sqlite-abstract/AbstractSqliteQueryRunner":"EN8B","../../subscriber/Broadcaster":"wiLV"}],"dN2P":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReactNativeDriver=void 0;var e=i(require("tslib")),t=require("../sqlite-abstract/AbstractSqliteDriver"),r=require("./ReactNativeQueryRunner"),n=require("../../error/DriverOptionNotSetError"),o=require("../../error/DriverPackageNotInstalledError");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var a=function(t){function i(e){var r=t.call(this,e)||this;if(r.database=r.options.database,!r.options.database)throw new n.DriverOptionNotSetError("database");if(!r.options.location)throw new n.DriverOptionNotSetError("location");return r.loadDependencies(),r}return e.__extends(i,t),i.prototype.disconnect=function(){return e.__awaiter(this,void 0,void 0,function(){var t=this;return e.__generator(this,function(e){return[2,new Promise(function(e,r){t.queryRunner=void 0,t.databaseConnection.close(e,r)})]})})},i.prototype.createQueryRunner=function(e){return void 0===e&&(e="master"),this.queryRunner||(this.queryRunner=new r.ReactNativeQueryRunner(this)),this.queryRunner},i.prototype.createDatabaseConnection=function(){var e=this;return new Promise(function(t,r){var n=Object.assign({},{name:e.options.database,location:e.options.location},e.options.extra||{});e.sqlite.openDatabase(n,function(e){var n=e;n.executeSql("PRAGMA foreign_keys = ON;",[],function(e){t(n)},function(e){r(e)})},function(e){r(e)})})},i.prototype.loadDependencies=function(){try{this.sqlite=require("react-native-sqlite-storage")}catch(e){throw new o.DriverPackageNotInstalledError("React-Native","react-native-sqlite-storage")}},i}(t.AbstractSqliteDriver);exports.ReactNativeDriver=a;
},{"tslib":"c4AP","../sqlite-abstract/AbstractSqliteDriver":"1srY","./ReactNativeQueryRunner":"+G/2","../../error/DriverOptionNotSetError":"dW+p","../../error/DriverPackageNotInstalledError":"NaUg"}],"jp3L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NativescriptQueryRunner=void 0;var e=i(require("tslib")),r=require("../../error/QueryRunnerAlreadyReleasedError"),t=require("../../error/QueryFailedError"),n=require("../sqlite-abstract/AbstractSqliteQueryRunner"),o=require("../../subscriber/Broadcaster");function i(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var u=function(n){function i(e){var r=n.call(this)||this;return r.driver=e,r.connection=e.connection,r.broadcaster=new o.Broadcaster(r),r}return e.__extends(i,n),i.prototype.query=function(e,n){var o=this;if(this.isReleased)throw new r.QueryRunnerAlreadyReleasedError;var i=this.driver.connection;return new Promise(function(r,u){var a="INSERT INTO"===e.substr(0,11),c=function(o,a){var c=i.options.maxQueryExecutionTime,l=+new Date-s;c&&l>c&&i.logger.logQuerySlow(l,e,n,this),o?(i.logger.logQueryError(o,e,n,this),u(new t.QueryFailedError(e,n,o))):r(a)};o.driver.connection.logger.logQuery(e,n,o);var s=+new Date;o.connect().then(function(r){a?r.execSQL(e,n,c):r.all(e,n,c)})})},i.prototype.parametrize=function(e,r){return void 0===r&&(r=0),Object.keys(e).map(function(e,r){return'"'+e+'"=?'})},i}(n.AbstractSqliteQueryRunner);exports.NativescriptQueryRunner=u;
},{"tslib":"c4AP","../../error/QueryRunnerAlreadyReleasedError":"CGt0","../../error/QueryFailedError":"U3oI","../sqlite-abstract/AbstractSqliteQueryRunner":"EN8B","../../subscriber/Broadcaster":"wiLV"}],"Nzbc":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports.NativescriptDriver=void 0;var r=a(require("tslib")),t=require("../sqlite-abstract/AbstractSqliteDriver"),i=require("./NativescriptQueryRunner"),n=require("../../error/DriverOptionNotSetError"),o=require("../../error/DriverPackageNotInstalledError");function a(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};i.get||i.set?Object.defineProperty(r,t,i):r[t]=e[t]}return r.default=e,r}var s=function(t){function a(e){var r=t.call(this,e)||this;if(r.connection=e,r.options=e.options,r.database=r.options.database,r.driver=r.options.driver,!r.options.database)throw new n.DriverOptionNotSetError("database");return r.loadDependencies(),r}return r.__extends(a,t),a.prototype.disconnect=function(){return r.__awaiter(this,void 0,void 0,function(){var e=this;return r.__generator(this,function(r){return[2,new Promise(function(r,t){e.queryRunner=void 0,e.databaseConnection.close().then(r).catch(t)})]})})},a.prototype.createQueryRunner=function(e){return void 0===e&&(e="master"),this.queryRunner||(this.queryRunner=new i.NativescriptQueryRunner(this)),this.queryRunner},a.prototype.normalizeType=function(r){return r.type===e?"blob":t.prototype.normalizeType.call(this,r)},a.prototype.createDatabaseConnection=function(){var e=this;return new Promise(function(r,t){var i=Object.assign({},{name:e.options.database},e.options.extra||{});new e.sqlite(i.name,function(i,n){if(i)return t(i);n.resultType(e.sqlite.RESULTSASOBJECT),n.execSQL("PRAGMA foreign_keys = ON;",[],function(e,i){if(e)return t(e);r(n)})})})},a.prototype.loadDependencies=function(){if(this.sqlite=this.driver,!this.driver)throw new o.DriverPackageNotInstalledError("Nativescript","nativescript-sqlite")},a}(t.AbstractSqliteDriver);exports.NativescriptDriver=s;
},{"tslib":"c4AP","../sqlite-abstract/AbstractSqliteDriver":"1srY","./NativescriptQueryRunner":"jp3L","../../error/DriverOptionNotSetError":"dW+p","../../error/DriverPackageNotInstalledError":"NaUg","buffer":"iHVs"}],"Hl6Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExpoQueryRunner=void 0;var r=s(require("tslib")),t=require("../../error/QueryRunnerAlreadyReleasedError"),e=require("../../error/QueryFailedError"),n=require("../sqlite-abstract/AbstractSqliteQueryRunner"),i=require("../../error/TransactionAlreadyStartedError"),o=require("../../error/TransactionNotStartedError"),a=require("../../subscriber/Broadcaster");function s(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)if(Object.prototype.hasOwnProperty.call(r,e)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,e):{};n.get||n.set?Object.defineProperty(t,e,n):t[e]=r[e]}return t.default=r,t}var c=function(n){function s(r){var t=n.call(this)||this;return t.driver=r,t.connection=r.connection,t.broadcaster=new a.Broadcaster(t),t}return r.__extends(s,n),s.prototype.startTransaction=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){if(this.isTransactionActive&&void 0!==this.transaction)throw new i.TransactionAlreadyStartedError;return this.isTransactionActive=!0,[2]})})},s.prototype.commitTransaction=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){if(!this.isTransactionActive&&void 0===this.transaction)throw new o.TransactionNotStartedError;return this.isTransactionActive=!1,this.transaction=void 0,[2]})})},s.prototype.rollbackTransaction=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){if(!this.isTransactionActive&&void 0===this.transaction)throw new o.TransactionNotStartedError;return this.isTransactionActive=!1,this.transaction=void 0,[2]})})},s.prototype.query=function(n,i){var o=this;if(this.isReleased)throw new t.QueryRunnerAlreadyReleasedError;return new Promise(function(t,a){return r.__awaiter(o,void 0,void 0,function(){var o,s,c=this;return r.__generator(this,function(r){switch(r.label){case 0:return[4,this.connect()];case 1:return o=r.sent(),this.driver.connection.logger.logQuery(n,i,this),s=+new Date,o.transaction(function(r){void 0===c.transaction&&(c.startTransaction(),c.transaction=r),c.transaction.executeSql(n,i,function(r,e){var o=c.driver.connection.options.maxQueryExecutionTime,a=+new Date-s;if(o&&a>o&&c.driver.connection.logger.logQuerySlow(a,n,i,c),"INSERT INTO"===n.substr(0,11))t(e.insertId);else{for(var u=[],d=0;d<e.rows.length;d++)u.push(e.rows.item(d));t(u)}},function(r,t){c.driver.connection.logger.logQueryError(t,n,i,c),a(new e.QueryFailedError(n,i,t))})},function(r){c.rollbackTransaction()},function(){c.isTransactionActive=!1,c.transaction=void 0}),[2]}})})})},s}(n.AbstractSqliteQueryRunner);exports.ExpoQueryRunner=c;
},{"tslib":"c4AP","../../error/QueryRunnerAlreadyReleasedError":"CGt0","../../error/QueryFailedError":"U3oI","../sqlite-abstract/AbstractSqliteQueryRunner":"EN8B","../../error/TransactionAlreadyStartedError":"kZCV","../../error/TransactionNotStartedError":"nZEx","../../subscriber/Broadcaster":"wiLV"}],"kRJp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExpoDriver=void 0;var e=i(require("tslib")),r=require("../sqlite-abstract/AbstractSqliteDriver"),t=require("./ExpoQueryRunner"),n=require("../../error/DriverOptionNotSetError"),o=require("../../error/DriverPackageNotInstalledError");function i(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var a=function(r){function i(e){var t=r.call(this,e)||this;if(t.database=t.options.database,!t.options.database)throw new n.DriverOptionNotSetError("database");return t.loadDependencies(),t}return e.__extends(i,r),i.prototype.disconnect=function(){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(e){return[2,new Promise(function(e,t){try{r.queryRunner=void 0,r.databaseConnection=void 0,e()}catch(n){t(n)}})]})})},i.prototype.createQueryRunner=function(e){return void 0===e&&(e="master"),this.queryRunner||(this.queryRunner=new t.ExpoQueryRunner(this)),this.queryRunner},i.prototype.createDatabaseConnection=function(){var e=this;return new Promise(function(r,t){try{var n=e.sqlite.openDatabase(e.options.database);n.transaction(function(e){e.executeSql("PRAGMA foreign_keys = ON;",[],function(e,t){r(n)},function(e,r){t({transaction:e,error:r})})},function(e){t(e)})}catch(o){t(o)}})},i.prototype.loadDependencies=function(){try{this.sqlite=window.Expo.SQLite}catch(e){throw new o.DriverPackageNotInstalledError("Expo","expo")}},i}(r.AbstractSqliteDriver);exports.ExpoDriver=a;
},{"tslib":"c4AP","../sqlite-abstract/AbstractSqliteDriver":"1srY","./ExpoQueryRunner":"Hl6Z","../../error/DriverOptionNotSetError":"dW+p","../../error/DriverPackageNotInstalledError":"NaUg"}],"9r33":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DriverFactory=void 0;var r=require("../error/MissingDriverError"),e=require("./cockroachdb/CockroachDriver"),i=require("./mongodb/MongoDriver"),t=require("./sqlserver/SqlServerDriver"),s=require("./oracle/OracleDriver"),o=require("./sqlite/SqliteDriver"),v=require("./cordova/CordovaDriver"),a=require("./react-native/ReactNativeDriver"),c=require("./nativescript/NativescriptDriver"),n=require("./sqljs/SqljsDriver"),u=require("./mysql/MysqlDriver"),q=require("./postgres/PostgresDriver"),D=require("./expo/ExpoDriver"),l=function(){function l(){}return l.prototype.create=function(l){var p=l.options.type;switch(p){case"mysql":return new u.MysqlDriver(l);case"postgres":return new q.PostgresDriver(l);case"cockroachdb":return new e.CockroachDriver(l);case"mariadb":return new u.MysqlDriver(l);case"sqlite":return new o.SqliteDriver(l);case"cordova":return new v.CordovaDriver(l);case"nativescript":return new c.NativescriptDriver(l);case"react-native":return new a.ReactNativeDriver(l);case"sqljs":return new n.SqljsDriver(l);case"oracle":return new s.OracleDriver(l);case"mssql":return new t.SqlServerDriver(l);case"mongodb":return new i.MongoDriver(l);case"expo":return new D.ExpoDriver(l);default:throw new r.MissingDriverError(p)}},l}();exports.DriverFactory=l;
},{"../error/MissingDriverError":"KQ8P","./cockroachdb/CockroachDriver":"mleT","./mongodb/MongoDriver":"TOLf","./sqlserver/SqlServerDriver":"sMRg","./oracle/OracleDriver":"l9nz","./sqlite/SqliteDriver":"2OT/","./cordova/CordovaDriver":"Srag","./react-native/ReactNativeDriver":"dN2P","./nativescript/NativescriptDriver":"Nzbc","./sqljs/SqljsDriver":"qCTI","./mysql/MysqlDriver":"TOLf","./postgres/PostgresDriver":"TOLf","./expo/ExpoDriver":"kRJp"}],"AMB6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.importClassesFromDirectories=r,exports.importJsonsFromDirectories=e;var o=require("../platform/PlatformTools"),t=require("../index");function r(r,e){return void 0===e&&(e=[".js",".ts"]),function o(r,e){return"function"==typeof r||r instanceof t.EntitySchema?e.push(r):Array.isArray(r)?r.forEach(function(t){return o(t,e)}):"object"==typeof r&&null!==r&&Object.keys(r).forEach(function(t){return o(r[t],e)}),e}(r.reduce(function(t,r){return t.concat(o.PlatformTools.load("glob").sync(o.PlatformTools.pathNormalize(r)))},[]).filter(function(t){var r=t.substring(t.length-5,t.length);return-1!==e.indexOf(o.PlatformTools.pathExtname(t))&&".d.ts"!==r}).map(function(t){return o.PlatformTools.load(o.PlatformTools.pathResolve(t))}),[])}function e(t,r){return void 0===r&&(r=".json"),t.reduce(function(t,r){return t.concat(o.PlatformTools.load("glob").sync(o.PlatformTools.pathNormalize(r)))},[]).filter(function(t){return o.PlatformTools.pathExtname(t)===r}).map(function(t){return o.PlatformTools.load(o.PlatformTools.pathResolve(t))})}
},{"../platform/PlatformTools":"YF44","../index":"wlNf"}],"0ey2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.useContainer=r,exports.getFromContainer=i;var t,e,n=new(function(){function t(){this.instances=[]}return t.prototype.get=function(t){var e=this.instances.find(function(e){return e.type===t});return e||(e={type:t,object:new t},this.instances.push(e)),e.object},t}());function r(n,r){t=n,e=r}function i(r){if(t)try{var i=t.get(r);if(i)return i;if(!e||!e.fallback)return i}catch(o){if(!e||!e.fallbackOnErrors)throw o}return n.get(r)}
},{}],"/SWG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IndexMetadata=void 0;var t=function(){function t(t){this.isUnique=!1,this.isSpatial=!1,this.isFulltext=!1,this.synchronize=!0,this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=t.entityMetadata,this.embeddedMetadata=t.embeddedMetadata,t.columns&&(this.columns=t.columns),t.args&&(this.target=t.args.target,null!==t.args.synchronize&&void 0!==t.args.synchronize&&(this.synchronize=t.args.synchronize),this.isUnique=!!t.args.unique,this.isSpatial=!!t.args.spatial,this.isFulltext=!!t.args.fulltext,this.where=t.args.where,this.isSparse=t.args.sparse,this.isBackground=t.args.background,this.expireAfterSeconds=t.args.expireAfterSeconds,this.givenName=t.args.name,this.givenColumnNames=t.args.columns)}return t.prototype.build=function(t){var e=this;if(!1===this.synchronize)return this.name=this.givenName,this;var n={};if(this.givenColumnNames){var a=[];if(this.givenColumnNames instanceof Array)(a=this.givenColumnNames.map(function(t){return e.embeddedMetadata?e.embeddedMetadata.propertyPath+"."+t:t})).forEach(function(t){return n[t]=1});else{var i=this.givenColumnNames(this.entityMetadata.propertiesMap);i instanceof Array?(a=i.map(function(t){return String(t)})).forEach(function(t){return n[t]=1}):(a=Object.keys(i).map(function(t){return String(t)}),Object.keys(i).forEach(function(t){return n[t]=i[t]}))}this.columns=a.map(function(t){var n=e.entityMetadata.columns.find(function(e){return e.propertyPath===t});if(n)return[n];var a=e.entityMetadata.relations.find(function(e){return e.isWithJoinColumn&&e.propertyName===t});if(a)return a.joinColumns;var i=e.givenName?'"'+e.givenName+'" ':"",r=e.entityMetadata.targetName;throw new Error("Index "+i+"contains column that is missing in the entity ("+r+"): "+t)}).reduce(function(t,e){return t.concat(e)})}return this.columnNamesWithOrderingMap=Object.keys(n).reduce(function(t,a){var i=e.entityMetadata.columns.find(function(t){return t.propertyPath===a});return i&&(t[i.databasePath]=n[a]),t},{}),this.name=this.givenName?this.givenName:t.indexName(this.entityMetadata.tablePath,this.columns.map(function(t){return t.databaseName}),this.where),this},t}();exports.IndexMetadata=t;
},{}],"NlpZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationMetadata=void 0;var e=i(require("tslib")),t=require("./EntityMetadata");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};n.get||n.set?Object.defineProperty(t,i,n):t[i]=e[i]}return t.default=e,t}var n=function(){function i(e){this.isTreeParent=!1,this.isTreeChildren=!1,this.isPrimary=!1,this.isLazy=!1,this.isEager=!1,this.persistenceEnabled=!0,this.isCascadeInsert=!1,this.isCascadeUpdate=!1,this.isCascadeRemove=!1,this.isNullable=!0,this.isOwning=!1,this.isOneToOne=!1,this.isOneToOneOwner=!1,this.isWithJoinColumn=!1,this.isOneToOneNotOwner=!1,this.isOneToMany=!1,this.isManyToOne=!1,this.isManyToMany=!1,this.isManyToManyOwner=!1,this.isManyToManyNotOwner=!1,this.foreignKeys=[],this.joinColumns=[],this.inverseJoinColumns=[],this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata;var t=e.args;this.target=t.target,this.propertyName=t.propertyName,this.relationType=t.relationType,t.inverseSideProperty&&(this.givenInverseSidePropertyFactory=t.inverseSideProperty),this.isLazy=t.isLazy||!1,this.isCascadeInsert=!0===t.options.cascade||t.options.cascade instanceof Array&&-1!==t.options.cascade.indexOf("insert"),this.isCascadeUpdate=!0===t.options.cascade||t.options.cascade instanceof Array&&-1!==t.options.cascade.indexOf("update"),this.isCascadeRemove=!0===t.options.cascade||t.options.cascade instanceof Array&&-1!==t.options.cascade.indexOf("remove"),this.isPrimary=t.options.primary||!1,this.isNullable=!1!==t.options.nullable&&!this.isPrimary,this.onDelete=t.options.onDelete,this.onUpdate=t.options.onUpdate,this.deferrable=t.options.deferrable,this.isEager=t.options.eager||!1,this.persistenceEnabled=!1!==t.options.persistence,this.isTreeParent=t.isTreeParent||!1,this.isTreeChildren=t.isTreeChildren||!1,this.type=t.type instanceof Function?t.type():t.type,this.isOneToOne="one-to-one"===this.relationType,this.isOneToMany="one-to-many"===this.relationType,this.isManyToOne="many-to-one"===this.relationType,this.isManyToMany="many-to-many"===this.relationType,this.isOneToOneNotOwner=!!this.isOneToOne,this.isManyToManyNotOwner=!!this.isManyToMany}return i.prototype.getRelationIdMap=function(e){var i=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map(function(e){return e.referencedColumn});return t.EntityMetadata.getValueMap(e,i)},i.prototype.ensureRelationIdMap=function(e){if(e instanceof Object)return e;var t=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map(function(e){return e.referencedColumn});if(t.length>1)throw new Error("Cannot create relation id map for a single value because relation contains multiple referenced columns.");return t[0].createValueMap(e)},i.prototype.getEntityValue=function(t,i){if(void 0===i&&(i=!1),null!=t){if(this.embeddedMetadata){var n=e.__spread(this.embeddedMetadata.parentPropertyNames),s=function(e,t){var i=e.shift();return i?t[i]?s(e,t[i]):void 0:t},r=s(n,t);return this.isLazy?void 0!==r["__"+this.propertyName+"__"]?r["__"+this.propertyName+"__"]:!0===i?r[this.propertyName]:void 0:r?r[this.isLazy?"__"+this.propertyName+"__":this.propertyName]:void 0}return this.isLazy?void 0!==t["__"+this.propertyName+"__"]?t["__"+this.propertyName+"__"]:!0===i?t[this.propertyName]:void 0:t[this.propertyName]}},i.prototype.setEntityValue=function(t,i){var n=this.isLazy?"__"+this.propertyName+"__":this.propertyName;if(this.embeddedMetadata){var s=function(e,t){var r=e.shift();return r?(t[r.propertyName]||(t[r.propertyName]=r.create()),s(e,t[r.propertyName]),t):(t[n]=i,t)};return s(e.__spread(this.embeddedMetadata.embeddedMetadataTree),t)}t[n]=i},i.prototype.createValueMap=function(t){var i,n=this;if(this.embeddedMetadata){var s=e.__spread(this.embeddedMetadata.parentPropertyNames),r=function(e,i){var s=e.shift();return s?(i[s]={},r(e,i[s]),i):(i[n.propertyName]=t,i)};return r(s,{})}return(i={})[this.propertyName]=t,i},i.prototype.build=function(){this.propertyPath=this.buildPropertyPath()},i.prototype.registerForeignKeys=function(){for(var t,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];(t=this.foreignKeys).push.apply(t,e.__spread(i)),this.joinColumns=this.foreignKeys[0]?this.foreignKeys[0].columns:[],this.inverseJoinColumns=this.foreignKeys[1]?this.foreignKeys[1].columns:[],this.isOwning=this.isManyToOne||(this.isManyToMany||this.isOneToOne)&&this.joinColumns.length>0,this.isOneToOneOwner=this.isOneToOne&&this.isOwning,this.isOneToOneNotOwner=this.isOneToOne&&!this.isOwning,this.isManyToManyOwner=this.isManyToMany&&this.isOwning,this.isManyToManyNotOwner=this.isManyToMany&&!this.isOwning,this.isWithJoinColumn=this.isManyToOne||this.isOneToOneOwner},i.prototype.registerJunctionEntityMetadata=function(e){this.junctionEntityMetadata=e,this.joinTableName=e.tableName,this.inverseRelation&&(this.inverseRelation.junctionEntityMetadata=e,this.joinTableName=e.tableName)},i.prototype.buildInverseSidePropertyPath=function(){if(this.givenInverseSidePropertyFactory){var e=this.inverseEntityMetadata.propertiesMap;if("function"==typeof this.givenInverseSidePropertyFactory)return this.givenInverseSidePropertyFactory(e);if("string"==typeof this.givenInverseSidePropertyFactory)return this.givenInverseSidePropertyFactory}else{if(this.isTreeParent&&this.entityMetadata.treeChildrenRelation)return this.entityMetadata.treeChildrenRelation.propertyName;if(this.isTreeChildren&&this.entityMetadata.treeParentRelation)return this.entityMetadata.treeParentRelation.propertyName}return""},i.prototype.buildPropertyPath=function(){return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length?this.embeddedMetadata.parentPropertyNames.join(".")+"."+this.propertyName:this.propertyName},i}();exports.RelationMetadata=n;
},{"tslib":"c4AP","./EntityMetadata":"Raef"}],"Z6gZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EmbeddedMetadata=void 0;var e=r(require("tslib")),t=require("../driver/mongodb/MongoDriver");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var i=function(){function r(e){this.columns=[],this.relations=[],this.listeners=[],this.indices=[],this.uniques=[],this.relationIds=[],this.relationCounts=[],this.embeddeds=[],this.isArray=!1,this.parentPropertyNames=[],this.parentPrefixes=[],this.embeddedMetadataTree=[],this.columnsFromTree=[],this.relationsFromTree=[],this.listenersFromTree=[],this.indicesFromTree=[],this.uniquesFromTree=[],this.relationIdsFromTree=[],this.relationCountsFromTree=[],this.entityMetadata=e.entityMetadata,this.type=e.args.type(),this.propertyName=e.args.propertyName,this.customPrefix=e.args.prefix,this.isArray=e.args.isArray}return r.prototype.create=function(){return new this.type},r.prototype.build=function(e){return this.embeddeds.forEach(function(t){return t.build(e)}),this.prefix=this.buildPrefix(e),this.parentPropertyNames=this.buildParentPropertyNames(),this.parentPrefixes=this.buildParentPrefixes(),this.propertyPath=this.parentPropertyNames.join("."),this.embeddedMetadataTree=this.buildEmbeddedMetadataTree(),this.columnsFromTree=this.buildColumnsFromTree(),this.relationsFromTree=this.buildRelationsFromTree(),this.listenersFromTree=this.buildListenersFromTree(),this.indicesFromTree=this.buildIndicesFromTree(),this.uniquesFromTree=this.buildUniquesFromTree(),this.relationIdsFromTree=this.buildRelationIdsFromTree(),this.relationCountsFromTree=this.buildRelationCountsFromTree(),this},r.prototype.buildPartialPrefix=function(){if(void 0===this.customPrefix||!0===this.customPrefix)return[this.propertyName];if(""===this.customPrefix||!1===this.customPrefix)return[];if("string"==typeof this.customPrefix)return[this.customPrefix];throw new Error("Invalid prefix option given for "+this.entityMetadata.targetName+"#"+this.propertyName)},r.prototype.buildPrefix=function(r){if(r.driver instanceof t.MongoDriver)return this.propertyName;var i=[];return this.parentEmbeddedMetadata&&i.push(this.parentEmbeddedMetadata.buildPrefix(r)),i.push.apply(i,e.__spread(this.buildPartialPrefix())),i.join("_")},r.prototype.buildParentPropertyNames=function(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPropertyNames().concat(this.propertyName):[this.propertyName]},r.prototype.buildParentPrefixes=function(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPrefixes().concat(this.buildPartialPrefix()):this.buildPartialPrefix()},r.prototype.buildEmbeddedMetadataTree=function(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildEmbeddedMetadataTree().concat(this):[this]},r.prototype.buildColumnsFromTree=function(){return this.embeddeds.reduce(function(e,t){return e.concat(t.buildColumnsFromTree())},this.columns)},r.prototype.buildRelationsFromTree=function(){return this.embeddeds.reduce(function(e,t){return e.concat(t.buildRelationsFromTree())},this.relations)},r.prototype.buildListenersFromTree=function(){return this.embeddeds.reduce(function(e,t){return e.concat(t.buildListenersFromTree())},this.listeners)},r.prototype.buildIndicesFromTree=function(){return this.embeddeds.reduce(function(e,t){return e.concat(t.buildIndicesFromTree())},this.indices)},r.prototype.buildUniquesFromTree=function(){return this.embeddeds.reduce(function(e,t){return e.concat(t.buildUniquesFromTree())},this.uniques)},r.prototype.buildRelationIdsFromTree=function(){return this.embeddeds.reduce(function(e,t){return e.concat(t.buildRelationIdsFromTree())},this.relationIds)},r.prototype.buildRelationCountsFromTree=function(){return this.embeddeds.reduce(function(e,t){return e.concat(t.buildRelationCountsFromTree())},this.relationCounts)},r}();exports.EmbeddedMetadata=i;
},{"tslib":"c4AP","../driver/mongodb/MongoDriver":"TOLf"}],"7i6W":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationIdMetadata=void 0;var t=function(){function t(t){this.entityMetadata=t.entityMetadata,this.target=t.args.target,this.propertyName=t.args.propertyName,this.relationNameOrFactory=t.args.relation,this.alias=t.args.alias,this.queryBuilderFactory=t.args.queryBuilderFactory}return t.prototype.setValue=function(t){var e=this,a=this.relation.getEntityValue(t);if(a instanceof Array)t[this.propertyName]=a.map(function(t){return e.relation.inverseEntityMetadata.getEntityIdMixedMap(t)}).filter(function(t){return null!=t});else{var r=this.relation.inverseEntityMetadata.getEntityIdMixedMap(a);void 0!==r&&(t[this.propertyName]=r)}},t.prototype.build=function(){var t=this.relationNameOrFactory instanceof Function?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,e=this.entityMetadata.findRelationWithPropertyPath(t);if(!e)throw new Error("Cannot find relation "+t+". Wrong relation specified for @RelationId decorator.");this.relation=e},t}();exports.RelationIdMetadata=t;
},{}],"zJZ8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationCountMetadata=void 0;var t=function(){function t(t){this.entityMetadata=t.entityMetadata,this.target=t.args.target,this.propertyName=t.args.propertyName,this.relationNameOrFactory=t.args.relation,this.alias=t.args.alias,this.queryBuilderFactory=t.args.queryBuilderFactory}return t.prototype.build=function(){var t=this.relationNameOrFactory instanceof Function?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,a=this.entityMetadata.findRelationWithPropertyPath(t);if(!a)throw new Error("Cannot find relation "+t+". Wrong relation specified for @RelationCount decorator.");this.relation=a},t}();exports.RelationCountMetadata=t;
},{}],"7r6E":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MetadataUtils=void 0;var t=function(){function t(){}return t.getInheritanceTree=function(t){var e=[t],r=function(t){var n=Object.getPrototypeOf(t);n&&n.name&&(e.push(n),r(n))};return r(t),e},t.isInherited=function(t,e){return t.prototype instanceof e},t.filterByTarget=function(t,e){return e?t.filter(function(t){return t.target&&-1!==e.indexOf(t.target)}):t},t}();exports.MetadataUtils=t;
},{}],"1fru":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ForeignKeyMetadata=void 0;var e=function(){function e(e){this.columns=[],this.referencedColumns=[],this.columnNames=[],this.referencedColumnNames=[],this.entityMetadata=e.entityMetadata,this.referencedEntityMetadata=e.referencedEntityMetadata,this.columns=e.columns,this.referencedColumns=e.referencedColumns,this.onDelete=e.onDelete||"NO ACTION",this.onUpdate=e.onUpdate||"NO ACTION",this.deferrable=e.deferrable,e.namingStrategy&&this.build(e.namingStrategy)}return e.prototype.build=function(e){this.columnNames=this.columns.map(function(e){return e.databaseName}),this.referencedColumnNames=this.referencedColumns.map(function(e){return e.databaseName}),this.referencedTablePath=this.referencedEntityMetadata.tablePath,this.name=e.foreignKeyName(this.entityMetadata.tablePath,this.columnNames)},e}();exports.ForeignKeyMetadata=e;
},{}],"CqIy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JunctionEntityMetadataBuilder=void 0;var e=i(require("tslib")),n=require("../driver/mysql/MysqlDriver"),t=require("../metadata/ColumnMetadata"),a=require("../metadata/EntityMetadata"),r=require("../metadata/ForeignKeyMetadata"),o=require("../metadata/IndexMetadata");function i(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};a.get||a.set?Object.defineProperty(n,t,a):n[t]=e[t]}return n.default=e,n}var l=function(){function i(e){this.connection=e}return i.prototype.build=function(i,l){var u=this,c=this.collectReferencedColumns(i,l),m=this.collectInverseReferencedColumns(i,l),s=l.name||this.connection.namingStrategy.joinTableName(i.entityMetadata.tableNameWithoutPrefix,i.inverseEntityMetadata.tableNameWithoutPrefix,i.propertyPath,i.inverseRelation?i.inverseRelation.propertyName:""),d=new a.EntityMetadata({connection:this.connection,args:{target:"",name:s,type:"junction",database:l.database||i.entityMetadata.database,schema:l.schema||i.entityMetadata.schema}});d.build();var f=c.map(function(e){var a=l.joinColumns?l.joinColumns.find(function(n){return!(n.referencedColumnName&&n.referencedColumnName!==e.propertyName||!n.name)}):void 0,r=a&&a.name?a.name:u.connection.namingStrategy.joinTableColumnName(i.entityMetadata.tableNameWithoutPrefix,e.propertyName,e.databaseName);return new t.ColumnMetadata({connection:u.connection,entityMetadata:d,referencedColumn:e,args:{target:"",mode:"virtual",propertyName:r,options:{name:r,length:!e.length&&u.connection.driver instanceof n.MysqlDriver&&("uuid"===e.generationStrategy||"uuid"===e.type)?"36":e.length,width:e.width,type:e.type,precision:e.precision,scale:e.scale,charset:e.charset,collation:e.collation,zerofill:e.zerofill,unsigned:!!e.zerofill||e.unsigned,nullable:!1,primary:!0}}})}),y=m.map(function(e){var a=l.inverseJoinColumns?l.inverseJoinColumns.find(function(n){return!(n.referencedColumnName&&n.referencedColumnName!==e.propertyName||!n.name)}):void 0,r=a&&a.name?a.name:u.connection.namingStrategy.joinTableInverseColumnName(i.inverseEntityMetadata.tableNameWithoutPrefix,e.propertyName,e.databaseName);return new t.ColumnMetadata({connection:u.connection,entityMetadata:d,referencedColumn:e,args:{target:"",mode:"virtual",propertyName:r,options:{length:!e.length&&u.connection.driver instanceof n.MysqlDriver&&("uuid"===e.generationStrategy||"uuid"===e.type)?"36":e.length,type:e.type,precision:e.precision,scale:e.scale,charset:e.charset,collation:e.collation,zerofill:e.zerofill,unsigned:!!e.zerofill||e.unsigned,name:r,nullable:!1,primary:!0}}})});return this.changeDuplicatedColumnNames(f,y),d.ownerColumns=f,d.inverseColumns=y,d.ownColumns=e.__spread(f,y),d.ownColumns.forEach(function(e){return e.relationMetadata=i}),d.foreignKeys=[new r.ForeignKeyMetadata({entityMetadata:d,referencedEntityMetadata:i.entityMetadata,columns:f,referencedColumns:c,onDelete:i.onDelete||"CASCADE"}),new r.ForeignKeyMetadata({entityMetadata:d,referencedEntityMetadata:i.inverseEntityMetadata,columns:y,referencedColumns:m,onDelete:i.onDelete||"CASCADE"})],d.ownIndices=[new o.IndexMetadata({entityMetadata:d,columns:f,args:{target:d.target,synchronize:!0}}),new o.IndexMetadata({entityMetadata:d,columns:y,args:{target:d.target,synchronize:!0}})],d},i.prototype.collectReferencedColumns=function(e,n){var t=!!n.joinColumns&&n.joinColumns.find(function(e){return!!e.referencedColumnName});return!n.joinColumns||n.joinColumns&&!t?e.entityMetadata.columns.filter(function(e){return e.isPrimary}):n.joinColumns.map(function(n){var t=e.entityMetadata.columns.find(function(e){return e.propertyName===n.referencedColumnName});if(!t)throw new Error("Referenced column "+n.referencedColumnName+" was not found in entity "+e.entityMetadata.name);return t})},i.prototype.collectInverseReferencedColumns=function(e,n){var t=!!n.inverseJoinColumns,a=!!t&&n.inverseJoinColumns.find(function(e){return!!e.referencedColumnName});return!t||t&&!a?e.inverseEntityMetadata.primaryColumns:n.inverseJoinColumns.map(function(n){var t=e.inverseEntityMetadata.ownColumns.find(function(e){return e.propertyName===n.referencedColumnName});if(!t)throw new Error("Referenced column "+n.referencedColumnName+" was not found in entity "+e.inverseEntityMetadata.name);return t})},i.prototype.changeDuplicatedColumnNames=function(e,n){var t=this;e.forEach(function(e){n.forEach(function(n){if(e.givenDatabaseName===n.givenDatabaseName){var a=t.connection.namingStrategy.joinTableColumnDuplicationPrefix(e.propertyName,1);e.propertyName=a,e.givenDatabaseName=a;var r=t.connection.namingStrategy.joinTableColumnDuplicationPrefix(n.propertyName,2);n.propertyName=r,n.givenDatabaseName=r}})})},i}();exports.JunctionEntityMetadataBuilder=l;
},{"tslib":"c4AP","../driver/mysql/MysqlDriver":"TOLf","../metadata/ColumnMetadata":"bJDV","../metadata/EntityMetadata":"Raef","../metadata/ForeignKeyMetadata":"1fru","../metadata/IndexMetadata":"/SWG"}],"7jrD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClosureJunctionEntityMetadataBuilder=void 0;var e=require("../metadata/EntityMetadata"),t=require("../metadata/ColumnMetadata"),n=require("../metadata/ForeignKeyMetadata"),a=require("../metadata/IndexMetadata"),o=function(){function o(e){this.connection=e}return o.prototype.build=function(o){var r=this,i=new e.EntityMetadata({parentClosureEntityMetadata:o,connection:this.connection,args:{target:"",name:o.tableNameWithoutPrefix,type:"closure-junction"}});return i.build(),o.primaryColumns.forEach(function(e){i.ownColumns.push(new t.ColumnMetadata({connection:r.connection,entityMetadata:i,closureType:"ancestor",referencedColumn:e,args:{target:"",mode:"virtual",propertyName:e.propertyName+"_ancestor",options:{primary:!0,length:e.length,type:e.type}}})),i.ownColumns.push(new t.ColumnMetadata({connection:r.connection,entityMetadata:i,closureType:"descendant",referencedColumn:e,args:{target:"",mode:"virtual",propertyName:e.propertyName+"_descendant",options:{primary:!0,length:e.length,type:e.type}}}))}),i.ownIndices=[new a.IndexMetadata({entityMetadata:i,columns:[i.ownColumns[0]],args:{target:i.target,synchronize:!0}}),new a.IndexMetadata({entityMetadata:i,columns:[i.ownColumns[1]],args:{target:i.target,synchronize:!0}})],o.treeLevelColumn&&i.ownColumns.push(new t.ColumnMetadata({connection:this.connection,entityMetadata:i,args:{target:"",mode:"virtual",propertyName:"level",options:{type:this.connection.driver.mappedDataTypes.treeLevel}}})),i.foreignKeys=[new n.ForeignKeyMetadata({entityMetadata:i,referencedEntityMetadata:o,columns:[i.ownColumns[0]],referencedColumns:o.primaryColumns}),new n.ForeignKeyMetadata({entityMetadata:i,referencedEntityMetadata:o,columns:[i.ownColumns[1]],referencedColumns:o.primaryColumns})],i},o}();exports.ClosureJunctionEntityMetadataBuilder=o;
},{"../metadata/EntityMetadata":"Raef","../metadata/ColumnMetadata":"bJDV","../metadata/ForeignKeyMetadata":"1fru","../metadata/IndexMetadata":"/SWG"}],"K+ON":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UniqueMetadata=void 0;var t=function(){function t(t){this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=t.entityMetadata,this.embeddedMetadata=t.embeddedMetadata,t.columns&&(this.columns=t.columns),t.args&&(this.target=t.args.target,this.givenName=t.args.name,this.givenColumnNames=t.args.columns)}return t.prototype.build=function(t){var e=this,n={};if(this.givenColumnNames){var a=[];if(this.givenColumnNames instanceof Array)(a=this.givenColumnNames.map(function(t){return e.embeddedMetadata?e.embeddedMetadata.propertyPath+"."+t:t})).forEach(function(t){return n[t]=1});else{var i=this.givenColumnNames(this.entityMetadata.propertiesMap);i instanceof Array?(a=i.map(function(t){return String(t)})).forEach(function(t){return n[t]=1}):(a=Object.keys(i).map(function(t){return String(t)}),Object.keys(i).forEach(function(t){return n[t]=i[t]}))}this.columns=a.map(function(t){var n=e.entityMetadata.columns.find(function(e){return e.propertyPath===t});if(n)return[n];var a=e.entityMetadata.relations.find(function(e){return e.isWithJoinColumn&&e.propertyName===t});if(a)return a.joinColumns;var i=e.givenName?'"'+e.givenName+'" ':"",r=e.entityMetadata.targetName;throw new Error("Unique constraint "+i+"contains column that is missing in the entity ("+r+"): "+t)}).reduce(function(t,e){return t.concat(e)})}return this.columnNamesWithOrderingMap=Object.keys(n).reduce(function(t,a){var i=e.entityMetadata.columns.find(function(t){return t.propertyPath===a});return i&&(t[i.databasePath]=n[a]),t},{}),this.name=this.givenName?this.givenName:t.uniqueConstraintName(this.entityMetadata.tablePath,this.columns.map(function(t){return t.databaseName})),this},t}();exports.UniqueMetadata=t;
},{}],"5AW2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationJoinColumnBuilder=void 0;var e=require("../driver/mysql/MysqlDriver"),t=require("../metadata/ColumnMetadata"),n=require("../metadata/UniqueMetadata"),a=require("../metadata/ForeignKeyMetadata"),r=require("../driver/oracle/OracleDriver"),i=function(){function i(e){this.connection=e}return i.prototype.build=function(e,t){var i=this.collectReferencedColumns(e,t);if(!i.length)return{foreignKey:void 0,uniqueConstraint:void 0};var o=this.collectColumns(e,t,i),u=new a.ForeignKeyMetadata({entityMetadata:t.entityMetadata,referencedEntityMetadata:t.inverseEntityMetadata,namingStrategy:this.connection.namingStrategy,columns:o,referencedColumns:i,onDelete:t.onDelete,onUpdate:t.onUpdate,deferrable:t.deferrable});if(this.connection.driver instanceof r.OracleDriver&&o.every(function(e){return e.isPrimary}))return{foreignKey:u,uniqueConstraint:void 0};if(i.length>0&&t.isOneToOne){var l=new n.UniqueMetadata({entityMetadata:t.entityMetadata,columns:u.columns,args:{name:this.connection.namingStrategy.relationConstraintName(t.entityMetadata.tablePath,u.columns.map(function(e){return e.databaseName})),target:t.entityMetadata.target}});return l.build(this.connection.namingStrategy),{foreignKey:u,uniqueConstraint:l}}return{foreignKey:u,uniqueConstraint:void 0}},i.prototype.collectReferencedColumns=function(e,t){var n=e.find(function(e){return!!e.referencedColumnName}),a=0===e.length&&t.isManyToOne,r=e.length>0&&!n;return a||r?t.inverseEntityMetadata.primaryColumns:e.map(function(e){var n=t.inverseEntityMetadata.ownColumns.find(function(t){return t.propertyName===e.referencedColumnName});if(!n)throw new Error("Referenced column "+e.referencedColumnName+" was not found in entity "+t.inverseEntityMetadata.name);return n})},i.prototype.collectColumns=function(n,a,r){var i=this;return r.map(function(r){var o=n.find(function(e){return!(e.referencedColumnName&&e.referencedColumnName!==r.propertyName||!e.name)}),u=o?o.name:i.connection.namingStrategy.joinColumnName(a.propertyName,r.propertyName),l=a.entityMetadata.ownColumns.find(function(e){return e.databaseName===u});return l||(l=new t.ColumnMetadata({connection:i.connection,entityMetadata:a.entityMetadata,args:{target:"",mode:"virtual",propertyName:a.propertyName,options:{name:u,type:r.type,length:!r.length&&i.connection.driver instanceof e.MysqlDriver&&("uuid"===r.generationStrategy||"uuid"===r.type)?"36":r.length,width:r.width,charset:r.charset,collation:r.collation,precision:r.precision,scale:r.scale,zerofill:r.zerofill,unsigned:r.unsigned,comment:r.comment,primary:a.isPrimary,nullable:a.isNullable}}}),a.entityMetadata.registerColumn(l)),l.referencedColumn=r,l.type=r.type,l.relationMetadata=a,l.build(i.connection),l})},i}();exports.RelationJoinColumnBuilder=i;
},{"../driver/mysql/MysqlDriver":"TOLf","../metadata/ColumnMetadata":"bJDV","../metadata/UniqueMetadata":"K+ON","../metadata/ForeignKeyMetadata":"1fru","../driver/oracle/OracleDriver":"l9nz"}],"FZvk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityListenerMetadata=void 0;var t=function(){function t(t){this.entityMetadata=t.entityMetadata,this.embeddedMetadata=t.embeddedMetadata,this.target=t.args.target,this.propertyName=t.args.propertyName,this.type=t.args.type}return t.prototype.isAllowed=function(t){return this.entityMetadata.target===t.constructor||this.entityMetadata.target instanceof Function&&t.constructor.prototype instanceof this.entityMetadata.target},t.prototype.execute=function(t){if(!this.embeddedMetadata)return t[this.propertyName]();this.callEntityEmbeddedMethod(t,this.embeddedMetadata.propertyPath.split("."))},t.prototype.callEntityEmbeddedMethod=function(t,e){var a=e.shift();a&&t[a]&&(0===e.length?t[a][this.propertyName]():t[a]&&this.callEntityEmbeddedMethod(t[a],e))},t}();exports.EntityListenerMetadata=t;
},{}],"mV98":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CheckMetadata=void 0;var t=function(){function t(t){this.entityMetadata=t.entityMetadata,t.args&&(this.target=t.args.target,this.expression=t.args.expression,this.givenName=t.args.name)}return t.prototype.build=function(t){return this.name=this.givenName?this.givenName:t.checkConstraintName(this.entityMetadata.tablePath,this.expression),this},t}();exports.CheckMetadata=t;
},{}],"X8nR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExclusionMetadata=void 0;var t=function(){function t(t){this.entityMetadata=t.entityMetadata,t.args&&(this.target=t.args.target,this.expression=t.args.expression,this.givenName=t.args.name)}return t.prototype.build=function(t){return this.name=this.givenName?this.givenName:t.exclusionConstraintName(this.entityMetadata.tablePath,this.expression),this},t}();exports.ExclusionMetadata=t;
},{}],"dvfJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityMetadataBuilder=void 0;var e=E(require("tslib")),t=require("../driver/cockroachdb/CockroachDriver"),n=require("../metadata/EntityMetadata"),a=require("../metadata/ColumnMetadata"),r=require("../metadata/IndexMetadata"),i=require("../metadata/RelationMetadata"),o=require("../metadata/EmbeddedMetadata"),u=require("../metadata/RelationIdMetadata"),s=require("../metadata/RelationCountMetadata"),c=require("./MetadataUtils"),d=require("./JunctionEntityMetadataBuilder"),l=require("./ClosureJunctionEntityMetadataBuilder"),f=require("./RelationJoinColumnBuilder"),m=require("../metadata/EntityListenerMetadata"),p=require("../metadata/UniqueMetadata"),y=require("../driver/mysql/MysqlDriver"),h=require("../metadata/CheckMetadata"),g=require("../driver/sqlserver/SqlServerDriver"),M=require("../driver/postgres/PostgresDriver"),b=require("../metadata/ExclusionMetadata");function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};a.get||a.set?Object.defineProperty(t,n,a):t[n]=e[n]}return t.default=e,t}var v=function(){function E(e,t){this.connection=e,this.metadataArgsStorage=t,this.junctionEntityMetadataBuilder=new d.JunctionEntityMetadataBuilder(e),this.closureJunctionEntityMetadataBuilder=new l.ClosureJunctionEntityMetadataBuilder(e),this.relationJoinColumnBuilder=new f.RelationJoinColumnBuilder(e)}return E.prototype.build=function(n){var a=this,i=(n?this.metadataArgsStorage.filterTables(n):this.metadataArgsStorage.tables).filter(function(e){return"regular"===e.type||"closure"===e.type||"entity-child"===e.type||"view"===e.type}).map(function(e){return a.createEntityMetadata(e)});return i.forEach(function(e){return a.computeParentEntityMetadata(i,e)}),i.forEach(function(e){e.childEntityMetadatas=i.filter(function(t){return e.target instanceof Function&&t.target instanceof Function&&c.MetadataUtils.isInherited(t.target,e.target)})}),i.filter(function(e){return"entity-child"!==e.tableType}).forEach(function(e){return e.build()}),i.filter(function(e){return"entity-child"===e.tableType}).forEach(function(e){return e.build()}),i.filter(function(e){return"entity-child"!==e.tableType}).forEach(function(e){return a.computeEntityMetadataStep1(i,e)}),i.filter(function(e){return"entity-child"===e.tableType}).forEach(function(e){return a.computeEntityMetadataStep1(i,e)}),i.forEach(function(e){return a.computeEntityMetadataStep2(e)}),i.forEach(function(e){return a.computeInverseProperties(e,i)}),i.filter(function(e){return"entity-child"!==e.tableType}).forEach(function(n){n.relations.filter(function(e){return e.isOneToOne||e.isManyToOne}).forEach(function(e){var i=a.metadataArgsStorage.filterJoinColumns(e.target,e.propertyName),o=a.relationJoinColumnBuilder.build(i,e),u=o.foreignKey,s=o.uniqueConstraint;if(u&&(e.registerForeignKeys(u),n.foreignKeys.push(u)),s)if(a.connection.driver instanceof y.MysqlDriver||a.connection.driver instanceof g.SqlServerDriver){var c=new r.IndexMetadata({entityMetadata:s.entityMetadata,columns:s.columns,args:{target:s.target,name:s.name,unique:!0,synchronize:!0}});a.connection.driver instanceof g.SqlServerDriver&&(c.where=c.columns.map(function(e){return a.connection.driver.escape(e.databaseName)+" IS NOT NULL"}).join(" AND ")),e.embeddedMetadata?e.embeddedMetadata.indices.push(c):e.entityMetadata.ownIndices.push(c),a.computeEntityMetadataStep2(n)}else e.embeddedMetadata?e.embeddedMetadata.uniques.push(s):e.entityMetadata.ownUniques.push(s),a.computeEntityMetadataStep2(n);if(u&&a.connection.driver instanceof t.CockroachDriver){c=new r.IndexMetadata({entityMetadata:e.entityMetadata,columns:u.columns,args:{target:e.entityMetadata.target,synchronize:!0}});e.embeddedMetadata?e.embeddedMetadata.indices.push(c):e.entityMetadata.ownIndices.push(c),a.computeEntityMetadataStep2(n)}}),n.relations.filter(function(e){return e.isManyToMany}).forEach(function(t){var n=a.metadataArgsStorage.findJoinTable(t.target,t.propertyName);if(n){var r=a.junctionEntityMetadataBuilder.build(t,n);t.registerForeignKeys.apply(t,e.__spread(r.foreignKeys)),t.registerJunctionEntityMetadata(r),a.computeEntityMetadataStep2(r),a.computeInverseProperties(r,i),i.push(r)}})}),i.forEach(function(e){e.relationsWithJoinColumns=e.relations.filter(function(e){return e.isWithJoinColumn}),e.hasNonNullableRelations=e.relationsWithJoinColumns.some(function(e){return!e.isNullable||e.isPrimary})}),i.filter(function(e){return"closure-table"===e.treeType}).forEach(function(e){var t=a.closureJunctionEntityMetadataBuilder.build(e);e.closureJunctionTable=t,a.computeEntityMetadataStep2(t),a.computeInverseProperties(t,i),i.push(t)}),i.filter(function(e){return"STI"===e.inheritancePattern&&e.discriminatorColumn}).forEach(function(e){return a.createKeysForTableInheritance(e)}),i.forEach(function(e){e.indices.forEach(function(e){return e.build(a.connection.namingStrategy)})}),i.forEach(function(e){e.uniques.forEach(function(e){return e.build(a.connection.namingStrategy)})}),i.forEach(function(e){e.checks.forEach(function(e){return e.build(a.connection.namingStrategy)})}),i.forEach(function(e){e.exclusions.forEach(function(e){return e.build(a.connection.namingStrategy)})}),i.filter(function(e){return e.target instanceof Function}).forEach(function(e){e.relations.filter(function(e){return e.isLazy}).forEach(function(t){a.connection.relationLoader.enableLazyLoad(t,e.target.prototype)})}),i.forEach(function(e){e.columns.forEach(function(t){var n=a.metadataArgsStorage.findGenerated(t.target,t.propertyName);n&&(t.isGenerated=!0,t.generationStrategy=n.strategy,"uuid"===n.strategy?t.type="uuid":"rowid"===n.strategy?t.type="int":t.type=t.type||Number,t.build(a.connection),a.computeEntityMetadataStep2(e))})}),i},E.prototype.createEntityMetadata=function(t){var a,r=t.target instanceof Function?c.MetadataUtils.getInheritanceTree(t.target):[t.target],i=this.metadataArgsStorage.findInheritanceType(t.target),o=this.metadataArgsStorage.findTree(t.target);return(i&&"STI"===i.pattern||"entity-child"===t.type)&&(a=this.metadataArgsStorage.filterSingleTableChildren(t.target).map(function(e){return e.target}).filter(function(e){return e instanceof Function}),r.push.apply(r,e.__spread(a))),new n.EntityMetadata({connection:this.connection,args:t,inheritanceTree:r,tableTree:o,inheritancePattern:i?i.pattern:void 0})},E.prototype.computeParentEntityMetadata=function(e,t){"entity-child"===t.tableType&&(t.parentEntityMetadata=e.find(function(e){return-1!==e.inheritanceTree.indexOf(t.target)&&"STI"===e.inheritancePattern}))},E.prototype.computeEntityMetadataStep1=function(n,o){var c,d,l,f=this,g=this.metadataArgsStorage.findInheritanceType(o.target),E=this.metadataArgsStorage.findDiscriminatorValue(o.target);if(o.discriminatorValue=E?E.value:o.target.name,o.embeddeds=this.createEmbeddedsRecursively(o,this.metadataArgsStorage.filterEmbeddeds(o.inheritanceTree)).map(function(e){return"STI"===o.inheritancePattern&&(e.columns=e.columns.map(function(e){return e.isNullable=!0,e})),e}),o.ownColumns=this.metadataArgsStorage.filterColumns(o.inheritanceTree).map(function(e){if("entity-child"===o.tableType)return o.parentEntityMetadata.ownColumns.find(function(t){return t.propertyName===e.propertyName});var t=new a.ColumnMetadata({connection:f.connection,entityMetadata:o,args:e});return n.find(function(t){return"entity-child"===t.tableType&&t.target===e.target})&&(t.isNullable=!0),t}),g&&g.column){var v=g.column&&g.column.name?g.column.name:"type",T=o.ownColumns.find(function(e){return e.propertyName===v});T?T.isDiscriminator=!0:((T=new a.ColumnMetadata({connection:this.connection,entityMetadata:o,args:{target:o.target,mode:"virtual",propertyName:v,options:g.column||{name:v,type:"varchar",nullable:!1}}})).isVirtual=!0,T.isDiscriminator=!0,o.ownColumns.push(T))}if("entity-child"===o.tableType){var w=o.parentEntityMetadata.ownColumns.find(function(e){return e.isDiscriminator});w&&!o.ownColumns.find(function(e){return e===w})&&o.ownColumns.push(w)}if("materialized-path"===o.treeType?o.ownColumns.push(new a.ColumnMetadata({connection:this.connection,entityMetadata:o,materializedPath:!0,args:{target:o.target,mode:"virtual",propertyName:"mpath",options:{name:"mpath",type:"varchar",nullable:!0,default:""}}})):"nested-set"===o.treeType&&(o.ownColumns.push(new a.ColumnMetadata({connection:this.connection,entityMetadata:o,nestedSetLeft:!0,args:{target:o.target,mode:"virtual",propertyName:"nsleft",options:{name:"nsleft",type:"integer",nullable:!1,default:1}}})),o.ownColumns.push(new a.ColumnMetadata({connection:this.connection,entityMetadata:o,nestedSetRight:!0,args:{target:o.target,mode:"virtual",propertyName:"nsright",options:{name:"nsright",type:"integer",nullable:!1,default:2}}}))),o.ownRelations=this.metadataArgsStorage.filterRelations(o.inheritanceTree).map(function(e){return"entity-child"===o.tableType?o.parentEntityMetadata.ownRelations.find(function(t){return t.propertyName===e.propertyName}):new i.RelationMetadata({entityMetadata:o,args:e})}),o.relationIds=this.metadataArgsStorage.filterRelationIds(o.inheritanceTree).map(function(e){return"entity-child"===o.tableType?o.parentEntityMetadata.relationIds.find(function(t){return t.propertyName===e.propertyName}):new u.RelationIdMetadata({entityMetadata:o,args:e})}),o.relationCounts=this.metadataArgsStorage.filterRelationCounts(o.inheritanceTree).map(function(e){return"entity-child"===o.tableType?o.parentEntityMetadata.relationCounts.find(function(t){return t.propertyName===e.propertyName}):new s.RelationCountMetadata({entityMetadata:o,args:e})}),o.ownListeners=this.metadataArgsStorage.filterListeners(o.inheritanceTree).map(function(e){return new m.EntityListenerMetadata({entityMetadata:o,args:e})}),o.checks=this.metadataArgsStorage.filterChecks(o.inheritanceTree).map(function(e){return new h.CheckMetadata({entityMetadata:o,args:e})}),this.connection.driver instanceof M.PostgresDriver&&(o.exclusions=this.metadataArgsStorage.filterExclusions(o.inheritanceTree).map(function(e){return new b.ExclusionMetadata({entityMetadata:o,args:e})})),this.connection.driver instanceof t.CockroachDriver){o.ownIndices=this.metadataArgsStorage.filterIndices(o.inheritanceTree).filter(function(e){return!e.unique}).map(function(e){return new r.IndexMetadata({entityMetadata:o,args:e})});var C=this.metadataArgsStorage.filterIndices(o.inheritanceTree).filter(function(e){return e.unique}).map(function(e){return new p.UniqueMetadata({entityMetadata:o,args:{target:e.target,name:e.name,columns:e.columns}})});(c=o.ownUniques).push.apply(c,e.__spread(C))}else o.ownIndices=this.metadataArgsStorage.filterIndices(o.inheritanceTree).map(function(e){return new r.IndexMetadata({entityMetadata:o,args:e})});if(this.connection.driver instanceof y.MysqlDriver){var S=this.metadataArgsStorage.filterUniques(o.inheritanceTree).map(function(e){return new r.IndexMetadata({entityMetadata:o,args:{target:e.target,name:e.name,columns:e.columns,unique:!0,synchronize:!0}})});(d=o.ownIndices).push.apply(d,e.__spread(S))}else{C=this.metadataArgsStorage.filterUniques(o.inheritanceTree).map(function(e){return new p.UniqueMetadata({entityMetadata:o,args:e})});(l=o.ownUniques).push.apply(l,e.__spread(C))}},E.prototype.createEmbeddedsRecursively=function(e,t){var n=this;return t.map(function(t){var d=new o.EmbeddedMetadata({entityMetadata:e,args:t}),l=c.MetadataUtils.getInheritanceTree(d.type);return d.columns=n.metadataArgsStorage.filterColumns(l).map(function(t){return new a.ColumnMetadata({connection:n.connection,entityMetadata:e,embeddedMetadata:d,args:t})}),d.relations=n.metadataArgsStorage.filterRelations(l).map(function(t){return new i.RelationMetadata({entityMetadata:e,embeddedMetadata:d,args:t})}),d.listeners=n.metadataArgsStorage.filterListeners(l).map(function(t){return new m.EntityListenerMetadata({entityMetadata:e,embeddedMetadata:d,args:t})}),d.indices=n.metadataArgsStorage.filterIndices(l).map(function(t){return new r.IndexMetadata({entityMetadata:e,embeddedMetadata:d,args:t})}),d.uniques=n.metadataArgsStorage.filterUniques(l).map(function(t){return new p.UniqueMetadata({entityMetadata:e,embeddedMetadata:d,args:t})}),d.relationIds=n.metadataArgsStorage.filterRelationIds(l).map(function(t){return new u.RelationIdMetadata({entityMetadata:e,args:t})}),d.relationCounts=n.metadataArgsStorage.filterRelationCounts(l).map(function(t){return new s.RelationCountMetadata({entityMetadata:e,args:t})}),d.embeddeds=n.createEmbeddedsRecursively(e,n.metadataArgsStorage.filterEmbeddeds(l)),d.embeddeds.forEach(function(e){return e.parentEmbeddedMetadata=d}),e.allEmbeddeds.push(d),d})},E.prototype.computeEntityMetadataStep2=function(e){var t=this;e.embeddeds.forEach(function(e){return e.build(t.connection)}),e.embeddeds.forEach(function(e){e.columnsFromTree.forEach(function(e){return e.build(t.connection)}),e.relationsFromTree.forEach(function(e){return e.build()})}),e.ownColumns.forEach(function(e){return e.build(t.connection)}),e.ownRelations.forEach(function(e){return e.build()}),e.relations=e.embeddeds.reduce(function(e,t){return e.concat(t.relationsFromTree)},e.ownRelations),e.eagerRelations=e.relations.filter(function(e){return e.isEager}),e.lazyRelations=e.relations.filter(function(e){return e.isLazy}),e.oneToOneRelations=e.relations.filter(function(e){return e.isOneToOne}),e.oneToManyRelations=e.relations.filter(function(e){return e.isOneToMany}),e.manyToOneRelations=e.relations.filter(function(e){return e.isManyToOne}),e.manyToManyRelations=e.relations.filter(function(e){return e.isManyToMany}),e.ownerOneToOneRelations=e.relations.filter(function(e){return e.isOneToOneOwner}),e.ownerManyToManyRelations=e.relations.filter(function(e){return e.isManyToManyOwner}),e.treeParentRelation=e.relations.find(function(e){return e.isTreeParent}),e.treeChildrenRelation=e.relations.find(function(e){return e.isTreeChildren}),e.columns=e.embeddeds.reduce(function(e,t){return e.concat(t.columnsFromTree)},e.ownColumns),e.listeners=e.embeddeds.reduce(function(e,t){return e.concat(t.listenersFromTree)},e.ownListeners),e.afterLoadListeners=e.listeners.filter(function(e){return"after-load"===e.type}),e.afterInsertListeners=e.listeners.filter(function(e){return"after-insert"===e.type}),e.afterUpdateListeners=e.listeners.filter(function(e){return"after-update"===e.type}),e.afterRemoveListeners=e.listeners.filter(function(e){return"after-remove"===e.type}),e.beforeInsertListeners=e.listeners.filter(function(e){return"before-insert"===e.type}),e.beforeUpdateListeners=e.listeners.filter(function(e){return"before-update"===e.type}),e.beforeRemoveListeners=e.listeners.filter(function(e){return"before-remove"===e.type}),e.indices=e.embeddeds.reduce(function(e,t){return e.concat(t.indicesFromTree)},e.ownIndices),e.uniques=e.embeddeds.reduce(function(e,t){return e.concat(t.uniquesFromTree)},e.ownUniques),e.primaryColumns=e.columns.filter(function(e){return e.isPrimary}),e.nonVirtualColumns=e.columns.filter(function(e){return!e.isVirtual}),e.ancestorColumns=e.columns.filter(function(e){return"ancestor"===e.closureType}),e.descendantColumns=e.columns.filter(function(e){return"descendant"===e.closureType}),e.hasMultiplePrimaryKeys=e.primaryColumns.length>1,e.generatedColumns=e.columns.filter(function(e){return e.isGenerated||e.isObjectId}),e.hasUUIDGeneratedColumns=e.columns.filter(function(e){return e.isGenerated||"uuid"===e.generationStrategy}).length>0,e.createDateColumn=e.columns.find(function(e){return e.isCreateDate}),e.updateDateColumn=e.columns.find(function(e){return e.isUpdateDate}),e.versionColumn=e.columns.find(function(e){return e.isVersion}),e.discriminatorColumn=e.columns.find(function(e){return e.isDiscriminator}),e.treeLevelColumn=e.columns.find(function(e){return e.isTreeLevel}),e.nestedSetLeftColumn=e.columns.find(function(e){return e.isNestedSetLeft}),e.nestedSetRightColumn=e.columns.find(function(e){return e.isNestedSetRight}),e.materializedPathColumn=e.columns.find(function(e){return e.isMaterializedPath}),e.objectIdColumn=e.columns.find(function(e){return e.isObjectId}),e.foreignKeys.forEach(function(e){return e.build(t.connection.namingStrategy)}),e.propertiesMap=e.createPropertiesMap(),e.relationIds.forEach(function(e){return e.build()}),e.relationCounts.forEach(function(e){return e.build()}),e.embeddeds.forEach(function(e){e.relationIdsFromTree.forEach(function(e){return e.build()}),e.relationCountsFromTree.forEach(function(e){return e.build()})})},E.prototype.computeInverseProperties=function(e,t){e.relations.forEach(function(n){var a=t.find(function(e){return e.target===n.type||"string"==typeof n.type&&e.targetName===n.type});if(!a)throw new Error("Entity metadata for "+e.name+"#"+n.propertyPath+" was not found. Check if you specified a correct entity object and if it's connected in the connection options.");n.inverseEntityMetadata=a,n.inverseSidePropertyPath=n.buildInverseSidePropertyPath(),n.inverseRelation=a.relations.find(function(e){return e.propertyPath===n.inverseSidePropertyPath})})},E.prototype.createKeysForTableInheritance=function(e){e.indices.push(new r.IndexMetadata({entityMetadata:e,columns:[e.discriminatorColumn],args:{target:e.target,unique:!1}}))},E}();exports.EntityMetadataBuilder=v;
},{"tslib":"c4AP","../driver/cockroachdb/CockroachDriver":"mleT","../metadata/EntityMetadata":"Raef","../metadata/ColumnMetadata":"bJDV","../metadata/IndexMetadata":"/SWG","../metadata/RelationMetadata":"NlpZ","../metadata/EmbeddedMetadata":"Z6gZ","../metadata/RelationIdMetadata":"7i6W","../metadata/RelationCountMetadata":"zJZ8","./MetadataUtils":"7r6E","./JunctionEntityMetadataBuilder":"CqIy","./ClosureJunctionEntityMetadataBuilder":"7jrD","./RelationJoinColumnBuilder":"5AW2","../metadata/EntityListenerMetadata":"FZvk","../metadata/UniqueMetadata":"K+ON","../driver/mysql/MysqlDriver":"TOLf","../metadata/CheckMetadata":"mV98","../driver/sqlserver/SqlServerDriver":"sMRg","../driver/postgres/PostgresDriver":"TOLf","../metadata/ExclusionMetadata":"X8nR"}],"Oy9V":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MetadataArgsStorage=void 0;var t=require("../metadata-builder/MetadataUtils"),e=function(){function e(){this.tables=[],this.trees=[],this.entityRepositories=[],this.transactionEntityManagers=[],this.transactionRepositories=[],this.namingStrategies=[],this.entitySubscribers=[],this.indices=[],this.uniques=[],this.checks=[],this.exclusions=[],this.columns=[],this.generations=[],this.relations=[],this.joinColumns=[],this.joinTables=[],this.entityListeners=[],this.relationCounts=[],this.relationIds=[],this.embeddeds=[],this.inheritances=[],this.discriminatorValues=[]}return e.prototype.filterTables=function(t){return this.filterByTarget(this.tables,t)},e.prototype.filterColumns=function(t){return this.filterByTargetAndWithoutDuplicateProperties(this.columns,t)},e.prototype.findGenerated=function(t,e){return this.generations.find(function(r){return(t instanceof Array?-1!==t.indexOf(r.target):r.target===t)&&r.propertyName===e})},e.prototype.findTree=function(t){return this.trees.find(function(e){return t instanceof Array?-1!==t.indexOf(e.target):e.target===t})},e.prototype.filterRelations=function(t){return this.filterByTargetAndWithoutDuplicateProperties(this.relations,t)},e.prototype.filterRelationIds=function(t){return this.filterByTargetAndWithoutDuplicateProperties(this.relationIds,t)},e.prototype.filterRelationCounts=function(t){return this.filterByTargetAndWithoutDuplicateProperties(this.relationCounts,t)},e.prototype.filterIndices=function(t){return this.indices.filter(function(e){return t instanceof Array?-1!==t.indexOf(e.target):e.target===t})},e.prototype.filterUniques=function(t){return this.uniques.filter(function(e){return t instanceof Array?-1!==t.indexOf(e.target):e.target===t})},e.prototype.filterChecks=function(t){return this.checks.filter(function(e){return t instanceof Array?-1!==t.indexOf(e.target):e.target===t})},e.prototype.filterExclusions=function(t){return this.exclusions.filter(function(e){return t instanceof Array?-1!==t.indexOf(e.target):e.target===t})},e.prototype.filterListeners=function(t){return this.filterByTarget(this.entityListeners,t)},e.prototype.filterEmbeddeds=function(t){return this.filterByTargetAndWithoutDuplicateEmbeddedProperties(this.embeddeds,t)},e.prototype.findJoinTable=function(t,e){return this.joinTables.find(function(r){return r.target===t&&r.propertyName===e})},e.prototype.filterJoinColumns=function(t,e){return this.joinColumns.filter(function(r){return r.target===t&&r.propertyName===e})},e.prototype.filterSubscribers=function(t){return this.filterByTarget(this.entitySubscribers,t)},e.prototype.filterNamingStrategies=function(t){return this.filterByTarget(this.namingStrategies,t)},e.prototype.filterTransactionEntityManagers=function(t,e){return this.transactionEntityManagers.filter(function(r){return(t instanceof Array?-1!==t.indexOf(r.target):r.target===t)&&r.methodName===e})},e.prototype.filterTransactionRepository=function(t,e){return this.transactionRepositories.filter(function(r){return(t instanceof Array?-1!==t.indexOf(r.target):r.target===t)&&r.methodName===e})},e.prototype.filterSingleTableChildren=function(e){return this.tables.filter(function(r){return r.target instanceof Function&&e instanceof Function&&t.MetadataUtils.isInherited(r.target,e)&&"entity-child"===r.type})},e.prototype.findInheritanceType=function(t){return this.inheritances.find(function(e){return e.target===t})},e.prototype.findDiscriminatorValue=function(t){return this.discriminatorValues.find(function(e){return e.target===t})},e.prototype.filterByTarget=function(t,e){return t.filter(function(t){return e instanceof Array?-1!==e.indexOf(t.target):t.target===e})},e.prototype.filterByTargetAndWithoutDuplicateProperties=function(t,e){var r=[];return t.forEach(function(t){(e instanceof Array?-1!==e.indexOf(t.target):t.target===e)&&(r.find(function(e){return e.propertyName===t.propertyName})||r.push(t))}),r},e.prototype.filterByTargetAndWithoutDuplicateEmbeddedProperties=function(t,e){var r=[];return t.forEach(function(t){(e instanceof Array?-1!==e.indexOf(t.target):t.target===e)&&(r.find(function(e){return e.prefix===t.prefix&&e.propertyName===t.propertyName})||r.push(t))}),r},e}();exports.MetadataArgsStorage=e;
},{"../metadata-builder/MetadataUtils":"7r6E"}],"UiWk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntitySchemaTransformer=void 0;var e=require("../metadata-args/MetadataArgsStorage"),a=function(){function a(){}return a.prototype.transform=function(a){var n=new e.MetadataArgsStorage;return a.forEach(function(e){var a=e.options,r={target:a.target||a.name,name:a.tableName,database:a.database,schema:a.schema,type:a.type||"regular",orderBy:a.orderBy,synchronize:a.synchronize,expression:a.expression};n.tables.push(r),Object.keys(a.columns).forEach(function(e){var r=a.columns[e],t="regular";r.createDate&&(t="createDate"),r.updateDate&&(t="updateDate"),r.version&&(t="version"),r.treeChildrenCount&&(t="treeChildrenCount"),r.treeLevel&&(t="treeLevel"),r.objectId&&(t="objectId");var o={target:a.target||a.name,mode:t,propertyName:e,options:{type:r.type,name:r.objectId?"_id":r.name,length:r.length,width:r.width,nullable:r.nullable,readonly:r.readonly,update:r.update,select:r.select,insert:r.insert,primary:r.primary,unique:r.unique,comment:r.comment,default:r.default,onUpdate:r.onUpdate,precision:r.precision,scale:r.scale,zerofill:r.zerofill,unsigned:r.unsigned,charset:r.charset,collation:r.collation,enum:r.enum,asExpression:r.asExpression,generatedType:r.generatedType,hstoreType:r.hstoreType,array:r.array,transformer:r.transformer,spatialFeatureType:r.spatialFeatureType,srid:r.srid}};if(n.columns.push(o),r.generated){var s={target:a.target||a.name,propertyName:e,strategy:"string"==typeof r.generated?r.generated:"increment"};n.generations.push(s)}r.unique&&n.uniques.push({target:a.target||a.name,columns:[e]})}),a.relations&&Object.keys(a.relations).forEach(function(e){var r=a.relations[e],t={target:a.target||a.name,propertyName:e,relationType:r.type,isLazy:r.lazy||!1,type:r.target,inverseSideProperty:r.inverseSide,isTreeParent:r.treeParent,isTreeChildren:r.treeChildren,options:{eager:r.eager||!1,cascade:r.cascade,nullable:r.nullable,onDelete:r.onDelete,onUpdate:r.onUpdate,deferrable:r.deferrable,primary:r.primary,persistence:r.persistence}};if(n.relations.push(t),r.joinColumn)if("boolean"==typeof r.joinColumn){var o={target:a.target||a.name,propertyName:e};n.joinColumns.push(o)}else{o={target:a.target||a.name,propertyName:e,name:r.joinColumn.name,referencedColumnName:r.joinColumn.referencedColumnName};n.joinColumns.push(o)}if(r.joinTable)if("boolean"==typeof r.joinTable){var s={target:a.target||a.name,propertyName:e};n.joinTables.push(s)}else{s={target:a.target||a.name,propertyName:e,name:r.joinTable.name,database:r.joinTable.database,schema:r.joinTable.schema,joinColumns:r.joinTable.joinColumn?[r.joinTable.joinColumn]:r.joinTable.joinColumns,inverseJoinColumns:r.joinTable.inverseJoinColumn?[r.joinTable.inverseJoinColumn]:r.joinTable.inverseJoinColumns};n.joinTables.push(s)}}),a.indices&&a.indices.forEach(function(e){var r={target:a.target||a.name,name:e.name,unique:!0===e.unique,spatial:!0===e.spatial,fulltext:!0===e.fulltext,synchronize:!1!==e.synchronize,where:e.where,sparse:e.sparse,columns:e.columns};n.indices.push(r)}),a.uniques&&a.uniques.forEach(function(e){var r={target:a.target||a.name,name:e.name,columns:e.columns};n.uniques.push(r)}),a.checks&&a.checks.forEach(function(e){var r={target:a.target||a.name,name:e.name,expression:e.expression};n.checks.push(r)}),a.exclusions&&a.exclusions.forEach(function(e){var r={target:a.target||a.name,name:e.name,expression:e.expression};n.exclusions.push(r)})}),n},a}();exports.EntitySchemaTransformer=a;
},{"../metadata-args/MetadataArgsStorage":"Oy9V"}],"ZvNi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntitySchema=void 0;var t=function(){return function(t){this.options=t}}();exports.EntitySchema=t;
},{}],"g+iS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConnectionMetadataBuilder=void 0;var e=u(require("tslib")),t=require("../util/DirectoryExportedClassesLoader"),r=require("../util/OrmUtils"),i=require("../container"),n=require("../index"),a=require("../metadata-builder/EntityMetadataBuilder"),o=require("../entity-schema/EntitySchemaTransformer"),s=require("../entity-schema/EntitySchema");function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var c=function(){function u(e){this.connection=e}return u.prototype.buildMigrations=function(n){var a=e.__read(r.OrmUtils.splitClassesAndStrings(n),2),o=a[0],s=a[1];return e.__spread(o,(0,t.importClassesFromDirectories)(s)).map(function(e){return(0,i.getFromContainer)(e)})},u.prototype.buildSubscribers=function(a){var o=e.__read(r.OrmUtils.splitClassesAndStrings(a||[]),2),s=o[0],u=o[1],c=e.__spread(s,(0,t.importClassesFromDirectories)(u));return(0,n.getMetadataArgsStorage)().filterSubscribers(c).map(function(e){return(0,i.getFromContainer)(e.target)})},u.prototype.buildEntityMetadatas=function(i){var u=e.__read(r.OrmUtils.splitClassesAndStrings(i||[]),2),c=u[0],d=u[1],l=c.filter(function(e){return e instanceof s.EntitySchema==!1}),p=c.filter(function(e){return e instanceof s.EntitySchema}),f=e.__spread(l,(0,t.importClassesFromDirectories)(d));f.forEach(function(e){e instanceof s.EntitySchema&&(p.push(e),f.slice(f.indexOf(e),1))});var m=new a.EntityMetadataBuilder(this.connection,(0,n.getMetadataArgsStorage)()).build(f),y=(new o.EntitySchemaTransformer).transform(p),_=new a.EntityMetadataBuilder(this.connection,y).build();return e.__spread(m,_)},u}();exports.ConnectionMetadataBuilder=c;
},{"tslib":"c4AP","../util/DirectoryExportedClassesLoader":"AMB6","../util/OrmUtils":"R//v","../container":"0ey2","../index":"wlNf","../metadata-builder/EntityMetadataBuilder":"dvfJ","../entity-schema/EntitySchemaTransformer":"UiWk","../entity-schema/EntitySchema":"ZvNi"}],"338u":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RawSqlResultsToEntityTransformer=void 0;var r=i(require("tslib")),t=require("../../util/OrmUtils"),n=require("../../metadata/EntityMetadata"),a=require("../../driver/DriverUtils");function i(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var o=function(){function i(e,r,t,n,a){this.expressionMap=e,this.driver=r,this.rawRelationIdResults=t,this.rawRelationCountResults=n,this.queryRunner=a}return i.prototype.transform=function(e,r){var t=this,n=this.group(e,r),a=[];return n.forEach(function(e){var n=t.transformRawResultsGroup(e,r);void 0!==n&&a.push(n)}),a},i.prototype.group=function(t,n){var i=this,o=new Map,u=[];return"view"===n.metadata.tableType?u.push.apply(u,r.__spread(n.metadata.columns.map(function(e){return a.DriverUtils.buildColumnAlias(i.driver,n.name,e.databaseName)}))):u.push.apply(u,r.__spread(n.metadata.primaryColumns.map(function(e){return a.DriverUtils.buildColumnAlias(i.driver,n.name,e.databaseName)}))),t.forEach(function(r){var t=u.map(function(t){var n=r[t];return e.isBuffer(n)?n.toString("hex"):n}).join("_");if(t){var n=o.get(t);n?n.push(r):o.set(t,[r])}}),o},i.prototype.transformRawResultsGroup=function(e,r){var t=this,n=r.metadata;if(n.discriminatorColumn){var i=e.map(function(e){return e[a.DriverUtils.buildColumnAlias(t.driver,r.name,r.metadata.discriminatorColumn.databaseName)]}),o=n.childEntityMetadatas.find(function(e){return!!i.find(function(r){return r===e.discriminatorValue})});o&&(n=o)}var u=-1!==this.expressionMap.options.indexOf("create-pojo")?{}:n.create(this.queryRunner),s=this.transformColumns(e,r,u,n),l=this.transformJoins(e,u,r,n),m=this.transformRelationIds(e,r,u,n),p=this.transformRelationCounts(e,r,u);return s?u:0===n.primaryColumns.filter(function(e){return!1===e.isVirtual}).length&&(l||m||p)?u:void 0},i.prototype.transformColumns=function(e,r,t,n){var i=this,o=!1;return n.columns.forEach(function(u){if(!(n.childEntityMetadatas.length>0&&-1!==n.childEntityMetadatas.map(function(e){return e.target}).indexOf(u.target))){var s=e[0][a.DriverUtils.buildColumnAlias(i.driver,r.name,u.databaseName)];void 0===s||u.isVirtual||i.expressionMap.selects.find(function(e){return e.selection===r.name||e.selection===r.name+"."+u.propertyPath})&&(u.setEntityValue(t,i.driver.prepareHydratedValue(s,u)),null!==s&&(o=!0))}}),o},i.prototype.transformJoins=function(e,r,t,n){var a=this,i=!1;return this.expressionMap.joinAttributes.forEach(function(o){if(o.metadata&&o.isSelected&&(!o.relation||n.relations.find(function(e){return e===o.relation}))){if(o.mapToProperty){if(o.mapToPropertyParentAlias!==t.name)return}else if(!o.relation||o.parentAlias!==t.name||o.relationPropertyPath!==o.relation.propertyPath)return;var u=a.transform(e,o.alias);u=o.isMany?u:u[0],void 0!==(u=o.isMany||void 0!==u?u:null)&&(o.mapToPropertyPropertyName?r[o.mapToPropertyPropertyName]=u:o.relation.setEntityValue(r,u),i=!0)}}),i},i.prototype.transformRelationIds=function(e,r,a,i){var o=this,u=!1;return this.rawRelationIdResults.forEach(function(i){if(i.relationIdAttribute.parentAlias===r.name){var s=i.relationIdAttribute.relation,l=o.createValueMapFromJoinColumns(s,i.relationIdAttribute.parentAlias,e);if(null!=l){var m=i.results.map(function(e){var r=o.extractEntityPrimaryIds(s,e);if(!1!==n.EntityMetadata.compareIds(r,l)){var a,u=(a=s.isManyToOne||s.isOneToOneOwner?s.joinColumns.map(function(e){return e}):s.isOneToMany||s.isOneToOneNotOwner?s.inverseEntityMetadata.primaryColumns.map(function(e){return e}):s.isOwning?s.inverseJoinColumns.map(function(e){return e}):s.inverseRelation.joinColumns.map(function(e){return e})).reduce(function(r,n){var a=e[n.databaseName];return s.isOneToMany||s.isOneToOneNotOwner?(n.referencedColumn&&(a=n.referencedColumn.createValueMap(a)),t.OrmUtils.mergeDeep(r,n.createValueMap(a))):(n.referencedColumn.referencedColumn&&(a=n.referencedColumn.referencedColumn.createValueMap(a)),t.OrmUtils.mergeDeep(r,n.referencedColumn.createValueMap(a)))},{});return 1===a.length&&!1===i.relationIdAttribute.disableMixedMap?s.isOneToMany||s.isOneToOneNotOwner?a[0].getEntityValue(u):a[0].referencedColumn.getEntityValue(u):u}}).filter(function(e){return e}),p=i.relationIdAttribute.mapToPropertyPropertyPath.split("."),f=function(e,r,t){var n=e.shift();return n&&0===e.length?(r[n]=t,r):n&&e.length>0?void f(e,r[n],t):r};s.isOneToOne||s.isManyToOne?void 0!==m[0]&&(f(p,a,m[0]),u=!0):(f(p,a,m),m.length>0&&(u=!0))}}}),u},i.prototype.transformRelationCounts=function(e,r,t){var n=this,i=!1;return this.rawRelationCountResults.filter(function(e){return e.relationCountAttribute.parentAlias===r.name}).forEach(function(o){var u,s=o.relationCountAttribute.relation;u=s.isOneToMany?s.inverseRelation.joinColumns[0].referencedColumn.databaseName:s.isOwning?s.joinColumns[0].referencedColumn.databaseName:s.inverseRelation.joinColumns[0].referencedColumn.databaseName;var l=e[0][a.DriverUtils.buildColumnAlias(n.driver,r.name,u)];null!=l&&(t[o.relationCountAttribute.mapToPropertyPropertyName]=0,o.results.filter(function(e){return e.parentId===l}).forEach(function(e){t[o.relationCountAttribute.mapToPropertyPropertyName]=parseInt(e.cnt),i=!0}))}),i},i.prototype.createValueMapFromJoinColumns=function(e,r,t){var n=this;return(e.isManyToOne||e.isOneToOneOwner?e.entityMetadata.primaryColumns.map(function(e){return e}):e.isOneToMany||e.isOneToOneNotOwner?e.inverseRelation.joinColumns.map(function(e){return e}):e.isOwning?e.joinColumns.map(function(e){return e}):e.inverseRelation.inverseJoinColumns.map(function(e){return e})).reduce(function(i,o){return t.forEach(function(t){e.isManyToOne||e.isOneToOneOwner?i[o.databaseName]=n.driver.prepareHydratedValue(t[a.DriverUtils.buildColumnAlias(n.driver,r,o.databaseName)],o):i[o.databaseName]=n.driver.prepareHydratedValue(t[a.DriverUtils.buildColumnAlias(n.driver,r,o.referencedColumn.databaseName)],o)}),i},{})},i.prototype.extractEntityPrimaryIds=function(e,r){return(e.isManyToOne||e.isOneToOneOwner?e.entityMetadata.primaryColumns.map(function(e){return e}):e.isOneToMany||e.isOneToOneNotOwner?e.inverseRelation.joinColumns.map(function(e){return e}):e.isOwning?e.joinColumns.map(function(e){return e}):e.inverseRelation.inverseJoinColumns.map(function(e){return e})).reduce(function(e,t){return e[t.databaseName]=r[t.databaseName],e},{})},i}();exports.RawSqlResultsToEntityTransformer=o;
},{"tslib":"c4AP","../../util/OrmUtils":"R//v","../../metadata/EntityMetadata":"Raef","../../driver/DriverUtils":"hdhF","buffer":"iHVs"}],"3YMZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PessimisticLockTransactionRequiredError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};i.get||i.set?Object.defineProperty(r,t,i):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(){var e=r.call(this)||this;return e.name="PessimisticLockTransactionRequiredError",Object.setPrototypeOf(e,t.prototype),e.message="An open transaction is required for pessimistic lock.",e}return e.__extends(t,r),t}(Error);exports.PessimisticLockTransactionRequiredError=t;
},{"tslib":"c4AP"}],"E4CT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NoVersionOrUpdateDateColumnError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(e){var o=r.call(this)||this;return o.name="NoVersionOrUpdateDateColumnError",Object.setPrototypeOf(o,t.prototype),o.message="Entity "+e+" does not have version or update date columns.",o}return e.__extends(t,r),t}(Error);exports.NoVersionOrUpdateDateColumnError=t;
},{"tslib":"c4AP"}],"x6IH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OptimisticLockVersionMismatchError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e,i,o){var s=t.call(this)||this;return s.name="OptimisticLockVersionMismatchError",Object.setPrototypeOf(s,r.prototype),s.message="The optimistic lock on entity "+e+" failed, version "+i+" was expected, but is actually "+o+".",s}return e.__extends(r,t),r}(Error);exports.OptimisticLockVersionMismatchError=r;
},{"tslib":"c4AP"}],"HbiY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OptimisticLockCanNotBeUsedError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(){var e=t.call(this)||this;return e.name="OptimisticLockCanNotBeUsedError",Object.setPrototypeOf(e,r.prototype),e.message="The optimistic lock can be used only with getOne() method.",e}return e.__extends(r,t),r}(Error);exports.OptimisticLockCanNotBeUsedError=r;
},{"tslib":"c4AP"}],"fump":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QueryBuilderUtils=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};i.get||i.set?Object.defineProperty(r,t,i):r[t]=e[t]}return r.default=e,r}var t=function(){function r(){}return r.isAliasProperty=function(r){if("string"!=typeof r||-1===r.indexOf("."))return!1;var t=e.__read(r.split("."),2),i=t[0],n=t[1];return!(!i||!n)&&(-1===r.indexOf("(")&&-1===r.indexOf(")"))},r}();exports.QueryBuilderUtils=t;
},{"tslib":"c4AP"}],"xyPr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JoinAttribute=void 0;var t=i(require("tslib")),e=require("./QueryBuilderUtils"),r=require("../util/ObjectUtils");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}var n=function(){function i(t,e,i){this.connection=t,this.queryExpressionMap=e,this.isSelectedEvalueated=!1,this.relationEvalueated=!1,r.ObjectUtils.assign(this,i||{})}return Object.defineProperty(i.prototype,"isMany",{get:function(){return void 0!==this.isMappingMany?this.isMappingMany:!!this.relation&&(this.relation.isManyToMany||this.relation.isOneToMany)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSelected",{get:function(){var e=this;if(!this.isSelectedEvalueated){this.isSelectedCache=function(){var r,i,n=function(t){return t.selection===e.alias.name?{value:!0}:e.metadata&&e.metadata.columns.find(function(r){return t.selection===e.alias.name+"."+r.propertyPath})?{value:!0}:void 0};try{for(var a=t.__values(e.queryExpressionMap.selects),o=a.next();!o.done;o=a.next()){var s=n(o.value);if("object"==typeof s)return s.value}}catch(l){r={error:l}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return!1}(),this.isSelectedEvalueated=!0}return this.isSelectedCache},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tablePath",{get:function(){return this.metadata?this.metadata.tablePath:this.entityOrProperty},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parentAlias",{get:function(){if(e.QueryBuilderUtils.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"relationPropertyPath",{get:function(){if(e.QueryBuilderUtils.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"relation",{get:function(){var t=this;if(!this.relationEvalueated){this.relationCache=function(){if(e.QueryBuilderUtils.isAliasProperty(t.entityOrProperty)){var r=t.queryExpressionMap.findAliasByName(t.parentAlias),i=r.metadata.findRelationWithPropertyPath(t.relationPropertyPath);if(i)return i;if(r.metadata.parentEntityMetadata&&(i=r.metadata.parentEntityMetadata.findRelationWithPropertyPath(t.relationPropertyPath)))return i;throw new Error("Relation with property path "+t.relationPropertyPath+" in entity was not found.")}}.bind(this)(),this.relationEvalueated=!0}return this.relationCache},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"metadata",{get:function(){return this.relation?this.relation.inverseEntityMetadata:this.connection.hasMetadata(this.entityOrProperty)?this.connection.getMetadata(this.entityOrProperty):void 0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"junctionAlias",{get:function(){if(!this.relation)throw new Error("Cannot get junction table for join without relation.");return this.relation.isOwning?this.parentAlias+"_"+this.alias.name:this.alias.name+"_"+this.parentAlias},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mapToPropertyParentAlias",{get:function(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mapToPropertyPropertyName",{get:function(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]},enumerable:!0,configurable:!0}),i}();exports.JoinAttribute=n;
},{"tslib":"c4AP","./QueryBuilderUtils":"fump","../util/ObjectUtils":"41H8"}],"6hXA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationIdAttribute=void 0;var e=i(require("tslib")),t=require("../QueryBuilderUtils"),r=require("../../util/ObjectUtils");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var n=function(){function i(e,t){this.queryExpressionMap=e,this.disableMixedMap=!1,r.ObjectUtils.assign(this,t||{})}return Object.defineProperty(i.prototype,"joinInverseSideMetadata",{get:function(){return this.relation.inverseEntityMetadata},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parentAlias",{get:function(){if(!t.QueryBuilderUtils.isAliasProperty(this.relationName))throw new Error("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"relationPropertyPath",{get:function(){if(!t.QueryBuilderUtils.isAliasProperty(this.relationName))throw new Error("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"relation",{get:function(){if(!t.QueryBuilderUtils.isAliasProperty(this.relationName))throw new Error("Given value must be a string representation of alias property");var e=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!e)throw new Error("Relation with property path "+this.relationPropertyPath+" in entity was not found.");return e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"junctionAlias",{get:function(){var t=e.__read(this.relationName.split("."),2);return t[0]+"_"+t[1]+"_rid"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"junctionMetadata",{get:function(){return this.relation.junctionEntityMetadata},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mapToPropertyParentAlias",{get:function(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mapToPropertyPropertyPath",{get:function(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)},enumerable:!0,configurable:!0}),i}();exports.RelationIdAttribute=n;
},{"tslib":"c4AP","../QueryBuilderUtils":"fump","../../util/ObjectUtils":"41H8"}],"LIRz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationCountAttribute=void 0;var e=i(require("tslib")),t=require("../QueryBuilderUtils"),r=require("../../util/ObjectUtils");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var n=function(){function i(e,t){this.expressionMap=e,r.ObjectUtils.assign(this,t||{})}return Object.defineProperty(i.prototype,"joinInverseSideMetadata",{get:function(){return this.relation.inverseEntityMetadata},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parentAlias",{get:function(){if(!t.QueryBuilderUtils.isAliasProperty(this.relationName))throw new Error("Given value must be a string representation of alias property");return this.relationName.split(".")[0]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"relationProperty",{get:function(){if(!t.QueryBuilderUtils.isAliasProperty(this.relationName))throw new Error("Given value is a string representation of alias property");return this.relationName.split(".")[1]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"junctionAlias",{get:function(){var t=e.__read(this.relationName.split("."),2);return t[0]+"_"+t[1]+"_rc"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"relation",{get:function(){if(!t.QueryBuilderUtils.isAliasProperty(this.relationName))throw new Error("Given value is a string representation of alias property");var r=e.__read(this.relationName.split("."),2),i=r[0],n=r[1],o=this.expressionMap.findAliasByName(i).metadata.findRelationWithPropertyPath(n);if(!o)throw new Error("Relation with property path "+n+" in entity was not found.");return o},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"metadata",{get:function(){if(!t.QueryBuilderUtils.isAliasProperty(this.relationName))throw new Error("Given value is a string representation of alias property");var e=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(e).metadata},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mapToPropertyPropertyName",{get:function(){return this.mapToProperty.split(".")[1]},enumerable:!0,configurable:!0}),i}();exports.RelationCountAttribute=n;
},{"tslib":"c4AP","../QueryBuilderUtils":"fump","../../util/ObjectUtils":"41H8"}],"K3XU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationIdLoader=void 0;var e=t(require("tslib")),r=require("../../driver/DriverUtils");function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var n=function(){function t(e,r,t){this.connection=e,this.queryRunner=r,this.relationIdAttributes=t}return t.prototype.load=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,a=this;return e.__generator(this,function(i){return n=this.relationIdAttributes.map(function(n){return e.__awaiter(a,void 0,void 0,function(){var a,i,o,u,s,d,c,l,p,f,m,y,b,v,h,O,N,j,A,C,w,P=this;return e.__generator(this,function(E){switch(E.label){case 0:if(!n.relation.isManyToOne&&!n.relation.isOneToOneOwner)return[3,1];if(n.queryBuilderFactory)throw new Error("Additional condition can not be used with ManyToOne or OneToOne owner relations.");return w=t.map(function(e){var t={};return n.relation.joinColumns.forEach(function(a){t[a.databaseName]=P.connection.driver.prepareHydratedValue(e[r.DriverUtils.buildColumnAlias(P.connection.driver,n.parentAlias,a.databaseName)],a.referencedColumn)}),n.relation.entityMetadata.primaryColumns.forEach(function(a){t[a.databaseName]=P.connection.driver.prepareHydratedValue(e[r.DriverUtils.buildColumnAlias(P.connection.driver,n.parentAlias,a.databaseName)],a)}),t}),[2,{relationIdAttribute:n,results:w}];case 1:return n.relation.isOneToMany||n.relation.isOneToOneNotOwner?(a=n.relation,i=a.isOwning?a.joinColumns:a.inverseRelation.joinColumns,o=a.inverseEntityMetadata.target,u=a.inverseEntityMetadata.tableName,s=n.alias||u,d={},(A=t.map(function(e,t){return i.map(function(a){var i=a.databaseName+t;return d[i]=e[r.DriverUtils.buildColumnAlias(P.connection.driver,n.parentAlias,a.referencedColumn.databaseName)],s+"."+a.propertyPath+" = :"+i}).join(" AND ")}).map(function(e){return"("+e+")"}).join(" OR "))?(c=this.connection.createQueryBuilder(this.queryRunner),i.forEach(function(e){c.addSelect(s+"."+e.propertyPath,e.databaseName)}),a.inverseRelation.entityMetadata.primaryColumns.forEach(function(e){c.addSelect(s+"."+e.propertyPath,e.databaseName)}),c.from(o,s).where("("+A+")").setParameters(d),n.queryBuilderFactory&&n.queryBuilderFactory(c),[4,c.getRawMany()]):[2,{relationIdAttribute:n,results:[]}]):[3,3];case 2:return(w=E.sent()).forEach(function(e){i.forEach(function(r){e[r.databaseName]=P.connection.driver.prepareHydratedValue(e[r.databaseName],r.referencedColumn)}),a.inverseRelation.entityMetadata.primaryColumns.forEach(function(r){e[r.databaseName]=P.connection.driver.prepareHydratedValue(e[r.databaseName],r)})}),[2,{relationIdAttribute:n,results:w}];case 3:return l=n.relation,p=l.isOwning?l.joinColumns:l.inverseRelation.inverseJoinColumns,f=l.isOwning?l.inverseJoinColumns:l.inverseRelation.joinColumns,m=n.junctionAlias,y=n.joinInverseSideMetadata.tableName,b=n.alias||y,v=l.isOwning?l.junctionEntityMetadata.tableName:l.inverseRelation.junctionEntityMetadata.tableName,0===(h=t.map(function(e){return p.reduce(function(t,a){return t[a.propertyPath]=e[r.DriverUtils.buildColumnAlias(P.connection.driver,n.parentAlias,a.referencedColumn.databaseName)],t},{})})).length?[2,{relationIdAttribute:n,results:[]}]:(O={},N=h.map(function(e,r){return Object.keys(e).map(function(t){var n=t+r;return O[n]=e[t],m+"."+t+" = :"+n}).join(" AND ")}),j=f.map(function(e){return m+"."+e.propertyPath+" = "+b+"."+e.referencedColumn.propertyPath}).join(" AND "),A=N.map(function(e){return"("+e+" AND "+j+")"}).join(" OR "),C=this.connection.createQueryBuilder(this.queryRunner),f.forEach(function(e){C.addSelect(m+"."+e.propertyPath,e.databaseName).addOrderBy(m+"."+e.propertyPath)}),p.forEach(function(e){C.addSelect(m+"."+e.propertyPath,e.databaseName).addOrderBy(m+"."+e.propertyPath)}),C.from(y,b).innerJoin(v,m,A).setParameters(O),n.queryBuilderFactory&&n.queryBuilderFactory(C),[4,C.getRawMany()]);case 4:return(w=E.sent()).forEach(function(r){e.__spread(p,f).forEach(function(e){r[e.databaseName]=P.connection.driver.prepareHydratedValue(r[e.databaseName],e.referencedColumn)})}),[2,{relationIdAttribute:n,results:w}]}})})}),[2,Promise.all(n)]})})},t}();exports.RelationIdLoader=n;
},{"tslib":"c4AP","../../driver/DriverUtils":"hdhF"}],"D79j":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationIdMetadataToAttributeTransformer=void 0;var t=require("./RelationIdAttribute"),e=function(){function e(t){this.expressionMap=t}return e.prototype.transform=function(){var t=this;this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach(function(e){var a=t.metadataToAttribute(t.expressionMap.mainAlias.name,e);t.expressionMap.relationIdAttributes.push(a)}),this.expressionMap.joinAttributes.forEach(function(e){e.metadata&&!e.metadata.isJunction&&e.metadata.relationIds.forEach(function(a){var r=t.metadataToAttribute(e.alias.name,a);t.expressionMap.relationIdAttributes.push(r)})})},e.prototype.metadataToAttribute=function(e,a){return new t.RelationIdAttribute(this.expressionMap,{relationName:e+"."+a.relation.propertyName,mapToProperty:e+"."+a.propertyName,alias:a.alias,queryBuilderFactory:a.queryBuilderFactory})},e}();exports.RelationIdMetadataToAttributeTransformer=e;
},{"./RelationIdAttribute":"6hXA"}],"tF9j":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationCountLoader=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}var n=function(){function t(e,t,n){this.connection=e,this.queryRunner=t,this.relationCountAttributes=n}return t.prototype.load=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r,a=this;return e.__generator(this,function(i){return n=function(e,t,n){return n.indexOf(e)===t},r=this.relationCountAttributes.map(function(r){return e.__awaiter(a,void 0,void 0,function(){var a,i,o,u,l,s,c,d,p,y,f,m,v,b,C,N,h,j;return e.__generator(this,function(e){switch(e.label){case 0:return r.relation.isOneToMany?(a=r.relation,i=a.inverseRelation,o=i.joinColumns[0].referencedColumn.propertyName,u=a.inverseEntityMetadata.target,v=a.inverseEntityMetadata.tableName,b=r.alias||v,l=i.propertyName,0===(f=(f=t.map(function(e){return e[r.parentAlias+"_"+o]}).filter(function(e){return!!e})).filter(n)).length?[2,{relationCountAttribute:r,results:[]}]:((h=this.connection.createQueryBuilder(this.queryRunner)).select(b+"."+l,"parentId").addSelect("COUNT(*)","cnt").from(u,b).where(b+"."+l+" IN (:...ids)").addGroupBy(b+"."+l).setParameter("ids",f),r.queryBuilderFactory&&r.queryBuilderFactory(h),s={relationCountAttribute:r},[4,h.getRawMany()])):[3,2];case 1:return[2,(s.results=e.sent(),s)];case 2:return d=void 0,p=void 0,y=void 0,r.relation.isOwning?(c=r.relation.joinColumns[0].referencedColumn.databaseName,d=r.relation.inverseJoinColumns[0].referencedColumn.databaseName,p=r.relation.junctionEntityMetadata.columns[0],y=r.relation.junctionEntityMetadata.columns[1]):(c=r.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,d=r.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,p=r.relation.junctionEntityMetadata.columns[1],y=r.relation.junctionEntityMetadata.columns[0]),0===(f=(f=t.map(function(e){return e[r.parentAlias+"_"+c]}).filter(function(e){return!!e})).filter(n)).length?[2,{relationCountAttribute:r,results:[]}]:(m=r.junctionAlias,v=r.joinInverseSideMetadata.tableName,b=r.alias||v,C=r.relation.junctionEntityMetadata.tableName,N=m+"."+p.propertyName+" IN ("+f.map(function(e){return isNaN(e)?"'"+e+"'":e})+") AND "+m+"."+y.propertyName+" = "+b+"."+d,(h=this.connection.createQueryBuilder(this.queryRunner)).select(m+"."+p.propertyName,"parentId").addSelect("COUNT("+h.escape(b)+"."+h.escape(d)+")","cnt").from(v,b).innerJoin(C,m,N).addGroupBy(m+"."+p.propertyName),r.queryBuilderFactory&&r.queryBuilderFactory(h),j={relationCountAttribute:r},[4,h.getRawMany()]);case 3:return[2,(j.results=e.sent(),j)]}})})}),[2,Promise.all(r)]})})},t}();exports.RelationCountLoader=n;
},{"tslib":"c4AP"}],"R+xf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationCountMetadataToAttributeTransformer=void 0;var t=require("./RelationCountAttribute"),e=function(){function e(t){this.expressionMap=t}return e.prototype.transform=function(){var t=this;this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach(function(e){var a=t.metadataToAttribute(t.expressionMap.mainAlias.name,e);t.expressionMap.relationCountAttributes.push(a)}),this.expressionMap.joinAttributes.forEach(function(e){e.metadata&&!e.metadata.isJunction&&e.metadata.relationCounts.forEach(function(a){var r=t.metadataToAttribute(e.alias.name,a);t.expressionMap.relationCountAttributes.push(r)})})},e.prototype.metadataToAttribute=function(e,a){return new t.RelationCountAttribute(this.expressionMap,{relationName:e+"."+a.relation.propertyName,mapToProperty:e+"."+a.propertyName,alias:a.alias,queryBuilderFactory:a.queryBuilderFactory})},e}();exports.RelationCountMetadataToAttributeTransformer=e;
},{"./RelationCountAttribute":"LIRz"}],"iHNO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Alias=void 0;var t=require("../util/ObjectUtils"),e=function(){function e(e){t.ObjectUtils.assign(this,e||{})}return Object.defineProperty(e.prototype,"target",{get:function(){return this.metadata.target},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasMetadata",{get:function(){return!!this._metadata},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){if(!this._metadata)throw new Error('Cannot get entity metadata for the given alias "'+this.name+'"');return this._metadata},set:function(t){this._metadata=t},enumerable:!0,configurable:!0}),e}();exports.Alias=e;
},{"../util/ObjectUtils":"41H8"}],"lz25":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QueryExpressionMap=void 0;var t=a(require("tslib")),e=require("./Alias"),i=require("./JoinAttribute"),n=require("./relation-id/RelationIdAttribute"),r=require("./relation-count/RelationCountAttribute");function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};n.get||n.set?Object.defineProperty(e,i,n):e[i]=t[i]}return e.default=t,e}var s=function(){function a(t){this.connection=t,this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.cache=!1,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={}}return Object.defineProperty(a.prototype,"allOrderBys",{get:function(){var t=this;if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&-1===this.options.indexOf("disable-global-order")){var e=this.mainAlias.metadata.orderBy||{};return Object.keys(e).reduce(function(i,n){return i[t.mainAlias.name+"."+n]=e[n],i},{})}return this.orderBys},enumerable:!0,configurable:!0}),a.prototype.setMainAlias=function(t){return this.mainAlias=t,t},a.prototype.createAlias=function(t){var i=t.name;!i&&t.tablePath&&(i=t.tablePath),!i&&t.target instanceof Function&&(i=t.target.name),i||"string"!=typeof t.target||(i=t.target);var n=new e.Alias;return n.type=t.type,i&&(n.name=i),t.metadata&&(n.metadata=t.metadata),t.target&&!n.hasMetadata&&(n.metadata=this.connection.getMetadata(t.target)),t.tablePath&&(n.tablePath=t.tablePath),t.subQuery&&(n.subQuery=t.subQuery),this.aliases.push(n),n},a.prototype.findAliasByName=function(t){var e=this.aliases.find(function(e){return e.name===t});if(!e)throw new Error('"'+t+'" alias was not found. Maybe you forgot to join it?');return e},a.prototype.findColumnByAliasExpression=function(e){var i=t.__read(e.split("."),2),n=i[0],r=i[1];return this.findAliasByName(n).metadata.findColumnWithPropertyName(r)},Object.defineProperty(a.prototype,"relationMetadata",{get:function(){if(!this.mainAlias)throw new Error("Entity to work with is not specified!");var t=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new Error("Relation "+this.relationPropertyPath+" was not found in entity "+this.mainAlias.name);return t},enumerable:!0,configurable:!0}),a.prototype.clone=function(){var s=this,o=new a(this.connection);return o.queryType=this.queryType,o.selects=this.selects.map(function(t){return t}),this.aliases.forEach(function(t){return o.aliases.push(new e.Alias(t))}),o.mainAlias=this.mainAlias,o.valuesSet=this.valuesSet,o.returning=this.returning,o.onConflict=this.onConflict,o.onIgnore=this.onIgnore,o.onUpdate=this.onUpdate,o.joinAttributes=this.joinAttributes.map(function(t){return new i.JoinAttribute(s.connection,s,t)}),o.relationIdAttributes=this.relationIdAttributes.map(function(t){return new n.RelationIdAttribute(s,t)}),o.relationCountAttributes=this.relationCountAttributes.map(function(t){return new r.RelationCountAttribute(s,t)}),o.wheres=this.wheres.map(function(e){return t.__assign({},e)}),o.havings=this.havings.map(function(e){return t.__assign({},e)}),o.orderBys=Object.assign({},this.orderBys),o.groupBys=this.groupBys.map(function(t){return t}),o.limit=this.limit,o.offset=this.offset,o.skip=this.skip,o.take=this.take,o.lockMode=this.lockMode,o.lockVersion=this.lockVersion,o.parameters=Object.assign({},this.parameters),o.disableEscaping=this.disableEscaping,o.enableRelationIdValues=this.enableRelationIdValues,o.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,o.subQuery=this.subQuery,o.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,o.cache=this.cache,o.cacheId=this.cacheId,o.cacheDuration=this.cacheDuration,o.relationPropertyPath=this.relationPropertyPath,o.of=this.of,o.insertColumns=this.insertColumns,o.whereEntities=this.whereEntities,o.updateEntity=this.updateEntity,o.callListeners=this.callListeners,o.useTransaction=this.useTransaction,o.nativeParameters=Object.assign({},this.nativeParameters),o},a}();exports.QueryExpressionMap=s;
},{"tslib":"c4AP","./Alias":"iHNO","./JoinAttribute":"xyPr","./relation-id/RelationIdAttribute":"6hXA","./relation-count/RelationCountAttribute":"LIRz"}],"d1r/":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Brackets=void 0;var e=function(){return function(e){this.whereFactory=e}}();exports.Brackets=e;
},{}],"3fkF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.In=r;var e=require("../FindOperator");function r(r){return new e.FindOperator("in",r,!0,!0)}
},{"../FindOperator":"YWTi"}],"lntw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InsertResult=void 0;var e=function(){return function(){this.identifiers=[],this.generatedMaps=[]}}();exports.InsertResult=e;
},{}],"3NnL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReturningStatementNotSupportedError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(){var e=r.call(this)||this;return e.name="ReturningStatementNotSupportedError",Object.setPrototypeOf(e,t.prototype),e.message="OUTPUT or RETURNING clause only supported by Microsoft SQL Server or PostgreSQL databases.",e}return e.__extends(t,r),t}(Error);exports.ReturningStatementNotSupportedError=t;
},{"tslib":"c4AP"}],"rwK1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InsertValuesMissingError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};s.get||s.set?Object.defineProperty(r,t,s):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(){var e=r.call(this)||this;return e.name="InsertValuesMissingError",Object.setPrototypeOf(e,t.prototype),e.message='Cannot perform insert query because values are not defined. Call "qb.values(...)" method to specify inserted values.',e}return e.__extends(t,r),t}(Error);exports.InsertValuesMissingError=t;
},{"tslib":"c4AP"}],"Xp0z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReturningResultsEntityUpdator=void 0;var e=n(require("tslib")),r=require("../util/OrmUtils"),t=require("../driver/oracle/OracleDriver");function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var a=function(){function n(e,r){this.queryRunner=e,this.expressionMap=r}return n.prototype.update=function(r,n){return e.__awaiter(this,void 0,void 0,function(){var a,i=this;return e.__generator(this,function(u){switch(u.label){case 0:return a=this.expressionMap.mainAlias.metadata,[4,Promise.all(n.map(function(n,u){return e.__awaiter(i,void 0,void 0,function(){var i,s,o,c,p=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.queryRunner.connection.driver.isReturningSqlSupported()?(this.queryRunner.connection.driver instanceof t.OracleDriver&&r.raw instanceof Array&&this.expressionMap.extraReturningColumns.length>0&&(r.raw=r.raw.reduce(function(e,r,t){return e[p.expressionMap.extraReturningColumns[t].databaseName]=r[0],e},{})),i=r.raw instanceof Array?r.raw[u]:r.raw,(s=this.queryRunner.connection.driver.createGeneratedMap(a,i))&&(this.queryRunner.manager.merge(a.target,n,s),r.generatedMaps.push(s)),[3,3]):[3,1];case 1:if(!(this.getUpdationReturningColumns().length>0))return[3,3];if(!(o=this.expressionMap.mainAlias.metadata.getEntityIdMap(n)))throw new Error("Cannot update entity because entity id is not set in the entity.");return[4,this.queryRunner.manager.createQueryBuilder().select(a.primaryColumns.map(function(e){return a.targetName+"."+e.propertyPath})).addSelect(this.getUpdationReturningColumns().map(function(e){return a.targetName+"."+e.propertyPath})).from(a.target,a.targetName).where(o).setOption("create-pojo").getOne()];case 2:(c=e.sent())&&(this.queryRunner.manager.merge(a.target,n,c),r.generatedMaps.push(c)),e.label=3;case 3:return[2]}})})}))];case 1:return u.sent(),[2]}})})},n.prototype.insert=function(n,a){return e.__awaiter(this,void 0,void 0,function(){var i,u,s,o=this;return e.__generator(this,function(c){switch(c.label){case 0:return i=this.expressionMap.mainAlias.metadata,u=this.getInsertionReturningColumns(),s=a.map(function(e,a){o.queryRunner.connection.driver instanceof t.OracleDriver&&n.raw instanceof Array&&o.expressionMap.extraReturningColumns.length>0&&(n.raw=n.raw.reduce(function(e,r,t){return e[o.expressionMap.extraReturningColumns[t].databaseName]=r[0],e},{}));var u=n.raw instanceof Array?n.raw[a]:n.raw,s=o.queryRunner.connection.driver.createGeneratedMap(i,u)||{};return!1===o.queryRunner.connection.driver.isUUIDGenerationSupported()&&i.generatedColumns.forEach(function(t){if("uuid"===t.generationStrategy){var n=t.getEntityValue(e);n||(n=o.expressionMap.nativeParameters["uuid_"+t.databaseName+a]),r.OrmUtils.mergeDeep(s,t.createValueMap(n))}}),o.queryRunner.manager.merge(i.target,e,s),s}),!1===this.queryRunner.connection.driver.isReturningSqlSupported()&&u.length>0?[4,Promise.all(a.map(function(r,t){return e.__awaiter(o,void 0,void 0,function(){var n,a;return e.__generator(this,function(e){switch(e.label){case 0:return n=i.getEntityIdMap(r),[4,this.queryRunner.manager.createQueryBuilder().select(i.primaryColumns.map(function(e){return i.targetName+"."+e.propertyPath})).addSelect(u.map(function(e){return i.targetName+"."+e.propertyPath})).from(i.target,i.targetName).where(n).setOption("create-pojo").getOne()];case 1:return a=e.sent(),this.queryRunner.manager.merge(i.target,s[t],a),[2]}})})}))]:[3,2];case 1:c.sent(),c.label=2;case 2:return a.forEach(function(e,r){var t=i.getEntityIdMap(e);n.identifiers.push(t),n.generatedMaps.push(s[r]),o.queryRunner.manager.merge(o.expressionMap.mainAlias.metadata.target,e,s[r],s[r])}),[2]}})})},n.prototype.getInsertionReturningColumns=function(){var e=this.queryRunner.connection.driver.isReturningSqlSupported();return this.expressionMap.mainAlias.metadata.columns.filter(function(r){return void 0!==r.default||e&&r.isGenerated||r.isCreateDate||r.isUpdateDate||r.isVersion})},n.prototype.getUpdationReturningColumns=function(){return this.expressionMap.mainAlias.metadata.columns.filter(function(e){return e.isUpdateDate||e.isVersion})},n}();exports.ReturningResultsEntityUpdator=a;
},{"tslib":"c4AP","../util/OrmUtils":"R//v","../driver/oracle/OracleDriver":"l9nz"}],"Hxxx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InsertQueryBuilder=void 0;var e=m(require("tslib")),r=require("../driver/cockroachdb/CockroachDriver"),t=require("./QueryBuilder"),n=require("../driver/sqlserver/SqlServerDriver"),i=require("../driver/postgres/PostgresDriver"),s=require("../driver/mysql/MysqlDriver"),a=require("../util/RandomGenerator"),o=require("./result/InsertResult"),c=require("../error/ReturningStatementNotSupportedError"),p=require("../error/InsertValuesMissingError"),u=require("./ReturningResultsEntityUpdator"),l=require("../driver/sqlite-abstract/AbstractSqliteDriver"),v=require("../driver/sqljs/SqljsDriver"),h=require("../subscriber/BroadcasterResult"),d=require("../"),f=require("../driver/oracle/OracleDriver");function m(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var M=function(t){function m(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(m,t),m.prototype.getQuery=function(){return this.createInsertExpression().trim()},m.prototype.execute=function(){return e.__awaiter(this,void 0,void 0,function(){var r,t,n,i,s,a,c,p,l,d,f,m,M=this;return e.__generator(this,function(x){switch(x.label){case 0:r=this.obtainQueryRunner(),t=!1,x.label=1;case 1:return x.trys.push([1,13,18,23]),!0!==this.expressionMap.useTransaction||!1!==r.isTransactionActive?[3,3]:[4,r.startTransaction()];case 2:x.sent(),t=!0,x.label=3;case 3:return n=this.getValueSets(),!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(i=new h.BroadcasterResult,n.forEach(function(e){r.broadcaster.broadcastBeforeInsertEvent(i,M.expressionMap.mainAlias.metadata,e)}),i.promises.length>0?[4,Promise.all(i.promises)]:[3,5]):[3,5];case 4:x.sent(),x.label=5;case 5:return s=new u.ReturningResultsEntityUpdator(r,this.expressionMap),!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.extraReturningColumns=s.getInsertionReturningColumns()),a=e.__read(this.getQueryAndParameters(),2),c=a[0],p=a[1],l=new o.InsertResult,d=l,[4,r.query(c,p)];case 6:return d.raw=x.sent(),!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata?[4,s.insert(l,n)]:[3,8];case 7:x.sent(),x.label=8;case 8:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(f=new h.BroadcasterResult,n.forEach(function(e){r.broadcaster.broadcastAfterInsertEvent(f,M.expressionMap.mainAlias.metadata,e)}),f.promises.length>0?[4,Promise.all(f.promises)]:[3,10]):[3,10];case 9:x.sent(),x.label=10;case 10:return t?[4,r.commitTransaction()]:[3,12];case 11:x.sent(),x.label=12;case 12:return[2,l];case 13:if(m=x.sent(),!t)return[3,17];x.label=14;case 14:return x.trys.push([14,16,,17]),[4,r.rollbackTransaction()];case 15:return x.sent(),[3,17];case 16:return x.sent(),[3,17];case 17:throw m;case 18:return r===this.queryRunner?[3,20]:[4,r.release()];case 19:x.sent(),x.label=20;case 20:return this.connection.driver instanceof v.SqljsDriver&&!r.isTransactionActive?[4,this.connection.driver.autoSave()]:[3,22];case 21:x.sent(),x.label=22;case 22:return[7];case 23:return[2]}})})},m.prototype.into=function(e,r){e=e instanceof d.EntitySchema?e.options.name:e;var t=this.createFromAlias(e);return this.expressionMap.setMainAlias(t),this.expressionMap.insertColumns=r||[],this},m.prototype.values=function(e){return this.expressionMap.valuesSet=e,this},m.prototype.output=function(e){return this.returning(e)},m.prototype.returning=function(e){if(!this.connection.driver.isReturningSqlSupported())throw new c.ReturningStatementNotSupportedError;return this.expressionMap.returning=e,this},m.prototype.updateEntity=function(e){return this.expressionMap.updateEntity=e,this},m.prototype.onConflict=function(e){return this.expressionMap.onConflict=e,this},m.prototype.orIgnore=function(e){return void 0===e&&(e=!0),this.expressionMap.onIgnore=e,this},m.prototype.orUpdate=function(e){return this.expressionMap.onUpdate={},e&&e.conflict_target instanceof Array&&(this.expressionMap.onUpdate.conflict=" ( "+e.conflict_target.join(", ")+" ) "),e&&"string"==typeof e.conflict_target&&(this.expressionMap.onUpdate.conflict=" ON CONSTRAINT "+e.conflict_target+" "),e&&e.columns instanceof Array&&(this.expressionMap.onUpdate.columns=e.columns.map(function(e){return e+" = :"+e}).join(", ")),e&&e.overwrite instanceof Array&&(this.connection.driver instanceof s.MysqlDriver?this.expressionMap.onUpdate.overwrite=e.overwrite.map(function(e){return e+" = VALUES("+e+")"}).join(", "):(this.connection.driver instanceof i.PostgresDriver||this.connection.driver instanceof l.AbstractSqliteDriver)&&(this.expressionMap.onUpdate.overwrite=e.overwrite.map(function(e){return e+" = EXCLUDED."+e}).join(", "))),this},m.prototype.createInsertExpression=function(){var e=this.getTableName(this.getMainTableName()),t=this.createValuesExpression(),a=this.createReturningExpression(),o=this.createColumnNamesExpression(),c="INSERT ";if(this.connection.driver instanceof s.MysqlDriver&&(c+=this.expressionMap.onIgnore?" IGNORE ":""),c+="INTO "+e,o?c+="("+o+")":!t&&this.connection.driver instanceof s.MysqlDriver&&(c+="()"),a&&this.connection.driver instanceof n.SqlServerDriver&&(c+=" OUTPUT "+a),t?c+=" VALUES "+t:this.connection.driver instanceof s.MysqlDriver?c+=" VALUES ()":c+=" DEFAULT VALUES",this.connection.driver instanceof i.PostgresDriver||this.connection.driver instanceof l.AbstractSqliteDriver){if(c+=this.expressionMap.onIgnore?" ON CONFLICT DO NOTHING ":"",c+=this.expressionMap.onConflict?" ON CONFLICT "+this.expressionMap.onConflict:"",this.expressionMap.onUpdate){var p=this.expressionMap.onUpdate,u=p.overwrite,v=p.columns,h=p.conflict;c+=v?" ON CONFLICT "+h+" DO UPDATE SET "+v:"",c+=u?" ON CONFLICT "+h+" DO UPDATE SET "+u:""}}else if(this.connection.driver instanceof s.MysqlDriver&&this.expressionMap.onUpdate){var d=this.expressionMap.onUpdate;u=d.overwrite;c+=(v=d.columns)?" ON DUPLICATE KEY UPDATE "+v:"",c+=u?" ON DUPLICATE KEY UPDATE "+u:""}return a&&(this.connection.driver instanceof i.PostgresDriver||this.connection.driver instanceof f.OracleDriver||this.connection.driver instanceof r.CockroachDriver)&&(c+=" RETURNING "+a),c},m.prototype.getInsertedColumns=function(){var e=this;return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.columns.filter(function(r){return e.expressionMap.insertColumns.length?-1!==e.expressionMap.insertColumns.indexOf(r.propertyPath):!!r.isInsert&&(!r.isGenerated||"increment"!==r.generationStrategy||e.connection.driver instanceof f.OracleDriver||e.connection.driver instanceof l.AbstractSqliteDriver||e.connection.driver instanceof s.MysqlDriver)}):[]},m.prototype.createColumnNamesExpression=function(){var e=this,r=this.getInsertedColumns();if(r.length>0)return r.map(function(r){return e.escape(r.databaseName)}).join(", ");if(!this.expressionMap.mainAlias.hasMetadata&&!this.expressionMap.insertColumns.length){var t=this.getValueSets();if(1===t.length)return Object.keys(t[0]).map(function(r){return e.escape(r)}).join(", ")}return this.expressionMap.insertColumns.map(function(r){return e.escape(r)}).join(", ")},m.prototype.createValuesExpression=function(){var e=this,r=this.getValueSets(),t=this.getInsertedColumns();if(t.length>0){var o="",c=Object.keys(this.expressionMap.nativeParameters).length;return r.forEach(function(p,u){t.forEach(function(v,h){0===h&&(o+="(");var d="i"+u+"_"+v.databaseName,f=v.getEntityValue(p);if(f=e.connection.driver.preparePersistentValue(f,v),v.isVersion)o+="1";else if(v.isDiscriminator)e.expressionMap.nativeParameters["discriminator_value_"+c]=e.expressionMap.mainAlias.metadata.discriminatorValue,o+=e.connection.driver.createParameter("discriminator_value_"+c,c),c++;else if(v.isGenerated&&"uuid"===v.generationStrategy&&!e.connection.driver.isUUIDGenerationSupported()&&void 0===f){var m="uuid_"+v.databaseName+u;f=a.RandomGenerator.uuid4(),e.expressionMap.nativeParameters[m]=f,o+=e.connection.driver.createParameter(m,c),c++}else void 0===f?e.connection.driver instanceof l.AbstractSqliteDriver?void 0!==v.default?o+=e.connection.driver.normalizeDefault(v):o+="NULL":o+="DEFAULT":f instanceof Function?o+=f():(e.connection.driver instanceof n.SqlServerDriver&&(f=e.connection.driver.parametrizeValue(v,f)),e.expressionMap.nativeParameters[d]=f,e.connection.driver instanceof s.MysqlDriver&&-1!==e.connection.driver.spatialTypes.indexOf(v.type)?o+="GeomFromText("+e.connection.driver.createParameter(d,c)+")":e.connection.driver instanceof i.PostgresDriver&&-1!==e.connection.driver.spatialTypes.indexOf(v.type)?null!=v.srid?o+="ST_SetSRID(ST_GeomFromGeoJSON("+e.connection.driver.createParameter(d,c)+"), "+v.srid+")::"+v.type:o+="ST_GeomFromGeoJSON("+e.connection.driver.createParameter(d,c)+")::"+v.type:o+=e.connection.driver.createParameter(d,c),c++);h===t.length-1?u===r.length-1?o+=")":o+="), ":o+=", "})}),"()"===o?"":o}var p="",u=Object.keys(this.expressionMap.nativeParameters).length;return r.forEach(function(t,n){Object.keys(t).forEach(function(i,s){0===s&&(p+="(");var a="i"+n+"_"+i,o=t[i];o instanceof Function?p+=o():void 0===o?e.connection.driver instanceof l.AbstractSqliteDriver?p+="NULL":p+="DEFAULT":(e.expressionMap.nativeParameters[a]=o,p+=e.connection.driver.createParameter(a,u),u++),s===Object.keys(t).length-1?n===r.length-1?p+=")":p+="), ":p+=", "})}),"()"===p?"":p},m.prototype.getValueSets=function(){if(this.expressionMap.valuesSet instanceof Array&&this.expressionMap.valuesSet.length>0)return this.expressionMap.valuesSet;if(this.expressionMap.valuesSet instanceof Object)return[this.expressionMap.valuesSet];throw new p.InsertValuesMissingError},m}(t.QueryBuilder);exports.InsertQueryBuilder=M;
},{"tslib":"c4AP","../driver/cockroachdb/CockroachDriver":"mleT","./QueryBuilder":"KIjK","../driver/sqlserver/SqlServerDriver":"sMRg","../driver/postgres/PostgresDriver":"TOLf","../driver/mysql/MysqlDriver":"TOLf","../util/RandomGenerator":"TvFb","./result/InsertResult":"lntw","../error/ReturningStatementNotSupportedError":"3NnL","../error/InsertValuesMissingError":"rwK1","./ReturningResultsEntityUpdator":"Xp0z","../driver/sqlite-abstract/AbstractSqliteDriver":"1srY","../driver/sqljs/SqljsDriver":"qCTI","../subscriber/BroadcasterResult":"thBa","../":"wlNf","../driver/oracle/OracleDriver":"l9nz"}],"Ukf1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UpdateResult=void 0;var e=function(){return function(){this.generatedMaps=[]}}();exports.UpdateResult=e;
},{}],"JVGN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LimitOnUpdateNotSupportedError=void 0;var t=e(require("tslib"));function e(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};o.get||o.set?Object.defineProperty(e,r,o):e[r]=t[r]}return e.default=t,e}var r=function(e){function r(){var t=e.call(this)||this;return t.name="LimitOnUpdateNotSupportedError",Object.setPrototypeOf(t,r.prototype),t.message="Your database does not support LIMIT on UPDATE statements.",t}return t.__extends(r,e),r}(Error);exports.LimitOnUpdateNotSupportedError=r;
},{"tslib":"c4AP"}],"PzDV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UpdateValuesMissingError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(){var e=r.call(this)||this;return e.name="UpdateValuesMissingError",Object.setPrototypeOf(e,t.prototype),e.message='Cannot perform update query because update values are not defined. Call "qb.set(...)" method to specify updated values.',e}return e.__extends(t,r),t}(Error);exports.UpdateValuesMissingError=t;
},{"tslib":"c4AP"}],"dVyF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityColumnNotFound=void 0;var t=e(require("tslib"));function e(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};o.get||o.set?Object.defineProperty(e,r,o):e[r]=t[r]}return e.default=t,e}var r=function(e){function r(t){var o=e.call(this)||this;return o.name="EntityColumnNotFound",Object.setPrototypeOf(o,r.prototype),o.message='No entity column "'+t+'" was found.',o}return t.__extends(r,e),r}(Error);exports.EntityColumnNotFound=r;
},{"tslib":"c4AP"}],"Z6U/":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UpdateQueryBuilder=void 0;var e=f(require("tslib")),r=require("../driver/cockroachdb/CockroachDriver"),t=require("./QueryBuilder"),i=require("../driver/sqlserver/SqlServerDriver"),n=require("../driver/postgres/PostgresDriver"),s=require("../metadata/EntityMetadata"),a=require("./result/UpdateResult"),o=require("../error/ReturningStatementNotSupportedError"),c=require("./ReturningResultsEntityUpdator"),p=require("../driver/sqljs/SqljsDriver"),u=require("../driver/mysql/MysqlDriver"),h=require("../subscriber/BroadcasterResult"),d=require("../driver/sqlite-abstract/AbstractSqliteDriver"),l=require("../error/LimitOnUpdateNotSupportedError"),v=require("../driver/oracle/OracleDriver"),m=require("../error/UpdateValuesMissingError"),y=require("../error/EntityColumnNotFound");function f(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};i.get||i.set?Object.defineProperty(r,t,i):r[t]=e[t]}return r.default=e,r}var M=function(t){function f(e,r){var i=t.call(this,e,r)||this;return i.expressionMap.aliasNamePrefixingEnabled=!1,i}return e.__extends(f,t),f.prototype.getQuery=function(){var e=this.createUpdateExpression();return e+=this.createOrderByExpression(),(e+=this.createLimitExpression()).trim()},f.prototype.execute=function(){return e.__awaiter(this,void 0,void 0,function(){var r,t,i,n,s,o,u,d,l,v;return e.__generator(this,function(m){switch(m.label){case 0:r=this.obtainQueryRunner(),t=!1,m.label=1;case 1:return m.trys.push([1,13,18,23]),!0!==this.expressionMap.useTransaction||!1!==r.isTransactionActive?[3,3]:[4,r.startTransaction()];case 2:m.sent(),t=!0,m.label=3;case 3:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(l=new h.BroadcasterResult,r.broadcaster.broadcastBeforeUpdateEvent(l,this.expressionMap.mainAlias.metadata),l.promises.length>0?[4,Promise.all(l.promises)]:[3,5]):[3,5];case 4:m.sent(),m.label=5;case 5:return i=new c.ReturningResultsEntityUpdator(r,this.expressionMap),!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=i.getUpdationReturningColumns()),n=e.__read(this.getQueryAndParameters(),2),s=n[0],o=n[1],u=new a.UpdateResult,d=u,[4,r.query(s,o)];case 6:return d.raw=m.sent(),!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0?[4,i.update(u,this.expressionMap.whereEntities)]:[3,8];case 7:m.sent(),m.label=8;case 8:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(l=new h.BroadcasterResult,r.broadcaster.broadcastAfterUpdateEvent(l,this.expressionMap.mainAlias.metadata),l.promises.length>0?[4,Promise.all(l.promises)]:[3,10]):[3,10];case 9:m.sent(),m.label=10;case 10:return t?[4,r.commitTransaction()]:[3,12];case 11:m.sent(),m.label=12;case 12:return[2,u];case 13:if(v=m.sent(),!t)return[3,17];m.label=14;case 14:return m.trys.push([14,16,,17]),[4,r.rollbackTransaction()];case 15:return m.sent(),[3,17];case 16:return m.sent(),[3,17];case 17:throw v;case 18:return r===this.queryRunner?[3,20]:[4,r.release()];case 19:m.sent(),m.label=20;case 20:return this.connection.driver instanceof p.SqljsDriver&&!r.isTransactionActive?[4,this.connection.driver.autoSave()]:[3,22];case 21:m.sent(),m.label=22;case 22:return[7];case 23:return[2]}})})},f.prototype.set=function(e){return this.expressionMap.valuesSet=e,this},f.prototype.where=function(e,r){this.expressionMap.wheres=[];var t=this.computeWhereParameter(e);return t&&(this.expressionMap.wheres=[{type:"simple",condition:t}]),r&&this.setParameters(r),this},f.prototype.andWhere=function(e,r){return this.expressionMap.wheres.push({type:"and",condition:this.computeWhereParameter(e)}),r&&this.setParameters(r),this},f.prototype.orWhere=function(e,r){return this.expressionMap.wheres.push({type:"or",condition:this.computeWhereParameter(e)}),r&&this.setParameters(r),this},f.prototype.whereInIds=function(e){return this.where(this.createWhereIdsExpression(e))},f.prototype.andWhereInIds=function(e){return this.andWhere(this.createWhereIdsExpression(e))},f.prototype.orWhereInIds=function(e){return this.orWhere(this.createWhereIdsExpression(e))},f.prototype.output=function(e){return this.returning(e)},f.prototype.returning=function(e){if(!this.connection.driver.isReturningSqlSupported())throw new o.ReturningStatementNotSupportedError;return this.expressionMap.returning=e,this},f.prototype.orderBy=function(e,r,t){var i,n;return void 0===r&&(r="ASC"),e?e instanceof Object?this.expressionMap.orderBys=e:this.expressionMap.orderBys=t?((i={})[e]={order:r,nulls:t},i):((n={})[e]=r,n):this.expressionMap.orderBys={},this},f.prototype.addOrderBy=function(e,r,t){return void 0===r&&(r="ASC"),this.expressionMap.orderBys[e]=t?{order:r,nulls:t}:r,this},f.prototype.limit=function(e){return this.expressionMap.limit=e,this},f.prototype.whereEntity=function(e){var r=this;if(!this.expressionMap.mainAlias.hasMetadata)throw new Error(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];var t=e instanceof Array?e:[e];return t.forEach(function(e){var t=r.expressionMap.mainAlias.metadata.getEntityIdMap(e);if(!t)throw new Error("Provided entity does not have ids set, cannot perform operation.");r.orWhereInIds(t)}),this.expressionMap.whereEntities=t,this},f.prototype.updateEntity=function(e){return this.expressionMap.updateEntity=e,this},f.prototype.createUpdateExpression=function(){var e=this,t=this.getValueSet(),a=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0,o=[],c={},p=this.connection.driver instanceof u.MysqlDriver||this.connection.driver instanceof v.OracleDriver||this.connection.driver instanceof d.AbstractSqliteDriver?0:Object.keys(this.expressionMap.nativeParameters).length;if(a?(s.EntityMetadata.createPropertyPath(a,t).forEach(function(r){var s=a.findColumnsWithPropertyPath(r);if(s.length<=0)throw new y.EntityColumnNotFound(r);s.forEach(function(r){if(r.isUpdate){var s="upd_"+r.databaseName,a=r.getEntityValue(t);if(r.referencedColumn&&a instanceof Object?a=r.referencedColumn.getEntityValue(a):a instanceof Function||(a=e.connection.driver.preparePersistentValue(a,r)),a instanceof Function)o.push(e.escape(r.databaseName)+" = "+a());else{e.connection.driver instanceof i.SqlServerDriver&&(a=e.connection.driver.parametrizeValue(r,a)),e.connection.driver instanceof u.MysqlDriver||e.connection.driver instanceof v.OracleDriver||e.connection.driver instanceof d.AbstractSqliteDriver?c[s]=a:e.expressionMap.nativeParameters[s]=a;var h=null;h=e.connection.driver instanceof u.MysqlDriver&&-1!==e.connection.driver.spatialTypes.indexOf(r.type)?"GeomFromText("+e.connection.driver.createParameter(s,p)+")":e.connection.driver instanceof n.PostgresDriver&&-1!==e.connection.driver.spatialTypes.indexOf(r.type)?null!=r.srid?"ST_SetSRID(ST_GeomFromGeoJSON("+e.connection.driver.createParameter(s,p)+"), "+r.srid+")::"+r.type:"ST_GeomFromGeoJSON("+e.connection.driver.createParameter(s,p)+")::"+r.type:e.connection.driver.createParameter(s,p),o.push(e.escape(r.databaseName)+" = "+h),p++}}})}),a.versionColumn&&o.push(this.escape(a.versionColumn.databaseName)+" = "+this.escape(a.versionColumn.databaseName)+" + 1"),a.updateDateColumn&&o.push(this.escape(a.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP")):Object.keys(t).map(function(r){var i=t[r];i instanceof Function?o.push(e.escape(r)+" = "+i()):(e.connection.driver instanceof u.MysqlDriver||e.connection.driver instanceof v.OracleDriver||e.connection.driver instanceof d.AbstractSqliteDriver?c[r]=i:e.expressionMap.nativeParameters[r]=i,o.push(e.escape(r)+" = "+e.connection.driver.createParameter(r,p)),p++)}),o.length<=0)throw new m.UpdateValuesMissingError;(this.connection.driver instanceof u.MysqlDriver||this.connection.driver instanceof v.OracleDriver||this.connection.driver instanceof d.AbstractSqliteDriver)&&(this.expressionMap.nativeParameters=Object.assign(c,this.expressionMap.nativeParameters));var h=this.createWhereExpression(),l=this.createReturningExpression();return l&&(this.connection.driver instanceof n.PostgresDriver||this.connection.driver instanceof v.OracleDriver||this.connection.driver instanceof r.CockroachDriver)?"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+o.join(", ")+h+" RETURNING "+l:l&&this.connection.driver instanceof i.SqlServerDriver?"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+o.join(", ")+" OUTPUT "+l+h:"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+o.join(", ")+h},f.prototype.createOrderByExpression=function(){var e=this,r=this.expressionMap.orderBys;return Object.keys(r).length>0?" ORDER BY "+Object.keys(r).map(function(t){return"string"==typeof r[t]?e.replacePropertyNames(t)+" "+r[t]:e.replacePropertyNames(t)+" "+r[t].order+" "+r[t].nulls}).join(", "):""},f.prototype.createLimitExpression=function(){var e=this.expressionMap.limit;if(e){if(this.connection.driver instanceof u.MysqlDriver)return" LIMIT "+e;throw new l.LimitOnUpdateNotSupportedError}return""},f.prototype.getValueSet=function(){if(this.expressionMap.valuesSet instanceof Object)return this.expressionMap.valuesSet;throw new m.UpdateValuesMissingError},f}(t.QueryBuilder);exports.UpdateQueryBuilder=M;
},{"tslib":"c4AP","../driver/cockroachdb/CockroachDriver":"mleT","./QueryBuilder":"KIjK","../driver/sqlserver/SqlServerDriver":"sMRg","../driver/postgres/PostgresDriver":"TOLf","../metadata/EntityMetadata":"Raef","./result/UpdateResult":"Ukf1","../error/ReturningStatementNotSupportedError":"3NnL","./ReturningResultsEntityUpdator":"Xp0z","../driver/sqljs/SqljsDriver":"qCTI","../driver/mysql/MysqlDriver":"TOLf","../subscriber/BroadcasterResult":"thBa","../driver/sqlite-abstract/AbstractSqliteDriver":"1srY","../error/LimitOnUpdateNotSupportedError":"JVGN","../driver/oracle/OracleDriver":"l9nz","../error/UpdateValuesMissingError":"PzDV","../error/EntityColumnNotFound":"dVyF"}],"wZjM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeleteResult=void 0;var e=function(){return function(){}}();exports.DeleteResult=e;
},{}],"B5/s":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeleteQueryBuilder=void 0;var e=l(require("tslib")),r=require("../driver/cockroachdb/CockroachDriver"),t=require("../driver/oracle/OracleDriver"),s=require("./QueryBuilder"),i=require("../driver/sqlserver/SqlServerDriver"),n=require("../driver/postgres/PostgresDriver"),a=require("./result/DeleteResult"),o=require("../error/ReturningStatementNotSupportedError"),c=require("../driver/sqljs/SqljsDriver"),u=require("../driver/mysql/MysqlDriver"),p=require("../subscriber/BroadcasterResult"),h=require("../index");function l(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};s.get||s.set?Object.defineProperty(r,t,s):r[t]=e[t]}return r.default=e,r}var d=function(s){function l(e,r){var t=s.call(this,e,r)||this;return t.expressionMap.aliasNamePrefixingEnabled=!1,t}return e.__extends(l,s),l.prototype.getQuery=function(){return this.createDeleteExpression().trim()},l.prototype.execute=function(){return e.__awaiter(this,void 0,void 0,function(){var s,o,h,l,d,v,f,m,y,b;return e.__generator(this,function(x){switch(x.label){case 0:s=e.__read(this.getQueryAndParameters(),2),o=s[0],h=s[1],l=this.obtainQueryRunner(),d=!1,x.label=1;case 1:return x.trys.push([1,11,16,21]),!0!==this.expressionMap.useTransaction||!1!==l.isTransactionActive?[3,3]:[4,l.startTransaction()];case 2:x.sent(),d=!0,x.label=3;case 3:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(y=new p.BroadcasterResult,l.broadcaster.broadcastBeforeRemoveEvent(y,this.expressionMap.mainAlias.metadata),y.promises.length>0?[4,Promise.all(y.promises)]:[3,5]):[3,5];case 4:x.sent(),x.label=5;case 5:return v=new a.DeleteResult,[4,l.query(o,h)];case 6:return f=x.sent(),(m=l.connection.driver)instanceof u.MysqlDriver?(v.raw=f,v.affected=f.affectedRows):m instanceof i.SqlServerDriver||m instanceof n.PostgresDriver||m instanceof r.CockroachDriver?(v.raw=f[0]?f[0]:null,v.affected="number"==typeof f[1]?f[1]:null):m instanceof t.OracleDriver?v.affected=f:v.raw=f,!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(y=new p.BroadcasterResult,l.broadcaster.broadcastAfterRemoveEvent(y,this.expressionMap.mainAlias.metadata),y.promises.length>0?[4,Promise.all(y.promises)]:[3,8]):[3,8];case 7:x.sent(),x.label=8;case 8:return d?[4,l.commitTransaction()]:[3,10];case 9:x.sent(),x.label=10;case 10:return[2,v];case 11:if(b=x.sent(),!d)return[3,15];x.label=12;case 12:return x.trys.push([12,14,,15]),[4,l.rollbackTransaction()];case 13:return x.sent(),[3,15];case 14:return x.sent(),[3,15];case 15:throw b;case 16:return l===this.queryRunner?[3,18]:[4,l.release()];case 17:x.sent(),x.label=18;case 18:return this.connection.driver instanceof c.SqljsDriver&&!l.isTransactionActive?[4,this.connection.driver.autoSave()]:[3,20];case 19:x.sent(),x.label=20;case 20:return[7];case 21:return[2]}})})},l.prototype.from=function(e,r){e=e instanceof h.EntitySchema?e.options.name:e;var t=this.createFromAlias(e,r);return this.expressionMap.setMainAlias(t),this},l.prototype.where=function(e,r){this.expressionMap.wheres=[];var t=this.computeWhereParameter(e);return t&&(this.expressionMap.wheres=[{type:"simple",condition:t}]),r&&this.setParameters(r),this},l.prototype.andWhere=function(e,r){return this.expressionMap.wheres.push({type:"and",condition:this.computeWhereParameter(e)}),r&&this.setParameters(r),this},l.prototype.orWhere=function(e,r){return this.expressionMap.wheres.push({type:"or",condition:this.computeWhereParameter(e)}),r&&this.setParameters(r),this},l.prototype.whereInIds=function(e){return this.where(this.createWhereIdsExpression(e))},l.prototype.andWhereInIds=function(e){return this.andWhere(this.createWhereIdsExpression(e))},l.prototype.orWhereInIds=function(e){return this.orWhere(this.createWhereIdsExpression(e))},l.prototype.output=function(e){return this.returning(e)},l.prototype.returning=function(e){if(!this.connection.driver.isReturningSqlSupported())throw new o.ReturningStatementNotSupportedError;return this.expressionMap.returning=e,this},l.prototype.createDeleteExpression=function(){var e=this.getTableName(this.getMainTableName()),t=this.createWhereExpression(),s=this.createReturningExpression();return s&&(this.connection.driver instanceof n.PostgresDriver||this.connection.driver instanceof r.CockroachDriver)?"DELETE FROM "+e+t+" RETURNING "+s:""!==s&&this.connection.driver instanceof i.SqlServerDriver?"DELETE FROM "+e+" OUTPUT "+s+t:"DELETE FROM "+e+t},l}(s.QueryBuilder);exports.DeleteQueryBuilder=d;
},{"tslib":"c4AP","../driver/cockroachdb/CockroachDriver":"mleT","../driver/oracle/OracleDriver":"l9nz","./QueryBuilder":"KIjK","../driver/sqlserver/SqlServerDriver":"sMRg","../driver/postgres/PostgresDriver":"TOLf","./result/DeleteResult":"wZjM","../error/ReturningStatementNotSupportedError":"3NnL","../driver/sqljs/SqljsDriver":"qCTI","../driver/mysql/MysqlDriver":"TOLf","../subscriber/BroadcasterResult":"thBa","../index":"wlNf"}],"rYUz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationUpdater=void 0;var e=r(require("tslib")),t=require("../driver/oracle/OracleDriver");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var n=function(){function r(e,t){this.queryBuilder=e,this.expressionMap=t}return r.prototype.update=function(r){return e.__awaiter(this,void 0,void 0,function(){var n,i,a,o,s,u,c,l,f,p,d,y,h,O=this;return e.__generator(this,function(e){switch(e.label){case 0:return(n=this.expressionMap.relationMetadata).isManyToOne||n.isOneToOneOwner?(c=n.joinColumns.reduce(function(e,t){var n=r instanceof Object?t.referencedColumn.getEntityValue(r):r;return t.setEntityValue(e,n),e},{}),!this.expressionMap.of||this.expressionMap.of instanceof Array&&!this.expressionMap.of.length?[2]:[4,this.queryBuilder.createQueryBuilder().update(n.entityMetadata.target).set(c).whereInIds(this.expressionMap.of).execute()]):[3,2];case 1:return e.sent(),[3,10];case 2:return!n.isOneToOneNotOwner&&!n.isOneToMany||null!==r?[3,4]:(i={},n.inverseRelation.joinColumns.forEach(function(e){i[e.propertyName]=null}),f=this.expressionMap.of instanceof Array?this.expressionMap.of:[this.expressionMap.of],a={},o=[],f.forEach(function(e,t){n.inverseRelation.joinColumns.map(function(r,n){var i="joinColumn_"+t+"_"+n;a[i]=e instanceof Object?r.referencedColumn.getEntityValue(e):e,o.push(r.propertyPath+" = :"+i)})}),(s=o.map(function(e){return"("+e+")"}).join(" OR "))?[4,this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(i).where(s).setParameters(a).execute()]:[2]);case 3:return e.sent(),[3,10];case 4:if(!n.isOneToOneNotOwner&&!n.isOneToMany)return[3,6];if(this.expressionMap.of instanceof Array)throw new Error("You cannot update relations of multiple entities with the same related object. Provide a single entity into .of method.");return u=this.expressionMap.of,c=n.inverseRelation.joinColumns.reduce(function(e,t){var r=u instanceof Object?t.referencedColumn.getEntityValue(u):u;return t.setEntityValue(e,r),e},{}),!r||r instanceof Array&&!r.length?[2]:[4,this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(c).whereInIds(r).execute()];case 5:return e.sent(),[3,10];case 6:return l=n.junctionEntityMetadata,f=this.expressionMap.of instanceof Array?this.expressionMap.of:[this.expressionMap.of],p=r instanceof Array?r:[r],d=n.isManyToManyOwner?f:p,y=n.isManyToManyOwner?p:f,h=[],d.forEach(function(e){y.forEach(function(t){var r={};l.ownerColumns.forEach(function(t){r[t.databaseName]=e instanceof Object?t.referencedColumn.getEntityValue(e):e}),l.inverseColumns.forEach(function(e){r[e.databaseName]=t instanceof Object?e.referencedColumn.getEntityValue(t):t}),h.push(r)})}),h.length?this.queryBuilder.connection.driver instanceof t.OracleDriver?[4,Promise.all(h.map(function(e){return O.queryBuilder.createQueryBuilder().insert().into(l.tableName).values(e).execute()}))]:[3,8]:[2];case 7:return e.sent(),[3,10];case 8:return[4,this.queryBuilder.createQueryBuilder().insert().into(l.tableName).values(h).execute()];case 9:e.sent(),e.label=10;case 10:return[2]}})})},r}();exports.RelationUpdater=n;
},{"tslib":"c4AP","../driver/oracle/OracleDriver":"l9nz"}],"L/p+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationRemover=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var r=function(){function t(e,t){this.queryBuilder=e,this.expressionMap=t}return t.prototype.remove=function(t){return e.__awaiter(this,void 0,void 0,function(){var r,n,a,i,o,s,u,p,c,f,l,y,d;return e.__generator(this,function(m){switch(m.label){case 0:return(r=this.expressionMap.relationMetadata).isOneToMany?(u=this.expressionMap.of instanceof Array?this.expressionMap.of:[this.expressionMap.of],n=t instanceof Array?t:[t],a={},r.inverseRelation.joinColumns.forEach(function(e){a[e.propertyName]=null}),i={},o=[],u.forEach(function(t,a){o.push.apply(o,e.__spread(n.map(function(n,o){return e.__spread(r.inverseRelation.joinColumns.map(function(e,r){var n="joinColumn_"+a+"_"+o+"_"+r;return i[n]=t instanceof Object?e.referencedColumn.getEntityValue(t):t,e.propertyPath+" = :"+n}),r.inverseRelation.entityMetadata.primaryColumns.map(function(e,t){var r="primaryColumn_"+o+"_"+o+"_"+t;return i[r]=n instanceof Object?e.getEntityValue(n):n,e.propertyPath+" = :"+r})).join(" AND ")})))}),(d=o.map(function(e){return"("+e+")"}).join(" OR "))?[4,this.queryBuilder.createQueryBuilder().update(r.inverseEntityMetadata.target).set(a).where(d).setParameters(i).execute()]:[2]):[3,2];case 1:return m.sent(),[3,4];case 2:return s=r.junctionEntityMetadata,u=this.expressionMap.of instanceof Array?this.expressionMap.of:[this.expressionMap.of],p=t instanceof Array?t:[t],c=r.isManyToManyOwner?u:p,f=r.isManyToManyOwner?p:u,l={},y=[],c.forEach(function(t,r){y.push.apply(y,e.__spread(f.map(function(n,a){return e.__spread(s.ownerColumns.map(function(e,n){var i="firstValue_"+r+"_"+a+"_"+n;return l[i]=t instanceof Object?e.referencedColumn.getEntityValue(t):t,e.databaseName+" = :"+i}),s.inverseColumns.map(function(e,i){var o="secondValue_"+r+"_"+a+"_"+i;return l[o]=t instanceof Object?e.referencedColumn.getEntityValue(n):n,e.databaseName+" = :"+o})).join(" AND ")})))}),d=y.map(function(e){return"("+e+")"}).join(" OR "),[4,this.queryBuilder.createQueryBuilder().delete().from(s.tableName).where(d).setParameters(l).execute()];case 3:m.sent(),m.label=4;case 4:return[2]}})})},t}();exports.RelationRemover=r;
},{"tslib":"c4AP"}],"8i6n":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationQueryBuilder=void 0;var e=r(require("tslib")),t=require("./QueryBuilder"),n=require("./RelationUpdater"),o=require("./RelationRemover");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}var i=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(r,t),r.prototype.getQuery=function(){return""},r.prototype.of=function(e){return this.expressionMap.of=e,this},r.prototype.set=function(t){return e.__awaiter(this,void 0,void 0,function(){var o;return e.__generator(this,function(e){if(o=this.expressionMap.relationMetadata,!this.expressionMap.of)throw new Error("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(o.isManyToMany||o.isOneToMany)throw new Error('Set operation is only supported for many-to-one and one-to-one relations. However given "'+o.propertyPath+'" has '+o.relationType+" relation. Use .add() method instead.");if(o.joinColumns&&o.joinColumns.length>1&&(!(t instanceof Object)||Object.keys(t).length<o.joinColumns.length))throw new Error('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return[2,new n.RelationUpdater(this,this.expressionMap).update(t)]})})},r.prototype.add=function(t){return e.__awaiter(this,void 0,void 0,function(){var o;return e.__generator(this,function(e){if(t instanceof Array&&0===t.length)return[2];if(o=this.expressionMap.relationMetadata,!this.expressionMap.of)throw new Error("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(o.isManyToOne||o.isOneToOne)throw new Error('Add operation is only supported for many-to-many and one-to-many relations. However given "'+o.propertyPath+'" has '+o.relationType+" relation. Use .set() method instead.");if(o.joinColumns&&o.joinColumns.length>1&&(!(t instanceof Object)||Object.keys(t).length<o.joinColumns.length))throw new Error('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return[2,new n.RelationUpdater(this,this.expressionMap).update(t)]})})},r.prototype.remove=function(t){return e.__awaiter(this,void 0,void 0,function(){var n;return e.__generator(this,function(e){if(t instanceof Array&&0===t.length)return[2];if(n=this.expressionMap.relationMetadata,!this.expressionMap.of)throw new Error("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new Error('Add operation is only supported for many-to-many and one-to-many relations. However given "'+n.propertyPath+'" has '+n.relationType+" relation. Use .set(null) method instead.");return[2,new o.RelationRemover(this,this.expressionMap).remove(t)]})})},r.prototype.addAndRemove=function(t,n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.remove(n)];case 1:return e.sent(),[4,this.add(t)];case 2:return e.sent(),[2]}})})},r.prototype.loadOne=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,this.loadMany().then(function(e){return e[0]})]})})},r.prototype.loadMany=function(){return e.__awaiter(this,void 0,void 0,function(){var t,n;return e.__generator(this,function(e){if(!((t=this.expressionMap.of)instanceof Object)){if((n=this.expressionMap.mainAlias.metadata).hasMultiplePrimaryKeys)throw new Error("Cannot load entity because only one primary key was specified, however entity contains multiple primary keys");t=n.primaryColumns[0].createValueMap(t)}return[2,this.connection.relationLoader.load(this.expressionMap.relationMetadata,t)]})})},r}(t.QueryBuilder);exports.RelationQueryBuilder=i;
},{"tslib":"c4AP","./QueryBuilder":"KIjK","./RelationUpdater":"rYUz","./RelationRemover":"L/p+"}],"KIjK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QueryBuilder=void 0;var e=c(require("tslib")),r=require("./QueryExpressionMap"),t=require("./Brackets"),n=require("../metadata/EntityMetadata"),a=require("../driver/sqljs/SqljsDriver"),i=require("../driver/sqlserver/SqlServerDriver"),s=require("../driver/oracle/OracleDriver"),o=require("../"),p=require("../find-options/FindOperator"),u=require("../find-options/operator/In");function c(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var h=function(){function c(e,t){e instanceof c?(this.connection=e.connection,this.queryRunner=e.queryRunner,this.expressionMap=e.expressionMap.clone()):(this.connection=e,this.queryRunner=t,this.expressionMap=new r.QueryExpressionMap(this.connection))}return Object.defineProperty(c.prototype,"alias",{get:function(){if(!this.expressionMap.mainAlias)throw new Error("Main alias is not set");return this.expressionMap.mainAlias.name},enumerable:!0,configurable:!0}),c.prototype.select=function(e,r){this.expressionMap.queryType="select",e instanceof Array?this.expressionMap.selects=e.map(function(e){return{selection:e}}):e&&(this.expressionMap.selects=[{selection:e,aliasName:r}]);var t=require("./SelectQueryBuilder").SelectQueryBuilder;return this instanceof t?this:new t(this)},c.prototype.insert=function(){this.expressionMap.queryType="insert";var e=require("./InsertQueryBuilder").InsertQueryBuilder;return this instanceof e?this:new e(this)},c.prototype.update=function(e,r){var t=r||e;if((e=e instanceof o.EntitySchema?e.options.name:e)instanceof Function||"string"==typeof e){var n=this.createFromAlias(e);this.expressionMap.setMainAlias(n)}this.expressionMap.queryType="update",this.expressionMap.valuesSet=t;var a=require("./UpdateQueryBuilder").UpdateQueryBuilder;return this instanceof a?this:new a(this)},c.prototype.delete=function(){this.expressionMap.queryType="delete";var e=require("./DeleteQueryBuilder").DeleteQueryBuilder;return this instanceof e?this:new e(this)},c.prototype.relation=function(e,r){var t=2===arguments.length?e:void 0,n=2===arguments.length?r:e;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=n,t){var a=this.createFromAlias(t);this.expressionMap.setMainAlias(a)}var i=require("./RelationQueryBuilder").RelationQueryBuilder;return this instanceof i?this:new i(this)},c.prototype.hasRelation=function(e,r){var t=this.connection.getMetadata(e);return(r instanceof Array?r:[r]).every(function(e){return!!t.findRelationWithPropertyPath(e)})},c.prototype.setParameter=function(e,r){return this.expressionMap.parameters[e]=r,this},c.prototype.setParameters=function(e){var r=this;return Object.keys(e).forEach(function(r){if(e[r]instanceof Function)throw new Error("Function parameter isn't supported in the parameters. Please check \""+r+'" parameter.')}),this.expressionMap.parentQueryBuilder&&this.expressionMap.parentQueryBuilder.setParameters(e),Object.keys(e).forEach(function(t){return r.setParameter(t,e[t])}),this},c.prototype.setNativeParameters=function(e){var r=this;return this.expressionMap.parentQueryBuilder&&this.expressionMap.parentQueryBuilder.setNativeParameters(e),Object.keys(e).forEach(function(t){r.expressionMap.nativeParameters[t]=e[t]}),this},c.prototype.getParameters=function(){var e=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){var r=this.expressionMap.mainAlias.metadata;if(r.discriminatorColumn&&r.parentEntityMetadata){var t=r.childEntityMetadatas.filter(function(e){return e.discriminatorColumn}).map(function(e){return e.discriminatorValue});t.push(r.discriminatorValue),e.discriminatorColumnValues=t}}return e},c.prototype.printSql=function(){var r=e.__read(this.getQueryAndParameters(),2),t=r[0],n=r[1];return this.connection.logger.logQuery(t,n),this},c.prototype.getSql=function(){return this.getQueryAndParameters()[0]},c.prototype.getQueryAndParameters=function(){var e=this.getQuery(),r=this.getParameters();return this.connection.driver.escapeQueryWithParameters(e,r,this.expressionMap.nativeParameters)},c.prototype.execute=function(){return e.__awaiter(this,void 0,void 0,function(){var r,t,n,i;return e.__generator(this,function(s){switch(s.label){case 0:r=e.__read(this.getQueryAndParameters(),2),t=r[0],n=r[1],i=this.obtainQueryRunner(),s.label=1;case 1:return s.trys.push([1,,3,8]),[4,i.query(t,n)];case 2:return[2,s.sent()];case 3:return i===this.queryRunner?[3,5]:[4,i.release()];case 4:s.sent(),s.label=5;case 5:return this.connection.driver instanceof a.SqljsDriver?[4,this.connection.driver.autoSave()]:[3,7];case 6:s.sent(),s.label=7;case 7:return[7];case 8:return[2]}})})},c.prototype.createQueryBuilder=function(){return new this.constructor(this.connection,this.queryRunner)},c.prototype.clone=function(){return new this.constructor(this)},c.prototype.disableEscaping=function(){return this.expressionMap.disableEscaping=!1,this},c.prototype.escape=function(e){return this.expressionMap.disableEscaping?this.connection.driver.escape(e):e},c.prototype.setQueryRunner=function(e){return this.queryRunner=e,this},c.prototype.callListeners=function(e){return this.expressionMap.callListeners=e,this},c.prototype.useTransaction=function(e){return this.expressionMap.useTransaction=e,this},c.prototype.getTableName=function(e){var r=this;return e.split(".").map(function(e){return""===e?e:r.escape(e)}).join(".")},c.prototype.getMainTableName=function(){if(!this.expressionMap.mainAlias)throw new Error('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath},c.prototype.createFromAlias=function(e,r){if(this.connection.hasMetadata(e)){var t=this.connection.getMetadata(e);return this.expressionMap.createAlias({type:"from",name:r,metadata:this.connection.getMetadata(e),tablePath:t.tablePath})}var n="";if(e instanceof Function){var a=e(this.subQuery());this.setParameters(a.getParameters()),n=a.getQuery()}else n=e;var i=e instanceof Function||"("===e.substr(0,1)&&")"===e.substr(-1);return this.expressionMap.createAlias({type:"from",name:r,tablePath:!1===i?e:void 0,subQuery:!0===i?n:void 0})},c.prototype.replacePropertyNames=function(r){var t=this;return this.expressionMap.aliases.forEach(function(n){if(n.hasMetadata){var a=t.expressionMap.aliasNamePrefixingEnabled?n.name+"\\.":"",i=t.expressionMap.aliasNamePrefixingEnabled?t.escape(n.name)+".":"";n.metadata.columns.forEach(function(e){var n="([ =(]|^.{0})"+a+e.propertyPath+"([ =),]|.{0}$)";r=r.replace(new RegExp(n,"gm"),"$1"+i+t.escape(e.databaseName)+"$2");var s="([ =(]|^.{0})"+a+e.propertyName+"([ =),]|.{0}$)";r=r.replace(new RegExp(s,"gm"),"$1"+i+t.escape(e.databaseName)+"$2")}),n.metadata.relations.forEach(function(n){if(e.__spread(n.joinColumns,n.inverseJoinColumns).forEach(function(e){var s="([ =(]|^.{0})"+a+n.propertyPath+"\\."+e.referencedColumn.propertyPath+"([ =),]|.{0}$)";r=r.replace(new RegExp(s,"gm"),"$1"+i+t.escape(e.databaseName)+"$2")}),n.joinColumns.length>0){var s="([ =(]|^.{0})"+a+n.propertyPath+"([ =),]|.{0}$)";r=r.replace(new RegExp(s,"gm"),"$1"+i+t.escape(n.joinColumns[0].databaseName)+"$2")}})}}),r},c.prototype.createWhereExpression=function(){var e=this.createWhereExpressionString();if(this.expressionMap.mainAlias.hasMetadata){var r=this.expressionMap.mainAlias.metadata;if(r.discriminatorColumn&&r.parentEntityMetadata){var t=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+r.discriminatorColumn.databaseName:r.discriminatorColumn.databaseName,n=this.replacePropertyNames(t)+" IN (:...discriminatorColumnValues)";return" WHERE "+(e.length?"("+e+") AND":"")+" "+n}}return e.length?this.expressionMap.extraAppendedAndWhereCondition?" WHERE ("+e+") AND "+this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition):" WHERE "+e:this.expressionMap.extraAppendedAndWhereCondition?" WHERE "+this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition):""},c.prototype.createReturningExpression=function(){var r=this,t=this.getReturningColumns(),n=this.connection.driver;if("string"!=typeof this.expressionMap.returning&&this.expressionMap.extraReturningColumns.length>0&&n.isReturningSqlSupported()&&t.push.apply(t,e.__spread(this.expressionMap.extraReturningColumns.filter(function(e){return-1===t.indexOf(e)}))),t.length){var a=t.map(function(e){var t=r.escape(e.databaseName);return n instanceof i.SqlServerDriver?"insert"===r.expressionMap.queryType||"update"===r.expressionMap.queryType?"INSERTED."+t:r.escape(r.getMainTableName())+"."+t:t}).join(", ");return n instanceof s.OracleDriver&&(a+=" INTO "+t.map(function(e){var t="output_"+e.databaseName;return r.expressionMap.nativeParameters[t]={type:n.columnTypeToNativeParameter(e.type),dir:n.oracle.BIND_OUT},r.connection.driver.createParameter(t,Object.keys(r.expressionMap.nativeParameters).length)}).join(", ")),a}return"string"==typeof this.expressionMap.returning?this.expressionMap.returning:""},c.prototype.getReturningColumns=function(){var r=this,t=[];return this.expressionMap.returning instanceof Array&&this.expressionMap.returning.forEach(function(n){r.expressionMap.mainAlias.hasMetadata&&t.push.apply(t,e.__spread(r.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(n)))}),t},c.prototype.createWhereExpressionString=function(){var e=this;return this.expressionMap.wheres.map(function(r,t){switch(r.type){case"and":return(t>0?"AND ":"")+e.replacePropertyNames(r.condition);case"or":return(t>0?"OR ":"")+e.replacePropertyNames(r.condition);default:return e.replacePropertyNames(r.condition)}}).join(" ")},c.prototype.createWhereIdsExpression=function(e){var r,t=this,n=this.expressionMap.mainAlias.metadata,a=(Array.isArray(e)?e:[e]).map(function(e){return n.ensureEntityIdMap(e)});if(!n.hasMultiplePrimaryKeys&&0===n.embeddeds.length){var i=n.primaryColumns[0];if(!i.transformer)return this.computeWhereParameter(((r={})[i.propertyName]=(0,u.In)(a.map(function(e){return i.getEntityValue(e,!1)})),r))}var s=this.expressionMap.aliasNamePrefixingEnabled?this.escape(this.expressionMap.mainAlias.name)+".":"",o=Object.keys(this.expressionMap.nativeParameters).length,p=a.map(function(e,r){var a=[];return n.primaryColumns.forEach(function(n,i){var p="id_"+r+"_"+i;a.push(s+t.escape(n.databaseName)+" = "+t.connection.driver.createParameter(p,o)),t.expressionMap.nativeParameters[p]=n.getEntityValue(e,!0),o++}),a.join(" AND ")});return p.length>1?"("+p.map(function(e){return"("+e+")"}).join(" OR ")+")":p[0]},c.prototype.computeWhereParameter=function(e){var r=this;if("string"==typeof e)return e;if(e instanceof t.Brackets){var a=this.createQueryBuilder();e.whereFactory(a);var i=a.createWhereExpressionString();return this.setParameters(a.getParameters()),i?"("+i+")":""}if(e instanceof Function)return e(this);if(e instanceof Object){var s=e instanceof Array?e:[e],o=void 0,u=Object.keys(this.expressionMap.nativeParameters).length;return(o=this.expressionMap.mainAlias.hasMetadata?s.map(function(e,t){return n.EntityMetadata.createPropertyPath(r.expressionMap.mainAlias.metadata,e).map(function(n,a){return r.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(n).map(function(i,s){var o=r.expressionMap.aliasNamePrefixingEnabled?r.alias+"."+n:i.propertyPath,c=i.getEntityValue(e,!0),h="where_"+t+"_"+a+"_"+s,l=Object.keys(r.expressionMap.nativeParameters).filter(function(e){return e.startsWith(h)}).length;if(null===c)return o+" IS NULL";if(c instanceof p.FindOperator){var m=[];if(c.useParameter)(c.multipleParameters?c.value:[c.value]).forEach(function(e,t){r.expressionMap.nativeParameters[h+(l+t)]=e,u++,m.push(r.connection.driver.createParameter(h+(l+t),u-1))});return c.toSql(r.connection,o,m)}return r.expressionMap.nativeParameters[h]=c,u++,o+" = "+r.connection.driver.createParameter(h,u-1)}).filter(function(e){return!!e}).join(" AND ")}).filter(function(e){return!!e}).join(" AND ")}):s.map(function(e,t){return Object.keys(e).map(function(n,a){var i=e[n],s=r.expressionMap.aliasNamePrefixingEnabled?r.alias+"."+n:n;if(null===i)return s+" IS NULL";var o="where_"+t+"_"+a;return r.expressionMap.nativeParameters[o]=i,a++,s+" = "+r.connection.driver.createParameter(o,a-1)}).join(" AND ")})).length>1?o.map(function(e){return"("+e+")"}).join(" OR "):o.join("")}return""},c.prototype.obtainQueryRunner=function(){return this.queryRunner||this.connection.createQueryRunner("master")},c}();exports.QueryBuilder=h;
},{"tslib":"c4AP","./QueryExpressionMap":"lz25","./Brackets":"d1r/","../metadata/EntityMetadata":"Raef","../driver/sqljs/SqljsDriver":"qCTI","../driver/sqlserver/SqlServerDriver":"sMRg","../driver/oracle/OracleDriver":"l9nz","../":"wlNf","../find-options/FindOperator":"YWTi","../find-options/operator/In":"3fkF","./SelectQueryBuilder":"lbRQ","./InsertQueryBuilder":"Hxxx","./UpdateQueryBuilder":"Z6U/","./DeleteQueryBuilder":"B5/s","./RelationQueryBuilder":"8i6n"}],"inO+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LockNotSupportedOnGivenDriverError=void 0;var r=e(require("tslib"));function e(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,t):{};o.get||o.set?Object.defineProperty(e,t,o):e[t]=r[t]}return e.default=r,e}var t=function(e){function t(){var r=e.call(this)||this;return r.name="LockNotSupportedOnGivenDriverError",Object.setPrototypeOf(r,t.prototype),r.message="Locking not supported on given driver.",r}return r.__extends(t,e),t}(Error);exports.LockNotSupportedOnGivenDriverError=t;
},{"tslib":"c4AP"}],"gfql":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OffsetWithoutLimitNotSupportedError=void 0;var t=e(require("tslib"));function e(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};o.get||o.set?Object.defineProperty(e,r,o):e[r]=t[r]}return e.default=t,e}var r=function(e){function r(t){var o=e.call(this)||this;return o.name="OffsetWithoutLimitNotSupportedError",Object.setPrototypeOf(o,r.prototype),o.message=t+" does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).",o}return t.__extends(r,e),r}(Error);exports.OffsetWithoutLimitNotSupportedError=r;
},{"tslib":"c4AP"}],"lbRQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SelectQueryBuilder=void 0;var e=A(require("tslib")),t=require("./transformer/RawSqlResultsToEntityTransformer"),r=require("../driver/sqlserver/SqlServerDriver"),i=require("../error/PessimisticLockTransactionRequiredError"),s=require("../error/NoVersionOrUpdateDateColumnError"),n=require("../error/OptimisticLockVersionMismatchError"),a=require("../error/OptimisticLockCanNotBeUsedError"),o=require("./JoinAttribute"),p=require("./relation-id/RelationIdAttribute"),c=require("./relation-count/RelationCountAttribute"),u=require("./relation-id/RelationIdLoader"),l=require("./relation-id/RelationIdMetadataToAttributeTransformer"),h=require("./relation-count/RelationCountLoader"),d=require("./relation-count/RelationCountMetadataToAttributeTransformer"),m=require("./QueryBuilder"),f=require("../error/LockNotSupportedOnGivenDriverError"),y=require("../driver/mysql/MysqlDriver"),M=require("../driver/postgres/PostgresDriver"),v=require("../driver/oracle/OracleDriver"),x=require("../driver/sqlite-abstract/AbstractSqliteDriver"),b=require("../error/OffsetWithoutLimitNotSupportedError"),N=require("../subscriber/BroadcasterResult"),O=require("../util/ObjectUtils"),E=require("../driver/DriverUtils");function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var w=function(m){function A(){return null!==m&&m.apply(this,arguments)||this}return e.__extends(A,m),A.prototype.getQuery=function(){var e=this.createSelectExpression();return e+=this.createJoinExpression(),e+=this.createWhereExpression(),e+=this.createGroupByExpression(),e+=this.createHavingExpression(),e+=this.createOrderByExpression(),e+=this.createLimitOffsetExpression(),e=(e+=this.createLockExpression()).trim(),this.expressionMap.subQuery&&(e="("+e+")"),e},A.prototype.subQuery=function(){var e=this.createQueryBuilder();return e.expressionMap.subQuery=!0,e.expressionMap.parentQueryBuilder=this,e},A.prototype.select=function(e,t){if(this.expressionMap.queryType="select",e instanceof Array)this.expressionMap.selects=e.map(function(e){return{selection:e}});else if(e instanceof Function){var r=e(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:t})}else e&&(this.expressionMap.selects=[{selection:e,aliasName:t}]);return this},A.prototype.addSelect=function(e,t){if(!e)return this;if(e instanceof Array)this.expressionMap.selects=this.expressionMap.selects.concat(e.map(function(e){return{selection:e}}));else if(e instanceof Function){var r=e(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:t})}else e&&this.expressionMap.selects.push({selection:e,aliasName:t});return this},A.prototype.from=function(e,t){var r=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(r),this},A.prototype.addFrom=function(e,t){var r=this.createFromAlias(e,t);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(r),this},A.prototype.innerJoin=function(e,t,r,i){return void 0===r&&(r=""),this.join("INNER",e,t,r,i),this},A.prototype.leftJoin=function(e,t,r,i){return void 0===r&&(r=""),this.join("LEFT",e,t,r,i),this},A.prototype.innerJoinAndSelect=function(e,t,r,i){return void 0===r&&(r=""),this.addSelect(t),this.innerJoin(e,t,r,i),this},A.prototype.leftJoinAndSelect=function(e,t,r,i){return void 0===r&&(r=""),this.addSelect(t),this.leftJoin(e,t,r,i),this},A.prototype.innerJoinAndMapMany=function(e,t,r,i,s){return void 0===i&&(i=""),this.addSelect(r),this.join("INNER",t,r,i,s,e,!0),this},A.prototype.innerJoinAndMapOne=function(e,t,r,i,s){return void 0===i&&(i=""),this.addSelect(r),this.join("INNER",t,r,i,s,e,!1),this},A.prototype.leftJoinAndMapMany=function(e,t,r,i,s){return void 0===i&&(i=""),this.addSelect(r),this.join("LEFT",t,r,i,s,e,!0),this},A.prototype.leftJoinAndMapOne=function(e,t,r,i,s){return void 0===i&&(i=""),this.addSelect(r),this.join("LEFT",t,r,i,s,e,!1),this},A.prototype.loadRelationIdAndMap=function(e,t,r,i){var s=new p.RelationIdAttribute(this.expressionMap);return s.mapToProperty=e,s.relationName=t,"string"==typeof r&&(s.alias=r),r instanceof Object&&r.disableMixedMap&&(s.disableMixedMap=!0),s.queryBuilderFactory=i,this.expressionMap.relationIdAttributes.push(s),s.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:s.junctionAlias,metadata:s.relation.junctionEntityMetadata}),this},A.prototype.loadRelationCountAndMap=function(e,t,r,i){var s=new c.RelationCountAttribute(this.expressionMap);return s.mapToProperty=e,s.relationName=t,s.alias=r,s.queryBuilderFactory=i,this.expressionMap.relationCountAttributes.push(s),this.expressionMap.createAlias({type:"other",name:s.junctionAlias}),s.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:s.junctionAlias,metadata:s.relation.junctionEntityMetadata}),this},A.prototype.loadAllRelationIds=function(e){var t=this;return this.expressionMap.mainAlias.metadata.relations.forEach(function(r){void 0!==e&&void 0!==e.relations&&-1===e.relations.indexOf(r.propertyPath)||t.loadRelationIdAndMap(t.expressionMap.mainAlias.name+"."+r.propertyPath,t.expressionMap.mainAlias.name+"."+r.propertyPath,e)}),this},A.prototype.where=function(e,t){this.expressionMap.wheres=[];var r=this.computeWhereParameter(e);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),t&&this.setParameters(t),this},A.prototype.andWhere=function(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.computeWhereParameter(e)}),t&&this.setParameters(t),this},A.prototype.orWhere=function(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.computeWhereParameter(e)}),t&&this.setParameters(t),this},A.prototype.whereInIds=function(e){return this.where(this.createWhereIdsExpression(e))},A.prototype.andWhereInIds=function(e){return this.andWhere(this.createWhereIdsExpression(e))},A.prototype.orWhereInIds=function(e){return this.orWhere(this.createWhereIdsExpression(e))},A.prototype.having=function(e,t){return this.expressionMap.havings.push({type:"simple",condition:e}),t&&this.setParameters(t),this},A.prototype.andHaving=function(e,t){return this.expressionMap.havings.push({type:"and",condition:e}),t&&this.setParameters(t),this},A.prototype.orHaving=function(e,t){return this.expressionMap.havings.push({type:"or",condition:e}),t&&this.setParameters(t),this},A.prototype.groupBy=function(e){return this.expressionMap.groupBys=e?[e]:[],this},A.prototype.addGroupBy=function(e){return this.expressionMap.groupBys.push(e),this},A.prototype.orderBy=function(e,t,r){var i,s;if(void 0===t&&(t="ASC"),void 0!==t&&"ASC"!==t&&"DESC"!==t)throw new Error('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(void 0!==r&&"NULLS FIRST"!==r&&"NULLS LAST"!==r)throw new Error('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return e?e instanceof Object?this.expressionMap.orderBys=e:this.expressionMap.orderBys=r?((i={})[e]={order:t,nulls:r},i):((s={})[e]=t,s):this.expressionMap.orderBys={},this},A.prototype.addOrderBy=function(e,t,r){if(void 0===t&&(t="ASC"),void 0!==t&&"ASC"!==t&&"DESC"!==t)throw new Error('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(void 0!==r&&"NULLS FIRST"!==r&&"NULLS LAST"!==r)throw new Error('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return this.expressionMap.orderBys[e]=r?{order:t,nulls:r}:t,this},A.prototype.limit=function(e){if(this.expressionMap.limit=this.normalizeNumber(e),void 0!==this.expressionMap.limit&&isNaN(this.expressionMap.limit))throw new Error('Provided "limit" value is not a number. Please provide a numeric value.');return this},A.prototype.offset=function(e){if(this.expressionMap.offset=this.normalizeNumber(e),void 0!==this.expressionMap.offset&&isNaN(this.expressionMap.offset))throw new Error('Provided "offset" value is not a number. Please provide a numeric value.');return this},A.prototype.take=function(e){if(this.expressionMap.take=this.normalizeNumber(e),void 0!==this.expressionMap.take&&isNaN(this.expressionMap.take))throw new Error('Provided "take" value is not a number. Please provide a numeric value.');return this},A.prototype.skip=function(e){if(this.expressionMap.skip=this.normalizeNumber(e),void 0!==this.expressionMap.skip&&isNaN(this.expressionMap.skip))throw new Error('Provided "skip" value is not a number. Please provide a numeric value.');return this},A.prototype.setLock=function(e,t){return this.expressionMap.lockMode=e,this.expressionMap.lockVersion=t,this},A.prototype.getRawOne=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.getRawMany()];case 1:return[2,e.sent()[0]]}})})},A.prototype.getRawMany=function(){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,s;return e.__generator(this,function(e){switch(e.label){case 0:if("optimistic"===this.expressionMap.lockMode)throw new a.OptimisticLockCanNotBeUsedError;this.expressionMap.queryEntity=!1,t=this.obtainQueryRunner(),r=!1,e.label=1;case 1:return e.trys.push([1,7,12,15]),!0!==this.expressionMap.useTransaction||!1!==t.isTransactionActive?[3,3]:[4,t.startTransaction()];case 2:e.sent(),r=!0,e.label=3;case 3:return[4,this.loadRawResults(t)];case 4:return i=e.sent(),r?[4,t.commitTransaction()]:[3,6];case 5:e.sent(),e.label=6;case 6:return[2,i];case 7:if(s=e.sent(),!r)return[3,11];e.label=8;case 8:return e.trys.push([8,10,,11]),[4,t.rollbackTransaction()];case 9:return e.sent(),[3,11];case 10:return e.sent(),[3,11];case 11:throw s;case 12:return t===this.queryRunner?[3,14]:[4,t.release()];case 13:e.sent(),e.label=14;case 14:return[7];case 15:return[2]}})})},A.prototype.getRawAndEntities=function(){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,s;return e.__generator(this,function(e){switch(e.label){case 0:t=this.obtainQueryRunner(),r=!1,e.label=1;case 1:return e.trys.push([1,7,12,15]),!0!==this.expressionMap.useTransaction||!1!==t.isTransactionActive?[3,3]:[4,t.startTransaction()];case 2:e.sent(),r=!0,e.label=3;case 3:return this.expressionMap.queryEntity=!0,[4,this.executeEntitiesAndRawResults(t)];case 4:return i=e.sent(),r?[4,t.commitTransaction()]:[3,6];case 5:e.sent(),e.label=6;case 6:return[2,i];case 7:if(s=e.sent(),!r)return[3,11];e.label=8;case 8:return e.trys.push([8,10,,11]),[4,t.rollbackTransaction()];case 9:return e.sent(),[3,11];case 10:return e.sent(),[3,11];case 11:throw s;case 12:return t===this.queryRunner?[3,14]:[4,t.release()];case 13:e.sent(),e.label=14;case 14:return[7];case 15:return[2]}})})},A.prototype.getOne=function(){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,s;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.getRawAndEntities()];case 1:if(t=e.sent(),(r=t.entities[0])&&"optimistic"===this.expressionMap.lockMode&&this.expressionMap.lockVersion)if(i=this.expressionMap.mainAlias.metadata,this.expressionMap.lockVersion instanceof Date){if((s=i.updateDateColumn.getEntityValue(r)).getTime()!==this.expressionMap.lockVersion.getTime())throw new n.OptimisticLockVersionMismatchError(i.name,this.expressionMap.lockVersion,s)}else if((s=i.versionColumn.getEntityValue(r))!==this.expressionMap.lockVersion)throw new n.OptimisticLockVersionMismatchError(i.name,this.expressionMap.lockVersion,s);return[2,r]}})})},A.prototype.getMany=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:if("optimistic"===this.expressionMap.lockMode)throw new a.OptimisticLockCanNotBeUsedError;return[4,this.getRawAndEntities()];case 1:return[2,e.sent().entities]}})})},A.prototype.getCount=function(){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,s;return e.__generator(this,function(e){switch(e.label){case 0:if("optimistic"===this.expressionMap.lockMode)throw new a.OptimisticLockCanNotBeUsedError;t=this.obtainQueryRunner(),r=!1,e.label=1;case 1:return e.trys.push([1,7,12,15]),!0!==this.expressionMap.useTransaction||!1!==t.isTransactionActive?[3,3]:[4,t.startTransaction()];case 2:e.sent(),r=!0,e.label=3;case 3:return this.expressionMap.queryEntity=!1,[4,this.executeCountQuery(t)];case 4:return i=e.sent(),r?[4,t.commitTransaction()]:[3,6];case 5:e.sent(),e.label=6;case 6:return[2,i];case 7:if(s=e.sent(),!r)return[3,11];e.label=8;case 8:return e.trys.push([8,10,,11]),[4,t.rollbackTransaction()];case 9:return e.sent(),[3,11];case 10:return e.sent(),[3,11];case 11:throw s;case 12:return t===this.queryRunner?[3,14]:[4,t.release()];case 13:e.sent(),e.label=14;case 14:return[7];case 15:return[2]}})})},A.prototype.getManyAndCount=function(){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,s,n,o;return e.__generator(this,function(e){switch(e.label){case 0:if("optimistic"===this.expressionMap.lockMode)throw new a.OptimisticLockCanNotBeUsedError;t=this.obtainQueryRunner(),r=!1,e.label=1;case 1:return e.trys.push([1,8,13,16]),!0!==this.expressionMap.useTransaction||!1!==t.isTransactionActive?[3,3]:[4,t.startTransaction()];case 2:e.sent(),r=!0,e.label=3;case 3:return this.expressionMap.queryEntity=!0,[4,this.executeEntitiesAndRawResults(t)];case 4:return i=e.sent(),this.expressionMap.queryEntity=!1,[4,this.executeCountQuery(t)];case 5:return s=e.sent(),n=[i.entities,s],r?[4,t.commitTransaction()]:[3,7];case 6:e.sent(),e.label=7;case 7:return[2,n];case 8:if(o=e.sent(),!r)return[3,12];e.label=9;case 9:return e.trys.push([9,11,,12]),[4,t.rollbackTransaction()];case 10:return e.sent(),[3,12];case 11:return e.sent(),[3,12];case 12:throw o;case 13:return t===this.queryRunner?[3,15]:[4,t.release()];case 14:e.sent(),e.label=15;case 15:return[7];case 16:return[2]}})})},A.prototype.stream=function(){return e.__awaiter(this,void 0,void 0,function(){var t,r,i,s,n,a,o,p,c=this;return e.__generator(this,function(u){switch(u.label){case 0:this.expressionMap.queryEntity=!1,t=e.__read(this.getQueryAndParameters(),2),r=t[0],i=t[1],s=this.obtainQueryRunner(),n=!1,u.label=1;case 1:return u.trys.push([1,6,11,14]),!0!==this.expressionMap.useTransaction||!1!==s.isTransactionActive?[3,3]:[4,s.startTransaction()];case 2:u.sent(),n=!0,u.label=3;case 3:return a=function(){if(s!==c.queryRunner)return s.release()},o=s.stream(r,i,a,a),n?[4,s.commitTransaction()]:[3,5];case 4:u.sent(),u.label=5;case 5:return[2,o];case 6:if(p=u.sent(),!n)return[3,10];u.label=7;case 7:return u.trys.push([7,9,,10]),[4,s.rollbackTransaction()];case 8:return u.sent(),[3,10];case 9:return u.sent(),[3,10];case 10:throw p;case 11:return s===this.queryRunner?[3,13]:[4,s.release()];case 12:u.sent(),u.label=13;case 13:return[7];case 14:return[2]}})})},A.prototype.cache=function(e,t){return"boolean"==typeof e?this.expressionMap.cache=e:"number"==typeof e?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=e):"string"!=typeof e&&"number"!=typeof e||(this.expressionMap.cache=!0,this.expressionMap.cacheId=e),t&&(this.expressionMap.cacheDuration=t),this},A.prototype.setOption=function(e){return this.expressionMap.options.push(e),this},A.prototype.join=function(e,t,r,i,s,n,a){this.setParameters(s||{});var p=new o.JoinAttribute(this.connection,this.expressionMap);if(p.direction=e,p.mapToProperty=n,p.isMappingMany=a,p.entityOrProperty=t,p.condition=i,this.expressionMap.joinAttributes.push(p),p.metadata)p.alias=this.expressionMap.createAlias({type:"join",name:r,metadata:p.metadata}),p.relation&&p.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:p.junctionAlias,metadata:p.relation.junctionEntityMetadata});else{var c="";if(t instanceof Function){var u=t(this.subQuery());this.setParameters(u.getParameters()),c=u.getQuery()}else c=t;var l=t instanceof Function||"("===t.substr(0,1)&&")"===t.substr(-1);p.alias=this.expressionMap.createAlias({type:"join",name:r,tablePath:!1===l?t:void 0,subQuery:!0===l?c:void 0})}},A.prototype.createSelectExpression=function(){var t=this;if(!this.expressionMap.mainAlias)throw new Error("Cannot build query because main alias is not set (call qb#from method)");var i=[],s=[];if(this.expressionMap.mainAlias.hasMetadata){var n=this.expressionMap.mainAlias.metadata;i.push.apply(i,e.__spread(this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,n))),s.push.apply(s,e.__spread(this.findEntityColumnSelects(this.expressionMap.mainAlias.name,n)))}this.expressionMap.joinAttributes.forEach(function(r){if(r.metadata)i.push.apply(i,e.__spread(t.buildEscapedEntityColumnSelects(r.alias.name,r.metadata))),s.push.apply(s,e.__spread(t.findEntityColumnSelects(r.alias.name,r.metadata)));else if(t.expressionMap.selects.some(function(e){return e.selection===r.alias.name})){i.push({selection:t.escape(r.alias.name)+".*"});var n=t.expressionMap.selects.find(function(e){return e.selection===r.alias.name});s.push(n)}}),this.expressionMap.selects.filter(function(e){return-1===s.indexOf(e)}).forEach(function(e){return i.push({selection:t.replacePropertyNames(e.selection),aliasName:e.aliasName})}),0===i.length&&i.push({selection:"*"});var a="";if(this.connection.driver instanceof r.SqlServerDriver)switch(this.expressionMap.lockMode){case"pessimistic_read":a=" WITH (HOLDLOCK, ROWLOCK)";break;case"pessimistic_write":a=" WITH (UPDLOCK, ROWLOCK)";break;case"dirty_read":a=" WITH (NOLOCK)"}var o=this.expressionMap.aliases.filter(function(e){return"from"===e.type&&(e.tablePath||e.subQuery)}).map(function(e){return e.subQuery?e.subQuery+" "+t.escape(e.name):t.getTableName(e.tablePath)+" "+t.escape(e.name)});return"SELECT "+i.map(function(e){return e.selection+(e.aliasName?" AS "+t.escape(e.aliasName):"")}).join(", ")+" FROM "+o.join(", ")+a},A.prototype.createJoinExpression=function(){var e=this;return this.expressionMap.joinAttributes.map(function(t){var r=t.relation,i=t.tablePath,s=t.alias.name,n=t.condition?" AND ("+t.condition+")":"",a=t.parentAlias;if(!a||!r){var o=t.alias.subQuery?t.alias.subQuery:e.getTableName(i);return" "+t.direction+" JOIN "+o+" "+e.escape(s)+(t.condition?" ON "+e.replacePropertyNames(t.condition):"")}if(r.isManyToOne||r.isOneToOneOwner){var p=r.joinColumns.map(function(e){return s+"."+e.referencedColumn.propertyPath+"="+a+"."+r.propertyPath+"."+e.referencedColumn.propertyPath}).join(" AND ");return" "+t.direction+" JOIN "+e.getTableName(i)+" "+e.escape(s)+" ON "+e.replacePropertyNames(p+n)}if(r.isOneToMany||r.isOneToOneNotOwner){p=r.inverseRelation.joinColumns.map(function(e){return s+"."+r.inverseRelation.propertyPath+"."+e.referencedColumn.propertyPath+"="+a+"."+e.referencedColumn.propertyPath}).join(" AND ");return" "+t.direction+" JOIN "+e.getTableName(i)+" "+e.escape(s)+" ON "+e.replacePropertyNames(p+n)}var c=r.junctionEntityMetadata.tablePath,u=t.junctionAlias,l="",h="";return r.isOwning?(l=r.joinColumns.map(function(e){return u+"."+e.propertyPath+"="+a+"."+e.referencedColumn.propertyPath}).join(" AND "),h=r.inverseJoinColumns.map(function(e){return s+"."+e.referencedColumn.propertyPath+"="+u+"."+e.propertyPath}).join(" AND ")):(l=r.inverseRelation.inverseJoinColumns.map(function(e){return u+"."+e.propertyPath+"="+a+"."+e.referencedColumn.propertyPath}).join(" AND "),h=r.inverseRelation.joinColumns.map(function(e){return s+"."+e.referencedColumn.propertyPath+"="+u+"."+e.propertyPath}).join(" AND "))," "+t.direction+" JOIN "+e.getTableName(c)+" "+e.escape(u)+" ON "+e.replacePropertyNames(l)+" "+t.direction+" JOIN "+e.getTableName(i)+" "+e.escape(s)+" ON "+e.replacePropertyNames(h+n)}).join(" ")},A.prototype.createGroupByExpression=function(){return this.expressionMap.groupBys&&this.expressionMap.groupBys.length?" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", ")):""},A.prototype.createOrderByExpression=function(){var e=this,t=this.expressionMap.allOrderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(function(r){return"string"==typeof t[r]?e.replacePropertyNames(r)+" "+t[r]:e.replacePropertyNames(r)+" "+t[r].order+" "+t[r].nulls}).join(", "):""},A.prototype.createLimitOffsetExpression=function(){var e=this.expressionMap.offset,t=this.expressionMap.limit;if(e||t||0!==this.expressionMap.joinAttributes.length||(e=this.expressionMap.skip,t=this.expressionMap.take),this.connection.driver instanceof r.SqlServerDriver){var i="";if((t||e)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(i=" ORDER BY (SELECT NULL)"),t&&e)return i+" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(t)return i+" OFFSET 0 ROWS FETCH NEXT "+t+" ROWS ONLY";if(e)return i+" OFFSET "+e+" ROWS"}else if(this.connection.driver instanceof y.MysqlDriver){if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)throw new b.OffsetWithoutLimitNotSupportedError("MySQL")}else if(this.connection.driver instanceof x.AbstractSqliteDriver){if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)return" LIMIT -1 OFFSET "+e}else if(this.connection.driver instanceof v.OracleDriver){if(t&&e)return" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(t)return" FETCH NEXT "+t+" ROWS ONLY";if(e)return" OFFSET "+e+" ROWS"}else{if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)return" OFFSET "+e}return""},A.prototype.createLockExpression=function(){var e=this.connection.driver;switch(this.expressionMap.lockMode){case"pessimistic_read":if(e instanceof y.MysqlDriver)return" LOCK IN SHARE MODE";if(e instanceof M.PostgresDriver)return" FOR SHARE";if(e instanceof v.OracleDriver)return" FOR UPDATE";if(e instanceof r.SqlServerDriver)return"";throw new f.LockNotSupportedOnGivenDriverError;case"pessimistic_write":if(e instanceof y.MysqlDriver||e instanceof M.PostgresDriver||e instanceof v.OracleDriver)return" FOR UPDATE";if(e instanceof r.SqlServerDriver)return"";throw new f.LockNotSupportedOnGivenDriverError;default:return""}},A.prototype.createHavingExpression=function(){var e=this;if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";var t=this.expressionMap.havings.map(function(t,r){switch(t.type){case"and":return(r>0?"AND ":"")+e.replacePropertyNames(t.condition);case"or":return(r>0?"OR ":"")+e.replacePropertyNames(t.condition);default:return e.replacePropertyNames(t.condition)}}).join(" ");return t.length?" HAVING "+t:""},A.prototype.buildEscapedEntityColumnSelects=function(t,i){var s=this,n=this.expressionMap.selects.some(function(e){return e.selection===t}),a=[];if(n&&a.push.apply(a,e.__spread(i.columns.filter(function(e){return!0===e.isSelect}))),a.push.apply(a,e.__spread(i.columns.filter(function(e){return s.expressionMap.selects.some(function(r){return r.selection===t+"."+e.propertyPath})}))),0===a.length)return[];var o=this.expressionMap.queryEntity?i.primaryColumns.filter(function(e){return-1===a.indexOf(e)}):[];return e.__spread(a,o).map(function(e){var i=s.expressionMap.selects.find(function(r){return r.selection===t+"."+e.propertyPath}),a=s.escape(t)+"."+s.escape(e.databaseName);return-1!==s.connection.driver.spatialTypes.indexOf(e.type)&&(s.connection.driver instanceof y.MysqlDriver&&(a="AsText("+a+")"),s.connection.driver instanceof M.PostgresDriver&&(a="ST_AsGeoJSON("+a+")::json"),s.connection.driver instanceof r.SqlServerDriver&&(a+=".ToString()")),{selection:a,aliasName:i&&i.aliasName?i.aliasName:E.DriverUtils.buildColumnAlias(s.connection.driver,t,e.databaseName),virtual:i?!0===i.virtual:!n}})},A.prototype.findEntityColumnSelects=function(e,t){var r=this.expressionMap.selects.find(function(t){return t.selection===e});return r?[r]:this.expressionMap.selects.filter(function(r){return t.columns.some(function(t){return r.selection===e+"."+t.propertyPath})})},A.prototype.executeCountQuery=function(t){return e.__awaiter(this,void 0,void 0,function(){var r,i,s,n,a,o=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=this.expressionMap.mainAlias.name,i=this.expressionMap.mainAlias.metadata,s=this.escape(r),n="",n=i.hasMultiplePrimaryKeys?this.connection.driver instanceof x.AbstractSqliteDriver?"COUNT(DISTINCT("+i.primaryColumns.map(function(e,t){var r=o.escape(e.databaseName);return s+"."+r}).join(" || ")+')) as "cnt"':"COUNT(DISTINCT(CONCAT("+i.primaryColumns.map(function(e,t){var r=o.escape(e.databaseName);return s+"."+r}).join(", ")+'))) as "cnt"':"COUNT(DISTINCT("+i.primaryColumns.map(function(e,t){var r=o.escape(e.databaseName);return s+"."+r}).join(", ")+')) as "cnt"',[4,this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(n).setOption("disable-global-order").loadRawResults(t)];case 1:return(a=e.sent())&&a[0]&&a[0].cnt?[2,parseInt(a[0].cnt)]:[2,0]}})})},A.prototype.executeEntitiesAndRawResults=function(r){return e.__awaiter(this,void 0,void 0,function(){var n,a,o,p,c,m,f,y,M,v,x,b,O,w,T,S,C,R,P=this;return e.__generator(this,function(g){switch(g.label){case 0:if(!this.expressionMap.mainAlias)throw new Error('Alias is not set. Use "from" method to set an alias.');if(("pessimistic_read"===this.expressionMap.lockMode||"pessimistic_write"===this.expressionMap.lockMode)&&!r.isTransactionActive)throw new i.PessimisticLockTransactionRequiredError;if("optimistic"===this.expressionMap.lockMode&&!(n=this.expressionMap.mainAlias.metadata).versionColumn&&!n.updateDateColumn)throw new s.NoVersionOrUpdateDateColumnError(n.name);return a=new u.RelationIdLoader(this.connection,r,this.expressionMap.relationIdAttributes),o=new h.RelationCountLoader(this.connection,r,this.expressionMap.relationCountAttributes),new l.RelationIdMetadataToAttributeTransformer(this.expressionMap).transform(),new d.RelationCountMetadataToAttributeTransformer(this.expressionMap).transform(),p=[],c=[],(this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0?(m=e.__read(this.createOrderByCombinedWithSelectExpression("distinctAlias"),2),f=m[0],y=m[1],M=this.expressionMap.mainAlias.metadata,v=this.expressionMap.mainAlias.name,x=M.primaryColumns.map(function(e){var t=P.escape("distinctAlias"),r=P.escape(E.DriverUtils.buildColumnAlias(P.connection.driver,v,e.databaseName));return y[r]||(y[r]="ASC"),t+"."+r+' as "ids_'+E.DriverUtils.buildColumnAlias(P.connection.driver,v,e.databaseName)+'"'}),[4,new A(this.connection,r).select("DISTINCT "+x.join(", ")).addSelect(f).from("("+this.clone().orderBy().getQuery()+")","distinctAlias").offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(y).cache(this.expressionMap.cache?this.expressionMap.cache:this.expressionMap.cacheId,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany()]):[3,4];case 1:return(p=g.sent()).length>0?(b="",O={},M.hasMultiplePrimaryKeys?b=p.map(function(e,t){return M.primaryColumns.map(function(r){return O["ids_"+t+"_"+r.databaseName]=e["ids_"+v+"_"+r.databaseName],v+"."+r.propertyPath+"=:ids_"+t+"_"+r.databaseName}).join(" AND ")}).join(" OR "):(w=p.map(function(e){return e["ids_"+E.DriverUtils.buildColumnAlias(P.connection.driver,v,M.primaryColumns[0].databaseName)]}),w.every(function(e){return"number"==typeof e})?b=v+"."+M.primaryColumns[0].propertyPath+" IN ("+w.join(", ")+")":(O.ids=w,b=v+"."+M.primaryColumns[0].propertyPath+" IN (:...ids)")),[4,this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:b}).setParameters(O).loadRawResults(r)]):[3,3];case 2:p=g.sent(),g.label=3;case 3:return[3,6];case 4:return[4,this.loadRawResults(r)];case 5:p=g.sent(),g.label=6;case 6:return p.length>0?[4,a.load(p)]:[3,10];case 7:return T=g.sent(),[4,o.load(p)];case 8:return S=g.sent(),C=new t.RawSqlResultsToEntityTransformer(this.expressionMap,this.connection.driver,T,S,this.queryRunner),c=C.transform(p,this.expressionMap.mainAlias),!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(R=new N.BroadcasterResult,r.broadcaster.broadcastLoadEventsForAll(R,this.expressionMap.mainAlias.metadata,c),R.promises.length>0?[4,Promise.all(R.promises)]:[3,10]):[3,10];case 9:g.sent(),g.label=10;case 10:return[2,{raw:p,entities:c}]}})})},A.prototype.createOrderByCombinedWithSelectExpression=function(t){var r=this,i=this.expressionMap.allOrderBys,s=Object.keys(i).map(function(i){if(-1!==i.indexOf(".")){var s=e.__read(i.split("."),2),n=s[0],a=s[1],o=r.expressionMap.findAliasByName(n).metadata.findColumnWithPropertyName(a);return r.escape(t)+"."+r.escape(E.DriverUtils.buildColumnAlias(r.connection.driver,n,o.databaseName))}return r.expressionMap.selects.find(function(e){return e.selection===i||e.aliasName===i})?r.escape(t)+"."+i:""}).join(", "),n={};return Object.keys(i).forEach(function(s){if(-1!==s.indexOf(".")){var a=e.__read(s.split("."),2),o=a[0],p=a[1],c=r.expressionMap.findAliasByName(o).metadata.findColumnWithPropertyName(p);n[r.escape(t)+"."+r.escape(E.DriverUtils.buildColumnAlias(r.connection.driver,o,c.databaseName))]=i[s]}else r.expressionMap.selects.find(function(e){return e.selection===s||e.aliasName===s})?n[r.escape(t)+"."+s]=i[s]:n[s]=i[s]}),[s,n]},A.prototype.loadRawResults=function(t){return e.__awaiter(this,void 0,void 0,function(){var r,i,s,n,a,o,p;return e.__generator(this,function(c){switch(c.label){case 0:return r=e.__read(this.getQueryAndParameters(),2),i=r[0],s=r[1],n=i+" -- PARAMETERS: "+JSON.stringify(s),a="object"==typeof this.connection.options.cache?this.connection.options.cache:{},o=void 0,this.connection.queryResultCache&&(this.expressionMap.cache||a.alwaysEnabled)?[4,this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:n,duration:this.expressionMap.cacheDuration||a.duration||1e3},t)]:[3,2];case 1:if((o=c.sent())&&!this.connection.queryResultCache.isExpired(o))return[2,JSON.parse(o.result)];c.label=2;case 2:return[4,t.query(i,s)];case 3:return p=c.sent(),this.connection.queryResultCache&&(this.expressionMap.cache||a.alwaysEnabled)?[4,this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:n,time:(new Date).getTime(),duration:this.expressionMap.cacheDuration||a.duration||1e3,result:JSON.stringify(p)},o,t)]:[3,5];case 4:c.sent(),c.label=5;case 5:return[2,p]}})})},A.prototype.mergeExpressionMap=function(e){return O.ObjectUtils.assign(this.expressionMap,e),this},A.prototype.normalizeNumber=function(e){return"number"==typeof e||null==e?e:Number(e)},A.prototype.obtainQueryRunner=function(){return this.queryRunner||this.connection.createQueryRunner("slave")},A}(m.QueryBuilder);exports.SelectQueryBuilder=w;
},{"tslib":"c4AP","./transformer/RawSqlResultsToEntityTransformer":"338u","../driver/sqlserver/SqlServerDriver":"sMRg","../error/PessimisticLockTransactionRequiredError":"3YMZ","../error/NoVersionOrUpdateDateColumnError":"E4CT","../error/OptimisticLockVersionMismatchError":"x6IH","../error/OptimisticLockCanNotBeUsedError":"HbiY","./JoinAttribute":"xyPr","./relation-id/RelationIdAttribute":"6hXA","./relation-count/RelationCountAttribute":"LIRz","./relation-id/RelationIdLoader":"K3XU","./relation-id/RelationIdMetadataToAttributeTransformer":"D79j","./relation-count/RelationCountLoader":"tF9j","./relation-count/RelationCountMetadataToAttributeTransformer":"R+xf","./QueryBuilder":"KIjK","../error/LockNotSupportedOnGivenDriverError":"inO+","../driver/mysql/MysqlDriver":"TOLf","../driver/postgres/PostgresDriver":"TOLf","../driver/oracle/OracleDriver":"l9nz","../driver/sqlite-abstract/AbstractSqliteDriver":"1srY","../error/OffsetWithoutLimitNotSupportedError":"gfql","../subscriber/BroadcasterResult":"thBa","../util/ObjectUtils":"41H8","../driver/DriverUtils":"hdhF"}],"++uV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SimpleConsoleLogger=void 0;var o=function(){function o(o){this.options=o}return o.prototype.logQuery=function(o,t,i){if("all"===this.options||!0===this.options||this.options instanceof Array&&-1!==this.options.indexOf("query")){var n=o+(t&&t.length?" -- PARAMETERS: "+this.stringifyParams(t):"");console.log("query: "+n)}},o.prototype.logQueryError=function(o,t,i,n){if("all"===this.options||!0===this.options||this.options instanceof Array&&-1!==this.options.indexOf("error")){var s=t+(i&&i.length?" -- PARAMETERS: "+this.stringifyParams(i):"");console.log("query failed: "+s),console.log("error:",o)}},o.prototype.logQuerySlow=function(o,t,i,n){var s=t+(i&&i.length?" -- PARAMETERS: "+this.stringifyParams(i):"");console.log("query is slow: "+s),console.log("execution time: "+o)},o.prototype.logSchemaBuild=function(o,t){("all"===this.options||this.options instanceof Array&&-1!==this.options.indexOf("schema"))&&console.log(o)},o.prototype.logMigration=function(o,t){console.log(o)},o.prototype.log=function(o,t,i){switch(o){case"log":("all"===this.options||this.options instanceof Array&&-1!==this.options.indexOf("log"))&&console.log(t);break;case"info":("all"===this.options||this.options instanceof Array&&-1!==this.options.indexOf("info"))&&console.info(t);break;case"warn":("all"===this.options||this.options instanceof Array&&-1!==this.options.indexOf("warn"))&&console.warn(t)}},o.prototype.stringifyParams=function(o){try{return JSON.stringify(o)}catch(t){return o}},o}();exports.SimpleConsoleLogger=o;
},{}],"GoC3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AdvancedConsoleLogger=void 0;var o=require("../platform/PlatformTools"),t=function(){function t(o){this.options=o}return t.prototype.logQuery=function(t,i,r){if("all"===this.options||!0===this.options||this.options instanceof Array&&-1!==this.options.indexOf("query")){var s=t+(i&&i.length?" -- PARAMETERS: "+this.stringifyParams(i):"");o.PlatformTools.logInfo("query:",o.PlatformTools.highlightSql(s))}},t.prototype.logQueryError=function(t,i,r,s){if("all"===this.options||!0===this.options||this.options instanceof Array&&-1!==this.options.indexOf("error")){var n=i+(r&&r.length?" -- PARAMETERS: "+this.stringifyParams(r):"");o.PlatformTools.logError("query failed:",o.PlatformTools.highlightSql(n)),o.PlatformTools.logError("error:",t)}},t.prototype.logQuerySlow=function(t,i,r,s){var n=i+(r&&r.length?" -- PARAMETERS: "+this.stringifyParams(r):"");o.PlatformTools.logWarn("query is slow:",o.PlatformTools.highlightSql(n)),o.PlatformTools.logWarn("execution time:",t)},t.prototype.logSchemaBuild=function(t,i){("all"===this.options||this.options instanceof Array&&-1!==this.options.indexOf("schema"))&&o.PlatformTools.log(t)},t.prototype.logMigration=function(t,i){o.PlatformTools.log(t)},t.prototype.log=function(t,i,r){switch(t){case"log":("all"===this.options||this.options instanceof Array&&-1!==this.options.indexOf("log"))&&console.log(i);break;case"info":("all"===this.options||this.options instanceof Array&&-1!==this.options.indexOf("info"))&&console.info(i);break;case"warn":("all"===this.options||this.options instanceof Array&&-1!==this.options.indexOf("warn"))&&console.warn(o.PlatformTools.warn(i))}},t.prototype.stringifyParams=function(o){try{return JSON.stringify(o)}catch(t){return o}},t}();exports.AdvancedConsoleLogger=t;
},{"../platform/PlatformTools":"YF44"}],"XHDv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FileLogger=void 0;var t=require("../platform/PlatformTools"),o=function(){function o(t){this.options=t}return o.prototype.logQuery=function(t,o,i){if("all"===this.options||!0===this.options||this.options instanceof Array&&-1!==this.options.indexOf("query")){var n=t+(o&&o.length?" -- PARAMETERS: "+this.stringifyParams(o):"");this.write("[QUERY]: "+n)}},o.prototype.logQueryError=function(t,o,i,n){if("all"===this.options||!0===this.options||this.options instanceof Array&&-1!==this.options.indexOf("error")){var r=o+(i&&i.length?" -- PARAMETERS: "+this.stringifyParams(i):"");this.write(["[FAILED QUERY]: "+r,"[QUERY ERROR]: "+t])}},o.prototype.logQuerySlow=function(t,o,i,n){var r=o+(i&&i.length?" -- PARAMETERS: "+this.stringifyParams(i):"");this.write("[SLOW QUERY: "+t+" ms]: "+r)},o.prototype.logSchemaBuild=function(t,o){("all"===this.options||this.options instanceof Array&&-1!==this.options.indexOf("schema"))&&this.write(t)},o.prototype.logMigration=function(t,o){this.write(t)},o.prototype.log=function(t,o,i){switch(t){case"log":("all"===this.options||this.options instanceof Array&&-1!==this.options.indexOf("log"))&&this.write("[LOG]: "+o);break;case"info":("all"===this.options||this.options instanceof Array&&-1!==this.options.indexOf("info"))&&this.write("[INFO]: "+o);break;case"warn":("all"===this.options||this.options instanceof Array&&-1!==this.options.indexOf("warn"))&&this.write("[WARN]: "+o)}},o.prototype.write=function(o){o=o instanceof Array?o:[o];var i=t.PlatformTools.load("app-root-path").path;o=o.map(function(t){return"["+(new Date).toISOString()+"]"+t}),t.PlatformTools.appendFileSync(i+"/ormlogs.log",o.join("\r\n")+"\r\n")},o.prototype.stringifyParams=function(t){try{return JSON.stringify(t)}catch(o){return t}},o}();exports.FileLogger=o;
},{"../platform/PlatformTools":"YF44"}],"Lxqb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DebugLogger=void 0;var e=require("../platform/PlatformTools"),t=function(){function t(){this.debug=e.PlatformTools.load("debug"),this.debugQueryLog=this.debug("typeorm:query:log"),this.debugQueryError=this.debug("typeorm:query:error"),this.debugQuerySlow=this.debug("typeorm:query:slow"),this.debugSchemaBuild=this.debug("typeorm:schema"),this.debugMigration=this.debug("typeorm:migration"),this.debugLog=this.debug("typeorm:log"),this.debugInfo=this.debug("typeorm:info"),this.debugWarn=this.debug("typeorm:warn")}return t.prototype.logQuery=function(t,o,r){this.debugQueryLog.enabled&&(this.debugQueryLog(e.PlatformTools.highlightSql(t)+";"),o&&o.length&&this.debugQueryLog("parameters:",o))},t.prototype.logQueryError=function(t,o,r,u){this.debugQueryError.enabled&&(this.debugQueryError(e.PlatformTools.highlightSql(o)+";"),r&&r.length&&this.debugQueryError("parameters:",r),this.debugQueryError("error: ",t))},t.prototype.logQuerySlow=function(t,o,r,u){this.debugQuerySlow.enabled&&(this.debugQuerySlow(e.PlatformTools.highlightSql(o)+";"),r&&r.length&&this.debugQuerySlow("parameters:",r),this.debugQuerySlow("execution time:",t))},t.prototype.logSchemaBuild=function(e,t){this.debugSchemaBuild.enabled&&this.debugSchemaBuild(e)},t.prototype.logMigration=function(e,t){this.debugMigration.enabled&&this.debugMigration(e)},t.prototype.log=function(e,t,o){switch(e){case"log":this.debugLog.enabled&&this.debugLog(t);break;case"info":this.debugInfo.enabled&&this.debugInfo(t);break;case"warn":this.debugWarn.enabled&&this.debugWarn(t)}},t}();exports.DebugLogger=t;
},{"../platform/PlatformTools":"YF44"}],"AsxB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LoggerFactory=void 0;var e=require("./SimpleConsoleLogger"),r=require("./AdvancedConsoleLogger"),o=require("./FileLogger"),n=require("./DebugLogger"),g=function(){function g(){}return g.prototype.create=function(g,t){if(g instanceof Object)return g;if(g)switch(g){case"simple-console":return new e.SimpleConsoleLogger(t);case"file":return new o.FileLogger(t);case"advanced-console":return new r.AdvancedConsoleLogger(t);case"debug":return new n.DebugLogger}return new r.AdvancedConsoleLogger(t)},g}();exports.LoggerFactory=g;
},{"./SimpleConsoleLogger":"++uV","./AdvancedConsoleLogger":"GoC3","./FileLogger":"XHDv","./DebugLogger":"Lxqb"}],"NNS3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RedisQueryResultCache=void 0;var t=i(require("tslib")),e=require("../platform/PlatformTools");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};n.get||n.set?Object.defineProperty(e,i,n):e[i]=t[i]}return e.default=t,e}var n=function(){function i(t,e){this.connection=t,this.clientType=e,this.redis=this.loadRedis()}return i.prototype.connect=function(){return t.__awaiter(this,void 0,void 0,function(){var e;return t.__generator(this,function(t){if(e=this.connection.options.cache,"redis"===this.clientType)e&&e.options?this.client=this.redis.createClient(e.options):this.client=this.redis.createClient();else if("ioredis"===this.clientType)e&&e.options?this.client=new this.redis(e.options):this.client=new this.redis;else if("ioredis/cluster"===this.clientType)if(e&&e.options&&e.options instanceof Array)this.client=new this.redis.Cluster(e.options);else{if(!(e&&e.options&&e.options.startupNodes))throw new Error("options.startupNodes required for "+this.clientType+".");this.client=new this.redis.Cluster(e.options.startupNodes,e.options.options)}return[2]})})},i.prototype.disconnect=function(){return t.__awaiter(this,void 0,void 0,function(){var e=this;return t.__generator(this,function(t){return[2,new Promise(function(t,i){e.client.quit(function(n,r){if(n)return i(n);t(),e.client=void 0})})]})})},i.prototype.synchronize=function(e){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(t){return[2]})})},i.prototype.getFromCache=function(t,e){var i=this;return new Promise(function(e,n){t.identifier?i.client.get(t.identifier,function(t,i){if(t)return n(t);e(JSON.parse(i))}):t.query?i.client.get(t.query,function(t,i){if(t)return n(t);e(JSON.parse(i))}):e(void 0)})},i.prototype.isExpired=function(t){return t.time+t.duration<(new Date).getTime()},i.prototype.storeInCache=function(e,i,n){return t.__awaiter(this,void 0,void 0,function(){var i=this;return t.__generator(this,function(t){return[2,new Promise(function(t,n){e.identifier?i.client.set(e.identifier,JSON.stringify(e),"PX",e.duration,function(e,i){if(e)return n(e);t()}):e.query&&i.client.set(e.query,JSON.stringify(e),"PX",e.duration,function(e,i){if(e)return n(e);t()})})]})})},i.prototype.clear=function(e){return t.__awaiter(this,void 0,void 0,function(){var e=this;return t.__generator(this,function(t){return[2,new Promise(function(t,i){e.client.flushdb(function(e,n){if(e)return i(e);t()})})]})})},i.prototype.remove=function(e,i){return t.__awaiter(this,void 0,void 0,function(){var i=this;return t.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.all(e.map(function(t){return i.deleteKey(t)}))];case 1:return t.sent(),[2]}})})},i.prototype.deleteKey=function(t){var e=this;return new Promise(function(i,n){e.client.del(t,function(t,e){if(t)return n(t);i()})})},i.prototype.loadRedis=function(){try{return e.PlatformTools.load(this.clientType)}catch(t){throw new Error("Cannot use cache because "+this.clientType+' is not installed. Please run "npm i '+this.clientType+' --save".')}},i}();exports.RedisQueryResultCache=n;
},{"tslib":"c4AP","../platform/PlatformTools":"YF44"}],"ktnX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DbQueryResultCache=void 0;var e=a(require("tslib")),r=require("../schema-builder/table/Table"),t=require("../driver/sqlserver/SqlServerDriver"),i=require("../driver/sqlserver/MssqlParameter"),n=require("../driver/oracle/OracleDriver");function a(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};i.get||i.set?Object.defineProperty(r,t,i):r[t]=e[t]}return r.default=e,r}var c=function(){function a(e){this.connection=e;var r=this.connection.driver.options,t=("object"==typeof this.connection.options.cache?this.connection.options.cache:{}).tableName||"query-result-cache";this.queryResultCacheTable=this.connection.driver.buildTableName(t,r.schema,r.database)}return a.prototype.connect=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2]})})},a.prototype.disconnect=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2]})})},a.prototype.synchronize=function(t){return e.__awaiter(this,void 0,void 0,function(){var i;return e.__generator(this,function(e){switch(e.label){case 0:return t=this.getQueryRunner(t),i=this.connection.driver,[4,t.hasTable(this.queryResultCacheTable)];case 1:return e.sent()?[2]:[4,t.createTable(new r.Table({name:this.queryResultCacheTable,columns:[{name:"id",isPrimary:!0,isNullable:!1,type:i.normalizeType({type:i.mappedDataTypes.cacheId}),generationStrategy:"increment",isGenerated:!0},{name:"identifier",type:i.normalizeType({type:i.mappedDataTypes.cacheIdentifier}),isNullable:!0},{name:"time",type:i.normalizeType({type:i.mappedDataTypes.cacheTime}),isPrimary:!1,isNullable:!1},{name:"duration",type:i.normalizeType({type:i.mappedDataTypes.cacheDuration}),isPrimary:!1,isNullable:!1},{name:"query",type:i.normalizeType({type:i.mappedDataTypes.cacheQuery}),isPrimary:!1,isNullable:!1},{name:"result",type:i.normalizeType({type:i.mappedDataTypes.cacheResult}),isNullable:!1}]}))];case 2:return e.sent(),[2]}})})},a.prototype.getFromCache=function(e,r){r=this.getQueryRunner(r);var a=this.connection.createQueryBuilder(r).select().from(this.queryResultCacheTable,"cache");return e.identifier?a.where(a.escape("cache")+"."+a.escape("identifier")+" = :identifier").setParameters({identifier:this.connection.driver instanceof t.SqlServerDriver?new i.MssqlParameter(e.identifier,"nvarchar"):e.identifier}).getRawOne():e.query?this.connection.driver instanceof n.OracleDriver?a.where("dbms_lob.compare("+a.escape("cache")+"."+a.escape("query")+", :query) = 0",{query:e.query}).getRawOne():a.where(a.escape("cache")+"."+a.escape("query")+" = :query").setParameters({query:this.connection.driver instanceof t.SqlServerDriver?new i.MssqlParameter(e.query,"nvarchar"):e.query}).getRawOne():Promise.resolve(void 0)},a.prototype.isExpired=function(e){var r="string"==typeof e.duration?parseInt(e.duration):e.duration;return("string"==typeof e.time?parseInt(e.time):e.time)+r<(new Date).getTime()},a.prototype.storeInCache=function(r,a,c){return e.__awaiter(this,void 0,void 0,function(){var s,o;return e.__generator(this,function(e){switch(e.label){case 0:return c=this.getQueryRunner(c),s=r,this.connection.driver instanceof t.SqlServerDriver&&(s={identifier:new i.MssqlParameter(r.identifier,"nvarchar"),time:new i.MssqlParameter(r.time,"bigint"),duration:new i.MssqlParameter(r.duration,"int"),query:new i.MssqlParameter(r.query,"nvarchar"),result:new i.MssqlParameter(r.result,"nvarchar")}),a&&a.identifier?((o=c.manager.createQueryBuilder().update(this.queryResultCacheTable).set(s)).where(o.escape("identifier")+" = :condition",{condition:s.identifier}),[4,o.execute()]):[3,2];case 1:return e.sent(),[3,6];case 2:return a&&a.query?(o=c.manager.createQueryBuilder().update(this.queryResultCacheTable).set(s),this.connection.driver instanceof n.OracleDriver?o.where('dbms_lob.compare("query", :condition) = 0',{condition:s.query}):o.where(o.escape("query")+" = :condition",{condition:s.query}),[4,o.execute()]):[3,4];case 3:return e.sent(),[3,6];case 4:return[4,c.manager.createQueryBuilder().insert().into(this.queryResultCacheTable).values(s).execute()];case 5:e.sent(),e.label=6;case 6:return[2]}})})},a.prototype.clear=function(r){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,this.getQueryRunner(r).clearTable(this.queryResultCacheTable)]})})},a.prototype.remove=function(r,t){return e.__awaiter(this,void 0,void 0,function(){var i=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,Promise.all(r.map(function(e){var r=i.getQueryRunner(t).manager.createQueryBuilder();return r.delete().from(i.queryResultCacheTable).where(r.escape("identifier")+" = :identifier",{identifier:e}).execute()}))];case 1:return e.sent(),[2]}})})},a.prototype.getQueryRunner=function(e){return e||this.connection.createQueryRunner("master")},a}();exports.DbQueryResultCache=c;
},{"tslib":"c4AP","../schema-builder/table/Table":"e+Cn","../driver/sqlserver/SqlServerDriver":"sMRg","../driver/sqlserver/MssqlParameter":"FBTY","../driver/oracle/OracleDriver":"l9nz"}],"lqv5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QueryResultCacheFactory=void 0;var e=require("./RedisQueryResultCache"),t=require("./DbQueryResultCache"),o=function(){function o(e){this.connection=e}return o.prototype.create=function(){if(!this.connection.options.cache)throw new Error("To use cache you need to enable it in connection options by setting cache: true or providing some caching options. Example: { host: ..., username: ..., cache: true }");return"redis"===this.connection.options.cache.type?new e.RedisQueryResultCache(this.connection,"redis"):"ioredis"===this.connection.options.cache.type?new e.RedisQueryResultCache(this.connection,"ioredis"):"ioredis/cluster"===this.connection.options.cache.type?new e.RedisQueryResultCache(this.connection,"ioredis/cluster"):new t.DbQueryResultCache(this.connection)},o}();exports.QueryResultCacheFactory=o;
},{"./RedisQueryResultCache":"NNS3","./DbQueryResultCache":"ktnX"}],"j4HD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationLoader=void 0;var e=n(require("tslib"));function n(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};r.get||r.set?Object.defineProperty(n,t,r):n[t]=e[t]}return n.default=e,n}var t=function(){function n(e){this.connection=e}return n.prototype.load=function(e,n,t){return t&&t.isReleased&&(t=void 0),e.isManyToOne||e.isOneToOneOwner?this.loadManyToOneOrOneToOneOwner(e,n,t):e.isOneToMany||e.isOneToOneNotOwner?this.loadOneToManyOrOneToOneNotOwner(e,n,t):e.isManyToManyOwner?this.loadManyToManyOwner(e,n,t):this.loadManyToManyNotOwner(e,n,t)},n.prototype.loadManyToOneOrOneToOneOwner=function(e,n,t){var r=n instanceof Array?n:[n],o=e.entityMetadata.primaryColumns,a=(e.isOwning?e.joinColumns:e.inverseRelation.joinColumns).map(function(n){return e.entityMetadata.name+"."+n.propertyName+" = "+e.propertyName+"."+n.referencedColumn.propertyName}).join(" AND "),i=e.entityMetadata.name,p=this.connection.createQueryBuilder(t).select(e.propertyName).from(e.type,e.propertyName).innerJoin(e.entityMetadata.target,i,a);if(1===o.length)p.where(i+"."+o[0].propertyPath+" IN (:..."+i+"_"+o[0].propertyName+")"),p.setParameter(i+"_"+o[0].propertyName,r.map(function(e){return o[0].getEntityValue(e)}));else{var u=r.map(function(e,n){return o.map(function(t,r){var o=i+"_entity_"+n+"_"+r;return p.setParameter(o,t.getEntityValue(e)),i+"."+t.propertyPath+" = :"+o}).join(" AND ")}).map(function(e){return"("+e+")"}).join(" OR ");p.where(u)}return p.getMany()},n.prototype.loadOneToManyOrOneToOneNotOwner=function(e,n,t){var r=n instanceof Array?n:[n],o=e.propertyName,a=e.inverseRelation.joinColumns,i=this.connection.createQueryBuilder(t).select(o).from(e.inverseRelation.entityMetadata.target,o);if(1===a.length)i.where(o+"."+a[0].propertyPath+" IN (:..."+o+"_"+a[0].propertyName+")"),i.setParameter(o+"_"+a[0].propertyName,r.map(function(e){return a[0].referencedColumn.getEntityValue(e)}));else{var p=r.map(function(e,n){return a.map(function(t,r){var a=o+"_entity_"+n+"_"+r;return i.setParameter(a,t.referencedColumn.getEntityValue(e)),o+"."+t.propertyPath+" = :"+a}).join(" AND ")}).map(function(e){return"("+e+")"}).join(" OR ");i.where(p)}return i.getMany()},n.prototype.loadManyToManyOwner=function(n,t,r){var o=t instanceof Array?t:[t],a=n.propertyName,i=n.junctionEntityMetadata.tableName,p=n.joinColumns.map(function(e){return i+"."+e.propertyName+" IN (:..."+e.propertyName+")"}),u=n.inverseJoinColumns.map(function(e){return i+"."+e.propertyName+"="+a+"."+e.referencedColumn.propertyName}),y=n.joinColumns.reduce(function(e,n){return e[n.propertyName]=o.map(function(e){return n.referencedColumn.getEntityValue(e)}),e},{});return this.connection.createQueryBuilder(r).select(a).from(n.type,a).innerJoin(i,i,e.__spread(p,u).join(" AND ")).setParameters(y).getMany()},n.prototype.loadManyToManyNotOwner=function(n,t,r){var o=t instanceof Array?t:[t],a=n.propertyName,i=n.junctionEntityMetadata.tableName,p=n.inverseRelation.joinColumns.map(function(e){return i+"."+e.propertyName+" = "+a+"."+e.referencedColumn.propertyName}),u=n.inverseRelation.inverseJoinColumns.map(function(e){return i+"."+e.propertyName+" IN (:..."+e.propertyName+")"}),y=n.inverseRelation.inverseJoinColumns.reduce(function(e,n){return e[n.propertyName]=o.map(function(e){return n.referencedColumn.getEntityValue(e)}),e},{});return this.connection.createQueryBuilder(r).select(a).from(n.type,a).innerJoin(i,i,e.__spread(p,u).join(" AND ")).setParameters(y).getMany()},n.prototype.enableLazyLoad=function(e,n,t){var r=this,o="__"+e.propertyName+"__",a="__promise_"+e.propertyName+"__",i="__has_"+e.propertyName+"__";Object.defineProperty(n,e.propertyName,{get:function(){var n=this;return!0===this[i]||this[o]?Promise.resolve(this[o]):this[a]?this[a]:(this[a]=r.load(e,this,t).then(function(t){return(e.isOneToOne||e.isManyToOne)&&(t=t[0]),n[o]=t,n[i]=!0,delete n[a],n[o]}),this[a])},set:function(e){var n=this;e instanceof Promise?e.then(function(e){n[o]=e,n[i]=!0}):(this[o]=e,this[i]=!0)},configurable:!0})},n}();exports.RelationLoader=t;
},{"tslib":"c4AP"}],"l3jK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationIdLoader=void 0;var e=n(require("tslib")),t=require("../metadata/RelationMetadata");function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}var r=function(){function n(e){this.connection=e}return n.prototype.load=function(n,r,a,o){return e.__awaiter(this,void 0,void 0,function(){var i,u,c,l;return e.__generator(this,function(e){if(n instanceof t.RelationMetadata)i=n,u=r instanceof Array?r:[r],c=a instanceof Array?a:a?[a]:void 0;else{if(l=this.connection.getMetadata(n),!(i=l.findRelationWithPropertyPath(r)))throw new Error('Relation "'+i+'" was not found in "'+l.name+'".');u=a instanceof Array?a:[a],c=o instanceof Array?o:o?[o]:void 0}return i.isManyToMany?[2,this.loadForManyToMany(i,u,c)]:i.isManyToOne||i.isOneToOneOwner?[2,this.loadForManyToOneAndOneToOneOwner(i,u,c)]:[2,this.loadForOneToManyAndOneToOneNotOwner(i,u,c)]})})},n.prototype.loadManyToManyRelationIdsAndGroup=function(t,n,r){return e.__awaiter(this,void 0,void 0,function(){var a,o,i,u,c,l;return e.__generator(this,function(e){switch(e.label){case 0:return a=t.isManyToMany||t.isOneToMany,o=n instanceof Array?n:[n],r?[3,2]:[4,this.connection.relationLoader.load(t,n)];case 1:if(!(r=e.sent()).length)return[2,o.map(function(e){return{entity:e,related:a?[]:void 0}})];e.label=2;case 2:return[4,this.load(t,n,r)];case 3:return i=e.sent(),u=r instanceof Array?r:[r],t.isManyToManyOwner?(c=t.junctionEntityMetadata.inverseColumns.map(function(e){return e.referencedColumn}),l=t.junctionEntityMetadata.ownerColumns.map(function(e){return e.referencedColumn})):t.isManyToManyNotOwner?(c=t.junctionEntityMetadata.ownerColumns.map(function(e){return e.referencedColumn}),l=t.junctionEntityMetadata.inverseColumns.map(function(e){return e.referencedColumn})):t.isManyToOne||t.isOneToOneOwner?(c=t.joinColumns.map(function(e){return e.referencedColumn}),l=t.entityMetadata.primaryColumns):(t.isOneToMany||t.isOneToOneNotOwner)&&(c=t.inverseRelation.entityMetadata.primaryColumns,l=t.inverseRelation.joinColumns.map(function(e){return e.referencedColumn})),[2,o.map(function(e){var n={entity:e,related:a?[]:void 0};return i.forEach(function(r){l.every(function(t){return t.getEntityValue(e)===r[t.entityMetadata.name+"_"+t.propertyPath.replace(".","_")]})&&u.forEach(function(e){c.every(function(n){return n.getEntityValue(e)===r[n.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+n.propertyPath.replace(".","_")]})&&(a?n.related.push(e):n.related=e)})}),n})]}})})},n.prototype.loadForManyToMany=function(e,t,n){var r=e.junctionEntityMetadata,a=r.name,o=e.isOwning?r.ownerColumns:r.inverseColumns,i=e.isOwning?r.inverseColumns:r.ownerColumns,u=this.connection.createQueryBuilder();r.ownerColumns.forEach(function(e){var t=e.referencedColumn.entityMetadata.name+"_"+e.referencedColumn.propertyPath.replace(".","_");u.addSelect(a+"."+e.propertyPath,t)}),r.inverseColumns.forEach(function(t){var n=t.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+t.referencedColumn.propertyPath.replace(".","_");u.addSelect(a+"."+t.propertyPath,n)});var c="";1===o.length?(u.setParameter("values1",t.map(function(e){return o[0].referencedColumn.getEntityValue(e)})),c=a+"."+o[0].propertyPath+" IN (:...values1)"):c="("+t.map(function(e,t){return o.map(function(n){var r="entity1_"+t+"_"+n.propertyName;return u.setParameter(r,n.referencedColumn.getEntityValue(e)),a+"."+n.propertyPath+" = :"+r}).join(" AND ")}).map(function(e){return"("+e+")"}).join(" OR ")+")";var l="";return n&&(1===i.length?(u.setParameter("values2",n.map(function(e){return i[0].referencedColumn.getEntityValue(e)})),l=a+"."+i[0].propertyPath+" IN (:...values2)"):l="("+n.map(function(e,t){return i.map(function(n){var r="entity2_"+t+"_"+n.propertyName;return u.setParameter(r,n.referencedColumn.getEntityValue(e)),a+"."+n.propertyPath+" = :"+r}).join(" AND ")}).map(function(e){return"("+e+")"}).join(" OR ")+")"),u.from(r.target,a).where(c+(l?" AND "+l:"")).getRawMany()},n.prototype.loadForManyToOneAndOneToOneOwner=function(e,t,n){var r=e.entityMetadata.targetName,a=this.connection.createQueryBuilder();e.entityMetadata.primaryColumns.forEach(function(e){var t=e.entityMetadata.name+"_"+e.propertyPath.replace(".","_");a.addSelect(r+"."+e.propertyPath,t)}),e.joinColumns.forEach(function(t){var n=t.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+t.referencedColumn.propertyPath.replace(".","_");a.addSelect(r+"."+t.propertyPath,n)});var o="";return 1===e.entityMetadata.primaryColumns.length?(a.setParameter("values",t.map(function(t){return e.entityMetadata.primaryColumns[0].getEntityValue(t)})),o=r+"."+e.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)"):o=t.map(function(t,n){return e.entityMetadata.primaryColumns.map(function(e,o){var i="entity"+n+"_"+o;return a.setParameter(i,e.getEntityValue(t)),r+"."+e.propertyPath+" = :"+i}).join(" AND ")}).map(function(e){return"("+e+")"}).join(" OR "),a.from(e.entityMetadata.target,r).where(o).getRawMany()},n.prototype.loadForOneToManyAndOneToOneNotOwner=function(e,t,n){var r=(e=e.inverseRelation).entityMetadata.targetName,a=this.connection.createQueryBuilder();e.entityMetadata.primaryColumns.forEach(function(t){var n=t.entityMetadata.name+"_"+e.inverseRelation.propertyPath.replace(".","_")+"_"+t.propertyPath.replace(".","_");a.addSelect(r+"."+t.propertyPath,n)}),e.joinColumns.forEach(function(e){var t=e.referencedColumn.entityMetadata.name+"_"+e.referencedColumn.propertyPath.replace(".","_");a.addSelect(r+"."+e.propertyPath,t)});var o="";return 1===e.joinColumns.length?(a.setParameter("values",t.map(function(t){return e.joinColumns[0].referencedColumn.getEntityValue(t)})),o=r+"."+e.joinColumns[0].propertyPath+" IN (:...values)"):o=t.map(function(t,n){return e.joinColumns.map(function(e,o){var i="entity"+n+"_"+o;return a.setParameter(i,e.referencedColumn.getEntityValue(t)),r+"."+e.propertyPath+" = :"+i}).join(" AND ")}).map(function(e){return"("+e+")"}).join(" OR "),a.from(e.entityMetadata.target,r).where(o).getRawMany()},n}();exports.RelationIdLoader=r;
},{"tslib":"c4AP","../metadata/RelationMetadata":"NlpZ"}],"TRA1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Connection=void 0;var e=q(require("tslib")),t=require("../naming-strategy/DefaultNamingStrategy"),r=require("../error/CannotExecuteNotConnectedError"),n=require("../error/CannotConnectAlreadyConnectedError"),i=require("../error/EntityMetadataNotFoundError"),a=require("../migration/MigrationExecutor"),o=require("../driver/mongodb/MongoDriver"),s=require("../entity-manager/MongoEntityManager"),u=require("../metadata-builder/EntityMetadataValidator"),c=require("../error/QueryRunnerProviderAlreadyReleasedError"),h=require("../entity-manager/EntityManagerFactory"),d=require("../driver/DriverFactory"),l=require("./ConnectionMetadataBuilder"),y=require("../query-builder/SelectQueryBuilder"),g=require("../logger/LoggerFactory"),f=require("../cache/QueryResultCacheFactory"),p=require("../entity-manager/SqljsEntityManager"),b=require("../query-builder/RelationLoader"),v=require("../query-builder/RelationIdLoader"),M=require("../"),w=require("../driver/sqlserver/SqlServerDriver"),m=require("../driver/mysql/MysqlDriver"),E=require("../util/ObjectUtils");function q(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var C=function(){function q(e){this.migrations=[],this.subscribers=[],this.entityMetadatas=[],this.name=e.name||"default",this.options=e,this.logger=(new g.LoggerFactory).create(this.options.logger,this.options.logging),this.driver=(new d.DriverFactory).create(this),this.manager=this.createEntityManager(),this.namingStrategy=e.namingStrategy||new t.DefaultNamingStrategy,this.queryResultCache=e.cache?new f.QueryResultCacheFactory(this).create():void 0,this.relationLoader=new b.RelationLoader(this),this.relationIdLoader=new v.RelationIdLoader(this),this.isConnected=!1}return Object.defineProperty(q.prototype,"mongoManager",{get:function(){if(!(this.manager instanceof s.MongoEntityManager))throw new Error("MongoEntityManager is only available for MongoDB databases.");return this.manager},enumerable:!0,configurable:!0}),Object.defineProperty(q.prototype,"sqljsManager",{get:function(){if(!(this.manager instanceof p.SqljsEntityManager))throw new Error("SqljsEntityManager is only available for Sqljs databases.");return this.manager},enumerable:!0,configurable:!0}),q.prototype.connect=function(){return e.__awaiter(this,void 0,void 0,function(){var t;return e.__generator(this,function(e){switch(e.label){case 0:if(this.isConnected)throw new n.CannotConnectAlreadyConnectedError(this.name);return[4,this.driver.connect()];case 1:return e.sent(),this.queryResultCache?[4,this.queryResultCache.connect()]:[3,3];case 2:e.sent(),e.label=3;case 3:E.ObjectUtils.assign(this,{isConnected:!0}),e.label=4;case 4:return e.trys.push([4,12,,14]),this.buildMetadatas(),[4,this.driver.afterConnect()];case 5:return e.sent(),this.options.dropSchema?[4,this.dropDatabase()]:[3,7];case 6:e.sent(),e.label=7;case 7:return this.options.synchronize?[4,this.synchronize()]:[3,9];case 8:e.sent(),e.label=9;case 9:return this.options.migrationsRun?[4,this.runMigrations()]:[3,11];case 10:e.sent(),e.label=11;case 11:return[3,14];case 12:return t=e.sent(),[4,this.close()];case 13:throw e.sent(),t;case 14:return[2,this]}})})},q.prototype.close=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:if(!this.isConnected)throw new r.CannotExecuteNotConnectedError(this.name);return[4,this.driver.disconnect()];case 1:return e.sent(),this.queryResultCache?[4,this.queryResultCache.disconnect()]:[3,3];case 2:e.sent(),e.label=3;case 3:return E.ObjectUtils.assign(this,{isConnected:!1}),[2]}})})},q.prototype.synchronize=function(t){return void 0===t&&(t=!1),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:if(!this.isConnected)throw new r.CannotExecuteNotConnectedError(this.name);return t?[4,this.dropDatabase()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[4,this.driver.createSchemaBuilder().build()];case 3:return e.sent(),[2]}})})},q.prototype.dropDatabase=function(){return e.__awaiter(this,void 0,void 0,function(){var t,r;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.createQueryRunner("master")];case 1:t=e.sent(),e.label=2;case 2:return e.trys.push([2,,7,9]),this.driver instanceof w.SqlServerDriver||this.driver instanceof m.MysqlDriver?(r=this.driver.database?[this.driver.database]:[],this.entityMetadatas.forEach(function(e){e.database&&-1===r.indexOf(e.database)&&r.push(e.database)}),[4,M.PromiseUtils.runInSequence(r,function(e){return t.clearDatabase(e)})]):[3,4];case 3:return e.sent(),[3,6];case 4:return[4,t.clearDatabase()];case 5:e.sent(),e.label=6;case 6:return[3,9];case 7:return[4,t.release()];case 8:return e.sent(),[7];case 9:return[2]}})})},q.prototype.runMigrations=function(t){return e.__awaiter(this,void 0,void 0,function(){var n;return e.__generator(this,function(e){switch(e.label){case 0:if(!this.isConnected)throw new r.CannotExecuteNotConnectedError(this.name);return n=new a.MigrationExecutor(this),t&&!1===t.transaction&&(n.transaction=!1),[4,n.executePendingMigrations()];case 1:return[2,e.sent()]}})})},q.prototype.undoLastMigration=function(t){return e.__awaiter(this,void 0,void 0,function(){var n;return e.__generator(this,function(e){switch(e.label){case 0:if(!this.isConnected)throw new r.CannotExecuteNotConnectedError(this.name);return n=new a.MigrationExecutor(this),t&&!1===t.transaction&&(n.transaction=!1),[4,n.undoLastMigration()];case 1:return e.sent(),[2]}})})},q.prototype.showMigrations=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:if(!this.isConnected)throw new r.CannotExecuteNotConnectedError(this.name);return[4,new a.MigrationExecutor(this).showMigrations()];case 1:return[2,e.sent()]}})})},q.prototype.hasMetadata=function(e){return!!this.findMetadata(e)},q.prototype.getMetadata=function(e){var t=this.findMetadata(e);if(!t)throw new i.EntityMetadataNotFoundError(e);return t},q.prototype.getRepository=function(e){return this.manager.getRepository(e)},q.prototype.getTreeRepository=function(e){return this.manager.getTreeRepository(e)},q.prototype.getMongoRepository=function(e){if(!(this.driver instanceof o.MongoDriver))throw new Error("You can use getMongoRepository only for MongoDB connections.");return this.manager.getRepository(e)},q.prototype.getCustomRepository=function(e){return this.manager.getCustomRepository(e)},q.prototype.transaction=function(t,r){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return[2,this.manager.transaction(t,r)]})})},q.prototype.query=function(t,r,n){return e.__awaiter(this,void 0,void 0,function(){var i;return e.__generator(this,function(e){switch(e.label){case 0:if(this instanceof s.MongoEntityManager)throw new Error("Queries aren't supported by MongoDB.");if(n&&n.isReleased)throw new c.QueryRunnerProviderAlreadyReleasedError;i=n||this.createQueryRunner("master"),e.label=1;case 1:return e.trys.push([1,,3,6]),[4,i.query(t,r)];case 2:return[2,e.sent()];case 3:return n?[3,5]:[4,i.release()];case 4:e.sent(),e.label=5;case 5:return[7];case 6:return[2]}})})},q.prototype.createQueryBuilder=function(e,t,r){if(this instanceof s.MongoEntityManager)throw new Error("Query Builder is not supported by MongoDB.");if(t){var n=this.getMetadata(e);return new y.SelectQueryBuilder(this,r).select(t).from(n.target,t)}return new y.SelectQueryBuilder(this,e)},q.prototype.createQueryRunner=function(e){void 0===e&&(e="master");var t=this.driver.createQueryRunner(e),r=this.createEntityManager(t);return Object.assign(t,{manager:r}),t},q.prototype.getManyToManyMetadata=function(e,t){var r=this.getMetadata(e).findRelationWithPropertyPath(t);if(!r)throw new Error('Relation "'+t+'" was not found in '+e+" entity.");if(!r.isManyToMany)throw new Error('Relation "'+e+"#"+t+'" does not have a many-to-many relationship.You can use this method only on many-to-many relations.');return r.junctionEntityMetadata},q.prototype.createEntityManager=function(e){return(new h.EntityManagerFactory).create(this,e)},q.prototype.findMetadata=function(e){return this.entityMetadatas.find(function(t){return t.target===e||(e instanceof M.EntitySchema?t.name===e.options.name:"string"==typeof e&&(-1!==e.indexOf(".")?t.tablePath===e:t.name===e||t.tableName===e))})},q.prototype.buildMetadatas=function(){var e=new l.ConnectionMetadataBuilder(this),t=new u.EntityMetadataValidator,r=e.buildSubscribers(this.options.subscribers||[]);E.ObjectUtils.assign(this,{subscribers:r});var n=e.buildEntityMetadatas(this.options.entities||[]);E.ObjectUtils.assign(this,{entityMetadatas:n});var i=e.buildMigrations(this.options.migrations||[]);E.ObjectUtils.assign(this,{migrations:i}),t.validateMany(this.entityMetadatas.filter(function(e){return"view"!==e.tableType}),this.driver)},q}();exports.Connection=C;
},{"tslib":"c4AP","../naming-strategy/DefaultNamingStrategy":"DPOO","../error/CannotExecuteNotConnectedError":"wK9M","../error/CannotConnectAlreadyConnectedError":"I5R+","../error/EntityMetadataNotFoundError":"vp4m","../migration/MigrationExecutor":"ncIU","../driver/mongodb/MongoDriver":"TOLf","../entity-manager/MongoEntityManager":"TOLf","../metadata-builder/EntityMetadataValidator":"A5sy","../error/QueryRunnerProviderAlreadyReleasedError":"sQhW","../entity-manager/EntityManagerFactory":"cdud","../driver/DriverFactory":"9r33","./ConnectionMetadataBuilder":"g+iS","../query-builder/SelectQueryBuilder":"lbRQ","../logger/LoggerFactory":"AsxB","../cache/QueryResultCacheFactory":"lqv5","../entity-manager/SqljsEntityManager":"Bmim","../query-builder/RelationLoader":"j4HD","../query-builder/RelationIdLoader":"l3jK","../":"wlNf","../driver/sqlserver/SqlServerDriver":"sMRg","../driver/mysql/MysqlDriver":"TOLf","../util/ObjectUtils":"41H8"}],"foyp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConnectionNotFoundError=void 0;var e=r(require("tslib"));function r(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}var t=function(r){function t(e){var o=r.call(this)||this;return o.name="ConnectionNotFoundError",Object.setPrototypeOf(o,t.prototype),o.message='Connection "'+e+'" was not found.',o}return e.__extends(t,r),t}(Error);exports.ConnectionNotFoundError=t;
},{"tslib":"c4AP"}],"wyOL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AlreadyHasActiveConnectionError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e){var n=t.call(this)||this;return n.name="AlreadyHasActiveConnectionError",Object.setPrototypeOf(n,r.prototype),n.message='Cannot create a new connection named "'+e+'", because connection with such name already exist and it now has an active connection session.',n}return e.__extends(r,t),r}(Error);exports.AlreadyHasActiveConnectionError=r;
},{"tslib":"c4AP"}],"byiK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConnectionManager=void 0;var n=require("./Connection"),e=require("../error/ConnectionNotFoundError"),o=require("../error/AlreadyHasActiveConnectionError"),t=function(){function t(){this.connections=[]}return t.prototype.has=function(n){return!!this.connections.find(function(e){return e.name===n})},t.prototype.get=function(n){void 0===n&&(n="default");var o=this.connections.find(function(e){return e.name===n});if(!o)throw new e.ConnectionNotFoundError(n);return o},t.prototype.create=function(e){var t=this.connections.find(function(n){return n.name===(e.name||"default")});if(t){if(t.isConnected)throw new o.AlreadyHasActiveConnectionError(e.name||"default");this.connections.splice(this.connections.indexOf(t),1)}var r=new n.Connection(e);return this.connections.push(r),r},t}();exports.ConnectionManager=t;
},{"./Connection":"TRA1","../error/ConnectionNotFoundError":"foyp","../error/AlreadyHasActiveConnectionError":"wyOL"}],"Fo3F":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConnectionOptionsEnvReader=void 0;var o=require("../../platform/PlatformTools"),r=require("../../util/OrmUtils"),a=function(){function a(){}return a.prototype.read=function(){return{type:o.PlatformTools.getEnvVariable("TYPEORM_CONNECTION")||(o.PlatformTools.getEnvVariable("TYPEORM_URL")?o.PlatformTools.getEnvVariable("TYPEORM_URL").split("://")[0]:void 0),url:o.PlatformTools.getEnvVariable("TYPEORM_URL"),host:o.PlatformTools.getEnvVariable("TYPEORM_HOST"),port:o.PlatformTools.getEnvVariable("TYPEORM_PORT"),username:o.PlatformTools.getEnvVariable("TYPEORM_USERNAME"),password:o.PlatformTools.getEnvVariable("TYPEORM_PASSWORD"),database:o.PlatformTools.getEnvVariable("TYPEORM_DATABASE"),sid:o.PlatformTools.getEnvVariable("TYPEORM_SID"),schema:o.PlatformTools.getEnvVariable("TYPEORM_SCHEMA"),extra:o.PlatformTools.getEnvVariable("TYPEORM_DRIVER_EXTRA")?JSON.parse(o.PlatformTools.getEnvVariable("TYPEORM_DRIVER_EXTRA")):void 0,synchronize:r.OrmUtils.toBoolean(o.PlatformTools.getEnvVariable("TYPEORM_SYNCHRONIZE")),dropSchema:r.OrmUtils.toBoolean(o.PlatformTools.getEnvVariable("TYPEORM_DROP_SCHEMA")),migrationsRun:r.OrmUtils.toBoolean(o.PlatformTools.getEnvVariable("TYPEORM_MIGRATIONS_RUN")),entities:this.stringToArray(o.PlatformTools.getEnvVariable("TYPEORM_ENTITIES")),migrations:this.stringToArray(o.PlatformTools.getEnvVariable("TYPEORM_MIGRATIONS")),migrationsTableName:o.PlatformTools.getEnvVariable("TYPEORM_MIGRATIONS_TABLE_NAME"),subscribers:this.stringToArray(o.PlatformTools.getEnvVariable("TYPEORM_SUBSCRIBERS")),logging:this.transformLogging(o.PlatformTools.getEnvVariable("TYPEORM_LOGGING")),logger:o.PlatformTools.getEnvVariable("TYPEORM_LOGGER"),entityPrefix:o.PlatformTools.getEnvVariable("TYPEORM_ENTITY_PREFIX"),maxQueryExecutionTime:o.PlatformTools.getEnvVariable("TYPEORM_MAX_QUERY_EXECUTION_TIME"),debug:o.PlatformTools.getEnvVariable("TYPEORM_DEBUG"),cli:{entitiesDir:o.PlatformTools.getEnvVariable("TYPEORM_ENTITIES_DIR"),migrationsDir:o.PlatformTools.getEnvVariable("TYPEORM_MIGRATIONS_DIR"),subscribersDir:o.PlatformTools.getEnvVariable("TYPEORM_SUBSCRIBERS_DIR")},cache:this.transformCaching(),uuidExtension:o.PlatformTools.getEnvVariable("TYPEORM_UUID_EXTENSION")}},a.prototype.transformLogging=function(o){return"true"===o||"TRUE"===o||"1"===o||("all"===o?"all":this.stringToArray(o))},a.prototype.transformCaching=function(){var r=o.PlatformTools.getEnvVariable("TYPEORM_CACHE");return"true"===r||"TRUE"===r||"1"===r||"false"!==r&&"FALSE"!==r&&"0"!==r&&("redis"===r||"database"===r?{type:r,options:o.PlatformTools.getEnvVariable("TYPEORM_CACHE_OPTIONS")?JSON.parse(o.PlatformTools.getEnvVariable("TYPEORM_CACHE_OPTIONS")):void 0,alwaysEnabled:o.PlatformTools.getEnvVariable("TYPEORM_CACHE_ALWAYS_ENABLED"),duration:parseInt(o.PlatformTools.getEnvVariable("TYPEORM_CACHE_DURATION"))}:void 0)},a.prototype.stringToArray=function(o){return o?o.split(",").map(function(o){return o.trim()}):[]},a}();exports.ConnectionOptionsEnvReader=a;
},{"../../platform/PlatformTools":"YF44","../../util/OrmUtils":"R//v"}],"ZxSk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConnectionOptionsYmlReader=void 0;var e=require("../../platform/PlatformTools"),o=function(){function o(){}return o.prototype.read=function(o){var t=e.PlatformTools.load("js-yaml").safeLoad(e.PlatformTools.readFileSync(o));return Object.keys(t).map(function(e){return Object.assign({name:e},t[e])})},o}();exports.ConnectionOptionsYmlReader=o;
},{"../../platform/PlatformTools":"YF44"}],"z/eX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConnectionOptionsXmlReader=void 0;var e=r(require("tslib")),t=require("../../platform/PlatformTools");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}var o=function(){function r(){}return r.prototype.read=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.readXml(t)];case 1:return[2,e.sent().connection.map(function(e){return{name:e.$.name,type:e.$.type,url:e.url?e.url[0]:void 0,host:e.host?e.host[0]:void 0,port:e.port&&e.port[0]?parseInt(e.port[0]):void 0,username:e.username?e.username[0]:void 0,password:e.password?e.password[0]:void 0,database:e.database?e.database[0]:void 0,sid:e.sid?e.sid[0]:void 0,extra:e.extra?e.extra[0]:void 0,synchronize:e.synchronize?e.synchronize[0]:void 0,entities:e.entities?e.entities[0].entity:[],subscribers:e.subscribers?e.subscribers[0].entity:[],logging:e.logging[0]?e.logging[0].split(","):void 0}})]}})})},r.prototype.readXml=function(e){var r=t.PlatformTools.load("xml2js").parseString,o={trim:!0,explicitRoot:!1};return new Promise(function(n,i){r(t.PlatformTools.readFileSync(e),o,function(e,t){return e?i(e):n(t)})})},r}();exports.ConnectionOptionsXmlReader=o;
},{"tslib":"c4AP","../../platform/PlatformTools":"YF44"}],"f3df":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConnectionOptionsReader=void 0;var e=i(require("tslib")),t=require("../platform/PlatformTools"),n=require("./options-reader/ConnectionOptionsEnvReader"),r=require("./options-reader/ConnectionOptionsYmlReader"),o=require("./options-reader/ConnectionOptionsXmlReader");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}var a=function(){function i(e){this.options=e}return i.prototype.all=function(){return e.__awaiter(this,void 0,void 0,function(){var t;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.load()];case 1:if(!(t=e.sent()))throw new Error("No connection options were found in any of configurations file.");return[2,t]}})})},i.prototype.get=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.all()];case 1:if(n=e.sent(),!(r=n.find(function(e){return e.name===t||"default"===t&&!e.name})))throw new Error("Cannot find connection "+t+" because its not defined in any orm configuration files.");return[2,r]}})})},i.prototype.has=function(t){return e.__awaiter(this,void 0,void 0,function(){var n;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.load()];case 1:return(n=e.sent())?[2,!!n.find(function(e){return e.name===t||"default"===t&&!e.name})]:[2,!1]}})})},i.prototype.load=function(){return e.__awaiter(this,void 0,void 0,function(){var i,a,s,c,u,l,f=this;return e.__generator(this,function(e){switch(e.label){case 0:return i=void 0,a=["env","js","ts","json","yml","yaml","xml"],s=this.baseFilePath.substr(this.baseFilePath.lastIndexOf(".")),c=a.find(function(e){return"."+e===s}),"env"===(u=c||a.find(function(e){return t.PlatformTools.fileExist(f.baseFilePath+"."+e)}))?t.PlatformTools.load("dotenv").config({path:this.baseFilePath}):t.PlatformTools.fileExist(".env")&&t.PlatformTools.load("dotenv").config({path:".env"}),l=c?this.baseFilePath:this.baseFilePath+"."+u,t.PlatformTools.getEnvVariable("TYPEORM_CONNECTION")||t.PlatformTools.getEnvVariable("TYPEORM_URL")?(i=(new n.ConnectionOptionsEnvReader).read(),[3,8]):[3,1];case 1:return"js"!==u?[3,2]:(i=t.PlatformTools.load(l),[3,8]);case 2:return"ts"!==u?[3,3]:(i=t.PlatformTools.load(l),[3,8]);case 3:return"json"!==u?[3,4]:(i=t.PlatformTools.load(l),[3,8]);case 4:return"yml"!==u?[3,5]:(i=(new r.ConnectionOptionsYmlReader).read(l),[3,8]);case 5:return"yaml"!==u?[3,6]:(i=(new r.ConnectionOptionsYmlReader).read(l),[3,8]);case 6:return"xml"!==u?[3,8]:[4,(new o.ConnectionOptionsXmlReader).read(l)];case 7:i=e.sent(),e.label=8;case 8:return i?[2,this.normalizeConnectionOptions(i)]:[2,void 0]}})})},i.prototype.normalizeConnectionOptions=function(e){var t=this;return e instanceof Array||(e=[e]),e.forEach(function(n){if(n.entities){var r=n.entities.map(function(e){return"string"==typeof e&&"/"!==e.substr(0,1)?t.baseDirectory+"/"+e:e});Object.assign(e,{entities:r})}if(n.subscribers){var o=n.subscribers.map(function(e){return"string"==typeof e&&"/"!==e.substr(0,1)?t.baseDirectory+"/"+e:e});Object.assign(e,{subscribers:o})}if(n.migrations){var i=n.migrations.map(function(e){return"string"==typeof e&&"/"!==e.substr(0,1)?t.baseDirectory+"/"+e:e});Object.assign(e,{migrations:i})}"sqlite"===n.type&&"string"==typeof n.database&&"/"!==n.database.substr(0,1)&&":\\"!==n.database.substr(1,2)&&":memory:"!==n.database&&Object.assign(n,{database:t.baseDirectory+"/"+n.database})}),e},Object.defineProperty(i.prototype,"baseFilePath",{get:function(){return this.baseDirectory+"/"+this.baseConfigName},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"baseDirectory",{get:function(){return this.options&&this.options.root?this.options.root:t.PlatformTools.load("app-root-path").path},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"baseConfigName",{get:function(){return this.options&&this.options.configName?this.options.configName:"ormconfig"},enumerable:!0,configurable:!0}),i}();exports.ConnectionOptionsReader=a;
},{"tslib":"c4AP","../platform/PlatformTools":"YF44","./options-reader/ConnectionOptionsEnvReader":"Fo3F","./options-reader/ConnectionOptionsYmlReader":"ZxSk","./options-reader/ConnectionOptionsXmlReader":"z/eX"}],"l0CY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColumnTypeUndefinedError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e,o){var n=t.call(this)||this;return n.name="ColumnTypeUndefinedError",Object.setPrototypeOf(n,r.prototype),n.message="Column type for "+e.constructor.name+"#"+o+' is not defined and cannot be guessed. Make sure you have turned on an "emitDecoratorMetadata": true option in tsconfig.json. Also make sure you have imported "reflect-metadata" on top of the main entry file in your application (before any entity imported).If you are using JavaScript instead of TypeScript you must explicitly provide a column type.',n}return e.__extends(r,t),r}(Error);exports.ColumnTypeUndefinedError=r;
},{"tslib":"c4AP"}],"qleF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Column=r;var e=require("../../"),t=require("../../error/ColumnTypeUndefinedError");function r(r,o){return function(a,n){var s;"string"==typeof r||r instanceof Function?s=r:r&&(o=r,s=r.type),o||(o={});var i=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",a,n):void 0;if(!s&&i&&(s=i),!o.type&&s&&(o.type=s),"hstore"!==o.type||o.hstoreType||(o.hstoreType=i===Object?"object":"string"),r instanceof Function)(0,e.getMetadataArgsStorage)().embeddeds.push({target:a.constructor,propertyName:n,isArray:i===Array||!0===o.array,prefix:void 0!==o.prefix?o.prefix:void 0,type:r});else{if(!o.type)throw new t.ColumnTypeUndefinedError(a,n);!0===o.unique&&(0,e.getMetadataArgsStorage)().uniques.push({target:a.constructor,columns:[n]}),(0,e.getMetadataArgsStorage)().columns.push({target:a.constructor,propertyName:n,mode:"regular",options:o}),o.generated&&(0,e.getMetadataArgsStorage)().generations.push({target:a.constructor,propertyName:n,strategy:"string"==typeof o.generated?o.generated:"increment"})}}}
},{"../../":"wlNf","../../error/ColumnTypeUndefinedError":"l0CY"}],"mcqJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CreateDateColumn=t;var e=require("../../");function t(t){return function(r,o){(0,e.getMetadataArgsStorage)().columns.push({target:r.constructor,propertyName:o,mode:"createDate",options:t||{}})}}
},{"../../":"wlNf"}],"u+TS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PrimaryGeneratedColumn=t;var e=require("../../");function t(t,r){var n,a={};return t?("string"==typeof t&&(n=t),t instanceof Object&&(n="increment",Object.assign(a,t))):n="increment",r instanceof Object&&Object.assign(a,r),function(t,r){a.type||("increment"===n?a.type=Number:"uuid"===n?a.type="uuid":"rowid"===n&&(a.type="int")),a.primary=!0,(0,e.getMetadataArgsStorage)().columns.push({target:t.constructor,propertyName:r,mode:"regular",options:a}),(0,e.getMetadataArgsStorage)().generations.push({target:t.constructor,propertyName:r,strategy:n})}}
},{"../../":"wlNf"}],"J831":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PrimaryColumnCannotBeNullableError=void 0;var r=e(require("tslib"));function e(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,t):{};o.get||o.set?Object.defineProperty(e,t,o):e[t]=r[t]}return e.default=r,e}var t=function(e){function t(r,o){var n=e.call(this)||this;return n.name="PrimaryColumnCannotBeNullableError",Object.setPrototypeOf(n,t.prototype),n.message="Primary column "+r.constructor.name+"#"+o+" cannot be nullable. Its not allowed for primary keys. Try to remove nullable option.",n}return r.__extends(t,e),t}(Error);exports.PrimaryColumnCannotBeNullableError=t;
},{"tslib":"c4AP"}],"K6zO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PrimaryColumn=a;var e=require("../../"),r=require("../../error/ColumnTypeUndefinedError"),t=require("../../error/PrimaryColumnCannotBeNullableError");function a(a,o){return function(n,u){var i;"string"==typeof a?i=a:o=a,o||(o={});var l=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",n,u):void 0;if(!i&&l&&(i=l),!o.type&&i&&(o.type=i),!o.type)throw new r.ColumnTypeUndefinedError(n,u);if(o.nullable)throw new t.PrimaryColumnCannotBeNullableError(n,u);o.primary=!0,(0,e.getMetadataArgsStorage)().columns.push({target:n.constructor,propertyName:u,mode:"regular",options:o}),o.generated&&(0,e.getMetadataArgsStorage)().generations.push({target:n.constructor,propertyName:u,strategy:"string"==typeof o.generated?o.generated:"increment"})}}
},{"../../":"wlNf","../../error/ColumnTypeUndefinedError":"l0CY","../../error/PrimaryColumnCannotBeNullableError":"J831"}],"/3Oe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UpdateDateColumn=t;var e=require("../../");function t(t){return function(r,o){(0,e.getMetadataArgsStorage)().columns.push({target:r.constructor,propertyName:o,mode:"updateDate",options:t||{}})}}
},{"../../":"wlNf"}],"/DuP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VersionColumn=r;var e=require("../../");function r(r){return function(t,o){(0,e.getMetadataArgsStorage)().columns.push({target:t.constructor,propertyName:o,mode:"version",options:r||{}})}}
},{"../../":"wlNf"}],"59Mw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewColumn=r;var e=require("../../");function r(){return function(r,t){(0,e.getMetadataArgsStorage)().columns.push({target:r.constructor,propertyName:t,mode:"regular",options:{}})}}
},{"../../":"wlNf"}],"bhYT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ObjectIdColumn=t;var e=require("../../");function t(t){return function(r,o){t||(t={}),t.primary=!0,t.name||(t.name="_id"),(0,e.getMetadataArgsStorage)().columns.push({target:r.constructor,propertyName:o,mode:"objectId",options:t})}}
},{"../../":"wlNf"}],"Fmn9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EventListenerTypes=void 0;var e=function(){function e(){}return e.AFTER_LOAD="after-load",e.BEFORE_INSERT="before-insert",e.AFTER_INSERT="after-insert",e.BEFORE_UPDATE="before-update",e.AFTER_UPDATE="after-update",e.BEFORE_REMOVE="before-remove",e.AFTER_REMOVE="after-remove",e}();exports.EventListenerTypes=e;
},{}],"CWLy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AfterInsert=r;var e=require("../../"),t=require("../../metadata/types/EventListenerTypes");function r(){return function(r,s){(0,e.getMetadataArgsStorage)().entityListeners.push({target:r.constructor,propertyName:s,type:t.EventListenerTypes.AFTER_INSERT})}}
},{"../../":"wlNf","../../metadata/types/EventListenerTypes":"Fmn9"}],"dryV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AfterLoad=r;var e=require("../../"),t=require("../../metadata/types/EventListenerTypes");function r(){return function(r,s){(0,e.getMetadataArgsStorage)().entityListeners.push({target:r.constructor,propertyName:s,type:t.EventListenerTypes.AFTER_LOAD})}}
},{"../../":"wlNf","../../metadata/types/EventListenerTypes":"Fmn9"}],"06Ao":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AfterRemove=r;var e=require("../../"),t=require("../../metadata/types/EventListenerTypes");function r(){return function(r,s){(0,e.getMetadataArgsStorage)().entityListeners.push({target:r.constructor,propertyName:s,type:t.EventListenerTypes.AFTER_REMOVE})}}
},{"../../":"wlNf","../../metadata/types/EventListenerTypes":"Fmn9"}],"Rfdi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AfterUpdate=r;var e=require("../../"),t=require("../../metadata/types/EventListenerTypes");function r(){return function(r,s){(0,e.getMetadataArgsStorage)().entityListeners.push({target:r.constructor,propertyName:s,type:t.EventListenerTypes.AFTER_UPDATE})}}
},{"../../":"wlNf","../../metadata/types/EventListenerTypes":"Fmn9"}],"F2U4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BeforeInsert=r;var e=require("../../"),t=require("../../metadata/types/EventListenerTypes");function r(){return function(r,s){(0,e.getMetadataArgsStorage)().entityListeners.push({target:r.constructor,propertyName:s,type:t.EventListenerTypes.BEFORE_INSERT})}}
},{"../../":"wlNf","../../metadata/types/EventListenerTypes":"Fmn9"}],"meTF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BeforeRemove=r;var e=require("../../"),t=require("../../metadata/types/EventListenerTypes");function r(){return function(r,s){(0,e.getMetadataArgsStorage)().entityListeners.push({target:r.constructor,propertyName:s,type:t.EventListenerTypes.BEFORE_REMOVE})}}
},{"../../":"wlNf","../../metadata/types/EventListenerTypes":"Fmn9"}],"yGdA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BeforeUpdate=r;var e=require("../../"),t=require("../../metadata/types/EventListenerTypes");function r(){return function(r,s){(0,e.getMetadataArgsStorage)().entityListeners.push({target:r.constructor,propertyName:s,type:t.EventListenerTypes.BEFORE_UPDATE})}}
},{"../../":"wlNf","../../metadata/types/EventListenerTypes":"Fmn9"}],"2tYN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EventSubscriber=t;var e=require("../../");function t(){return function(t){(0,e.getMetadataArgsStorage)().entitySubscribers.push({target:t})}}
},{"../../":"wlNf"}],"ft/t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JoinColumn=r;var e=require("../../");function r(r){return function(n,t){(r instanceof Array?r:[r||{}]).forEach(function(r){(0,e.getMetadataArgsStorage)().joinColumns.push({target:n.constructor,propertyName:t,name:r.name,referencedColumnName:r.referencedColumnName})})}}
},{"../../":"wlNf"}],"PSo5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JoinTable=n;var e=require("../../");function n(n){return function(o,a){n=n||{},(0,e.getMetadataArgsStorage)().joinTables.push({target:o.constructor,propertyName:a,name:n.name,joinColumns:n&&n.joinColumn?[n.joinColumn]:n.joinColumns,inverseJoinColumns:n&&n.inverseJoinColumn?[n.inverseJoinColumn]:n.inverseJoinColumns,schema:n&&n.schema?n.schema:void 0,database:n&&n.database?n.database:void 0})}}
},{"../../":"wlNf"}],"B6Zk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ManyToMany=t;var e=require("../../");function t(t,a,r){var o;return"object"==typeof a?r=a:o=a,function(a,n){r||(r={});var s=!0===r.lazy;if(!s&&Reflect&&Reflect.getMetadata){var i=Reflect.getMetadata("design:type",a,n);i&&"string"==typeof i.name&&"promise"===i.name.toLowerCase()&&(s=!0)}(0,e.getMetadataArgsStorage)().relations.push({target:a.constructor,propertyName:n,relationType:"many-to-many",isLazy:s,type:t,inverseSideProperty:o,options:r})}}
},{"../../":"wlNf"}],"rqI9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ManyToOne=t;var e=require("../../");function t(t,r,a){var o;return"object"==typeof r?a=r:o=r,function(r,n){a||(a={});var s=!(!a||!0!==a.lazy);if(!s&&Reflect&&Reflect.getMetadata){var i=Reflect.getMetadata("design:type",r,n);i&&"string"==typeof i.name&&"promise"===i.name.toLowerCase()&&(s=!0)}(0,e.getMetadataArgsStorage)().relations.push({target:r.constructor,propertyName:n,relationType:"many-to-one",isLazy:s,type:t,inverseSideProperty:o,options:a})}}
},{"../../":"wlNf"}],"BaJY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OneToMany=t;var e=require("../../");function t(t,r,a){return function(o,n){a||(a={});var s=!(!a||!0!==a.lazy);if(!s&&Reflect&&Reflect.getMetadata){var i=Reflect.getMetadata("design:type",o,n);i&&"string"==typeof i.name&&"promise"===i.name.toLowerCase()&&(s=!0)}(0,e.getMetadataArgsStorage)().relations.push({target:o.constructor,propertyName:n,isLazy:s,relationType:"one-to-many",type:t,inverseSideProperty:r,options:a})}}
},{"../../":"wlNf"}],"SNSy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OneToOne=t;var e=require("../../");function t(t,r,o){var a;return"object"==typeof r?o=r:a=r,function(r,n){o||(o={});var s=!(!o||!0!==o.lazy);if(!s&&Reflect&&Reflect.getMetadata){var i=Reflect.getMetadata("design:type",r,n);i&&"string"==typeof i.name&&"promise"===i.name.toLowerCase()&&(s=!0)}(0,e.getMetadataArgsStorage)().relations.push({target:r.constructor,propertyName:n,isLazy:s,relationType:"one-to-one",type:t,inverseSideProperty:a,options:o})}}
},{"../../":"wlNf"}],"CBKm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationCount=t;var e=require("../../");function t(t,r,o){return function(a,u){(0,e.getMetadataArgsStorage)().relationCounts.push({target:a.constructor,propertyName:u,relation:t,alias:r,queryBuilderFactory:o})}}
},{"../../":"wlNf"}],"w7SH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelationId=r;var e=require("../../");function r(r,t,a){return function(o,u){(0,e.getMetadataArgsStorage)().relationIds.push({target:o.constructor,propertyName:u,relation:r,alias:t,queryBuilderFactory:a})}}
},{"../../":"wlNf"}],"RdRM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Entity=t;var e=require("../../");function t(t,r){var a=("object"==typeof t?t:r)||{},n="string"==typeof t?t:a.name;return function(t){(0,e.getMetadataArgsStorage)().tables.push({target:t,name:n,type:"regular",orderBy:a.orderBy?a.orderBy:void 0,engine:a.engine?a.engine:void 0,database:a.database?a.database:void 0,schema:a.schema?a.schema:void 0,synchronize:a.synchronize})}}
},{"../../":"wlNf"}],"G4ey":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChildEntity=e;var t=require("../../");function e(e){return function(r){(0,t.getMetadataArgsStorage)().tables.push({target:r,type:"entity-child"}),e&&(0,t.getMetadataArgsStorage)().discriminatorValues.push({target:r,value:e})}}
},{"../../":"wlNf"}],"juLg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TableInheritance=t;var e=require("../../");function t(t){return function(n){(0,e.getMetadataArgsStorage)().inheritances.push({target:n,pattern:t&&t.pattern?t.pattern:"STI",column:t&&t.column?"string"==typeof t.column?{name:t.column}:t.column:void 0})}}
},{"../../":"wlNf"}],"9E0Q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewEntity=t;var e=require("../../");function t(t,a){var s=("object"==typeof t?t:a)||{},r="string"==typeof t?t:s.name;return function(t){(0,e.getMetadataArgsStorage)().tables.push({target:t,name:r,expression:s.expression,type:"view",database:s.database?s.database:void 0,schema:s.schema?s.schema:void 0})}}
},{"../../":"wlNf"}],"BuVI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Transaction=o;var e=r(require("tslib")),t=require("../../");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}function o(r){return function(o,n,a){var i=a.value;a.value=function(){for(var a=this,s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];var p="default",y=void 0;r&&("string"==typeof r?p=r:(r.connectionName&&(p=r.connectionName),r.isolation&&(y=r.isolation)));var u=function(r){var c,p=(0,t.getMetadataArgsStorage)().filterTransactionEntityManagers(o.constructor,n).reverse(),y=(0,t.getMetadataArgsStorage)().filterTransactionRepository(o.constructor,n).reverse();return p.length>0?(c=e.__spread(s),p.forEach(function(e){c.splice(e.index,0,r)})):c=0===y.length?e.__spread([r],s):e.__spread(s),y.forEach(function(e){var o;switch(e.repositoryType){case t.Repository:o=r.getRepository(e.entityType);break;case t.MongoRepository:o=r.getMongoRepository(e.entityType);break;case t.TreeRepository:o=r.getTreeRepository(e.entityType);break;default:o=r.getCustomRepository(e.repositoryType)}c.splice(e.index,0,o)}),i.apply(a,c)};return y?(0,t.getConnection)(p).manager.transaction(y,u):(0,t.getConnection)(p).manager.transaction(u)}}}
},{"tslib":"c4AP","../../":"wlNf"}],"CRas":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransactionManager=e;var t=require("../../");function e(){return function(e,r,a){(0,t.getMetadataArgsStorage)().transactionEntityManagers.push({target:e.constructor,methodName:r,index:a})}}
},{"../../":"wlNf"}],"2dK7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CannotReflectMethodParameterTypeError=void 0;var e=t(require("tslib"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}var r=function(t){function r(e,o){var a=t.call(this)||this;return a.name="CannotReflectMethodParameterTypeError",Object.setPrototypeOf(a,r.prototype),a.message='Cannot get reflected type for a "'+o+'" method\'s parameter of "'+e.name+'" class. Make sure you have turned on an "emitDecoratorMetadata": true option in tsconfig.json. Also make sure you have imported "reflect-metadata" on top of the main entry file in your application.',a}return e.__extends(r,t),r}(Error);exports.CannotReflectMethodParameterTypeError=r;
},{"tslib":"c4AP"}],"mkqp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransactionRepository=r;var e=require("../../"),t=require("../../error/CannotReflectMethodParameterTypeError");function r(r){return function(o,a,n){var s;try{s=Reflect.getOwnMetadata("design:paramtypes",o,a)[n]}catch(c){throw new t.CannotReflectMethodParameterTypeError(o.constructor,a)}(0,e.getMetadataArgsStorage)().transactionRepositories.push({target:o.constructor,methodName:a,index:n,repositoryType:s,entityType:r})}}
},{"../../":"wlNf","../../error/CannotReflectMethodParameterTypeError":"2dK7"}],"+Hy2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TreeLevelColumn=t;var e=require("../../");function t(){return function(t,r){(0,e.getMetadataArgsStorage)().columns.push({target:t.constructor,propertyName:r,mode:"treeLevel",options:{}})}}
},{"../../":"wlNf"}],"fQwK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TreeParent=t;var e=require("../../");function t(){return function(t,r){var a=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",t,r):void 0,o=a&&"string"==typeof a.name&&"promise"===a.name.toLowerCase()||!1;(0,e.getMetadataArgsStorage)().relations.push({isTreeParent:!0,target:t.constructor,propertyName:r,isLazy:o,relationType:"many-to-one",type:function(){return t.constructor},options:{}})}}
},{"../../":"wlNf"}],"CN8e":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TreeChildren=t;var e=require("../../");function t(t){return function(r,o){t||(t={});var a=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",r,o):void 0,n=a&&"string"==typeof a.name&&"promise"===a.name.toLowerCase()||!1;(0,e.getMetadataArgsStorage)().relations.push({isTreeChildren:!0,target:r.constructor,propertyName:o,isLazy:n,relationType:"one-to-many",type:function(){return r.constructor},options:t})}}
},{"../../":"wlNf"}],"3r3F":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Tree=t;var e=require("../../");function t(t){return function(r){(0,e.getMetadataArgsStorage)().trees.push({target:r,type:t})}}
},{"../../":"wlNf"}],"Og7E":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Index=r;var e=require("../");function r(r,t,o){var s="string"==typeof r?r:void 0,n="string"==typeof r?t:r,i="object"!=typeof r||Array.isArray(r)?o:r;return i||(i="object"!=typeof t||Array.isArray(t)?o:t),function(r,t){(0,e.getMetadataArgsStorage)().indices.push({target:t?r.constructor:r,name:s,columns:t?[t]:n,synchronize:!i||!1!==i.synchronize,where:i?i.where:void 0,unique:!(!i||!i.unique),spatial:!(!i||!i.spatial),fulltext:!(!i||!i.fulltext),sparse:!(!i||!i.sparse),background:!(!i||!i.background),expireAfterSeconds:i&&i.expireAfterSeconds?i.expireAfterSeconds:void 0})}}
},{"../":"wlNf"}],"6Ovw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Unique=t;var e=require("../index");function t(t,r){var n="string"==typeof t?t:void 0,o="string"==typeof t?r:t;return function(t,r){var u={target:r?t.constructor:t,name:n,columns:r?[r]:o};(0,e.getMetadataArgsStorage)().uniques.push(u)}}
},{"../index":"wlNf"}],"R5N0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Check=r;var e=require("../");function r(r,t){var o=t?r:void 0,s=t||r;if(!s)throw new Error("Check expression is required");return function(r,t){(0,e.getMetadataArgsStorage)().checks.push({target:t?r.constructor:r,name:o,expression:s})}}
},{"../":"wlNf"}],"hsym":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Exclusion=r;var e=require("../");function r(r,t){var o=t?r:void 0,s=t||r;if(!s)throw new Error("Exclusion expression is required");return function(r,t){(0,e.getMetadataArgsStorage)().exclusions.push({target:t?r.constructor:r,name:o,expression:s})}}
},{"../":"wlNf"}],"dEdE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Generated=t;var e=require("../");function t(t){return void 0===t&&(t="increment"),function(r,n){(0,e.getMetadataArgsStorage)().generations.push({target:r.constructor,propertyName:n,strategy:t})}}
},{"../":"wlNf"}],"ss+X":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityRepository=e;var t=require("../");function e(e){return function(r){(0,t.getMetadataArgsStorage)().entityRepositories.push({target:r,entity:e})}}
},{"../":"wlNf"}],"MEA8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Any=r;var e=require("../FindOperator");function r(r){return new e.FindOperator("any",r)}
},{"../FindOperator":"YWTi"}],"VcYq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Between=r;var e=require("../FindOperator");function r(r,t){return new e.FindOperator("between",[r,t],!0,!0)}
},{"../FindOperator":"YWTi"}],"zjoC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Equal=r;var e=require("../FindOperator");function r(r){return new e.FindOperator("equal",r)}
},{"../FindOperator":"YWTi"}],"pJN9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IsNull=r;var e=require("../FindOperator");function r(){return new e.FindOperator("isNull",void 0,!1)}
},{"../FindOperator":"YWTi"}],"tx1a":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LessThan=r;var e=require("../FindOperator");function r(r){return new e.FindOperator("lessThan",r)}
},{"../FindOperator":"YWTi"}],"ek4k":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LessThanOrEqual=r;var e=require("../FindOperator");function r(r){return new e.FindOperator("lessThanOrEqual",r)}
},{"../FindOperator":"YWTi"}],"3CCC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Like=r;var e=require("../FindOperator");function r(r){return new e.FindOperator("like",r)}
},{"../FindOperator":"YWTi"}],"6Sfe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MoreThan=r;var e=require("../FindOperator");function r(r){return new e.FindOperator("moreThan",r)}
},{"../FindOperator":"YWTi"}],"cmMz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MoreThanOrEqual=r;var e=require("../FindOperator");function r(r){return new e.FindOperator("moreThanOrEqual",r)}
},{"../FindOperator":"YWTi"}],"HlAT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Not=r;var e=require("../FindOperator");function r(r){return new e.FindOperator("not",r)}
},{"../FindOperator":"YWTi"}],"CSTf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Raw=r;var e=require("../FindOperator");function r(r){return new e.FindOperator("raw",r,!1)}
},{"../FindOperator":"YWTi"}],"uBO3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseEntity=void 0;var t=n(require("tslib")),e=require("../index"),r=require("../util/ObjectUtils");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}var i=function(){function n(){}return n.prototype.hasId=function(){return this.constructor.getRepository().hasId(this)},n.prototype.save=function(){return this.constructor.getRepository().save(this)},n.prototype.remove=function(){return this.constructor.getRepository().remove(this)},n.prototype.reload=function(){return t.__awaiter(this,void 0,void 0,function(){var e,n;return t.__generator(this,function(t){switch(t.label){case 0:return[4,(e=this.constructor).getRepository().findOneOrFail(e.getId(this))];case 1:return n=t.sent(),r.ObjectUtils.assign(this,n),[2]}})})},n.useConnection=function(t){this.usedConnection=t},n.getRepository=function(){return(this.usedConnection||(0,e.getConnection)()).getRepository(this)},Object.defineProperty(n,"target",{get:function(){return this.getRepository().target},enumerable:!0,configurable:!0}),n.hasId=function(t){return this.getRepository().hasId(t)},n.getId=function(t){return this.getRepository().getId(t)},n.createQueryBuilder=function(t){return this.getRepository().createQueryBuilder(t)},n.create=function(t){return this.getRepository().create(t)},n.merge=function(e){for(var r,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return(r=this.getRepository()).merge.apply(r,t.__spread([e],n))},n.preload=function(t){return this.getRepository().preload(t)},n.save=function(t,e){return this.getRepository().save(t,e)},n.remove=function(t,e){return this.getRepository().remove(t,e)},n.insert=function(t,e){return this.getRepository().insert(t,e)},n.update=function(t,e,r){return this.getRepository().update(t,e,r)},n.delete=function(t,e){return this.getRepository().delete(t,e)},n.count=function(t){return this.getRepository().count(t)},n.find=function(t){return this.getRepository().find(t)},n.findAndCount=function(t){return this.getRepository().findAndCount(t)},n.findByIds=function(t,e){return this.getRepository().findByIds(t,e)},n.findOne=function(t,e){return this.getRepository().findOne(t,e)},n.findOneOrFail=function(t,e){return this.getRepository().findOneOrFail(t,e)},n.query=function(t,e){return this.getRepository().query(t,e)},n.clear=function(){return this.getRepository().clear()},n}();exports.BaseEntity=i;
},{"tslib":"c4AP","../index":"wlNf","../util/ObjectUtils":"41H8"}],"oveQ":[function(require,module,exports) {
"use strict";var r=require("../../platform/PlatformTools");
},{"../../platform/PlatformTools":"YF44"}],"wlNf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={getMetadataArgsStorage:!0,getConnectionOptions:!0,getConnectionManager:!0,createConnection:!0,createConnections:!0,getConnection:!0,getManager:!0,getMongoManager:!0,getSqljsManager:!0,getRepository:!0,getTreeRepository:!0,getCustomRepository:!0,getMongoRepository:!0,createQueryBuilder:!0,ConnectionManager:!0,ConnectionOptionsReader:!0,PromiseUtils:!0,EntityManager:!0,Repository:!0,BaseEntity:!0,TreeRepository:!0,MongoRepository:!0,Connection:!0,QueryBuilder:!0,SelectQueryBuilder:!0,DeleteQueryBuilder:!0,InsertQueryBuilder:!0,UpdateQueryBuilder:!0,RelationQueryBuilder:!0,Brackets:!0,InsertResult:!0,UpdateResult:!0,DeleteResult:!0,MongoEntityManager:!0,DefaultNamingStrategy:!0,EntitySchema:!0};exports.getMetadataArgsStorage=Le,exports.getConnectionOptions=Ne,exports.getConnectionManager=Fe,exports.createConnection=Ve,exports.createConnections=Ge,exports.getConnection=Je,exports.getManager=Ke,exports.getMongoManager=ze,exports.getSqljsManager=He,exports.getRepository=We,exports.getTreeRepository=Xe,exports.getCustomRepository=Ye,exports.getMongoRepository=Ze,exports.createQueryBuilder=$e,Object.defineProperty(exports,"ConnectionManager",{enumerable:!0,get:function(){return t.ConnectionManager}}),Object.defineProperty(exports,"ConnectionOptionsReader",{enumerable:!0,get:function(){return a.ConnectionOptionsReader}}),Object.defineProperty(exports,"PromiseUtils",{enumerable:!0,get:function(){return c.PromiseUtils}}),Object.defineProperty(exports,"EntityManager",{enumerable:!0,get:function(){return ye.EntityManager}}),Object.defineProperty(exports,"Repository",{enumerable:!0,get:function(){return be.Repository}}),Object.defineProperty(exports,"BaseEntity",{enumerable:!0,get:function(){return Oe.BaseEntity}}),Object.defineProperty(exports,"TreeRepository",{enumerable:!0,get:function(){return je.TreeRepository}}),Object.defineProperty(exports,"MongoRepository",{enumerable:!0,get:function(){return ge.MongoRepository}}),Object.defineProperty(exports,"Connection",{enumerable:!0,get:function(){return xe.Connection}}),Object.defineProperty(exports,"QueryBuilder",{enumerable:!0,get:function(){return ve.QueryBuilder}}),Object.defineProperty(exports,"SelectQueryBuilder",{enumerable:!0,get:function(){return Ee.SelectQueryBuilder}}),Object.defineProperty(exports,"DeleteQueryBuilder",{enumerable:!0,get:function(){return we.DeleteQueryBuilder}}),Object.defineProperty(exports,"InsertQueryBuilder",{enumerable:!0,get:function(){return ke.InsertQueryBuilder}}),Object.defineProperty(exports,"UpdateQueryBuilder",{enumerable:!0,get:function(){return Re.UpdateQueryBuilder}}),Object.defineProperty(exports,"RelationQueryBuilder",{enumerable:!0,get:function(){return Ce.RelationQueryBuilder}}),Object.defineProperty(exports,"Brackets",{enumerable:!0,get:function(){return Be.Brackets}}),Object.defineProperty(exports,"InsertResult",{enumerable:!0,get:function(){return Te.InsertResult}}),Object.defineProperty(exports,"UpdateResult",{enumerable:!0,get:function(){return Qe.UpdateResult}}),Object.defineProperty(exports,"DeleteResult",{enumerable:!0,get:function(){return Se.DeleteResult}}),Object.defineProperty(exports,"MongoEntityManager",{enumerable:!0,get:function(){return Ie.MongoEntityManager}}),Object.defineProperty(exports,"DefaultNamingStrategy",{enumerable:!0,get:function(){return Ue.DefaultNamingStrategy}}),Object.defineProperty(exports,"EntitySchema",{enumerable:!0,get:function(){return De.EntitySchema}});var r=Ae(require("tslib"));require("reflect-metadata");var t=require("./connection/ConnectionManager"),o=require("./metadata-args/MetadataArgsStorage"),n=require("./container");Object.keys(n).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return n[r]}}))});var u=require("./platform/PlatformTools"),a=require("./connection/ConnectionOptionsReader"),c=require("./util/PromiseUtils"),i=require("./error/QueryFailedError");Object.keys(i).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return i[r]}}))});var l=require("./decorator/columns/Column");Object.keys(l).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return l[r]}}))});var s=require("./decorator/columns/CreateDateColumn");Object.keys(s).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return s[r]}}))});var p=require("./decorator/columns/PrimaryGeneratedColumn");Object.keys(p).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return p[r]}}))});var f=require("./decorator/columns/PrimaryColumn");Object.keys(f).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return f[r]}}))});var y=require("./decorator/columns/UpdateDateColumn");Object.keys(y).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return y[r]}}))});var d=require("./decorator/columns/VersionColumn");Object.keys(d).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return d[r]}}))});var b=require("./decorator/columns/ViewColumn");Object.keys(b).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return b[r]}}))});var O=require("./decorator/columns/ObjectIdColumn");Object.keys(O).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return O[r]}}))});var j=require("./decorator/listeners/AfterInsert");Object.keys(j).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return j[r]}}))});var g=require("./decorator/listeners/AfterLoad");Object.keys(g).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return g[r]}}))});var P=require("./decorator/listeners/AfterRemove");Object.keys(P).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return P[r]}}))});var h=require("./decorator/listeners/AfterUpdate");Object.keys(h).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return h[r]}}))});var _=require("./decorator/listeners/BeforeInsert");Object.keys(_).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return _[r]}}))});var m=require("./decorator/listeners/BeforeRemove");Object.keys(m).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return m[r]}}))});var M=require("./decorator/listeners/BeforeUpdate");Object.keys(M).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return M[r]}}))});var q=require("./decorator/listeners/EventSubscriber");Object.keys(q).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return q[r]}}))});var x=require("./decorator/relations/JoinColumn");Object.keys(x).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return x[r]}}))});var v=require("./decorator/relations/JoinTable");Object.keys(v).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return v[r]}}))});var E=require("./decorator/relations/ManyToMany");Object.keys(E).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return E[r]}}))});var w=require("./decorator/relations/ManyToOne");Object.keys(w).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return w[r]}}))});var k=require("./decorator/relations/OneToMany");Object.keys(k).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return k[r]}}))});var R=require("./decorator/relations/OneToOne");Object.keys(R).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return R[r]}}))});var C=require("./decorator/relations/RelationCount");Object.keys(C).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return C[r]}}))});var B=require("./decorator/relations/RelationId");Object.keys(B).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return B[r]}}))});var T=require("./decorator/entity/Entity");Object.keys(T).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return T[r]}}))});var Q=require("./decorator/entity/ChildEntity");Object.keys(Q).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return Q[r]}}))});var S=require("./decorator/entity/TableInheritance");Object.keys(S).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return S[r]}}))});var I=require("./decorator/entity-view/ViewEntity");Object.keys(I).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return I[r]}}))});var U=require("./decorator/transaction/Transaction");Object.keys(U).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return U[r]}}))});var D=require("./decorator/transaction/TransactionManager");Object.keys(D).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return D[r]}}))});var A=require("./decorator/transaction/TransactionRepository");Object.keys(A).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return A[r]}}))});var L=require("./decorator/tree/TreeLevelColumn");Object.keys(L).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return L[r]}}))});var N=require("./decorator/tree/TreeParent");Object.keys(N).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return N[r]}}))});var F=require("./decorator/tree/TreeChildren");Object.keys(F).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return F[r]}}))});var V=require("./decorator/tree/Tree");Object.keys(V).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return V[r]}}))});var G=require("./decorator/Index");Object.keys(G).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return G[r]}}))});var J=require("./decorator/Unique");Object.keys(J).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return J[r]}}))});var K=require("./decorator/Check");Object.keys(K).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return K[r]}}))});var z=require("./decorator/Exclusion");Object.keys(z).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return z[r]}}))});var H=require("./decorator/Generated");Object.keys(H).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return H[r]}}))});var W=require("./decorator/EntityRepository");Object.keys(W).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return W[r]}}))});var X=require("./find-options/operator/Any");Object.keys(X).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return X[r]}}))});var Y=require("./find-options/operator/Between");Object.keys(Y).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return Y[r]}}))});var Z=require("./find-options/operator/Equal");Object.keys(Z).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return Z[r]}}))});var $=require("./find-options/operator/In");Object.keys($).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return $[r]}}))});var ee=require("./find-options/operator/IsNull");Object.keys(ee).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return ee[r]}}))});var re=require("./find-options/operator/LessThan");Object.keys(re).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return re[r]}}))});var te=require("./find-options/operator/LessThanOrEqual");Object.keys(te).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return te[r]}}))});var oe=require("./find-options/operator/Like");Object.keys(oe).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return oe[r]}}))});var ne=require("./find-options/operator/MoreThan");Object.keys(ne).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return ne[r]}}))});var ue=require("./find-options/operator/MoreThanOrEqual");Object.keys(ue).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return ue[r]}}))});var ae=require("./find-options/operator/Not");Object.keys(ae).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return ae[r]}}))});var ce=require("./find-options/operator/Raw");Object.keys(ce).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return ce[r]}}))});var ie=require("./find-options/FindOperator");Object.keys(ie).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return ie[r]}}))});var le=require("./logger/AdvancedConsoleLogger");Object.keys(le).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return le[r]}}))});var se=require("./logger/SimpleConsoleLogger");Object.keys(se).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return se[r]}}))});var pe=require("./logger/FileLogger");Object.keys(pe).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return pe[r]}}))});var fe=require("./metadata/EntityMetadata");Object.keys(fe).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return fe[r]}}))});var ye=require("./entity-manager/EntityManager");Object.keys(ye).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return ye[r]}}))});var de=require("./repository/AbstractRepository");Object.keys(de).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return de[r]}}))});var be=require("./repository/Repository");Object.keys(be).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return be[r]}}))});var Oe=require("./repository/BaseEntity");Object.keys(Oe).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return Oe[r]}}))});var je=require("./repository/TreeRepository");Object.keys(je).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return je[r]}}))});var ge=require("./repository/MongoRepository");Object.keys(ge).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return ge[r]}}))});var Pe=require("./schema-builder/table/TableColumn");Object.keys(Pe).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return Pe[r]}}))});var he=require("./schema-builder/table/TableForeignKey");Object.keys(he).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return he[r]}}))});var _e=require("./schema-builder/table/TableIndex");Object.keys(_e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return _e[r]}}))});var me=require("./schema-builder/table/Table");Object.keys(me).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return me[r]}}))});var Me=require("./driver/mongodb/typings");Object.keys(Me).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return Me[r]}}))});var qe=require("./driver/sqlserver/MssqlParameter");Object.keys(qe).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return qe[r]}}))});var xe=require("./connection/Connection"),ve=require("./query-builder/QueryBuilder"),Ee=require("./query-builder/SelectQueryBuilder"),we=require("./query-builder/DeleteQueryBuilder"),ke=require("./query-builder/InsertQueryBuilder"),Re=require("./query-builder/UpdateQueryBuilder"),Ce=require("./query-builder/RelationQueryBuilder"),Be=require("./query-builder/Brackets"),Te=require("./query-builder/result/InsertResult"),Qe=require("./query-builder/result/UpdateResult"),Se=require("./query-builder/result/DeleteResult"),Ie=require("./entity-manager/MongoEntityManager"),Ue=require("./naming-strategy/DefaultNamingStrategy"),De=require("./entity-schema/EntitySchema");function Ae(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}function Le(){var e=u.PlatformTools.getGlobalVariable();return e.typeormMetadataArgsStorage||(e.typeormMetadataArgsStorage=new o.MetadataArgsStorage),e.typeormMetadataArgsStorage}function Ne(e){return void 0===e&&(e="default"),r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){return[2,(new a.ConnectionOptionsReader).get(e)]})})}function Fe(){return(0,n.getFromContainer)(t.ConnectionManager)}function Ve(e){return r.__awaiter(this,void 0,void 0,function(){var t,o,n;return r.__generator(this,function(r){switch(r.label){case 0:return t="string"==typeof e?e:"default",e instanceof Object?(n=e,[3,3]):[3,1];case 1:return[4,Ne(t)];case 2:n=r.sent(),r.label=3;case 3:return o=n,[2,Fe().create(o).connect()]}})})}function Ge(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(r){switch(r.label){case 0:return e?[3,2]:[4,(new a.ConnectionOptionsReader).all()];case 1:e=r.sent(),r.label=2;case 2:return t=e.map(function(e){return Fe().create(e)}),[2,c.PromiseUtils.runInSequence(t,function(e){return e.connect()})]}})})}function Je(e){return void 0===e&&(e="default"),Fe().get(e)}function Ke(e){return void 0===e&&(e="default"),Fe().get(e).manager}function ze(e){return void 0===e&&(e="default"),Fe().get(e).manager}function He(e){return void 0===e&&(e="default"),Fe().get(e).manager}function We(e,r){return void 0===r&&(r="default"),Fe().get(r).getRepository(e)}function Xe(e,r){return void 0===r&&(r="default"),Fe().get(r).getTreeRepository(e)}function Ye(e,r){return void 0===r&&(r="default"),Fe().get(r).getCustomRepository(e)}function Ze(e,r){return void 0===r&&(r="default"),Fe().get(r).getMongoRepository(e)}function $e(e,r,t){return void 0===t&&(t="default"),e?We(e,t).createQueryBuilder(r):Je(t).createQueryBuilder()}
},{"tslib":"c4AP","reflect-metadata":"w3jr","./connection/ConnectionManager":"byiK","./metadata-args/MetadataArgsStorage":"Oy9V","./container":"0ey2","./platform/PlatformTools":"YF44","./connection/ConnectionOptionsReader":"f3df","./util/PromiseUtils":"DcM6","./error/QueryFailedError":"U3oI","./decorator/columns/Column":"qleF","./decorator/columns/CreateDateColumn":"mcqJ","./decorator/columns/PrimaryGeneratedColumn":"u+TS","./decorator/columns/PrimaryColumn":"K6zO","./decorator/columns/UpdateDateColumn":"/3Oe","./decorator/columns/VersionColumn":"/DuP","./decorator/columns/ViewColumn":"59Mw","./decorator/columns/ObjectIdColumn":"bhYT","./decorator/listeners/AfterInsert":"CWLy","./decorator/listeners/AfterLoad":"dryV","./decorator/listeners/AfterRemove":"06Ao","./decorator/listeners/AfterUpdate":"Rfdi","./decorator/listeners/BeforeInsert":"F2U4","./decorator/listeners/BeforeRemove":"meTF","./decorator/listeners/BeforeUpdate":"yGdA","./decorator/listeners/EventSubscriber":"2tYN","./decorator/relations/JoinColumn":"ft/t","./decorator/relations/JoinTable":"PSo5","./decorator/relations/ManyToMany":"B6Zk","./decorator/relations/ManyToOne":"rqI9","./decorator/relations/OneToMany":"BaJY","./decorator/relations/OneToOne":"SNSy","./decorator/relations/RelationCount":"CBKm","./decorator/relations/RelationId":"w7SH","./decorator/entity/Entity":"RdRM","./decorator/entity/ChildEntity":"G4ey","./decorator/entity/TableInheritance":"juLg","./decorator/entity-view/ViewEntity":"9E0Q","./decorator/transaction/Transaction":"BuVI","./decorator/transaction/TransactionManager":"CRas","./decorator/transaction/TransactionRepository":"mkqp","./decorator/tree/TreeLevelColumn":"+Hy2","./decorator/tree/TreeParent":"fQwK","./decorator/tree/TreeChildren":"CN8e","./decorator/tree/Tree":"3r3F","./decorator/Index":"Og7E","./decorator/Unique":"6Ovw","./decorator/Check":"R5N0","./decorator/Exclusion":"hsym","./decorator/Generated":"dEdE","./decorator/EntityRepository":"ss+X","./find-options/operator/Any":"MEA8","./find-options/operator/Between":"VcYq","./find-options/operator/Equal":"zjoC","./find-options/operator/In":"3fkF","./find-options/operator/IsNull":"pJN9","./find-options/operator/LessThan":"tx1a","./find-options/operator/LessThanOrEqual":"ek4k","./find-options/operator/Like":"3CCC","./find-options/operator/MoreThan":"6Sfe","./find-options/operator/MoreThanOrEqual":"cmMz","./find-options/operator/Not":"HlAT","./find-options/operator/Raw":"CSTf","./find-options/FindOperator":"YWTi","./logger/AdvancedConsoleLogger":"GoC3","./logger/SimpleConsoleLogger":"++uV","./logger/FileLogger":"XHDv","./metadata/EntityMetadata":"Raef","./entity-manager/EntityManager":"oI6K","./repository/AbstractRepository":"7cL5","./repository/Repository":"ZbgY","./repository/BaseEntity":"uBO3","./repository/TreeRepository":"Ayc+","./repository/MongoRepository":"TOLf","./schema-builder/table/TableColumn":"SdPr","./schema-builder/table/TableForeignKey":"0LZF","./schema-builder/table/TableIndex":"S7W/","./schema-builder/table/Table":"e+Cn","./driver/mongodb/typings":"oveQ","./driver/sqlserver/MssqlParameter":"FBTY","./connection/Connection":"TRA1","./query-builder/QueryBuilder":"KIjK","./query-builder/SelectQueryBuilder":"lbRQ","./query-builder/DeleteQueryBuilder":"B5/s","./query-builder/InsertQueryBuilder":"Hxxx","./query-builder/UpdateQueryBuilder":"Z6U/","./query-builder/RelationQueryBuilder":"8i6n","./query-builder/Brackets":"d1r/","./query-builder/result/InsertResult":"lntw","./query-builder/result/UpdateResult":"Ukf1","./query-builder/result/DeleteResult":"wZjM","./entity-manager/MongoEntityManager":"TOLf","./naming-strategy/DefaultNamingStrategy":"DPOO","./entity-schema/EntitySchema":"ZvNi"}],"HZwn":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}var e=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),o=this&&this.__decorate||function(e,o,n,r){var i,u=arguments.length,f=u<3?o:null===r?r=Object.getOwnPropertyDescriptor(o,n):r;if("object"===("undefined"==typeof Reflect?"undefined":t(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(e,o,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(f=(u<3?i(f):u>3?i(o,n,f):i(o,n))||f);return u>3&&f&&Object.defineProperty(o,n,f),f},n=this&&this.__metadata||function(e,o){if("object"===("undefined"==typeof Reflect?"undefined":t(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,o)};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("typeorm"),i=require("./Token"),u=function(t){function u(){return null!==t&&t.apply(this,arguments)||this}return e(u,t),o([r.PrimaryGeneratedColumn(),n("design:type",Number)],u.prototype,"id",void 0),o([r.Column(),n("design:type",String)],u.prototype,"email",void 0),o([r.Column(),n("design:type",String)],u.prototype,"password",void 0),o([r.OneToMany(function(t){return i.Token},function(t){return t.user}),n("design:type",Array)],u.prototype,"tokens",void 0),u=o([r.Entity("users")],u)}(r.BaseEntity);exports.User=u;
},{"typeorm":"wlNf","./Token":"l/b1"}],"l/b1":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}var e=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),n=this&&this.__decorate||function(e,n,o,r){var i,f=arguments.length,c=f<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,o):r;if("object"===("undefined"==typeof Reflect?"undefined":t(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,n,o,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(c=(f<3?i(c):f>3?i(n,o,c):i(n,o))||c);return f>3&&c&&Object.defineProperty(n,o,c),c},o=this&&this.__metadata||function(e,n){if("object"===("undefined"==typeof Reflect?"undefined":t(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("typeorm"),i=require("./User"),f=function(t){function f(){return null!==t&&t.apply(this,arguments)||this}var c;return e(f,t),n([r.PrimaryColumn(),o("design:type",String)],f.prototype,"access_token",void 0),n([r.Column(),o("design:type",String)],f.prototype,"refresh_token",void 0),n([r.Column(),o("design:type",String)],f.prototype,"credentials_id",void 0),n([r.ManyToOne(function(t){return i.User},function(t){return t.tokens}),o("design:type","function"==typeof(c=void 0!==i.User&&i.User)?c:Object)],f.prototype,"user",void 0),f=n([r.Entity()],f)}(r.BaseEntity);exports.Token=f;
},{"typeorm":"wlNf","./User":"HZwn"}],"oX5T":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(a,o){function s(e){try{u(n.next(e))}catch(t){o(t)}}function i(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){e.done?a(e.value):new r(function(t){t(e.value)}).then(s,i)}u((n=n.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var r,n,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(i){o=[6,i],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var n=r(require("axios")),a=require("querystring"),o=require("../constants"),s=require("../entity/Token"),i=function(){function r(){}return r.exchangeCode=function(r){return e(this,void 0,void 0,function(){var e,s,i,u;return t(this,function(t){switch(t.label){case 0:return e={url:"https://auth.truelayer.com/connect/token",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:a.stringify({grant_type:"authorization_code",client_id:o.client_id,client_secret:o.TL_SECRET,redirect_uri:"http://localhost:3000/callback/callback",code:r})},[4,n.default(e)];case 1:return s=t.sent(),i=s.data.access_token,u=s.data.refresh_token,[2,{access_token:i,refresh_token:u}]}})})},r.meEndpoint=function(r){return e(this,void 0,Promise,function(){var e,a;return t(this,function(t){switch(t.label){case 0:e={url:"https://api.truelayer.com/data/v1/me",method:"GET",headers:{Authorization:"Bearer "+r}},t.label=1;case 1:return t.trys.push([1,3,,4]),[4,n.default(e)];case 2:return a=t.sent(),[3,4];case 3:return t.sent(),[2,void 0];case 4:return[2,a.data.results[0]]}})})},r.insertToken=function(r,n,a,o){return e(this,void 0,void 0,function(){var e,i;return t(this,function(t){switch(t.label){case 0:(e=new s.Token).access_token=r,e.refresh_token=n,e.credentials_id=a,e.user=o,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,e.save()];case 2:return t.sent(),[3,4];case 3:return i=t.sent(),console.log(i),[3,4];case 4:return[2]}})})},r.refreshToken=function(r){return e(this,void 0,void 0,function(){var e,i,u,c,l;return t(this,function(t){switch(t.label){case 0:return e={url:"https://auth.truelayer.com/connect/token",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:a.stringify({grant_type:"refresh_token",client_id:o.client_id,client_secret:o.TL_SECRET,refresh_token:r})},[4,n.default(e)];case 1:i=t.sent(),u=i.data.access_token,c=i.data.refresh_token,t.label=2;case 2:return t.trys.push([2,4,,5]),[4,s.Token.update({refresh_token:r},{access_token:u,refresh_token:c})];case 3:return t.sent(),[3,5];case 4:return l=t.sent(),console.log(l),[3,5];case 5:return[2]}})})},r.validateToken=function(r){return e(this,void 0,void 0,function(){var e,a;return t(this,function(t){switch(t.label){case 0:e={url:"https://api.truelayer.com/data/v1/me",method:"GET",headers:{Authorization:"Bearer "+r}},t.label=1;case 1:return t.trys.push([1,3,,4]),[4,n.default(e)];case 2:return a=t.sent(),[3,4];case 3:return t.sent(),[2,!1];case 4:return 200===a.status?[2,!0]:[2,!1]}})})},r}();exports.default=i;
},{"axios":"gI3o","querystring":"njjI","../constants":"Hmv1","../entity/Token":"l/b1"}],"mHh9":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}var t=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),n=this&&this.__decorate||function(t,n,r,o){var a,i=arguments.length,s=i<3?n:null===o?o=Object.getOwnPropertyDescriptor(n,r):o;if("object"===("undefined"==typeof Reflect?"undefined":e(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,n,r,o);else for(var u=t.length-1;u>=0;u--)(a=t[u])&&(s=(i<3?a(s):i>3?a(n,r,s):a(n,r))||s);return i>3&&s&&Object.defineProperty(n,r,s),s},r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(s){a=[6,s],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var i=require("vue-property-decorator"),s=a(require("axios")),u=a(require("./components/Table.vue")),c=a(require("./components/Navbar.vue")),l=a(require("sweetalert")),f=a(require("../../../app/services/truelayer")),p=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.credentials_id="",t.consent_status="",t.consent_status_created_at="",t.consent_status_expires_at="",t.provider_name="",t.provider_logo="",t.textLogOut="Log out",t.textRefresh="Refresh Token",t.textValidate="Validate Token",t.textAdd="Add Token",t.rowData=[],t}return t(a,e),a.prototype.mounted=function(){return r(this,void 0,void 0,function(){var e,t,n,r,a,i,u,c,p;return o(this,function(o){switch(o.label){case 0:e={url:"http://localhost:3000/home/home",method:"GET",headers:{"Content-Type":"application/json"}},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s.default(e)];case 2:return t=o.sent(),[3,4];case 3:return o.sent(),[2,l.default("Failed to fetch!")];case 4:console.log(t),n=t.data,console.log(n),r=0,a=n,o.label=5;case 5:return r<a.length?(i=a[r],u=i.access_token,[4,f.default.meEndpoint(u)]):[3,8];case 6:if(c=o.sent(),console.log(c),!c)return[2,"fail"];this.credentials_id=c.credentials_id,this.consent_status=c.consent_status,this.consent_status_created_at=c.consent_created_at,this.consent_status_expires_at=c.consent_expires_at,p=c.provider,this.provider_name=p.display_name,this.provider_logo=p.logo_uri,o.label=7;case 7:return r++,[3,5];case 8:return[2]}})})},a=n([i.Component({components:{Table:u.default,Navbar:c.default}})],a)}(i.Vue);exports.default=p;
(function(){var t=exports.default||module.exports;"function"==typeof t&&(t=t.options),Object.assign(t,{render:function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"Home"},[s("div",{staticClass:"Navbar"},[s("Navbar"),this._v(" "),s("div",{staticClass:"Table"},[s("Table",{attrs:{credentials_id:this.credentials_id,provider_name:this.provider_name,consent_status:this.consent_status,consent_status_created_at:this.consent_status_created_at,consent_status_expires_at:this.consent_status_expires_at,provider_icon:this.provider_logo}})],1)],1)])},staticRenderFns:[],_compiled:!0,_scopeId:null,functional:void 0});})();
},{"vue-property-decorator":"bOF0","axios":"gI3o","./components/Table.vue":"Bbek","./components/Navbar.vue":"k6wc","sweetalert":"AXFY","../../../app/services/truelayer":"oX5T"}],"OfRA":[function(require,module,exports) {

},{}],"9BfH":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("vue")),r=e(require("./Home.vue"));require("bootstrap/dist/css/bootstrap.min.css"),new t.default(r.default).$mount("#app");
},{"vue":"3Z1+","./Home.vue":"mHh9","bootstrap/dist/css/bootstrap.min.css":"OfRA"}]},{},["9BfH"], null)
//# sourceMappingURL=/home.93f8fe74.js.map